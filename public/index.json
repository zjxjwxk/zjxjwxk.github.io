[{"content":"ShardingJDBC çš„é…ç½®æºè·¯å¾„ SPI æœºåˆ¶ ç”±äºæœ€æ–°ç‰ˆæœ¬ ShardingJDBC ä¸å†æ”¯æŒåŸºäº Nacos ä½œä¸ºé…ç½®æ•°æ®æºçš„åŠŸèƒ½ï¼Œå¯ä»¥ä» ShardingSphere JDBC çš„ä¾èµ–åŒ…ä¸­è§‚å¯Ÿåˆ°ï¼Œå…¶æ•°æ®æºé…ç½®çš„è·å–æ¥å£ org.apache.shardingsphere.driver.jdbc.core.driver.ShardingSphereDriverURLProvider é‡‡ç”¨äº† SPI æœºåˆ¶ï¼Œä½†å…¶é»˜è®¤ä»…å®ç°äº†ä»¥ä¸‹å‡ ç§é…ç½®è·å–æ–¹å¼ï¼š AbsolutePathDriverURLProviderï¼ˆç»å¯¹è·¯å¾„ï¼‰ã€ClasspathDriverURLProvider ï¼ˆClass Path è·¯å¾„ï¼‰ å’Œ ApolloDriverURLProvider ï¼ˆApollo è·¯å¾„ï¼‰ã€‚\nå› æ­¤éœ€è¦è‡ªè¡ŒåŸºäº ShardingJDBC çš„ SPI æœºåˆ¶å¯¹ ShardingJDBC è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œä»¥å®ç°ä» Nacos è·å–æ•°æ®æºé…ç½®æ–‡ä»¶ã€‚\nShardingJDBC é…ç½®è·å–çš„æºç åˆ†æ æ ¹æ®è¯¥æ¥å£çš„åŒ…è·¯å¾„ org.apache.shardingsphere.driver.jdbc.core.driver ï¼Œå¯ä»¥æ‰¾åˆ°å…¶æ¥å£åŠå…¶å®ç°ç±»ï¼Œè¯¥æ¥å£åŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼š\nboolean accept(String url)ï¼šæ ¡éªŒå½“å‰ url æ˜¯å¦åº”è¯¥ä½¿ç”¨å½“å‰ç±»è·å–é…ç½® byte[] getContent(String url)ï¼šä»è¯¥ url è·å–é…ç½®æ–‡ä»¶ï¼Œå¹¶è¿”å›å­—èŠ‚æ•°ç»„ å¦‚æœå°†é…ç½®æ–‡ä»¶ db-sharding.yaml æ”¾åœ¨ src/main/resources ç›®å½•ä¸‹ï¼Œå¹¶ä½¿ç”¨ classpath ä½œä¸ºé…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼ˆå¦‚ spring.datasource.url=jdbc:shardingsphere:classpath:db-sharding.yamlï¼‰ï¼Œå¹¶åœ¨ ClasspathDriverURLProvider ç±»çš„ accept æ–¹æ³•ä¸­æ‰“æ–­ç‚¹å¹¶å¯åŠ¨æœåŠ¡ï¼Œå¯ä»¥å‘ç°åœ¨ä¸Šå±‚ä½¿ç”¨äº† ShardingSphereDriverURLManager ç±»æ¥å¯¹æ¯ä¸ªå®ç°ç±»è¿›è¡Œéå†ï¼Œåˆ†åˆ«è°ƒç”¨ accept æ ¡éªŒå½“å‰ url æ˜¯å¦é€‚ç”¨äºå½“å‰ç±»ï¼Œè‹¥é€‚ç”¨åˆ™è°ƒç”¨å…¶ getContent æ–¹æ³•ä»è¯¥ url è·å–ç›¸åº”çš„é…ç½®æ–‡ä»¶ã€‚\nå› æ­¤ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°å¯ä»¥åŸºäºè¯¥ SPI æœºåˆ¶å®ç°è‡ªå·±çš„ ShardingSphereDriverURLProvider å®ç°ç±»ï¼Œåˆ†åˆ«å®ç° accept æ–¹æ³•ç”¨äºæ ¡éªŒå½“å‰ url æ˜¯å¦æ˜¯ Nacos æ ¼å¼çš„é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œå¹¶å®ç° getContent æ–¹æ³•åˆ©ç”¨è¯¥ url ä» Nacos è·å–ç›¸åº”é…ç½®æ–‡ä»¶ã€‚\nåŸºäº SPI æœºåˆ¶å®ç° ShardingJDBC çš„ Nacos æ•°æ®æºé…ç½® å¼•å…¥ Maven ä¾èµ– æ­¤å¤„éœ€è¦å…ˆå¼•å…¥ä»¥ä¸‹ä¾èµ–ï¼Œä»¥å®ç° ShardingJDBC çš„ç›¸å…³æ¥å£ï¼Œå¹¶åˆ©ç”¨ Nacos æä¾›çš„ Client API è·å–é…ç½®æ–‡ä»¶ã€‚\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.shardingsphere\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;shardingsphere-jdbc-core\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.3.2\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.nacos\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;nacos-client\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; å®ç° Nacos é…ç½®æ–‡ä»¶è·å–ç±» åˆ›å»º NacosDriverURLProvider ç±»å®ç° ShardingJDBC æä¾›çš„ ShardingSphereDriverURLProvider SPI æ¥å£ï¼š\npackage com.zjxjwxk.live.framework.datasource.starter.config; import com.alibaba.nacos.api.NacosFactory; import com.alibaba.nacos.api.PropertyKeyConst; import com.alibaba.nacos.api.config.ConfigService; import com.alibaba.nacos.api.exception.NacosException; import groovy.util.logging.Slf4j; import org.apache.commons.lang3.StringUtils; import org.apache.shardingsphere.driver.jdbc.core.driver.ShardingSphereDriverURLProvider; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.util.Properties; /** * Sharding JDBC Nacos URL Provider * * @author Xinkang Wu * @date 2026/1/19 22:50 */ @Slf4j public class NacosDriverURLProvider implements ShardingSphereDriverURLProvider { private static final String NACOS_TYPE = \u0026#34;nacos:\u0026#34;; private static final String GROUP = \u0026#34;DEFAULT_GROUP\u0026#34;; private static final Logger log = LoggerFactory.getLogger(NacosDriverURLProvider.class); @Override public boolean accept(String url) { return StringUtils.isNotBlank(url) \u0026amp;\u0026amp; url.contains(NACOS_TYPE); } @Override public byte[] getContent(String url) { // url: jdbc:shardingsphere:nacos:live.zjxjwxk.com:8848:live-user-shardingjdbc.yaml?username=nacos\u0026amp;\u0026amp;password=nacos if (StringUtils.isBlank(url)) { return null; } // nacosUrl: live.zjxjwxk.com:8848:live-user-shardingjdbc.yaml?username=nacos\u0026amp;\u0026amp;password=nacos String nacosUrl = url.substring(url.lastIndexOf(NACOS_TYPE) + NACOS_TYPE.length()); // nacosUrlStr: {\u0026#34;live.zjxjwxk.com\u0026#34;, \u0026#34;8848\u0026#34;, \u0026#34;live-user-shardingjdbc.yaml?username=nacos\u0026amp;\u0026amp;password=nacos\u0026#34;} String[] nacosUrlStr = nacosUrl.split(\u0026#34;:\u0026#34;); // nacosFileUrl: live-user-shardingjdbc.yaml?username=nacos\u0026amp;\u0026amp;password=nacos String nacosFileUrl = nacosUrlStr[2]; // dataId: live-user-shardingjdbc.yaml String dataId = getDataId(nacosFileUrl); // username=\u0026gt;nacos, password=\u0026gt;nacos Properties properties = getProperties(nacosFileUrl); // serverAddr=\u0026gt;live.zjxjwxk.com:8848 properties.setProperty(PropertyKeyConst.SERVER_ADDR, nacosUrlStr[0] + \u0026#34;:\u0026#34; + nacosUrlStr[1]); try { ConfigService configService = NacosFactory.createConfigService(properties); String content = configService.getConfig(dataId, GROUP, 6000); log.info(\u0026#34;Sharding JDBC Configuration File from Nacos:\\n{}\u0026#34;, content); return content.getBytes(); } catch (NacosException e) { throw new RuntimeException(e); } } /** * è·å– Data ID * * @param nacosFile live-user-shardingjdbc.yaml?username=nacos\u0026amp;\u0026amp;password=nacos * @return live-user-shardingjdbc.yaml */ private String getDataId(String nacosFile) { // nacosProperties: {\u0026#34;live-user-shardingjdbc.yaml\u0026#34;, \u0026#34;username=nacos\u0026amp;\u0026amp;password=nacos\u0026#34;} String[] nacosProperties = nacosFile.split(\u0026#34;\\\\?\u0026#34;); // dataId: live-user-shardingjdbc.yaml return nacosProperties[0]; } /** * è·å– Properties * * @param nacosFileUrl live-user-shardingjdbc.yaml?username=nacos\u0026amp;\u0026amp;password=nacos * @return username=\u0026gt;nacos, password=\u0026gt;nacos */ private Properties getProperties(String nacosFileUrl) { Properties properties = new Properties(); // nacosProperties: {\u0026#34;live-user-shardingjdbc.yaml\u0026#34;, \u0026#34;username=nacos\u0026amp;\u0026amp;password=nacos\u0026#34;} String[] nacosProperties = nacosFileUrl.split(\u0026#34;\\\\?\u0026#34;); // propertyPairs: {\u0026#34;username=nacos\u0026#34;, \u0026#34;password=nacos\u0026#34;} String[] propertyPairs = nacosProperties[1].split(\u0026#34;\u0026amp;\u0026amp;\u0026#34;); for (String propertyPair : propertyPairs) { // propertyItem: {\u0026#34;username\u0026#34;, \u0026#34;nacos\u0026#34;} String[] propertyItem = propertyPair.split(\u0026#34;=\u0026#34;); String key = propertyItem[0]; String value = propertyItem[1]; properties.put(key, value); } return properties; } } æ­¤å¤„é…ç½®çš„ç›¸åº” url è·¯å¾„ä¸º jdbc:shardingsphere:nacos:live.zjxjwxk.com:8848:live-user-shardingjdbc.yaml?username=nacos\u0026amp;\u0026amp;password=nacosï¼Œå› æ­¤ä»¥ä¸‹æ–¹æ³•åˆ†åˆ«ç”¨äºå®ç°ï¼š\nboolean accept(String url)ï¼šæ ¡éªŒå½“å‰ url æ˜¯å¦åŒ…å« \u0026ldquo;nacos:\u0026rdquo; byte[] getContent(String url)ï¼šä»è¯¥ url è·å– Nacos é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­éœ€è¦åˆ†åˆ«ä» url ä¸­æå–ä»¥ä¸‹å­—æ®µç”¨äºä» Nacos è·å–é…ç½®æ–‡ä»¶ï¼š dataIdï¼ˆå³ Nacos ä¸Šè¯¥é…ç½®æ–‡ä»¶çš„ Data IDï¼‰ Properties ä¸­éœ€è¦åŒ…å«çš„å­—æ®µï¼ˆç›¸å…³å­—æ®µå¸¸é‡å¯ä»¥ä» com.alibaba.nacos.api.PropertyKeyConst è·å–ï¼‰ï¼š usernameï¼šNacos ç”¨æˆ·å passwordï¼šNacos å¯†ç  serverAddrï¼šNacos æœåŠ¡åœ°å€ åˆ›å»º SPI é…ç½®æ–‡ä»¶ éµå¾ª SPI æœºåˆ¶ï¼Œåœ¨ /META-INF/services/ è·¯å¾„ä¸‹ï¼Œåˆ›å»º SPI æ¥å£åŒåæ–‡ä»¶ org.apache.shardingsphere.driver.jdbc.core.driver.ShardingSphereDriverURLProvider ï¼ˆå…¨é™å®šç±»åï¼‰ï¼Œå¹¶åœ¨å…¶æ–‡ä»¶ä¸­å†™å…¥æˆ‘ä»¬åˆšåˆšå®ç°çš„ Nacos é…ç½®æ–‡ä»¶è·å–ç±» NacosDriverURLProvider çš„å…¨é™å®šç±»åï¼š\ncom.zjxjwxk.live.framework.datasource.starter.config.NacosDriverURLProvider ä¿®æ”¹ datasource url ä¸º Nacos åœ°å€ æœ€åï¼Œåœ¨ application.yml æ–‡ä»¶ä¸­ï¼Œå°† spring.datasource.url ä¿®æ”¹ä¸º Nacos é…ç½®æ–‡ä»¶è·¯å¾„å³å¯ï¼š\nspring: datasource: driver-class-name: org.apache.shardingsphere.driver.ShardingSphereDriver # url: jdbc:shardingsphere:classpath:db-sharding.yaml url: jdbc:shardingsphere:nacos:live.zjxjwxk.com:8848:live-user-shardingjdbc.yaml?username=nacos\u0026amp;\u0026amp;password=nacos ","permalink":"https://zjxjwxk.github.io/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/shardingjdbc/%E5%9F%BA%E4%BA%8E-spi-%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0-shardingjdbc-%E7%9A%84-nacos-%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE/","summary":"\u003ch2 id=\"shardingjdbc-çš„é…ç½®æºè·¯å¾„-spi-æœºåˆ¶\"\u003eShardingJDBC çš„é…ç½®æºè·¯å¾„ SPI æœºåˆ¶\u003c/h2\u003e\n\u003cp\u003eç”±äºæœ€æ–°ç‰ˆæœ¬ ShardingJDBC ä¸å†æ”¯æŒåŸºäº Nacos ä½œä¸ºé…ç½®æ•°æ®æºçš„åŠŸèƒ½ï¼Œå¯ä»¥ä» ShardingSphere JDBC çš„ä¾èµ–åŒ…ä¸­è§‚å¯Ÿåˆ°ï¼Œå…¶æ•°æ®æºé…ç½®çš„è·å–æ¥å£ \u003ccode\u003eorg.apache.shardingsphere.driver.jdbc.core.driver.ShardingSphereDriverURLProvider\u003c/code\u003e é‡‡ç”¨äº† SPI æœºåˆ¶ï¼Œä½†å…¶é»˜è®¤ä»…å®ç°äº†ä»¥ä¸‹å‡ ç§é…ç½®è·å–æ–¹å¼ï¼š AbsolutePathDriverURLProviderï¼ˆç»å¯¹è·¯å¾„ï¼‰ã€ClasspathDriverURLProvider ï¼ˆClass Path è·¯å¾„ï¼‰ å’Œ ApolloDriverURLProvider ï¼ˆApollo è·¯å¾„ï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20260120223851785\" loading=\"lazy\" src=\"/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/shardingjdbc/%E5%9F%BA%E4%BA%8E-spi-%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0-shardingjdbc-%E7%9A%84-nacos-%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE/images/image-20260120223851785.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå› æ­¤éœ€è¦è‡ªè¡ŒåŸºäº ShardingJDBC çš„ SPI æœºåˆ¶å¯¹ ShardingJDBC è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œä»¥å®ç°ä» Nacos è·å–æ•°æ®æºé…ç½®æ–‡ä»¶ã€‚\u003c/p\u003e\n\u003ch2 id=\"shardingjdbc-é…ç½®è·å–çš„æºç åˆ†æ\"\u003eShardingJDBC é…ç½®è·å–çš„æºç åˆ†æ\u003c/h2\u003e\n\u003cp\u003eæ ¹æ®è¯¥æ¥å£çš„åŒ…è·¯å¾„  \u003ccode\u003eorg.apache.shardingsphere.driver.jdbc.core.driver\u003c/code\u003e ï¼Œå¯ä»¥æ‰¾åˆ°å…¶æ¥å£åŠå…¶å®ç°ç±»ï¼Œè¯¥æ¥å£åŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eboolean accept(String url)ï¼šæ ¡éªŒå½“å‰ url æ˜¯å¦åº”è¯¥ä½¿ç”¨å½“å‰ç±»è·å–é…ç½®\u003c/li\u003e\n\u003cli\u003ebyte[] getContent(String url)ï¼šä»è¯¥ url è·å–é…ç½®æ–‡ä»¶ï¼Œå¹¶è¿”å›å­—èŠ‚æ•°ç»„\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg alt=\"image-20260120224837077\" loading=\"lazy\" src=\"/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/shardingjdbc/%E5%9F%BA%E4%BA%8E-spi-%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0-shardingjdbc-%E7%9A%84-nacos-%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE/images/image-20260120224837077.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå¦‚æœå°†é…ç½®æ–‡ä»¶ \u003ccode\u003edb-sharding.yaml\u003c/code\u003e æ”¾åœ¨ \u003ccode\u003esrc/main/resources\u003c/code\u003e ç›®å½•ä¸‹ï¼Œå¹¶ä½¿ç”¨ classpath ä½œä¸ºé…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼ˆå¦‚ \u003ccode\u003espring.datasource.url=jdbc:shardingsphere:classpath:db-sharding.yaml\u003c/code\u003eï¼‰ï¼Œå¹¶åœ¨ \u003ccode\u003eClasspathDriverURLProvider\u003c/code\u003e ç±»çš„ accept æ–¹æ³•ä¸­æ‰“æ–­ç‚¹å¹¶å¯åŠ¨æœåŠ¡ï¼Œå¯ä»¥å‘ç°åœ¨ä¸Šå±‚ä½¿ç”¨äº† \u003ccode\u003eShardingSphereDriverURLManager\u003c/code\u003e ç±»æ¥å¯¹æ¯ä¸ªå®ç°ç±»è¿›è¡Œéå†ï¼Œåˆ†åˆ«è°ƒç”¨ accept æ ¡éªŒå½“å‰ url æ˜¯å¦é€‚ç”¨äºå½“å‰ç±»ï¼Œè‹¥é€‚ç”¨åˆ™è°ƒç”¨å…¶ getContent æ–¹æ³•ä»è¯¥ url è·å–ç›¸åº”çš„é…ç½®æ–‡ä»¶ã€‚\u003c/p\u003e","title":"åŸºäº SPI æœºåˆ¶å®ç° ShardingJDBC çš„ Nacos æ•°æ®æºé…ç½®"},{"content":"Docker éƒ¨ç½² Nacos æ³¨å†Œä¸­å¿ƒ é¦–å…ˆéœ€è¦éƒ¨ç½² Nacos æ³¨å†Œä¸­å¿ƒï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸­è¿è¡Œ Nacos å•æœºæ¨¡å¼ï¼Œæ‰§è¡Œä»¥ä¸‹ Docker å‘½ä»¤æ‹‰å–é•œåƒå¹¶è¿è¡Œå®¹å™¨ï¼š\ndocker run -d \\ --name nacos-server \\ -p 8848:8848 \\ -p 9848:9848 \\ -e MODE=standalone \\ nacos/nacos-server:2.0.2 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‹¥åœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨æ¨¡æ‹ŸåŸŸåï¼ˆé…ç½®åœ¨ /etc/hosts ä¸­ï¼‰è®¿é—® Docker å®¹å™¨ä¸­çš„ Nacos æœåŠ¡ï¼Œå½“å¼€å¯äº† socks ç­‰ä»£ç†æœåŠ¡æ—¶ï¼Œå¯èƒ½å¯¼è‡´è®¿é—®å¤±è´¥ã€‚è‹¥ä½¿ç”¨äº†å¦‚ clash ç­‰ä»£ç†æœåŠ¡ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­å…³é—­å…¶ dns åŠŸèƒ½ï¼Œå¹¶é…ç½®è¯¥æ¨¡æ‹ŸåŸŸåä¸ºç›´è¿ï¼š\ndns: enable: false ... rules: - DOMAIN-SUFFIX,live.zjxjwxk.com,ğŸ¯ å…¨çƒç›´è¿ è‹¥éƒ¨ç½²æˆåŠŸï¼Œå¯ä»¥é€šè¿‡ localhost:8848/nacos/index.html è®¿é—® Nacos æ§åˆ¶å°é¡µé¢ã€‚\nMaven æ’ä»¶é…ç½® åœ¨éœ€è¦éƒ¨ç½²çš„å¾®æœåŠ¡çš„ pom.xml æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹æ’ä»¶ï¼Œç”¨äºåœ¨ Maven æ‰“åŒ…çš„åŒæ—¶æ„å»º Docker é•œåƒï¼š\n\u0026lt;build\u0026gt; \u0026lt;finalName\u0026gt;${artifactId}-docker\u0026lt;/finalName\u0026gt; \u0026lt;plugins\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;com.spotify\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;docker-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.0\u0026lt;/version\u0026gt; \u0026lt;executions\u0026gt; \u0026lt;!--å½“mvnæ‰§è¡Œinstallæ“ä½œçš„æ—¶å€™ï¼Œæ‰§è¡Œdockerçš„build--\u0026gt; \u0026lt;execution\u0026gt; \u0026lt;id\u0026gt;build\u0026lt;/id\u0026gt; \u0026lt;phase\u0026gt;install\u0026lt;/phase\u0026gt; \u0026lt;goals\u0026gt; \u0026lt;goal\u0026gt;build\u0026lt;/goal\u0026gt; \u0026lt;/goals\u0026gt; \u0026lt;/execution\u0026gt; \u0026lt;/executions\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;imageTags\u0026gt; \u0026lt;imageTag\u0026gt;${project.version}\u0026lt;/imageTag\u0026gt; \u0026lt;/imageTags\u0026gt; \u0026lt;imageName\u0026gt;${project.build.finalName}\u0026lt;/imageName\u0026gt; \u0026lt;!--æŒ‡å®šDockerfileæ–‡ä»¶çš„ä½ç½®--\u0026gt; \u0026lt;dockerDirectory\u0026gt;${project.basedir}/docker\u0026lt;/dockerDirectory\u0026gt; \u0026lt;!--æŒ‡å®šjaråŒ…è·¯å¾„ï¼Œè¿™é‡Œå¯¹åº”Dockerfileä¸­å¤åˆ¶jaråŒ… åˆ°dockerå®¹å™¨æŒ‡å®šç›®å½•é…ç½®ï¼Œä¹Ÿå¯ä»¥å†™åˆ°Dockerfileä¸­--\u0026gt; \u0026lt;resources\u0026gt; \u0026lt;resource\u0026gt; \u0026lt;targetPath\u0026gt;/\u0026lt;/targetPath\u0026gt; \u0026lt;!--å°†ä¸‹è¾¹ç›®å½•çš„å†…å®¹ï¼Œæ‹·è´åˆ°dockeré•œåƒä¸­--\u0026gt; \u0026lt;directory\u0026gt;${project.build.directory}\u0026lt;/directory\u0026gt; \u0026lt;include\u0026gt;${project.build.finalName}.jar\u0026lt;/include\u0026gt; \u0026lt;/resource\u0026gt; \u0026lt;/resources\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;/plugins\u0026gt; \u0026lt;/build\u0026gt; ç¼–å†™ Dockerfile æ–‡ä»¶ åœ¨éœ€è¦éƒ¨ç½²çš„å¾®æœåŠ¡ç›®å½•ä¸‹åˆ›å»º docker æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨æ­¤æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºå¦‚ä¸‹ Dockerfile æ–‡ä»¶ï¼ˆè·¯å¾„ä¸ pom.xml ä¸­çš„ ${project.basedir}/docker ä¸€è‡´ï¼‰ï¼š\nFROM openjdk:17-jdk-alpine VOLUME /tmp ADD live-user-provider-docker.jar app.jar ENV JAVA_OPTS=\u0026#34;\\ -server \\ -Xmx1g \\ -Xms1g \\ -Xmn256m\u0026#34; ENTRYPOINT java ${JAVA_OPTS} -Djava.security.egd=file:/dev/./urandom -jar app.jar æ„å»º Docker é•œåƒ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåœ¨ Maven æ‰“åŒ…çš„åŒæ—¶æ„å»º Docker é•œåƒï¼š\nmvn install è‹¥æ„å»ºæˆåŠŸï¼Œåˆ™å¯ä»¥åœ¨ docker images å‘½ä»¤ä¸­æ‰¾åˆ°æ„å»ºæˆåŠŸçš„ Docker é•œåƒï¼š\nâ¯ docker images â”€â•¯ REPOSITORY TAG IMAGE ID CREATED SIZE live-user-provider-docker 1.0.0 45a95bb45bd6 2 hours ago 470MB è¿è¡Œ Docker å®¹å™¨ å¼€å‘ç¯å¢ƒä¸­ï¼Œä¸ºäº†é¿å…æœ¬æœº IP å˜åŒ–é€ æˆçš„éº»çƒ¦ï¼Œå¯ä»¥åœ¨ç¯å¢ƒå˜é‡ä¸­ï¼ˆå¦‚ ~/.zshrc ä¸­ï¼‰å®šä¹‰æœ¬æœº IP ä¸º $HOST_IPã€‚å¦‚ MacOS å¯ä»¥å®šä¹‰å¦‚ä¸‹å˜é‡ï¼Œè‡ªåŠ¨è·å–å½“å‰ IPï¼š export HOST_IP=$(ipconfig getifaddr en0) ç”±äºè¯¥æœåŠ¡ä¾èµ–çš„æ‰€æœ‰å¤–éƒ¨åœ°å€å‡ä½¿ç”¨æ¨¡æ‹ŸåŸŸåï¼Œå¹¶åœ¨å¼€å‘ç¯å¢ƒä¸­é…ç½®äº† /etc/hosts æ–‡ä»¶ç”¨äºæ¨¡æ‹ŸçœŸå®åŸŸåï¼Œå› æ­¤åœ¨è¿è¡Œ Docker å®¹å™¨æ—¶ï¼Œéœ€è¦å°†åŸŸåå’Œå®¿ä¸»æœº IP çš„æ˜ å°„é€šè¿‡ --add-hostä½œä¸º host ä¼ å…¥å®¹å™¨å†…çš„ /etc/hosts æ–‡ä»¶ã€‚\nç”±äºè¯¥ Dubbo æœåŠ¡éœ€è¦å‘ Nacos æ³¨å†Œå½“å‰æœåŠ¡ IPï¼Œå› æ­¤éœ€è¦é…ç½®ç¯å¢ƒå˜é‡ -e DUBBO_IP_TO_REGISTRY ç”¨äºé…ç½®å‘ Nacos æ³¨å†Œçš„çœŸå® IPï¼ˆæ­¤å¤„ä¸ºå®¿ä¸»æœº IPï¼‰ï¼Œè€Œä¸æ˜¯å®¹å™¨å†…çš„ IPï¼›å¹¶é€šè¿‡ -p å®ç°ç«¯å£æ˜ å°„ã€‚ï¼ˆå¯å‚è€ƒï¼šDubbo éƒ¨ç½²åˆ° Docker ç¯å¢ƒï¼‰\nç»¼ä¸Šï¼Œæ‰§è¡Œä»¥ä¸‹ Docker å‘½ä»¤è¿è¡Œå®¹å™¨ï¼ˆå…¶ä¸­ $HOST_IP ä¸ºå®¿ä¸»æœº IPï¼Œ \u0026ldquo;live.zjxjwxk.com\u0026rdquo; ä¸ºæ­¤æœåŠ¡ä¾èµ–çš„æ¨¡æ‹ŸåŸŸåï¼‰ï¼š\ndocker run --name live-user-provider \\ -p \u0026#34;$HOST_IP\u0026#34;:9090:9090 \\ -e DUBBO_IP_TO_REGISTRY=\u0026#34;$HOST_IP\u0026#34; \\ --add-host \u0026#34;live.zjxjwxk.com:$HOST_IP\u0026#34; \\ -d live-user-provider-docker:latest ","permalink":"https://zjxjwxk.github.io/posts/nacos/docker-%E9%83%A8%E7%BD%B2-dubbo-%E5%BE%AE%E6%9C%8D%E5%8A%A1/","summary":"\u003ch2 id=\"docker-éƒ¨ç½²-nacos-æ³¨å†Œä¸­å¿ƒ\"\u003eDocker éƒ¨ç½² Nacos æ³¨å†Œä¸­å¿ƒ\u003c/h2\u003e\n\u003cp\u003eé¦–å…ˆéœ€è¦éƒ¨ç½² Nacos æ³¨å†Œä¸­å¿ƒï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸­è¿è¡Œ Nacos å•æœºæ¨¡å¼ï¼Œæ‰§è¡Œä»¥ä¸‹ Docker å‘½ä»¤æ‹‰å–é•œåƒå¹¶è¿è¡Œå®¹å™¨ï¼š\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edocker run -d \\\n  --name nacos-server \\\n  -p 8848:8848 \\\n  -p 9848:9848 \\\n  -e MODE=standalone \\\n  nacos/nacos-server:2.0.2\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‹¥åœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨æ¨¡æ‹ŸåŸŸåï¼ˆé…ç½®åœ¨ /etc/hosts ä¸­ï¼‰è®¿é—® Docker å®¹å™¨ä¸­çš„ Nacos æœåŠ¡ï¼Œå½“å¼€å¯äº† socks ç­‰ä»£ç†æœåŠ¡æ—¶ï¼Œå¯èƒ½å¯¼è‡´è®¿é—®å¤±è´¥ã€‚è‹¥ä½¿ç”¨äº†å¦‚ clash ç­‰ä»£ç†æœåŠ¡ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­å…³é—­å…¶ dns åŠŸèƒ½ï¼Œå¹¶é…ç½®è¯¥æ¨¡æ‹ŸåŸŸåä¸ºç›´è¿ï¼š\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003edns:\n  enable: false\n  ...\n\nrules:\n  - DOMAIN-SUFFIX,live.zjxjwxk.com,ğŸ¯ å…¨çƒç›´è¿\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eè‹¥éƒ¨ç½²æˆåŠŸï¼Œå¯ä»¥é€šè¿‡ localhost:8848/nacos/index.html è®¿é—® Nacos æ§åˆ¶å°é¡µé¢ã€‚\u003c/p\u003e\n\u003ch2 id=\"maven-æ’ä»¶é…ç½®\"\u003eMaven æ’ä»¶é…ç½®\u003c/h2\u003e\n\u003cp\u003eåœ¨éœ€è¦éƒ¨ç½²çš„å¾®æœåŠ¡çš„ pom.xml æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹æ’ä»¶ï¼Œç”¨äºåœ¨ Maven æ‰“åŒ…çš„åŒæ—¶æ„å»º Docker é•œåƒï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;build\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e\u0026lt;finalName\u0026gt;\u003c/span\u003e${artifactId}-docker\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/finalName\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e\u0026lt;plugins\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;plugin\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003ecom.spotify\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003edocker-maven-plugin\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e1.2.0\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;executions\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e\u0026lt;!--å½“mvnæ‰§è¡Œinstallæ“ä½œçš„æ—¶å€™ï¼Œæ‰§è¡Œdockerçš„build--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;execution\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e\u0026lt;id\u0026gt;\u003c/span\u003ebuild\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/id\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e\u0026lt;phase\u0026gt;\u003c/span\u003einstall\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/phase\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e\u0026lt;goals\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;goal\u0026gt;\u003c/span\u003ebuild\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/goal\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/goals\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/execution\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/executions\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;configuration\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;imageTags\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e\u0026lt;imageTag\u0026gt;\u003c/span\u003e${project.version}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/imageTag\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/imageTags\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;imageName\u0026gt;\u003c/span\u003e${project.build.finalName}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/imageName\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e\u0026lt;!--æŒ‡å®šDockerfileæ–‡ä»¶çš„ä½ç½®--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dockerDirectory\u0026gt;\u003c/span\u003e${project.basedir}/docker\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dockerDirectory\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e\u0026lt;!--æŒ‡å®šjaråŒ…è·¯å¾„ï¼Œè¿™é‡Œå¯¹åº”Dockerfileä¸­å¤åˆ¶jaråŒ…\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e        åˆ°dockerå®¹å™¨æŒ‡å®šç›®å½•é…ç½®ï¼Œä¹Ÿå¯ä»¥å†™åˆ°Dockerfileä¸­--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;resources\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e\u0026lt;resource\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;targetPath\u0026gt;\u003c/span\u003e/\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/targetPath\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e\u0026lt;!--å°†ä¸‹è¾¹ç›®å½•çš„å†…å®¹ï¼Œæ‹·è´åˆ°dockeré•œåƒä¸­--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;directory\u0026gt;\u003c/span\u003e${project.build.directory}\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/directory\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026lt;include\u0026gt;\u003c/span\u003e${project.build.finalName}.jar\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/include\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e          \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/resource\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/resources\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/configuration\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/plugin\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;plugin\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.springframework.boot\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003espring-boot-maven-plugin\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/plugin\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/plugins\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/build\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"ç¼–å†™-dockerfile-æ–‡ä»¶\"\u003eç¼–å†™ Dockerfile æ–‡ä»¶\u003c/h2\u003e\n\u003cp\u003eåœ¨éœ€è¦éƒ¨ç½²çš„å¾®æœåŠ¡ç›®å½•ä¸‹åˆ›å»º docker æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨æ­¤æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºå¦‚ä¸‹ Dockerfile æ–‡ä»¶ï¼ˆè·¯å¾„ä¸ pom.xml ä¸­çš„ \u003ccode\u003e${project.basedir}/docker\u003c/code\u003e ä¸€è‡´ï¼‰ï¼š\u003c/p\u003e","title":"Docker éƒ¨ç½² Dubbo å¾®æœåŠ¡"},{"content":"åˆ›å»ºå®¿ä¸»æœº Docker å®¹å™¨æŒ‚è½½ç›®å½• mkdir -p /var/lib/mysql/master1/conf mkdir -p /var/lib/mysql/master1/data mkdir -p /var/lib/mysql/slave1/conf mkdir -p /var/lib/mysql/slave1/data åˆ›å»º MySQL ä¸»ä»é…ç½®æ–‡ä»¶ åˆ›å»ºä¸»åº“é…ç½®æ–‡ä»¶ï¼ˆå®¿ä¸»æœºè·¯å¾„ä¸º /var/lib/mysql/master1/conf/my.cnfï¼‰ï¼š\n[mysqld] character-set-server = utf8 lower-case-table-names = 1 # ä¸»ä»å¤åˆ¶,ä¸»æœºé…ç½®,ä¸»æœåŠ¡å™¨å”¯ä¸€ID server-id = 1 # å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿— log-bin=mysql-bin # è®¾ç½®logbinæ ¼å¼ binlog_format = STATEMENT åˆ›å»ºä»åº“é…ç½®æ–‡ä»¶ï¼ˆå®¿ä¸»æœºè·¯å¾„ï¼š/var/lib/mysql/slave1/conf/my.cnfï¼‰ï¼š\n[mysqld] character-set-server = utf8 lower-case-table-names = 1 # ä¸»ä»å¤åˆ¶,ä»æœºé…ç½®,ä»æœåŠ¡å™¨å”¯ä¸€ID server-id = 2 # å¯ç”¨ä¸­ç»§æ—¥å¿— relay-log = mysql-relay æˆæƒæ–‡ä»¶å¤¹ï¼š\nchmod -R 777 /var/lib/mysql éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸»ä»çš„ my.cnf æ–‡ä»¶æƒé™ä¸èƒ½ä¸º 777ï¼Œå¦åˆ™ my.cnf æ–‡ä»¶æ— æ³•åœ¨å®¹å™¨å†…ç”Ÿæ•ˆï¼Œåœ¨ç™»é™† Docker å®¹å™¨å†…çš„ MySQL æ—¶ä¼šæç¤ºï¼šmysql: [Warning] World-writable config file '/etc/mysql/my.cnf' is ignoredã€‚è§£å†³åŠæ³•æ˜¯ä¿®æ”¹å®¿ä¸»æœºä¸Šä¸»ä»çš„ my.cnf æƒé™ä¸ºæ›´ä½çš„ 644ï¼š\nchmod 644 /var/lib/mysql/master1/conf/my.cnf chmod 644 /var/lib/mysql/slave1/conf/my.cnf Docker å®¹å™¨å¯åŠ¨å‘½ä»¤ ç”±äºæœ¬äºº MySQL çš„ Docker é•œåƒé‡‡ç”¨çš„æ˜¯ mysql:8.0ï¼Œé»˜è®¤çš„ data è·¯å¾„ä¸º /var/lib/mysqlï¼Œé»˜è®¤çš„ my.cnf æ–‡ä»¶è·¯å¾„ä¸º /etc/mysql/my.cnfï¼Œæ•…é…ç½®å¦‚ä¸‹ docker å¯åŠ¨å‘½ä»¤ã€‚\nMySQL ä¸»åº“ï¼š\ndocker run --name=mysql-master-1 \\ --privileged=true \\ -p 8808:3306 \\ -v /var/lib/mysql/master1/data/:/var/lib/mysql \\ -v /var/lib/mysql/master1/conf/my.cnf:/etc/mysql/my.cnf \\ -v /var/lib/mysql/master1/mysql-files/:/var/lib/mysql-files/ \\ -e MYSQL_ROOT_PASSWORD=xxxxxx \\ -d mysql:8.0 --lower_case_table_names=1 MySQL ä»åº“ï¼š\ndocker run --name=mysql-slave-1 \\ --privileged=true \\ -p 8809:3306 \\ -v /var/lib/mysql/slave1/data/:/var/lib/mysql \\ -v /var/lib/mysql/slave1/conf/my.cnf:/etc/mysql/my.cnf \\ -v /var/lib/mysql/slave1/mysql-files/:/var/lib/mysql-files/ \\ -e MYSQL_ROOT_PASSWORD=xxxxxx \\ -d mysql:8.0 --lower_case_table_names=1 MySQL ä¸»ä»åŒæ­¥è„šæœ¬ MySQL ä¸»åº“æ‰§è¡Œè„šæœ¬ï¼š\n# åˆ›å»ºç”¨æˆ·,è®¾ç½®ä¸»ä»åŒæ­¥çš„è´¦æˆ·å create user \u0026#39;live-slave\u0026#39;@\u0026#39;%\u0026#39; identified with mysql_native_password by \u0026#39;12345678\u0026#39;; # æˆæƒ grant replication slave on *.* to \u0026#39;live-slave\u0026#39;@\u0026#39;%\u0026#39;; # åˆ·æ–°æƒé™ flush privileges; # æŸ¥è¯¢server_idå€¼ show variables like \u0026#39;server_id\u0026#39;; # ä¹Ÿå¯ä¸´æ—¶ï¼ˆé‡å¯åå¤±æ•ˆï¼‰æŒ‡å®šserver_idçš„å€¼ï¼ˆä¸»ä»æ•°æ®åº“çš„server_idä¸èƒ½ç›¸åŒï¼‰ set global server_id = 1; # æŸ¥è¯¢MasterçŠ¶æ€ï¼Œå¹¶è®°å½•Fileå’ŒPositionçš„å€¼ï¼Œè¿™ä¸¤ä¸ªå€¼ç”¨äºå’Œä¸‹è¾¹çš„ä»æ•°æ®åº“ä¸­çš„changeé‚£æ¡sqlä¸­çš„master_log_fileï¼Œmaster_log_poså‚æ•°å¯¹é½ä½¿ç”¨ show master status; # é‡ç½®ä¸‹masterçš„binlogä½ç‚¹ reset master; å¯ä»¥ä» show master status è·å¾—ä¸»åº“å½“å‰çš„ File å’Œ Position ä¿¡æ¯ï¼Œä¾‹å¦‚ File ä¸º mysql-bin.000001ï¼ŒPosition ä¸º 157ï¼Œç”¨äºä»åº“ master_log_file å’Œ master_log_pos çš„è®¾ç½®ã€‚\nMySQL ä»åº“æ‰§è¡Œè„šæœ¬ï¼š\n# æŸ¥è¯¢server_idå€¼ show variables like \u0026#39;server_id\u0026#39;; # ä¹Ÿå¯ä¸´æ—¶ï¼ˆé‡å¯åå¤±æ•ˆï¼‰æŒ‡å®šserver_idçš„å€¼ï¼ˆä¸»ä»æ•°æ®åº“çš„server_idä¸èƒ½ç›¸åŒï¼‰ set global server_id = 2; # è‹¥ä¹‹å‰è®¾ç½®è¿‡åŒæ­¥ï¼Œè¯·å…ˆé‡ç½® stop slave; reset slave; # è®¾ç½®ä¸»æ•°æ®åº“ change master to master_host=\u0026#39;172.20.10.5\u0026#39;,master_port=8808,master_user=\u0026#39;live-slave\u0026#39;,master_password=\u0026#39;12345678\u0026#39;,master_log_file=\u0026#39;mysql-bin.000001\u0026#39;,master_log_pos=157; # å¼€å§‹åŒæ­¥ start slave; # æŸ¥è¯¢SlaveçŠ¶æ€ show slave status; # è‹¥å‡ºç°é”™è¯¯ï¼Œåˆ™åœæ­¢åŒæ­¥ï¼Œé‡ç½®åå†æ¬¡å¯åŠ¨ stop slave; reset slave; start slave; æ ¹æ®ä¸»åº“çš„ IPã€ç«¯å£ç­‰ä¿¡æ¯ï¼Œè®¾ç½®ä»åº“çš„ä¸»æ•°æ®åº“ï¼ŒåŒæ—¶è®¾ç½® master_log_file å’Œ master_log_pos ä¸ºä¸Šä¸€æ­¥ä»ä¸»åº“è·å–çš„ File å’Œ Position å€¼ã€‚\nMySQL ä¸»ä»åŒæ­¥çŠ¶æ€åˆ¤æ–­ å¼€å§‹åŒæ­¥åï¼Œè‹¥æ‰§è¡Œ show slave status; æŸ¥è¯¢ä»åº“çŠ¶æ€æ—¶ï¼Œè‹¥æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œåˆ™è¡¨ç¤ºä¸»ä»åŒæ­¥æ­£å¸¸ï¼š\nSlave_IO_Running æ˜¾ç¤ºä¸º Yes Slave_SQL_Running æ˜¾ç¤ºä¸º Yes åœ¨æ­¤ä¹‹ä¸Šï¼Œæ¯”è¾ƒä»¥ä¸‹ä¸¤å¯¹å€¼ï¼Œè‹¥å‡ä¸€è‡´ï¼Œåˆ™è¡¨ç¤ºä¸»ä»åŒæ­¥å®Œæˆä¸”ä¸€è‡´ï¼š\nä¸»åº“ ( File , Position ) = ä»åº“ ( Master_Log_File , Read_Master_Log_Pos ) ä»åº“ ( Master_Log_File , Read_Master_Log_Pos ) = ä»åº“ ( Relay_Master_Log_File , Exec_Master_Log_Pos ) å…¶ä¸­ï¼š\nä¸»åº“ ( File , Position ) è®°å½•äº†ä¸»åº“ binlog çš„ä½ç½®ã€‚ ä»åº“ ( Master_Log_File , Read_Master_Log_Pos ) è®°å½•äº†ä»åº“ IO çº¿ç¨‹å½“å‰æ­£åœ¨æ¥æ”¶çš„äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶åœ¨ä¸»åº“ binlog ä¸­çš„ä½ç½®ï¼Œå¦‚æœå°äº ( File , Position )ï¼Œåˆ™è¡¨ç¤º IO çº¿ç¨‹å­˜åœ¨å»¶è¿Ÿã€‚ ä»åº“ ( Relay_Master_Log_File, Exec_Master_Log_Pos ) è®°å½•äº†ä»åº“ SQL çº¿ç¨‹å½“å‰æ­£åœ¨æ‰§è¡Œçš„äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶åœ¨ä¸»åº“ binlog çš„ä½ç½®ï¼Œå¦‚æœå°äº ( Master_Log_File, Read_Master_Log_Pos )ï¼Œåˆ™è¡¨ç¤º SQL çº¿ç¨‹å­˜åœ¨å»¶è¿Ÿã€‚ ","permalink":"https://zjxjwxk.github.io/posts/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/docker-%E5%AE%B9%E5%99%A8%E4%B8%8B%E7%9A%84-mysql-%E4%B8%BB%E4%BB%8E%E5%90%8C%E6%AD%A5/","summary":"\u003ch2 id=\"åˆ›å»ºå®¿ä¸»æœº-docker-å®¹å™¨æŒ‚è½½ç›®å½•\"\u003eåˆ›å»ºå®¿ä¸»æœº Docker å®¹å™¨æŒ‚è½½ç›®å½•\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -p /var/lib/mysql/master1/conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -p /var/lib/mysql/master1/data\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -p /var/lib/mysql/slave1/conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir -p /var/lib/mysql/slave1/data\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"åˆ›å»º-mysql-ä¸»ä»é…ç½®æ–‡ä»¶\"\u003eåˆ›å»º MySQL ä¸»ä»é…ç½®æ–‡ä»¶\u003c/h2\u003e\n\u003cp\u003eåˆ›å»ºä¸»åº“é…ç½®æ–‡ä»¶ï¼ˆå®¿ä¸»æœºè·¯å¾„ä¸º /var/lib/mysql/master1/conf/my.cnfï¼‰ï¼š\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[mysqld]\ncharacter-set-server = utf8\nlower-case-table-names = 1\n# ä¸»ä»å¤åˆ¶,ä¸»æœºé…ç½®,ä¸»æœåŠ¡å™¨å”¯ä¸€ID\nserver-id = 1\n# å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—\nlog-bin=mysql-bin\n# è®¾ç½®logbinæ ¼å¼\nbinlog_format = STATEMENT\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eåˆ›å»ºä»åº“é…ç½®æ–‡ä»¶ï¼ˆå®¿ä¸»æœºè·¯å¾„ï¼š/var/lib/mysql/slave1/conf/my.cnfï¼‰ï¼š\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e[mysqld]\ncharacter-set-server = utf8\nlower-case-table-names = 1\n# ä¸»ä»å¤åˆ¶,ä»æœºé…ç½®,ä»æœåŠ¡å™¨å”¯ä¸€ID\nserver-id = 2\n# å¯ç”¨ä¸­ç»§æ—¥å¿—\nrelay-log = mysql-relay\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eæˆæƒæ–‡ä»¶å¤¹ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003echmod -R \u003cspan style=\"color:#ae81ff\"\u003e777\u003c/span\u003e /var/lib/mysql\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸»ä»çš„ my.cnf æ–‡ä»¶æƒé™ä¸èƒ½ä¸º 777ï¼Œå¦åˆ™ my.cnf æ–‡ä»¶æ— æ³•åœ¨å®¹å™¨å†…ç”Ÿæ•ˆï¼Œåœ¨ç™»é™† Docker å®¹å™¨å†…çš„ MySQL æ—¶ä¼šæç¤ºï¼š\u003ccode\u003emysql: [Warning] World-writable config file '/etc/mysql/my.cnf' is ignored\u003c/code\u003eã€‚è§£å†³åŠæ³•æ˜¯ä¿®æ”¹å®¿ä¸»æœºä¸Šä¸»ä»çš„ my.cnf æƒé™ä¸ºæ›´ä½çš„ 644ï¼š\u003c/p\u003e","title":"Docker å®¹å™¨ä¸‹çš„ MySQL ä¸»ä»åŒæ­¥"},{"content":"TrustStore and KeyStore in Kafka We need to have a secure deployment and encrypted communication on each of these four types of arrows.\nNowadays, the TLS is mostly used to secure a connection via a CA (Certificate Authority):\nCA (Certificate Authority): The CA can sign other entities certificates. Client: The client put certificates in the Trust Store and doesn\u0026rsquo;t hold keys. Server: The server puts certificates, public keys, and private keys in the Key Store. Let\u0026rsquo;s analyze these five entities in Kafka: the CA, Zookeeper, Brokers, Producers, and Consumers. Who needs a key store, and who needs a trust store, or both?\nThe CA: CA is the source of trust, it doesn\u0026rsquo;t need a keystore to verify against someone and just needs a trust store. Zookeepers: They are clients between themselves, so they need a trust store. But they are servers to the brokers, so they also need a key store with a CA certificate and both private and public keys for the brokers. Therefore, they need both. Brokers: They are similar to the zookeepers. They are clients between themselves and servers to producers and consumers. Therefore, they need both. Producers: They are just clients, so they just need a trust store. Consumers: They are just clients, so they just need a trust store. Demo: Creating the KeyStores and TrustStores Run Docker Containers Create a docker-compose file, including three zookeepers, three Kafka brokers, a Rest Proxy, and a Schema Registry.\n--- version: \u0026#39;3\u0026#39; services: zookeeper-1: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-1 container_name: zookeeper-1 volumes: - ./zookeeper-1_data:/var/lib/zookeeper/data - ./zookeeper-1_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 1 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-2: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-2 container_name: zookeeper-2 volumes: - ./zookeeper-2_data:/var/lib/zookeeper/data - ./zookeeper-2_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 2 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-3: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-3 container_name: zookeeper-3 volumes: - ./zookeeper-3_data:/var/lib/zookeeper/data - ./zookeeper-3_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 3 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 broker-1: image: confluentinc/cp-kafka:7.4.1 hostname: broker-1 container_name: broker-1 volumes: - ./broker-1-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 ports: - 9092:9092 - 29092:29092 environment: KAFKA_BROKER_ID: 1 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9092,INTERNAL://broker-1:29092 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-2: image: confluentinc/cp-kafka:7.4.1 hostname: broker-2 container_name: broker-2 volumes: - ./broker-2-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 ports: - 9093:9093 - 29093:29093 environment: KAFKA_BROKER_ID: 2 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9093,INTERNAL://broker-2:29093 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-3: image: confluentinc/cp-kafka:7.4.1 hostname: broker-3 container_name: broker-3 volumes: - ./broker-3-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 ports: - 9094:9094 - 29094:29094 environment: KAFKA_BROKER_ID: 3 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9094,INTERNAL://broker-3:29094 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true rest-proxy: image: confluentinc/cp-kafka-rest:7.4.1 ports: - \u0026#34;8082:8082\u0026#34; depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 - broker-3 hostname: rest-proxy container_name: rest-proxy environment: KAFKA_REST_HOST_NAME: rest-proxy KAFKA_REST_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; KAFKA_REST_LISTENERS: \u0026#34;http://0.0.0.0:8082\u0026#34; schema-registry: image: confluentinc/cp-schema-registry:7.4.1 hostname: schema-registry container_name: schema-registry depends_on: - rest-proxy ports: - \u0026#34;8081:8081\u0026#34; environment: SCHEMA_REGISTRY_HOST_NAME: schema-registry SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; Run composed containers:\ndocker compose up -d Create a Topic Create a myorders topic that has four partitions.\nkafka-topics.sh --create --bootstrap-server localhost:9092 --partitions 4 --topic myorders Generate the Certificate Authority Create a shell script file generate-called.sh like the following:\nVALIDITY_DAYS=36500 CA_KEY_FILE=\u0026#34;ca-key\u0026#34; CA_CERT_FILE=\u0026#34;ca-cert\u0026#34; openssl req -new -x509 -keyout $CA_KEY_FILE -out $CA_CERT_FILE -days $VALIDITY_DAYS #### Example Values #### # Passphrase: password # Country Name: US # State or Province: UT # City: Utah # Organization Name: zjxjwxk # Organizational Unit Name: zjxjwxk # Common Name: zjxjwxk.github.io # Email: zjxjwxk@gmail.com Run the script and input all information it needs:\nâ¯ ./generate-ca.sh ......+......+..+......+.........+.+......+...............+++++++++++++++++++++++++++++++++++++++*.+....+.........+++++++++++++++++++++++++++++++++++++++*..+.........+......++++++ ....+.....+...+++++++++++++++++++++++++++++++++++++++*...+...+++++++++++++++++++++++++++++++++++++++*.........+...+....+............+........+.....................+......+.+...+.....+.......+...+.................+.........+...............+.+...+..+.........+...+.+...................................+.+.....+....+..++++++ Enter PEM pass phrase: Verifying - Enter PEM pass phrase: ----- You are about to be asked to enter information that will be incorporated into your certificate request. What you are about to enter is what is called a Distinguished Name or a DN. There are quite a few fields but you can leave some blank For some fields there will be a default value, If you enter \u0026#39;.\u0026#39;, the field will be left blank. ----- Country Name (2 letter code) [AU]:US State or Province Name (full name) [Some-State]:UT Locality Name (eg, city) []:Utah Organization Name (eg, company) [Internet Widgits Pty Ltd]:zjxjwxk Organizational Unit Name (eg, section) []:zjxjwxk Common Name (e.g. server FQDN or YOUR name) []:zjxjwxk.github.io Email Address []:zjxjwxk@gmail.com Generate the KeyStores Create a shell script file generate-keystore.sh like the following:\nCOMMON_NAME=$1 ORGANIZATIONAL_UNIT=\u0026#34;zjxjwxk\u0026#34; ORGANIZATION=\u0026#34;zjxjwxk\u0026#34; CITY=\u0026#34;Utah\u0026#34; STATE=\u0026#34;UT\u0026#34; COUNTRY=\u0026#34;US\u0026#34; CA_ALIAS=\u0026#34;ca-root\u0026#34; CA_CERT_FILE=\u0026#34;ca-cert\u0026#34; VALIDITY_DAYS=36500 # Generate Keystore with Private Key keytool -keystore keystore/$COMMON_NAME.keystore.jks -alias $COMMON_NAME -validity $VALIDITY_DAYS -genkey -keyalg RSA -dname \u0026#34;CN=$COMMON_NAME, OU=$ORGANIZATIONAL_UNIT, O=$ORGANIZATION, L=$CITY, ST=$STATE, C=$COUNTRY\u0026#34; # Generate Certificate Signing Request (CSR) using the newly created KeyStore keytool -keystore keystore/$COMMON_NAME.keystore.jks -alias $COMMON_NAME -certreq -file $COMMON_NAME.csr # Sign the CSR using the custom CA openssl x509 -req -CA ca-cert -CAkey ca-key -in $COMMON_NAME.csr -out $COMMON_NAME.signed -days $VALIDITY_DAYS -CAcreateserial # Import ROOT CA certificate into Keystore keytool -keystore keystore/$COMMON_NAME.keystore.jks -alias $CA_ALIAS -importcert -file $CA_CERT_FILE # Import newly signed certificate into Keystore keytool -keystore keystore/$COMMON_NAME.keystore.jks -alias $COMMON_NAME -importcert -file $COMMON_NAME.signed # Clean-up rm $COMMON_NAME.csr rm $COMMON_NAME.signed rm ca-cert.srl Create the keystore folder in the same path and then run the script with a parameter, which will be the name using the key store (run this script 6 times for three brokers and three zookeepers), and then input the passphrase when needed:\nâ¯ ./generate-keystore.sh broker-1 è¾“å…¥å¯†é’¥åº“å£ä»¤: å†æ¬¡è¾“å…¥æ–°å£ä»¤: è¾“å…¥ \u0026lt;broker-1\u0026gt; çš„å¯†é’¥å£ä»¤ (å¦‚æœå’Œå¯†é’¥åº“å£ä»¤ç›¸åŒ, æŒ‰å›è½¦): Warning: JKS å¯†é’¥åº“ä½¿ç”¨ä¸“ç”¨æ ¼å¼ã€‚å»ºè®®ä½¿ç”¨ \u0026#34;keytool -importkeystore -srckeystore keystore/broker-1.keystore.jks -destkeystore keystore/broker-1.keystore.jks -deststoretype pkcs12\u0026#34; è¿ç§»åˆ°è¡Œä¸šæ ‡å‡†æ ¼å¼ PKCS12ã€‚ è¾“å…¥å¯†é’¥åº“å£ä»¤: Warning: JKS å¯†é’¥åº“ä½¿ç”¨ä¸“ç”¨æ ¼å¼ã€‚å»ºè®®ä½¿ç”¨ \u0026#34;keytool -importkeystore -srckeystore keystore/broker-1.keystore.jks -destkeystore keystore/broker-1.keystore.jks -deststoretype pkcs12\u0026#34; è¿ç§»åˆ°è¡Œä¸šæ ‡å‡†æ ¼å¼ PKCS12ã€‚ Certificate request self-signature ok subject=C=US, ST=UT, L=Utah, O=zjxjwxk, OU=zjxjwxk, CN=broker-1 Enter pass phrase for ca-key: è¾“å…¥å¯†é’¥åº“å£ä»¤: æ‰€æœ‰è€…: EMAILADDRESS=zjxjwxk@gmail.com, CN=zjxjwxk.github.io, OU=zjxjwxk, O=zjxjwxk, L=Utah, ST=UT, C=US å‘å¸ƒè€…: EMAILADDRESS=zjxjwxk@gmail.com, CN=zjxjwxk.github.io, OU=zjxjwxk, O=zjxjwxk, L=Utah, ST=UT, C=US åºåˆ—å·: 7f8120f61b9782eadb2fd5097a6e58e116ba5351 æœ‰æ•ˆæœŸä¸º Sun Mar 16 15:13:13 CST 2025 è‡³ Tue Feb 20 15:13:13 CST 2125 è¯ä¹¦æŒ‡çº¹: MD5: AE:1E:A0:89:D6:FC:FF:6C:73:83:A8:8E:72:EC:5C:14 SHA1: 27:BD:36:3A:64:92:08:BF:C5:93:EA:50:EC:B6:39:53:08:30:C9:96 SHA256: 7A:1A:E0:6D:91:C1:5E:FE:D1:6A:81:27:13:3E:08:5C:6A:D7:AF:A0:14:B4:C1:43:AA:65:85:AF:DC:B8:04:ED ç­¾åç®—æ³•åç§°: SHA256withRSA ä¸»ä½“å…¬å…±å¯†é’¥ç®—æ³•: 2048 ä½ RSA å¯†é’¥ ç‰ˆæœ¬: 3 æ‰©å±•: #1: ObjectId: 2.5.29.35 Criticality=false AuthorityKeyIdentifier [ KeyIdentifier [ 0000: 85 57 ED 32 DF F0 D2 E5 4B E9 DF 4E 77 5E 3B CA .W.2....K..Nw^;. 0010: 03 91 17 70 ...p ] ] #2: ObjectId: 2.5.29.19 Criticality=true BasicConstraints:[ CA:true PathLen:2147483647 ] #3: ObjectId: 2.5.29.14 Criticality=false SubjectKeyIdentifier [ KeyIdentifier [ 0000: 85 57 ED 32 DF F0 D2 E5 4B E9 DF 4E 77 5E 3B CA .W.2....K..Nw^;. 0010: 03 91 17 70 ...p ] ] æ˜¯å¦ä¿¡ä»»æ­¤è¯ä¹¦? [å¦]: y è¯ä¹¦å·²æ·»åŠ åˆ°å¯†é’¥åº“ä¸­ Warning: JKS å¯†é’¥åº“ä½¿ç”¨ä¸“ç”¨æ ¼å¼ã€‚å»ºè®®ä½¿ç”¨ \u0026#34;keytool -importkeystore -srckeystore keystore/broker-1.keystore.jks -destkeystore keystore/broker-1.keystore.jks -deststoretype pkcs12\u0026#34; è¿ç§»åˆ°è¡Œä¸šæ ‡å‡†æ ¼å¼ PKCS12ã€‚ è¾“å…¥å¯†é’¥åº“å£ä»¤: è¯ä¹¦å›å¤å·²å®‰è£…åœ¨å¯†é’¥åº“ä¸­ Warning: JKS å¯†é’¥åº“ä½¿ç”¨ä¸“ç”¨æ ¼å¼ã€‚å»ºè®®ä½¿ç”¨ \u0026#34;keytool -importkeystore -srckeystore keystore/broker-1.keystore.jks -destkeystore keystore/broker-1.keystore.jks -deststoretype pkcs12\u0026#34; è¿ç§»åˆ°è¡Œä¸šæ ‡å‡†æ ¼å¼ PKCS12ã€‚ Create the Truststores Create a shell script file generate-truststore.sh like the following:\nINSTANCE=$1 CA_ALIAS=\u0026#34;ca-root\u0026#34; CA_CERT_FILE=\u0026#34;ca-cert\u0026#34; #### Generate Truststore and import ROOT CA certificate #### keytool -keystore truststore/$INSTANCE.truststore.jks -import -alias $CA_ALIAS -file $CA_CERT_FILE Create the truststroe folder in the same path and then run the script with a parameter, which will be the name using the trust store (run this script 6 times for three brokers and three zookeepers), and then input the passphrase when needed:\nâ¯ ./generate-truststore.sh broker-1 è¾“å…¥å¯†é’¥åº“å£ä»¤: å†æ¬¡è¾“å…¥æ–°å£ä»¤: æ‰€æœ‰è€…: EMAILADDRESS=zjxjwxk@gmail.com, CN=zjxjwxk.github.io, OU=zjxjwxk, O=zjxjwxk, L=Utah, ST=UT, C=US å‘å¸ƒè€…: EMAILADDRESS=zjxjwxk@gmail.com, CN=zjxjwxk.github.io, OU=zjxjwxk, O=zjxjwxk, L=Utah, ST=UT, C=US åºåˆ—å·: 7f8120f61b9782eadb2fd5097a6e58e116ba5351 æœ‰æ•ˆæœŸä¸º Sun Mar 16 15:13:13 CST 2025 è‡³ Tue Feb 20 15:13:13 CST 2125 è¯ä¹¦æŒ‡çº¹: MD5: AE:1E:A0:89:D6:FC:FF:6C:73:83:A8:8E:72:EC:5C:14 SHA1: 27:BD:36:3A:64:92:08:BF:C5:93:EA:50:EC:B6:39:53:08:30:C9:96 SHA256: 7A:1A:E0:6D:91:C1:5E:FE:D1:6A:81:27:13:3E:08:5C:6A:D7:AF:A0:14:B4:C1:43:AA:65:85:AF:DC:B8:04:ED ç­¾åç®—æ³•åç§°: SHA256withRSA ä¸»ä½“å…¬å…±å¯†é’¥ç®—æ³•: 2048 ä½ RSA å¯†é’¥ ç‰ˆæœ¬: 3 æ‰©å±•: #1: ObjectId: 2.5.29.35 Criticality=false AuthorityKeyIdentifier [ KeyIdentifier [ 0000: 85 57 ED 32 DF F0 D2 E5 4B E9 DF 4E 77 5E 3B CA .W.2....K..Nw^;. 0010: 03 91 17 70 ...p ] ] #2: ObjectId: 2.5.29.19 Criticality=true BasicConstraints:[ CA:true PathLen:2147483647 ] #3: ObjectId: 2.5.29.14 Criticality=false SubjectKeyIdentifier [ KeyIdentifier [ 0000: 85 57 ED 32 DF F0 D2 E5 4B E9 DF 4E 77 5E 3B CA .W.2....K..Nw^;. 0010: 03 91 17 70 ...p ] ] æ˜¯å¦ä¿¡ä»»æ­¤è¯ä¹¦? [å¦]: y è¯ä¹¦å·²æ·»åŠ åˆ°å¯†é’¥åº“ä¸­ Finally, the generated key stores and trust stores should look like this:\nEncrypt Zookeeper Encrypting Zookeeper can be done in two ways: Online Fashion and Offline Fashion.\nThe configuration we need to add to each Zookeeper in the docker-compose file:\nzookeeper-1: ... volumes: ... - ./security/keystore/zookeeper-1.keystore.jks:/security/zookeeper-1.keystore.jks - ./security/truststore/zookeeper-1.truststore.jks:/security/zookeeper-1.truststore.jks environment: ... ZOO_CFG_EXTRA: \u0026#34;sslQuorum=true portUnification=false serverCnxnFactory=org.apache.zookeeper.server.NettyServerCnxnFactory ssl.quorum.hostnameVerification=false ssl.quorum.keyStore.location=/security/zookeeper-1.keystore.jks ssl.quorum.keyStore.password=password ssl.quorum.trustStore.location=/security/zookeeper-1.truststore.jks ssl.quorum.trustStore.password=password secureClientPort=2281 ssl.hostnameVerification=false ssl.keyStore.location=/security/zookeeper-1.keystore.jks ssl.keyStore.password=password ssl.trustStore.location=/security/zookeeper-1.truststore.jks ssl.trustStore.password=password\u0026#34; The configuration we need to add to each broker in the docker-compose file:\nbroker-1: ... volumes: ... - ./security/keystore/broker-1.keystore.jks:/kafka/security/broker-1.keystore.jks - ./security/truststore/broker-1.truststore.jks:/kafka/security/broker-1.truststore.jks environment: ... KAFKA_ZOOKEEPER_SSL_CLIENT_ENABLE: \u0026#34;true\u0026#34; KAFKA_ZOOKEEPER_CLIENT_CNXN_SOCKET: org.apache.zookeeper.ClientCnxnSocketNetty KAFKA_ZOOKEEPER_SSL_KEYSTORE_LOCATION: /kafka/security/broker-1.keystore.jks KAFKA_ZOOKEEPER_SSL_KEYSTORE_PASSWORD: password KAFKA_ZOOKEEPER_SSL_TRUSTSTORE_LOCATION: /kafka/security/broker-1.truststore.jks KAFKA_ZOOKEEPER_SSL_TRUSTSTORE_PASSWORD: password Encrypt Producers and Consumers Configuration Four supported protocols are PLAINTEXT, SSL, SASL_PLAINTEXT, and SASL_SSL. (SASL involves authentication).\nDeclaring a listener is quite simple as well, in the environment we need to set:\nbroker-1: ... environment: ... KAFKA_LISTENERS: PLAINTEXT://broker-1:9091 KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://broker-1:9091 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT If we want to use SSL, we need to change those to:\nbroker-1: ... environment: ... KAFKA_LISTENERS: SSL://broker-1:9192 KAFKA_ADVERTISED_LISTENERS: SSL://broker-1:9192 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: SSL:SSL KAFKA_SECURITY_INTER_BROKER_PROTOCOL: SSL KAFKA_SSL_CLIENT_AUTH: none Set the TrustStores and KeyStores:\nbroker-1: ... environment: ... KAFKA_SSL_KEYSTORE_LOCATION: /kafka/security/broker-1.keystore.jks KAFKA_SSL_KEYSTORE_PASSWORD: password KAFKA_SSL_KEY_PASSWORD: passowrd KAFKA_SSL_TRUSTSTORE_LOCATION: /kafka/security/broker-1.truststore.jks KAFKA_SSL_TRUSTSTORE_PASSWORD: password Consumer and Producer using SSL in Java The difference between a consumer using SSL and a consumer using plaintext is that:\nChange the ports of each broker configured to the ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG to the ports using SSL.\nprops.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;broker-1:9191,broker-2:9192,broker-3:9193\u0026#34;); Set the CommonClientConfigs.SECURITY_PROTOCOL_CONFIG to SSL.\nprops.put(CommonClientConfigs.SECURITY_PROTOCOL_CONFIG, \u0026#34;SSL\u0026#34;); Set the trust store key and the password.\nprops.put(SslConfigs.SSL_TRUSTSTORE_LOCATION_CONFIG, \u0026#34;/Users/zjxjwxk/Documents/Project/getting-started-kafka/module8/demo3/security/truststore/consumer.truststore.jks\u0026#34;); // Replace with the absolute path on your machine props.put(SslConfigs.SSL_TRUSTSTORE_PASSWORD_CONFIG, \u0026#34;password\u0026#34;); The consumer using SSL should be like:\nimport org.apache.kafka.clients.CommonClientConfigs; import org.apache.kafka.clients.consumer.ConsumerConfig; import org.apache.kafka.clients.consumer.ConsumerRecords; import org.apache.kafka.clients.consumer.KafkaConsumer; import org.apache.kafka.common.config.SslConfigs; import org.apache.kafka.common.serialization.StringDeserializer; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.time.Duration; import java.util.Collections; import java.util.Properties; import java.util.concurrent.ExecutionException; public class BasicSSLConsumer { private static final Logger log = LoggerFactory.getLogger(BasicSSLConsumer.class); public static void main(String[] args) throws ExecutionException, InterruptedException { Properties props = new Properties(); props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;broker-1:9191,broker-2:9192,broker-3:9193\u0026#34;); props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName()); props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName()); props.put(ConsumerConfig.GROUP_ID_CONFIG, \u0026#34;basic.consumer\u0026#34;); props.put(CommonClientConfigs.SECURITY_PROTOCOL_CONFIG, \u0026#34;SSL\u0026#34;); props.put(SslConfigs.SSL_TRUSTSTORE_LOCATION_CONFIG, \u0026#34;/Users/zjxjwxk/Documents/Project/getting-started-kafka/module8/demo3/security/truststore/consumer.truststore.jks\u0026#34;); // Replace with the absolute path on your machine props.put(SslConfigs.SSL_TRUSTSTORE_PASSWORD_CONFIG, \u0026#34;password\u0026#34;); KafkaConsumer\u0026lt;String, String\u0026gt; consumer = new KafkaConsumer\u0026lt;\u0026gt;(props); Thread haltedHook = new Thread(consumer::close); Runtime.getRuntime().addShutdownHook(haltedHook); consumer.subscribe(Collections.singletonList(\u0026#34;basic-topic\u0026#34;)); while (true) { ConsumerRecords\u0026lt;String, String\u0026gt; records = consumer.poll(Duration.ofMillis(100)); records.forEach(record -\u0026gt; log.info(\u0026#34;Consumed message: \u0026#34; + record.key() + \u0026#34;:\u0026#34; + record.value())); } } } The producer is similar:\nimport org.apache.kafka.clients.CommonClientConfigs; import org.apache.kafka.clients.producer.*; import org.apache.kafka.common.config.SslConfigs; import org.apache.kafka.common.serialization.StringSerializer; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.util.Properties; import java.util.UUID; import java.util.concurrent.ExecutionException; public class BasicSSLProducer { private static final Logger log = LoggerFactory.getLogger(BasicSSLProducer.class); public static void main(String[] args) throws ExecutionException, InterruptedException { Properties props = new Properties(); props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;broker-1:9191,broker-2:9192,broker-3:9193\u0026#34;); props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); props.put(CommonClientConfigs.SECURITY_PROTOCOL_CONFIG, \u0026#34;SSL\u0026#34;); props.put(SslConfigs.SSL_TRUSTSTORE_LOCATION_CONFIG, \u0026#34;/Users/zjxjwxk/Documents/Project/getting-started-kafka/module8/demo3/security/truststore/producer.truststore.jks\u0026#34;); // Replace with the absolute path on your machine props.put(SslConfigs.SSL_TRUSTSTORE_PASSWORD_CONFIG, \u0026#34;password\u0026#34;); KafkaProducer\u0026lt;String, String\u0026gt; producer = new KafkaProducer\u0026lt;\u0026gt;(props); Thread haltedHook = new Thread(producer::close); Runtime.getRuntime().addShutdownHook(haltedHook); long i = 0; while(true) { String key = String.valueOf(i); String value = UUID.randomUUID().toString(); ProducerRecord\u0026lt;String, String\u0026gt; producerRecord = new ProducerRecord\u0026lt;\u0026gt;(\u0026#34;basic-topic\u0026#34;, key, value); producer.send(producerRecord); log.info(\u0026#34;Message sent: \u0026#34; + key + \u0026#34;:\u0026#34; + value); i++; Thread.sleep(20); } } } Monitoring Kafka: Scaling Cluster Level If there are some problems with the cluster level, usually means a high load. Add a broker 4 and turn on the balancer. Then the load will be balanced between brokers.\nconfluent.balancer.enable=true Broker Level If there are some problems with the broker level. We can just restart the broker.\nTopic Level The only problem that load balancer from confluent doesn\u0026rsquo;t detect is the topic level. To detect that, the command to run is:\nâ¯ kafka-consumer-groups.sh --bootstrap-server localhost:9092 --describe --group 1 GROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAG CONSUMER-ID HOST CLIENT-ID 1 myorders 1 0 0 0 console-consumer-8a295fc9-0d1f-4712-9c60-8e5ce13c7155 /172.30.0.1 console-consumer 1 myorders 0 0 0 0 console-consumer-8a295fc9-0d1f-4712-9c60-8e5ce13c7155 /172.30.0.1 console-consumer% If a topic\u0026rsquo;s LAG is high, the consumer is not catching up, which means we need more partitions.\nIncreasing the number of partitions of a topic is not easy. The best way is:\nCreate another topic with more partitions. Then create a Kafka Streams application that will read from the original topic and write to the output topic. When that steam application is done, then there is no lag. Migrate producers and consumers to the new topic. Takeaway We need to secure all communications channels in Kafka by encrypting them with TLS. We created TrustStroes for all entities and KeyStores for Brokers and Zookeepers. To scale out Kafka, most of the problems are solved by the Confluent tool, SBC (Self-Balancing Clusters). ","permalink":"https://zjxjwxk.github.io/posts/mq/kafka/getting-started-with-apache-kafka/7-kafka-administration/","summary":"\u003ch2 id=\"truststore-and-keystore-in-kafka\"\u003eTrustStore and KeyStore in Kafka\u003c/h2\u003e\n\u003cp\u003eWe need to have a secure deployment and encrypted communication on each of these four types of arrows.\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250316135513552\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/7-kafka-administration/images/image-20250316135513552.png\"\u003e\u003c/p\u003e\n\u003cp\u003eNowadays, the TLS is mostly used to secure a connection via a CA (Certificate Authority):\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCA (Certificate Authority): The CA can sign other entities certificates.\u003c/li\u003e\n\u003cli\u003eClient: The client put certificates in the Trust Store and doesn\u0026rsquo;t hold keys.\u003c/li\u003e\n\u003cli\u003eServer: The server puts certificates, public keys, and private keys in the Key Store.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250316140335677\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/7-kafka-administration/images/image-20250316140335677.png\"\u003e\u003c/p\u003e","title":"Kafka Administration"},{"content":"Microservices with Kafka To understand the logic behind doing microservices with Kafka, I believe it is important to take a smaller tour of how databases work. The engine uses a file called the writeâ€‘ahead log, or WAL. First, it writes the operation to the WAL. Then, it executes operations on the tables and indexes to reflect what the WAL said they should look like.\nWe have normally two types of microservices:\nThe first one is the synchronous microservices. These are the normal ones, normally RESTful services that wait on other dependent services to respond. The asynchronous microservices have an event bus based on these futures or callbacks. Here is where we tie the knot because if we let Kafka become the center of the application, we can build an entire async application based on it. And to make it simpler, this is what Kafka Streams chimes in to create each of these services. Let\u0026rsquo;s see an example that an e-commerce application may clarify.\nUI Service -\u0026gt; send message -\u0026gt; Checkout Topic -\u0026gt; receive message -\u0026gt; Order Service Order Service -\u0026gt; send message -\u0026gt; OrderPlaced Topic -\u0026gt; receive message -\u0026gt; Payment Service Payment Service -\u0026gt; send message -\u0026gt; OrderPaid Topic -\u0026gt; receive message -\u0026gt; Fulfilment Service Fulfillment Service -\u0026gt; send message -\u0026gt; OrderFinalized Topic -\u0026gt; receive message -\u0026gt; UI Service Kafka will be the center. There are some reasons:\nEvery event happening in your application can be traced back to a Kafka topic, and that is stored. This also means that if each of these microservices is a Kafka Stream app, everything in your app goes through Kafka. Kafka topics have an abstraction called the log that allows messages to be replayed. This means Kafka becomes the WAL of the application and allows for things like multi-phase transactions. Kafka Streams and Stateless Stream Processing This is what Kafka Stream apps look like. They read from an input topic, which is the source. They perform some operations defined in a graph or topology. Finally, they write normally to an output topic. Optionally, they can write to another topic that can act as a log.\nThe map operation maps this green message to sendToLog, as well as to the Filter. As this one is green, it passes the Filter. Then the app produces the message to both the Output Topic, as well as the Log Topic.\nOn the other hand, the red message is mapped to the Filter and sendToLog, but it cannot pass the filter. So, it\u0026rsquo;s only sent to the Log Topic.\nThere are more benefits. Thanks to Kafka Connect and Kafka Streams, querying Kafka will be easier. If we set up a Kafka Streams app that takes the orders topic and writes it to a DB topic in the correct schema defined by the schema registry with Avro, then Kafka Connect can use the database connector to write it to a database like PostgreSQL or MongoDB. From there, we can expose a query API that only translates certain RESTful requests into DB queries.\nCreating a Kafka Streams Application Establishing Properties Create an application.id that represents your application group or \u0026ldquo;team\u0026rdquo; Serde is combination of Serializer/Deserializer Every stream application and KSQL app (later) is a consumer-producer Properties props = new Properties(); props.put(StreamsConfig.APPLICATION_ID_CONFIG, \u0026#34;my_stream_app\u0026#34;); props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;localhost:9092\u0026#34;); props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass()); props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass()); props.put(\u0026#34;schema.registry.url\u0026#34;, \u0026#34;http://localhost:8081\u0026#34;); Create a Stream Builder Always start with a StreamBuilder object. This is the GoF builder pattern, where we will create a Topology object that represents our data pipeline. StreamsBuilder builder = new StreamsBuilder(); KStream\u0026lt;String, DisasterValue\u0026gt; rawReadings = builder.stream(\u0026#34;DisasterReadings\u0026#34;, Consumed.with(Serdes.String(), Serdes.Integer())); Standard Functional Programming map, filter, flatMap, groupBy, reduce, window, join, leftJoin, outerJoin\nMapping Before: (1, \u0026ldquo;Hello\u0026rdquo;), (2, \u0026ldquo;Zoom\u0026rdquo;), (3, \u0026ldquo;Fold\u0026rdquo;)\nstream.map((key, value) -\u0026gt; new KeyValue\u0026lt;\u0026gt;(key + 1, value + \u0026#34;!\u0026#34;)); After: (2, \u0026ldquo;Hello!\u0026rdquo;), (3, \u0026ldquo;Zoom!\u0026rdquo;), (4, \u0026ldquo;Fold!\u0026rdquo;)\nFilter Before: (1, \u0026ldquo;Hello\u0026rdquo;), (2, \u0026ldquo;Zoom\u0026rdquo;), (3, \u0026ldquo;Fold\u0026rdquo;), (4, \u0026ldquo;Past\u0026rdquo;)\nstream.filter((key, value) -\u0026gt; key % 2 == 0); (2, \u0026ldquo;Zoom\u0026rdquo;), (4, \u0026ldquo;Past\u0026rdquo;)\nDump Results to a Topic Dump the results to a topic using through to post to the topic and continue.\nKStream stream = builder.stream(\u0026#34;my_topic\u0026#34;); stream.filter(...).through(\u0026#34;new_topic\u0026#34;).flatMap(...).to(\u0026#34;other_topic\u0026#34;); Run Topology topology = builder.build(); KafkaStreams streams = new KafkaStreams(topology, props); streams.start(); Adding a Shutdown Hook Runtime.getRuntime().addShutdownHook(new Thread(streams::close)); Demo: Creating a Kafka Streams Application Run Docker Containers Create a docker-compose file, including three zookeepers, three Kafka brokers, a Rest Proxy, and a Schema Registry.\n--- version: \u0026#39;3\u0026#39; services: zookeeper-1: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-1 container_name: zookeeper-1 volumes: - ./zookeeper-1_data:/var/lib/zookeeper/data - ./zookeeper-1_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 1 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-2: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-2 container_name: zookeeper-2 volumes: - ./zookeeper-2_data:/var/lib/zookeeper/data - ./zookeeper-2_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 2 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-3: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-3 container_name: zookeeper-3 volumes: - ./zookeeper-3_data:/var/lib/zookeeper/data - ./zookeeper-3_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 3 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 broker-1: image: confluentinc/cp-kafka:7.4.1 hostname: broker-1 container_name: broker-1 volumes: - ./broker-1-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 ports: - 9092:9092 - 29092:29092 environment: KAFKA_BROKER_ID: 1 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9092,INTERNAL://broker-1:29092 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-2: image: confluentinc/cp-kafka:7.4.1 hostname: broker-2 container_name: broker-2 volumes: - ./broker-2-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 ports: - 9093:9093 - 29093:29093 environment: KAFKA_BROKER_ID: 2 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9093,INTERNAL://broker-2:29093 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-3: image: confluentinc/cp-kafka:7.4.1 hostname: broker-3 container_name: broker-3 volumes: - ./broker-3-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 ports: - 9094:9094 - 29094:29094 environment: KAFKA_BROKER_ID: 3 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9094,INTERNAL://broker-3:29094 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true rest-proxy: image: confluentinc/cp-kafka-rest:7.4.1 ports: - \u0026#34;8082:8082\u0026#34; depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 - broker-3 hostname: rest-proxy container_name: rest-proxy environment: KAFKA_REST_HOST_NAME: rest-proxy KAFKA_REST_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; KAFKA_REST_LISTENERS: \u0026#34;http://0.0.0.0:8082\u0026#34; schema-registry: image: confluentinc/cp-schema-registry:7.4.1 hostname: schema-registry container_name: schema-registry depends_on: - rest-proxy ports: - \u0026#34;8081:8081\u0026#34; environment: SCHEMA_REGISTRY_HOST_NAME: schema-registry SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; Run composed containers:\ndocker compose up -d Create two Topics Create a RawTeampReadings topic that has 4 partitions.\nkafka-topics.sh --create --bootstrap-server localhost:9092 --partitions 4 --topic RawTempReadings Then create a ValidatedTempReadings topic that has 4 partitions.\nkafka-topics.sh --create --bootstrap-server localhost:9092 --partitions 4 --topic ValidatedTempReadings Create a Consumer kafka-console-consumer.sh \\ --bootstrap-server localhost:9092 \\ --topic ValidatedTempReadings --from-beginning \\ --key-deserializer org.apache.kafka.common.serialization.StringDeserializer \\ --value-deserializer org.apache.kafka.common.serialization.IntegerDeserializer \\ --property print.key=true \\ --property key.separator=, \\ --group 1 Run a Stream Run a Kafka Stream from topic RawTempReadings to topic ValidatedTempReadings, only filtering the messages whose values are between -50 and 130.\npackage com.globomantics; import org.apache.kafka.common.serialization.Serdes; import org.apache.kafka.streams.KafkaStreams; import org.apache.kafka.streams.StreamsBuilder; import org.apache.kafka.streams.StreamsConfig; import org.apache.kafka.streams.Topology; import org.apache.kafka.streams.kstream.KStream; import java.util.Properties; public class SimpleETL { public static void main(String[] args) { Properties props = new Properties(); props.put(StreamsConfig.APPLICATION_ID_CONFIG, \u0026#34;weather.filter\u0026#34;); props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;http://localhost:9092,http://localhost:9093,http://localhost:9094\u0026#34;); props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass()); props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.Integer().getClass()); StreamsBuilder builder = new StreamsBuilder(); KStream\u0026lt;String, Integer\u0026gt; rawReadings = builder.stream(\u0026#34;RawTempReadings\u0026#34;); KStream\u0026lt;String, Integer\u0026gt; validatedReadings = rawReadings .filter((key, value) -\u0026gt; value \u0026gt; -50 \u0026amp;\u0026amp; value \u0026lt; 130); validatedReadings.to(\u0026#34;ValidatedTempReadings\u0026#34;); Topology topo = builder.build(); System.out.println(topo.describe()); KafkaStreams streams = new KafkaStreams(topo, props); Runtime.getRuntime().addShutdownHook(new Thread(streams::close)); streams.cleanUp(); streams.start(); System.out.println(\u0026#34;Starting simple ETL\u0026#34;); } } Run a Producer Run a Kafka Producer that sends messages to the topic RawTempReadings, which sends messages whose values are between -20 and 180.\npackage com.globomantics; import org.apache.kafka.clients.producer.KafkaProducer; import org.apache.kafka.clients.producer.ProducerConfig; import org.apache.kafka.clients.producer.ProducerRecord; import org.apache.kafka.common.serialization.IntegerSerializer; import org.apache.kafka.common.serialization.StringSerializer; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.util.Properties; import java.util.Random; import java.util.concurrent.ThreadLocalRandom; public class Producer { private static final Logger log = LoggerFactory.getLogger(Producer.class); private static final Properties props = new Properties(); public static void main(String[] args) throws InterruptedException { props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;http://localhost:9092,http://localhost:9093,http://localhost:9094\u0026#34;); props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, IntegerSerializer.class.getName()); KafkaProducer\u0026lt;String, Integer\u0026gt; producer = new KafkaProducer\u0026lt;\u0026gt;(props); String[] sensors = new String[]{\u0026#34;sensor_1\u0026#34;, \u0026#34;sensor_2\u0026#34;, \u0026#34;sensor_3\u0026#34;}; Runtime.getRuntime().addShutdownHook(new Thread(producer::close)); while (true) { int idx = new Random().nextInt(sensors.length); String key = (sensors[idx]); int value = ThreadLocalRandom.current().nextInt(-20, 180 + 1); ProducerRecord\u0026lt;String, Integer\u0026gt; producerRecord = new ProducerRecord\u0026lt;\u0026gt;(\u0026#34;RawTempReadings\u0026#34;, key, value); producer.send(producerRecord); producer.flush(); log.info(\u0026#34;Successfully produced message from sensor \u0026#34; + key); Thread.sleep(200); } } } We can see the received messages from the consumer, whose values are only between -50 and 130, which have been filtered by the Kafka Stream successfully.\nâ¯ kafka-console-consumer.sh \\ --bootstrap-server localhost:9092 \\ --topic ValidatedTempReadings --from-beginning \\ --key-deserializer org.apache.kafka.common.serialization.StringDeserializer \\ --value-deserializer org.apache.kafka.common.serialization.IntegerDeserializer \\ --property print.key=true \\ --property key.separator=, \\ --group 1 sensor_2,89 sensor_2,86 sensor_1,75 sensor_1,0 sensor_2,39 sensor_3,-11 sensor_3,106 sensor_1,84 sensor_1,52 sensor_1,122 sensor_1,53 sensor_2,117 sensor_3,-10 sensor_1,16 sensor_2,113 sensor_3,-11 Querying a Stream with KSQL Run Docker Containers Create a docker-compose file, including three zookeepers, three Kafka brokers, a Rest Proxy, a Schema Registry, a KSQL DB Server, and a KSQL DB Client.\n--- version: \u0026#39;3\u0026#39; services: zookeeper-1: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-1 container_name: zookeeper-1 volumes: - ./zookeeper-1_data:/var/lib/zookeeper/data - ./zookeeper-1_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 1 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-2: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-2 container_name: zookeeper-2 volumes: - ./zookeeper-2_data:/var/lib/zookeeper/data - ./zookeeper-2_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 2 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-3: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-3 container_name: zookeeper-3 volumes: - ./zookeeper-3_data:/var/lib/zookeeper/data - ./zookeeper-3_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 3 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 broker-1: image: confluentinc/cp-kafka:7.4.1 hostname: broker-1 container_name: broker-1 volumes: - ./broker-1-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 ports: - 9092:9092 - 29092:29092 environment: KAFKA_BROKER_ID: 1 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9092,INTERNAL://broker-1:29092 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-2: image: confluentinc/cp-kafka:7.4.1 hostname: broker-2 container_name: broker-2 volumes: - ./broker-2-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 ports: - 9093:9093 - 29093:29093 environment: KAFKA_BROKER_ID: 2 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9093,INTERNAL://broker-2:29093 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-3: image: confluentinc/cp-kafka:7.4.1 hostname: broker-3 container_name: broker-3 volumes: - ./broker-3-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 ports: - 9094:9094 - 29094:29094 environment: KAFKA_BROKER_ID: 3 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9094,INTERNAL://broker-3:29094 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true rest-proxy: image: confluentinc/cp-kafka-rest:7.4.1 ports: - \u0026#34;8082:8082\u0026#34; depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 - broker-3 hostname: rest-proxy container_name: rest-proxy environment: KAFKA_REST_HOST_NAME: rest-proxy KAFKA_REST_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; KAFKA_REST_LISTENERS: \u0026#34;http://0.0.0.0:8082\u0026#34; schema-registry: image: confluentinc/cp-schema-registry:7.4.1 hostname: schema-registry container_name: schema-registry depends_on: - rest-proxy ports: - \u0026#34;8081:8081\u0026#34; environment: SCHEMA_REGISTRY_HOST_NAME: schema-registry SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; ksqldb-server: image: confluentinc/cp-ksqldb-server:7.4.1 hostname: ksqldb-server container_name: ksqldb-server depends_on: - schema-registry ports: - \u0026#34;8088:8088\u0026#34; environment: KSQL_LISTENERS: http://0.0.0.0:8088 KSQL_BOOTSTRAP_SERVERS: broker-1:29092,broker-2:29093,broker-3:29094 KSQL_KSQL_LOGGING_PROCESSING_STREAM_AUTO_CREATE: \u0026#34;true\u0026#34; KSQL_KSQL_LOGGING_PROCESSING_TOPIC_AUTO_CREATE: \u0026#34;true\u0026#34; ksqldb-cli: image: confluentinc/cp-ksqldb-cli:7.4.1 container_name: ksqldb-cli hostname: ksqldb-cli depends_on: - ksqldb-server entrypoint: /bin/sh tty: true Run composed containers:\ndocker compose up -d Run KSQL CLient docker exec -it ksqldb-cli ksql http://ksqldb-server:8088 We can show all the topics:\nksql\u0026gt; show all topics; Kafka Topic | Partitions | Partition Replicas -------------------------------------------------------------------------- _confluent-ksql-default__command_topic | 1 | 1 _schemas | 1 | 3 default_ksql_processing_log | 1 | 1 -------------------------------------------------------------------------- Then, set the topic offset to the earliest, so that we can see all topics from the beginning:\nksql\u0026gt; SET \u0026#39;auto.offset.reset\u0026#39;=\u0026#39;earliest\u0026#39;; Successfully changed local property \u0026#39;auto.offset.reset\u0026#39; to \u0026#39;earliest\u0026#39;. Use the UNSET command to revert your change. Create a Stream Create a Kafka Stream tempReadings with columns zipcode, sensortime, and temp, which is associated with topic readings. Its timestamp will come from the sensortime.\nksql\u0026gt; CREATE STREAM tempReadings (zipcode VARCHAR, sensortime BIGINT, temp DOUBLE) \\ \u0026gt; WITH (kafka_topic=\u0026#39;readings\u0026#39;, timestamp=\u0026#39;sensortime\u0026#39;, value_format=\u0026#39;json\u0026#39;, partitions=1); Message ---------------- Stream created ---------------- We can see the topics:\nksql\u0026gt; show topics extended; Kafka Topic | Partitions | Partition Replicas | Consumers | ConsumerGroups -------------------------------------------------------------------------------------------- default_ksql_processing_log | 1 | 1 | 0 | 0 readings | 1 | 1 | 0 | 0 -------------------------------------------------------------------------------------------- We can see the streams:\nksql\u0026gt; show streams extended; Name : TEMPREADINGS Type : STREAM Timestamp field : SENSORTIME Key format : KAFKA Value format : JSON Kafka topic : readings (partitions: 1, replication: 1) Statement : CREATE STREAM TEMPREADINGS (ZIPCODE STRING, SENSORTIME BIGINT, TEMP DOUBLE) WITH (CLEANUP_POLICY=\u0026#39;delete\u0026#39;, KAFKA_TOPIC=\u0026#39;readings\u0026#39;, KEY_FORMAT=\u0026#39;KAFKA\u0026#39;, PARTITIONS=1, TIMESTAMP=\u0026#39;sensortime\u0026#39;, VALUE_FORMAT=\u0026#39;JSON\u0026#39;); Field | Type ------------------------------ ZIPCODE | VARCHAR(STRING) SENSORTIME | BIGINT TEMP | DOUBLE ------------------------------ ... Insert Stream We can insert records to the stream tempReadings like inserting into a DB, which will send messages to the topic readings at the same time:\nksql\u0026gt; INSERT INTO tempReadings (zipcode, sensortime, temp) VALUES (\u0026#39;1865\u0026#39;, UNIX_TIMESTAMP(), 20); ksql\u0026gt; INSERT INTO tempReadings (zipcode, sensortime, temp) VALUES (\u0026#39;1806\u0026#39;, UNIX_TIMESTAMP(), 25); ksql\u0026gt; INSERT INTO tempReadings (zipcode, sensortime, temp) VALUES (\u0026#39;1806\u0026#39;, UNIX_TIMESTAMP() + 60 * 60 * 1000, 32); ksql\u0026gt; INSERT INTO tempReadings (zipcode, sensortime, temp) VALUES (\u0026#39;1865\u0026#39;, UNIX_TIMESTAMP() + 60 * 60 * 1000, 27); Query Stream We can query the rowcount and average temperature of each zipcode and each window time from the stream:\nksql\u0026gt; SELECT zipcode, TIMESTAMPTOSTRING(WINDOWSTART, \u0026#39;HH:mm:ss\u0026#39;) as windowtime, \u0026gt; COUNT(*) as rowcount, AVG(temp) as temp \u0026gt;FROM tempReadings \u0026gt;WINDOW TUMBLING (SIZE 1 HOURS) \u0026gt;GROUP BY zipcode EMIT CHANGES; +-----------------------+-----------------------+-----------------------+-----------------------+ |ZIPCODE |WINDOWTIME |ROWCOUNT |TEMP | +-----------------------+-----------------------+-----------------------+-----------------------+ |1865 |07:00:00 |1 |20.0 | |1806 |07:00:00 |1 |25.0 | |1806 |08:00:00 |1 |32.0 | |1865 |08:00:00 |1 |27.0 | Press CTRL-C to interrupt We can also run consumer to consume messages from the topic:\nâ¯ kafka-console-consumer.sh \\ \u0026gt; --bootstrap-server localhost:9092 \\ \u0026gt; --topic readings --from-beginning {\u0026#34;ZIPCODE\u0026#34;:\u0026#34;1865\u0026#34;,\u0026#34;SENSORTIME\u0026#34;:1742023920742,\u0026#34;TEMP\u0026#34;:20.0} {\u0026#34;ZIPCODE\u0026#34;:\u0026#34;1806\u0026#34;,\u0026#34;SENSORTIME\u0026#34;:1742023939063,\u0026#34;TEMP\u0026#34;:25.0} {\u0026#34;ZIPCODE\u0026#34;:\u0026#34;1806\u0026#34;,\u0026#34;SENSORTIME\u0026#34;:1742027558360,\u0026#34;TEMP\u0026#34;:32.0} {\u0026#34;ZIPCODE\u0026#34;:\u0026#34;1865\u0026#34;,\u0026#34;SENSORTIME\u0026#34;:1742027593367,\u0026#34;TEMP\u0026#34;:27.0} Create Table We can create a table highsandlows that selects data including the minimum and maximum temperature of each zipcode from the stream:\nksql\u0026gt; CREATE TABLE highsandlows WITH (kafka_topic=\u0026#39;readings\u0026#39;) AS \u0026gt; SELECT MIN(temp) as min_temp, MAX(temp) as max_temp, zipcode \u0026gt; FROM tempReadings GROUP BY zipcode; Message ------------------------------------------- Created query with ID CTAS_HIGHSANDLOWS_3 ------------------------------------------- Query Table Then, we can query data directly from the table, which is the latest data from the stream:\nksql\u0026gt; SELECT min_temp, max_temp, zipcode \u0026gt; FROM highsandlows \u0026gt; WHERE zipcode = \u0026#39;1865\u0026#39;; +--------------------------------+--------------------------------+--------------------------------+ |MIN_TEMP |MAX_TEMP |ZIPCODE | +--------------------------------+--------------------------------+--------------------------------+ Query terminated Takeaways Kafka can effectively act as the WAL for your app when using Kafka Streams. A stream app is just a topology of functional applications to a stream of incoming messages. One can deploy as many streams as you want and they act as microservices. KSQL is the CLI to query KSQLDB which is a thin layer over Kafka Streams and permits to do simple stuff without creating an streams app with code. Keys Try to create a table instead of a stream and query it. Try to investigate how to use groupBy and perform JOINs. Try to deploy the architecture we mentioned above to query a topic. ","permalink":"https://zjxjwxk.github.io/posts/mq/kafka/getting-started-with-apache-kafka/6-kafka-stream/","summary":"\u003ch2 id=\"microservices-with-kafka\"\u003eMicroservices with Kafka\u003c/h2\u003e\n\u003cp\u003eTo understand the logic behind doing microservices with Kafka, I believe it is important to take a smaller tour of how databases work. The engine uses a file called the writeâ€‘ahead log, or WAL. First, it writes the operation to the WAL. Then, it executes operations on the tables and indexes to reflect what the WAL said they should look like.\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20250113214711151\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/6-kafka-stream/images/image-20250113214711151.png\"\u003e\u003c/p\u003e\n\u003cp\u003eWe have normally two types of microservices:\u003c/p\u003e","title":"Kafka Stream"},{"content":"ETL with Apache Kafka One important statement is that Kafka Connect is not an ETL(Extract, Load, Transform) solution itself, it only connects.\nBut with the help of the correct plugins it can have some ETL capabilities.\nConnectors Source Connectors: Transfer data from a Source to Kafka. Sink Connectors: Transfer data from Kafka to a Sink. You can search through all of the connectors at thre registry: https://www.confluent.io/product/connectors.\nStandalone vs. Distributed Standalone The connector configurations will be files. The worker will be just one script that we run.\nDistributed We will have more worker instances. The configurations instead of files will be offset and information in topics inside of Kafka. Kafka Connect in distributed mode offers a RESTful API to deploy a configuration.\nTasks Rebalancing If worker 3 fails, the tasks will be moved to a living worker.\nWhen worker 3 is alive again, the tasks rebalance again to the original worker.\nDemo: Using the File Connector in a Standalone Mode Create a docker-compose file docker-compose.yaml containing three Zookeepers, three Kafka Brokers, a Kafka REST Proxy, and a Schema Registry:\n--- version: \u0026#39;3\u0026#39; services: zookeeper-1: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-1 container_name: zookeeper-1 volumes: - ./zookeeper-1_data:/var/lib/zookeeper/data - ./zookeeper-1_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 1 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-2: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-2 container_name: zookeeper-2 volumes: - ./zookeeper-2_data:/var/lib/zookeeper/data - ./zookeeper-2_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 2 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-3: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-3 container_name: zookeeper-3 volumes: - ./zookeeper-3_data:/var/lib/zookeeper/data - ./zookeeper-3_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 3 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 broker-1: image: confluentinc/cp-kafka:7.4.1 hostname: broker-1 container_name: broker-1 volumes: - ./broker-1-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 ports: - 9092:9092 - 29092:29092 environment: KAFKA_BROKER_ID: 1 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9092,INTERNAL://broker-1:29092 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-2: image: confluentinc/cp-kafka:7.4.1 hostname: broker-2 container_name: broker-2 volumes: - ./broker-2-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 ports: - 9093:9093 - 29093:29093 environment: KAFKA_BROKER_ID: 2 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9093,INTERNAL://broker-2:29093 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-3: image: confluentinc/cp-kafka:7.4.1 hostname: broker-3 container_name: broker-3 volumes: - ./broker-3-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 ports: - 9094:9094 - 29094:29094 environment: KAFKA_BROKER_ID: 3 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9094,INTERNAL://broker-3:29094 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true rest-proxy: image: confluentinc/cp-kafka-rest:7.4.1 ports: - \u0026#34;8082:8082\u0026#34; depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 - broker-3 hostname: rest-proxy container_name: rest-proxy environment: KAFKA_REST_HOST_NAME: rest-proxy KAFKA_REST_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; KAFKA_REST_LISTENERS: \u0026#34;http://0.0.0.0:8082\u0026#34; schema-registry: image: confluentinc/cp-schema-registry:7.4.1 hostname: schema-registry container_name: schema-registry depends_on: - rest-proxy ports: - \u0026#34;8081:8081\u0026#34; environment: SCHEMA_REGISTRY_HOST_NAME: schema-registry SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; Run composed containers:\ndocker compose up -d Create Topic Create a topic connect-log with partitions 4:\nkafka-topics.sh --create --bootstrap-server localhost:9092 --partitions 4 --topic connect-log Create a Worker Properties File Create a worker.properties file at the root of the project. You should change the plugin.path with your absolute path of Kafka libs. Then, set the schema.registry.url to your schema-registryurl, which is configured in thedocker-compose.yaml`.\n#worker.properties bootstrap.servers=http://localhost:9092,http://localhost:9093,http://localhost:9094 # The converters specify the format of data in Kafka and how to translate it into Connect data. Every Connect user will # need to configure these based on the format they want their data in when loaded from or stored into Kafka key.converter=org.apache.kafka.connect.storage.StringConverter value.converter=org.apache.kafka.connect.storage.StringConverter # The internal converter used for offsets and config data is configurable and must be specified, but most users will # always want to use the built-in default. Offset and config data is never visible outside of Copcyat in this format. internal.key.converter=org.apache.kafka.connect.json.JsonConverter internal.value.converter=org.apache.kafka.connect.json.JsonConverter internal.key.converter.schemas.enable=true internal.value.converter.schemas.enable=true offset.storage.file.filename=/tmp/connect.offsets # Flush much faster than normal, which is useful for testing/debugging offset.flush.interval.ms=5000 # Reload metadata faster too so consumer picks up new topics consumer.metadata.max.age.ms=10000 plugin.path=/Users/zjxjwxk/Library/kafka_2.13-3.9.0/libs schema.registry.url=http://localhost:8081 rest.port=8083 group.id=1 config.storage.topic=kafka_connect_configs cleanup.policy=compact offset.storage.topic=kafka_connect_offsets status.storage.topic=kafka_connect_statuses Create a Sink Properties File Create a filesink.properties file at the root of the project. We can set the number of tasks by tasks.max, set the path of the file by file, and set the topic we are listening to.\n#my-file-sink.properties config file name=local-file-sink connector.class=FileStreamSink tasks.max=1 file=./file-log.txt topics=connectlog Start the Kafka Connect in Standalone Mode Start a worker with a standalone instance. Set the parameters for the worker property file and the filesink property file.\nconnect-standalone.sh worker.properties filesink.properties Run a Kafka Producer Create a Java file to run the Kafka Producer sending messages to the topic connectlog:\npackage com.globomantics; import org.apache.kafka.clients.producer.KafkaProducer; import org.apache.kafka.clients.producer.ProducerConfig; import org.apache.kafka.clients.producer.ProducerRecord; import org.apache.kafka.common.serialization.DoubleSerializer; import org.apache.kafka.common.serialization.IntegerSerializer; import org.apache.kafka.common.serialization.StringSerializer; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.util.Properties; public class LogProducer { private static final Logger log = LoggerFactory.getLogger(LogProducer.class); private static final String TOPIC = \u0026#34;connectlog\u0026#34;; public static void main(String[] args) throws InterruptedException { Properties props = new Properties(); props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;http://localhost:9092,http://localhost:9093,http://localhost:9094\u0026#34;); props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, DoubleSerializer.class.getName()); props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); KafkaProducer\u0026lt;Double, String\u0026gt; producer = new KafkaProducer\u0026lt;\u0026gt;(props); for (int i = 0; i \u0026lt; 25000; i++) { double key = Math.floor(Math.random()*(50)); String value = \u0026#34;Some logging info from Kafka with key\u0026#34; + key; ProducerRecord\u0026lt;Double, String\u0026gt; producerRecord = new ProducerRecord\u0026lt;\u0026gt;(TOPIC, key, value); log.info(\u0026#34;Sending message \u0026#34; + value + \u0026#34; to Kafka\u0026#34;); producer.send(producerRecord, (metadata, e) -\u0026gt; { if (metadata != null) { System.out.println(producerRecord.key()); System.out.println(producerRecord.value()); System.out.println(metadata.toString()); } }); Thread.sleep(1000); } producer.flush(); producer.close(); log.info(\u0026#34;Successfully produced messages to \u0026#34; + TOPIC + \u0026#34; topic\u0026#34;); } } Check the Log File We can check the log file which is configured in the Sink Properties File:\nâ¯ cat file-log.txt Some logging info from Kafka with key29.0 Some logging info from Kafka with key49.0 Some logging info from Kafka with key26.0 Some logging info from Kafka with key12.0 Some logging info from Kafka with key12.0 Some logging info from Kafka with key1.0 Some logging info from Kafka with key16.0 Schema Evolution and Enforcement Schema Registry is a service provided by confluent that stores and enforces the schema on each topic in Kafka.\nApache Avro Apache Avro is the language over which the schemas are defined.\nSerialization is defined by schema. Schemas are JSON-based. Codegen is available at the command line. Codegen is available with Maven, Gradle, and SBT plugins. Supports the following languages: C, C++, Java, Perl, Python, Ruby, and PHP. Three Modes Generic Mode: Where you use Avro just to validate it is a valid schema, but don\u0026rsquo;t do codegen. Specific Mode: Where we use an avsc file and the codeine capabilities to generate the code we need. Reflection Mode: The inver of the previous mode, creates an avsc file based on a class. Primitive Types Avro Type Java Type null null double double float float int int long long bool bool string Unicode CharSequnce bytes Sequence of 8-bit unsigned bytes Complex Types { \u0026#34;namespace\u0026#34;: \u0026#34;com.xyzcorp\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;record\u0026#34;, \u0026#34;doc\u0026#34;: \u0026#34;An music album\u0026#34;, \u0026#34;name\u0026#34;: \u0026#34;Album\u0026#34;, \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;name\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;string\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;yearReleased\u0026#34;, \u0026#34;type\u0026#34;: [ \u0026#34;int\u0026#34;, \u0026#34;null\u0026#34; ] } ] } Overview Sample Code Producer What makes schema registry work is the Serializer. You must add schema.registry.url and specify the location of the registry.\nProperties properties = new Properties(); properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;http://localhost:9092\u0026#34;); properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, io.confluent.kafka.serializers.KafkaAvroSerializer.class.getName()); properties.put(\u0026#34;schema.registry.url\u0026#34;, \u0026#34;http://localhost:8081\u0026#34;); The ProducerRecord\u0026rsquo;s value is accepting an actual Java Object. We can send the object just like any other type.\nAlbum album = new Album(\u0026#34;Purple Rain\u0026#34;, \u0026#34;Prince\u0026#34;, 1984, Arrays.asList(\u0026#34;Purple Rain\u0026#34;, \u0026#34;Let\u0026#39;s go crazy\u0026#34;)); ProducerRecord\u0026lt;String, Album\u0026gt; producerRecord = new ProducerRecord\u0026lt;\u0026gt;(\u0026#34;music_albums\u0026#34;, \u0026#34;Prince\u0026#34;, album); producer.send(producerRecord); Consumer What makes schema registry work is the Deserializer. You must add schema.registry.url and specify the location of the registry. You must add specific.avro.reader and specify that you used specific avro mode.\nProperties properties = new Properties(); properties.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;localhost:9092\u0026#34;); properties.put(ConsumerConfig.GROUP_ID_CONFIG, \u0026#34;my_group\u0026#34;); properties.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); properties.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, io.confluent.kafka.serializers.KafkaAvroDeserializer.class); properties.setProperty(\u0026#34;schema.registry.url\u0026#34;, \u0026#34;http://localhost:8081\u0026#34;); properties.setProperty(\u0026#34;specific.avro.reader\u0026#34;, \u0026#34;true\u0026#34;); Receiving a Custom Object from Kafka:\nwhile (true) { ConsumerRecords\u0026lt;String, Album\u0026gt; records = consumer.poll(Duration.of(500, ChronoUnit.MILLIS)); for (ConsumerRecord\u0026lt;String, Album\u0026gt; record: records) { Album a = record.value(); System.out.format(\u0026#34;value: %s\\n\u0026#34;, a.getTitle()); System.out.format(\u0026#34;value: %s\\n\u0026#34;, a.getArtist()); } } Demo: Using the MongoDB Connector with Distributed Kafka Connect to Query a Topic Install Confluent Hub Client Use Brew if you are using Mac:\nbrew tap confluentinc/homebrew-confluent-hub-client brew install --cask confluent-hub-client Install Kafka Connect Avro Converter Install the Kafka Connect Avro Converter using the Confluent Hub we just installed:\nconfluent-hub install confluentinc/kafka-connect-avro-converter:7.5.0 --component-dir ~/Library/kafka_2.13-3.9.0/libs --worker-configs worker.properties Install Kafka MongoDB Connector confluent-hub install mongodb/kafka-connect-mongodb:1.11.0 --component-dir ~/Library/kafka_2.13-3.9.0/libs --worker-configs worker.properties Downloading Some Missing Jars Download and put some missing jars into the Kafka libs, including the failureaccess-1.0.1.jar and guava-32.1.2-jre.jar.\ncp failureaccess-1.0.1.jar ~/Library/kafka_2.13-3.9.0/libs cp guava-32.1.2-jre.jar ~/Library/kafka_2.13-3.9.0/libs Run Docker Containers Create a docker-compose.yaml file containing three Zookeepers, three Kafka Brokers, a Rest Proxy, a Schema Registry, and a MongoDB.\n--- version: \u0026#39;3\u0026#39; services: zookeeper-1: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-1 container_name: zookeeper-1 volumes: - ./zookeeper-1_data:/var/lib/zookeeper/data - ./zookeeper-1_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 1 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-2: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-2 container_name: zookeeper-2 volumes: - ./zookeeper-2_data:/var/lib/zookeeper/data - ./zookeeper-2_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 2 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-3: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-3 container_name: zookeeper-3 volumes: - ./zookeeper-3_data:/var/lib/zookeeper/data - ./zookeeper-3_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 3 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 broker-1: image: confluentinc/cp-kafka:7.4.1 hostname: broker-1 container_name: broker-1 volumes: - ./broker-1-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 ports: - 9092:9092 - 29092:29092 environment: KAFKA_BROKER_ID: 1 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9092,INTERNAL://broker-1:29092 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-2: image: confluentinc/cp-kafka:7.4.1 hostname: broker-2 container_name: broker-2 volumes: - ./broker-2-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 ports: - 9093:9093 - 29093:29093 environment: KAFKA_BROKER_ID: 2 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9093,INTERNAL://broker-2:29093 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-3: image: confluentinc/cp-kafka:7.4.1 hostname: broker-3 container_name: broker-3 volumes: - ./broker-3-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 ports: - 9094:9094 - 29094:29094 environment: KAFKA_BROKER_ID: 3 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9094,INTERNAL://broker-3:29094 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true rest-proxy: image: confluentinc/cp-kafka-rest:7.4.1 ports: - \u0026#34;8082:8082\u0026#34; depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 - broker-3 hostname: rest-proxy container_name: rest-proxy environment: KAFKA_REST_HOST_NAME: rest-proxy KAFKA_REST_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; KAFKA_REST_LISTENERS: \u0026#34;http://0.0.0.0:8082\u0026#34; schema-registry: image: confluentinc/cp-schema-registry:7.4.1 hostname: schema-registry container_name: schema-registry depends_on: - rest-proxy ports: - \u0026#34;8081:8081\u0026#34; environment: SCHEMA_REGISTRY_HOST_NAME: schema-registry SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; mongo: image: mongo hostname: mongo container_name: mongo ports: - 27017:27017 Run the composed containers:\ndocker compose up -d Create a Kafka Topic Create a Kafka Topic with 4 partitions:\nkafka-topics.sh --create --bootstrap-server localhost:9092 --partitions 4 --topic connect-distributed Generate Model with Avsc File Create an avsc file, which represents the Album record:\n{ \u0026#34;fields\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;name\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;string\u0026#34; }, { \u0026#34;name\u0026#34;: \u0026#34;year\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;int\u0026#34; } ], \u0026#34;name\u0026#34;: \u0026#34;Album\u0026#34;, \u0026#34;namespace\u0026#34;: \u0026#34;com.globomantics.model\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;record\u0026#34; } Generate the model class by running the Maven plugin:\nmvn generate-sources Then, the package that is configured at the namespace in the avsc file will be created, and the Album class will be genereated in the package like this:\n/** * Autogenerated by Avro * * DO NOT EDIT DIRECTLY */ package com.globomantics.model; import org.apache.avro.generic.GenericArray; import org.apache.avro.specific.SpecificData; import org.apache.avro.util.Utf8; import org.apache.avro.message.BinaryMessageEncoder; import org.apache.avro.message.BinaryMessageDecoder; import org.apache.avro.message.SchemaStore; @org.apache.avro.specific.AvroGenerated public class Album extends org.apache.avro.specific.SpecificRecordBase implements org.apache.avro.specific.SpecificRecord { ... } Create Other Topics We need to create some other necessary topics to apply the distributed mode, which are configured in the worker.properties file: kafka_connect_configs, kafka_connect_offsets, and kafka_connect_statuses.\nconfig.storage.topic=kafka_connect_configs cleanup.policy=compact offset.storage.topic=kafka_connect_offsets status.storage.topic=kafka_connect_statuses Create these topics:\nkafka-topics.sh --create --bootstrap-server localhost:9092 --topic kafka_connect_statuses --config cleanup.policy=compact kafka-topics.sh --create --bootstrap-server localhost:9092 --topic kafka_connect_offsets --config cleanup.policy=compact kafka-topics.sh --create --bootstrap-server localhost:9092 --topic kafka_connect_configs --config cleanup.policy=compact Start the Kafka Connect in Distributed Mode connect-distributed.sh worker.properties If we see the logs like the following, then Kafka Connect is started in distributed mode:\n... [2024-12-21 21:02:37,819] INFO [Worker clientId=connect-192.168.10.106:8083, groupId=1] Finished starting connectors and tasks (org.apache.kafka.connect.runtime.distributed.DistributedHerder:2008) [2024-12-21 21:02:37,984] INFO [Worker clientId=connect-192.168.10.106:8083, groupId=1] Session key updated (org.apache.kafka.connect.runtime.distributed.DistributedHerder:2510) Deploy Connectors The Kafka Connect in distributed mode offers some RESTful APIs. We can send an HTTP post request to the localhost://8083 to create a connector with request body like:\n{ \u0026#34;name\u0026#34;: \u0026#34;mongo-sink\u0026#34;, \u0026#34;config\u0026#34; : { \u0026#34;connector.class\u0026#34;: \u0026#34;com.mongodb.kafka.connect.MongoSinkConnector\u0026#34;, \u0026#34;connection.uri\u0026#34;: \u0026#34;mongodb://localhost:27017\u0026#34;, \u0026#34;database\u0026#34;: \u0026#34;quickstart\u0026#34;, \u0026#34;collection\u0026#34;: \u0026#34;topicData\u0026#34;, \u0026#34;topics\u0026#34;: \u0026#34;connect-distributed\u0026#34; } } And we can get created connectors by the GET method:\nThen, we can append the name of the connector to the url to get the details of a specific connector:\nSend a Message Create a Java class using Kafka Producer to send a messages with an Album model as value:\npackage com.globomantics; import com.globomantics.model.Album; import io.confluent.kafka.serializers.KafkaAvroSerializer; import io.confluent.kafka.serializers.KafkaAvroSerializerConfig; import org.apache.kafka.clients.producer.KafkaProducer; import org.apache.kafka.clients.producer.ProducerConfig; import org.apache.kafka.clients.producer.ProducerRecord; import org.apache.kafka.common.serialization.DoubleSerializer; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.util.Properties; public class AlbumSender { private static final Logger log = LoggerFactory.getLogger(AlbumSender.class); private static final String TOPIC = \u0026#34;connect-distributed\u0026#34;; public static void main(String[] args) { Properties props = new Properties(); props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;http://localhost:9092,http://localhost:9093,http://localhost:9094\u0026#34;); props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, DoubleSerializer.class.getName()); props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, KafkaAvroSerializer.class.getName()); props.put(KafkaAvroSerializerConfig.SCHEMA_REGISTRY_URL_CONFIG, \u0026#34;http://localhost:8081\u0026#34;); Album album = Album.newBuilder() .setName(\u0026#34;Use Your Illusion\u0026#34;) .setYear(1991).build(); KafkaProducer\u0026lt;Double, Album\u0026gt; producer = new KafkaProducer\u0026lt;\u0026gt;(props); double key = Math.floor(Math.random()*(50)); ProducerRecord\u0026lt;Double, Album\u0026gt; producerRecord = new ProducerRecord\u0026lt;\u0026gt;(TOPIC, key, album); log.info(\u0026#34;Sending message \u0026#34; + album + \u0026#34; to Kafka\u0026#34;); producer.send(producerRecord, (metadata, e) -\u0026gt; { if (metadata != null) { System.out.println(producerRecord.key()); System.out.println(producerRecord.value()); System.out.println(metadata.toString()); } }); producer.flush(); producer.close(); log.info(\u0026#34;Successfully produced messages to \u0026#34; + TOPIC + \u0026#34; topic\u0026#34;); } } Check MongoDB After running the sender class, we need to connect to the MongoDB to check that the massage is here.\n# mongosh localhost:27017 Current Mongosh Log ID: 6766c45295db57d019e94969 Connecting to: mongodb://localhost:27017/?directConnection=true\u0026amp;serverSelectionTimeoutMS=2000\u0026amp;appName=mongosh+2.3.4 Using MongoDB: 8.0.4 Using Mongosh: 2.3.4 For mongosh info see: https://www.mongodb.com/docs/mongodb-shell/ ... test\u0026gt; show dbs admin 40.00 KiB config 60.00 KiB local 40.00 KiB quickstart 40.00 KiB test\u0026gt; use quickstart switched to db quickstart quickstart\u0026gt; db.topicData.find() [ { _id: ObjectId(\u0026#39;6766c377e0b35c19402f4c3d\u0026#39;), name: \u0026#39;Use Your Illusion\u0026#39;, year: 1991 } ] Takeaways Kafka Connect can come in two variants: Standalone and Distributed. Kafka connects via worker processes where connectors get deployed as a number of tasks. One can leverage the schema registry and AVRO to send classes through Kafka messages with much more metadata. Thanks to the Kafka Connect that even sends those objects to another system. ","permalink":"https://zjxjwxk.github.io/posts/mq/kafka/getting-started-with-apache-kafka/5-kafka-connect/","summary":"\u003ch2 id=\"etl-with-apache-kafka\"\u003eETL with Apache Kafka\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241123173425604\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/5-kafka-connect/images/image-20241123173425604.png\"\u003e\u003c/p\u003e\n\u003cp\u003eOne important statement is that Kafka Connect is not an ETL(Extract, Load, Transform) solution itself, it only connects.\u003c/p\u003e\n\u003cp\u003eBut with the help of the correct plugins it can have some ETL capabilities.\u003c/p\u003e\n\u003ch2 id=\"connectors\"\u003eConnectors\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eSource Connectors\u003c/strong\u003e: Transfer data from a Source to Kafka.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSink Connectors\u003c/strong\u003e: Transfer data from Kafka to a Sink.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eYou can search through all of the connectors at thre registry: \u003ca href=\"https://www.confluent.io/product/connectors\"\u003ehttps://www.confluent.io/product/connectors\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"standalone-vs-distributed\"\u003eStandalone vs. Distributed\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241123182435451\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/5-kafka-connect/images/image-20241123182435451.png\"\u003e\u003c/p\u003e","title":"Kafka Connect"},{"content":"Kafka Consumer Group Consumers are typically done as a group. A single consumer will end up inefficient with large amounts of data. A consumer may never catch up. Every consumer should be on it\u0026rsquo;s own machine, instance, pod. The consumer group ID is the key so Kafka knows that messages should be distributed to both consumers without duplicating.\nIf we add one more consumer to this group, the last one will be idle, because one partition can\u0026rsquo;t be share across consumers. One partition can only be assigned to one consumer. Instead, the partitions are the way of Kafka to scale. More partitions imply you can have more consumers in the same consumer group.\nDemo: Consuming from Kafka Run Kafka Containers Create a docker-compose file docker-compose.yaml containing three Zookeepers, three Kafka Brokers, and a Kafka REST Proxy:\n--- version: \u0026#39;3\u0026#39; services: zookeeper-1: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-1 container_name: zookeeper-1 volumes: - ./zookeeper-1_data:/var/lib/zookeeper/data - ./zookeeper-1_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 1 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-2: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-2 container_name: zookeeper-2 volumes: - ./zookeeper-2_data:/var/lib/zookeeper/data - ./zookeeper-2_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 2 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-3: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-3 container_name: zookeeper-3 volumes: - ./zookeeper-3_data:/var/lib/zookeeper/data - ./zookeeper-3_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 3 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 broker-1: image: confluentinc/cp-kafka:7.4.1 hostname: broker-1 container_name: broker-1 volumes: - ./broker-1-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 ports: - 9092:9092 - 29092:29092 environment: KAFKA_BROKER_ID: 1 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9092,INTERNAL://broker-1:29092 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-2: image: confluentinc/cp-kafka:7.4.1 hostname: broker-2 container_name: broker-2 volumes: - ./broker-2-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 ports: - 9093:9093 - 29093:29093 environment: KAFKA_BROKER_ID: 2 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9093,INTERNAL://broker-2:29093 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-3: image: confluentinc/cp-kafka:7.4.1 hostname: broker-3 container_name: broker-3 volumes: - ./broker-3-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 ports: - 9094:9094 - 29094:29094 environment: KAFKA_BROKER_ID: 3 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9094,INTERNAL://broker-3:29094 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true rest-proxy: image: confluentinc/cp-kafka-rest:7.4.1 ports: - \u0026#34;8082:8082\u0026#34; depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 - broker-3 hostname: rest-proxy container_name: rest-proxy environment: KAFKA_REST_HOST_NAME: rest-proxy KAFKA_REST_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; KAFKA_REST_LISTENERS: \u0026#34;http://0.0.0.0:8082\u0026#34; Run composed containers:\ndocker compose up -d Create Topic Create a topic myorders with 2 partitions:\nkafka-topics.sh --create --bootstrap-server localhost:9092 --partitions 2 --topic myorders Run Consumer Run 3 Kafka Consumers in different terminals lisitening to the same topic myorders and deserialize the messages by string key and double value seperated by ,:\nkafka-console-consumer.sh \\ --bootstrap-server localhost:9092 \\ --topic myorders --from-beginning \\ --key-deserializer org.apache.kafka.common.serialization.StringDeserializer \\ --value-deserializer org.apache.kafka.common.serialization.DoubleDeserializer \\ --property print.key=true \\ --property key.separator=, \\ --group 1 Then, in another terminal, run another consumer with all the other same parameters but with --group 2.\nWe can see check the logs of broker 1:\ndocker logs broker-1 The following log can be found, which means there are three members in the group 1:\n[2024-11-18 14:36:14,337] INFO [GroupCoordinator 1]: Stabilized group 1 generation 3 (__consumer_offsets-49) with 3 members (kafka.coordinator.group.GroupCoordinator) [2024-11-18 14:36:14,346] INFO [GroupCoordinator 1]: Assignment received from leader console-consumer-340e7131-cbd4-4811-a62a-543fbac93948 for group 1 for generation 3. The group has 3 members, 0 of which are static. (kafka.coordinator.group.GroupCoordinator) And in the logs of broker 2 (or 3), we can see that there is one consumer in the group 2:\n[2024-11-18 14:38:49,987] INFO [GroupCoordinator 3]: Stabilized group 2 generation 1 (__consumer_offsets-0) with 1 members (kafka.coordinator.group.GroupCoordinator) [2024-11-18 14:38:50,050] INFO [GroupCoordinator 3]: Assignment received from leader console-consumer-bebf5e94-8479-4ab8-b078-ced3f0d81d4c for group 2 for generation 1. The group has 1 members, 0 of which are static. (kafka.coordinator.group.GroupCoordinator) Send Messages Run the following Java method to send messages to the topic myorders:\npublic class Main { private static final Logger log = LoggerFactory.getLogger(Main.class); private static final String TOPIC = \u0026#34;myorders\u0026#34;; public static void main(String[] args) throws InterruptedException { Properties props = new Properties(); props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;http://localhost:9092,http://localhost:9093,http://localhost:9094\u0026#34;); props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, DoubleSerializer.class.getName()); KafkaProducer\u0026lt;String, Double\u0026gt; producer = new KafkaProducer\u0026lt;\u0026gt;(props); String stateString = \u0026#34;AK,AL,AZ,AR,CA,CO,CT,DE,FL,GA,\u0026#34; + \u0026#34;HI,ID,IL,IN,IA,KS,KY,LA,ME, MD,\u0026#34; + \u0026#34;MA,MI,MN,MS,MO,MT,NE,NV,NH,NJ,\u0026#34; + \u0026#34;NM,NY,NC,ND,OH,OK,OR,PA,RI,SC,\u0026#34; + \u0026#34;SD,TN,TX,UT,VT,VA,WA,WV,WI,WY\u0026#34;; String[] stateArray = stateString.split(\u0026#34;,\u0026#34;); for (int i = 0; i \u0026lt; 25000; i++) { String key = stateArray[(int) Math.floor(Math.random()*(50))]; double value = Math.floor(Math.random()* (10000-10+1)+10); ProducerRecord\u0026lt;String, Double\u0026gt; producerRecord = new ProducerRecord\u0026lt;\u0026gt;(TOPIC, key, value); log.info(\u0026#34;Sending message with key \u0026#34; + key + \u0026#34; to Kafka\u0026#34;); producer.send(producerRecord, (metadata, e) -\u0026gt; { if (metadata != null) { System.out.println(producerRecord.key()); System.out.println(producerRecord.value()); System.out.println(metadata.toString()); } }); Thread.sleep(5000); } producer.flush(); producer.close(); log.info(\u0026#34;Successfully produced messages to \u0026#34; + TOPIC + \u0026#34; topic\u0026#34;); } } We can see that the consumer in the group 2 read all messages:\nMT,4138.0 LA,6868.0 KS,6318.0 MA,6184.0 NM,8817.0 NJ,6606.0 NV,9748.0 The consumer 1 in the group 1:\nMT,4138.0 NV,9748.0 The consumer 2 (or 3) in the group 2:\nLA,6868.0 KS,6318.0 MA,6184.0 NM,8817.0 NJ,6606.0 But consumer 3 (or 2) in the group 3 doesn\u0026rsquo;t read any message. That\u0026rsquo;s because there are only two partitions, which has been assigned to the other two consumers. So this consumer is idle. One partition can only be assigned to one consumer.\nWe can chek the detail of consumer groups:\nâ¯ kafka-consumer-groups.sh --all-groups --all-topics --bootstrap-server localhost:9092 --describe GROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAG CONSUMER-ID HOST CLIENT-ID 1 myorders 0 13 13 0 console-consumer-340e7131-cbd4-4811-a62a-543fbac93948 /172.18.0.1 console-consumer 1 myorders 1 16 16 0 console-consumer-68f58739-69be-4f48-af94-590ee15add84 /172.18.0.1 console-consumer GROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAG CONSUMER-ID HOST CLIENT-ID 2 myorders 1 16 16 0 console-consumer-bebf5e94-8479-4ab8-b078-ced3f0d81d4c /172.18.0.1 console-consumer 2 myorders 0 13 13 0 console-consumer-bebf5e94-8479-4ab8-b078-ced3f0d81d4c /172.18.0.1 console-consumer% We can see that in the group 1, these two partitions are assigned to two different consumers. But in the group2, these two partitions are assigned to the same consumer.\nDemo: Consuming Messages with Java Deserializers and Consumer Configuration Provide two or more locations where the Bootstrap servers are located:\nProperties properties = new Properties(); properties.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;localhost:9092\u0026#34;); properties.put(ConsumerConfig.GROUP_ID_CONFIG, \u0026#34;my_group\u0026#34;); properties.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, \u0026#34;org.apache.kafka.common.serialization.StringDeserializer\u0026#34;); properties.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, \u0026#34;org.apache.kafka,common,serialization.IntegerDeserializer\u0026#34;); properties.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, \u0026#34;earliest\u0026#34;); Construct a org.apache.kafka.clients.consumer.KafkaConsumer object:\nKafkaConsumer consumer = new KafkaConsumer\u0026lt;\u0026gt;(properties); Use the consumer that you have constructed, and call poll with pulse time:\nwhile (!done.get()) { ConsumerRecords\u0026lt;String, String\u0026gt; records = consumer.poll(Duration.of(500, ChronoUnit.MILLIS)); for (ConsumerRecord\u0026lt;String, String\u0026gt; record : records) { System.out.format(\u0026#34;offset: %d\\n\u0026#34;, record.offset()); System.out.format(\u0026#34;partition: %d\\n\u0026#34;, record.partition()); System.out.format(\u0026#34;timestamp: %d\\n\u0026#34;, record.timestamp()); System.out.format(\u0026#34;timeStamppType: %d\\n\u0026#34;, record.timestampType()); System.out.format(\u0026#34;topic: %d\\n\u0026#34;, record.topic()); System.out.format(\u0026#34;key: %d\\n\u0026#34;, record.key()); System.out.format(\u0026#34;value: %d\\n\u0026#34;, record.value()); } } Close the consumer:\nconsumer.close(); Rebalance Regardless of what a consumer is doing, at regular intervals, which are configurable, they send a heartbeat to Kafka. Specifically to the coordinator inside the broker, basically letting them know they are alive. Also, when we poll for records, that lets Kafka know what consumer is alive. When you close a consumer, that close() method lets Kafka know they are not alive anymore, which triggers a rebalance. Sample Code package com.globomantics; import org.apache.kafka.clients.consumer.ConsumerConfig; import org.apache.kafka.clients.consumer.ConsumerRecord; import org.apache.kafka.clients.consumer.ConsumerRecords; import org.apache.kafka.clients.consumer.KafkaConsumer; import org.apache.kafka.common.serialization.DoubleDeserializer; import org.apache.kafka.common.serialization.StringDeserializer; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.time.Duration; import java.util.Collections; import java.util.Properties; public class Consumer { private static final Logger log = LoggerFactory.getLogger(Consumer.class); public static void main(String[] args) { Properties props = new Properties(); props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;http://localhost:9092,http://localhost:9093,http://localhost:9094\u0026#34;); props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName()); props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, DoubleDeserializer.class.getName()); props.put(ConsumerConfig.GROUP_ID_CONFIG, args[0] + \u0026#34;consumer\u0026#34;); KafkaConsumer\u0026lt;String, Double\u0026gt; consumer = new KafkaConsumer\u0026lt;\u0026gt;(props); Thread haltedHook = new Thread(consumer::close); Runtime.getRuntime().addShutdownHook(haltedHook); consumer.subscribe(Collections.singletonList(\u0026#34;myorders\u0026#34;)); while (true) { ConsumerRecords\u0026lt;String, Double\u0026gt; records = consumer.poll(Duration.ofMillis(100)); records.forEach(Consumer::processRecord); } } private static void processRecord(ConsumerRecord record) { log.info(\u0026#34;Received message with key: \u0026#34; + record.key() + \u0026#34; and value \u0026#34; + record.value()); log.info(\u0026#34;It comes from partition: \u0026#34; + record.partition()); try { Thread.sleep(1000); } catch (InterruptedException e) { System.out.println(e.getMessage()); } } } Demo Run composed containers using the same yaml file:\ndocker compose up -d create a topic myorders with four partitions:\nkafka-topics.sh --create --bootstrap-server localhost:9092 \\ --partitions 4 --topic myorders Run two consumers in two terminals with the same command:\nmvn clean install exec:java -Dexec.mainClass=\u0026#34;com.globomantics.Consumer\u0026#34; -Dexec.args=\u0026#34;1\u0026#34; We can check the running consumers by checking the log of each broker:\ndocker logs broker-1 If any broker shows a log like the following, the two consumers are alive and assigned to this broker:\n[2024-11-20 16:01:51,462] INFO [GroupCoordinator 2]: Assignment received from leader consumer-1consumer-1-ec9ee2fb-587c-44ad-bd09-be2b75182295 for group 1consumer for generation 2. The group has 2 members, 0 of which are static. (kafka.coordinator.group.GroupCoordinator) Run a producer by the following Producer class, which send messages to the topic myorders:\npackage com.globomantics; import org.apache.kafka.clients.producer.KafkaProducer; import org.apache.kafka.clients.producer.ProducerConfig; import org.apache.kafka.clients.producer.ProducerRecord; import org.apache.kafka.common.serialization.DoubleSerializer; import org.apache.kafka.common.serialization.StringSerializer; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import java.util.Properties; public class Producer { private static final Logger log = LoggerFactory.getLogger(Producer.class); private static final String TOPIC = \u0026#34;myorders\u0026#34;; public static void main(String[] args) throws InterruptedException { Properties props = new Properties(); props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;http://localhost:9092,http://localhost:9093,http://localhost:9094\u0026#34;); props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, DoubleSerializer.class.getName()); KafkaProducer\u0026lt;String, Double\u0026gt; producer = new KafkaProducer\u0026lt;\u0026gt;(props); String stateString = \u0026#34;AK,AL,AZ,AR,CA,CO,CT,DE,FL,GA,\u0026#34; + \u0026#34;HI,ID,IL,IN,IA,KS,KY,LA,ME,MD,\u0026#34; + \u0026#34;MA,MI,MN,MS,MO,MT,NE,NV,NH,NJ,\u0026#34; + \u0026#34;NM,NY,NC,ND,OH,OK,OR,PA,RI,SC,\u0026#34; + \u0026#34;SD,TN,TX,UT,VT,VA,WA,WV,WI,WY\u0026#34;; String[] stateArray = stateString.split(\u0026#34;,\u0026#34;); for (int i = 0; i \u0026lt; 25000; i++) { String key = stateArray[(int) Math.floor(Math.random()*(50))]; double value = Math.floor(Math.random()* (10000-10+1)+10); ProducerRecord\u0026lt;String, Double\u0026gt; producerRecord = new ProducerRecord\u0026lt;\u0026gt;(TOPIC, key, value); log.info(\u0026#34;Sending message with key \u0026#34; + key + \u0026#34; to Kafka\u0026#34;); producer.send(producerRecord, (metadata, e) -\u0026gt; { if (metadata != null) { System.out.println(producerRecord.key()); System.out.println(producerRecord.value()); System.out.println(metadata.toString()); } }); Thread.sleep(5000); } producer.flush(); producer.close(); log.info(\u0026#34;Successfully produced messages to \u0026#34; + TOPIC + \u0026#34; topic\u0026#34;); } } We can see that the consumer 1 received messages from partitions 0 and 1:\n[com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - Received message with key: KS and value 9144.0 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - It comes from partition: 1 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - Received message with key: MS and value 4089.0 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - It comes from partition: 0 And, consumer 2 received messages from partitions 2 and 3:\n[com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - Received message with key: UT and value 1539.0 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - It comes from partition: 2 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - Received message with key: IA and value 9049.0 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - It comes from partition: 3 We can chek the detail of consumer groups:\nâ¯ kafka-consumer-groups.sh --all-groups --all-topics --bootstrap-server localhost:9092 --describe GROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAG CONSUMER-ID HOST CLIENT-ID 1consumer myorders 2 2 2 0 consumer-1consumer-1-ec9ee2fb-587c-44ad-bd09-be2b75182295 /172.19.0.1 consumer-1consumer-1 1consumer myorders 3 1 1 0 consumer-1consumer-1-ec9ee2fb-587c-44ad-bd09-be2b75182295 /172.19.0.1 consumer-1consumer-1 1consumer myorders 1 2 2 0 consumer-1consumer-1-41553fd9-436f-459f-8345-84cac011a51d /172.19.0.1 consumer-1consumer-1 1consumer myorders 0 2 2 0 consumer-1consumer-1-41553fd9-436f-459f-8345-84cac011a51d /172.19.0.1 consumer-1consumer-1% We can see that the partitions 0 and 1 are assigned to a same consumer, and the partitions 2 and 3 are assigned to the same consumers.\nThen let\u0026rsquo;s run the third consumer by the same command:\nmvn clean install exec:java -Dexec.mainClass=\u0026#34;com.globomantics.Consumer\u0026#34; -Dexec.args=\u0026#34;1\u0026#34; Now, we can see something like the consumer 2 only received messages from partition 3:\n[com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - Received message with key: MA and value 202.0 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - It comes from partition: 3 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - Received message with key: FL and value 4078.0 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - It comes from partition: 3 And, the new joining consumer 3 only received messages from partition 2:\n[com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - Received message with key: MN and value 8388.0 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - It comes from partition: 2 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - Received message with key: CT and value 1375.0 [com.globomantics.Consumer.main()] INFO com.globomantics.Consumer - It comes from partition: 2 The new consumer 3 shared the load of consumer 2.\nWe can also check the consumer groups again:\nâ¯ kafka-consumer-groups.sh --all-groups --all-topics --bootstrap-server localhost:9092 --describe GROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAG CONSUMER-ID HOST CLIENT-ID 1consumer myorders 1 24 24 0 consumer-1consumer-1-41553fd9-436f-459f-8345-84cac011a51d /172.19.0.1 consumer-1consumer-1 1consumer myorders 0 20 20 0 consumer-1consumer-1-41553fd9-436f-459f-8345-84cac011a51d /172.19.0.1 consumer-1consumer-1 1consumer myorders 3 29 30 1 consumer-1consumer-1-ec9ee2fb-587c-44ad-bd09-be2b75182295 /172.19.0.1 consumer-1consumer-1 1consumer myorders 2 16 16 0 consumer-1consumer-1-9bf052d6-4197-4c00-b327-8cc1f13662c4 /172.19.0.1 consumer-1consumer-1% We can see that partition 3 is assigned to only one consumer, and partition 2 is assigned to the other new joining consumer.\nWe can also check the log of broker 2 (or maybe in other broker):\n[2024-11-20 16:22:22,217] INFO [GroupCoordinator 2]: Dynamic member with unknown member id joins group 1consumer in Stable state. Created a new member id consumer-1consumer-1-9bf052d6-4197-4c00-b327-8cc1f13662c4 and request the member to rejoin with this id. (kafka.coordinator.group.GroupCoordinator) [2024-11-20 16:22:22,234] INFO [GroupCoordinator 2]: Preparing to rebalance group 1consumer in state PreparingRebalance with old generation 2 (__consumer_offsets-7) (reason: Adding new member consumer-1consumer-1-9bf052d6-4197-4c00-b327-8cc1f13662c4 with group instance id None; client reason: rebalance failed due to MemberIdRequiredException) (kafka.coordinator.group.GroupCoordinator) The group is rebalanced due to a new consumer joining in.\nTakeaways Consumers act as a group via the consumer group ID. Each consumer in the group gets assigned a partition, and a partition is not shared by two members of a group. A rebalance is triggered when a member leaves the group or they haven\u0026rsquo;t sent a heartbeat in a long time. A rebalance is a stop-the-world event that ensures all partitions are attended by some consumer in the group. Keys Be sure to configure your consumer to ensure you are not duplicating messages. Try to create a consumer loop with two consumers and verify the partition assignment by playing with keys in the producer. See what happens in the logs of the broker when a consumer joins or leaves the group. ","permalink":"https://zjxjwxk.github.io/posts/mq/kafka/getting-started-with-apache-kafka/4-kafka-conumers/","summary":"\u003ch2 id=\"kafka-consumer-group\"\u003eKafka Consumer Group\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eConsumers are typically done as a group.\u003c/li\u003e\n\u003cli\u003eA single consumer will end up inefficient with large amounts of data.\u003c/li\u003e\n\u003cli\u003eA consumer may never catch up.\u003c/li\u003e\n\u003cli\u003eEvery consumer should be on it\u0026rsquo;s own machine, instance, pod.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe consumer group ID is the key so Kafka knows that messages should be distributed to both consumers without duplicating.\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241118185205006\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/4-kafka-conumers/images/image-20241118185205006.png\"\u003e\u003c/p\u003e\n\u003cp\u003eIf we add one more consumer to this group, the last one will be idle, because one partition can\u0026rsquo;t be share across consumers. One partition can only be assigned to one consumer. Instead, the partitions are the way of Kafka to scale. More partitions imply you can have more consumers in the same consumer group.\u003c/p\u003e","title":"Kafka Consumer"},{"content":"Kafka Producer Overview Demo: Producing Messages with Kafka CLI Run Kafka Containers Create a docker-compose file docker-compose.yaml containing three Zookeepers, three Kafka Brokers, and a Kafka REST Proxy:\n--- version: \u0026#39;3\u0026#39; services: zookeeper-1: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-1 container_name: zookeeper-1 volumes: - ./zookeeper-1_data:/var/lib/zookeeper/data - ./zookeeper-1_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 1 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-2: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-2 container_name: zookeeper-2 volumes: - ./zookeeper-2_data:/var/lib/zookeeper/data - ./zookeeper-2_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 2 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-3: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-3 container_name: zookeeper-3 volumes: - ./zookeeper-3_data:/var/lib/zookeeper/data - ./zookeeper-3_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 3 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 broker-1: image: confluentinc/cp-kafka:7.4.1 hostname: broker-1 container_name: broker-1 volumes: - ./broker-1-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 ports: - 9092:9092 - 29092:29092 environment: KAFKA_BROKER_ID: 1 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9092,INTERNAL://broker-1:29092 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-2: image: confluentinc/cp-kafka:7.4.1 hostname: broker-2 container_name: broker-2 volumes: - ./broker-2-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 ports: - 9093:9093 - 29093:29093 environment: KAFKA_BROKER_ID: 2 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9093,INTERNAL://broker-2:29093 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-3: image: confluentinc/cp-kafka:7.4.1 hostname: broker-3 container_name: broker-3 volumes: - ./broker-3-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 ports: - 9094:9094 - 29094:29094 environment: KAFKA_BROKER_ID: 3 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9094,INTERNAL://broker-3:29094 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true rest-proxy: image: confluentinc/cp-kafka-rest:7.4.1 ports: - \u0026#34;8082:8082\u0026#34; depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 - broker-3 hostname: rest-proxy container_name: rest-proxy environment: KAFKA_REST_HOST_NAME: rest-proxy KAFKA_REST_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; KAFKA_REST_LISTENERS: \u0026#34;http://0.0.0.0:8082\u0026#34; Run composed containers:\ndocker compose up -d Create Topic Create a topic myorders with replication factor 3 and partitions 3:\nkafka-topics.sh --create --bootstrap-server localhost:9092 --replication-factor 3 --partitions 3 --topic myorders Run Consumer Run a Kafka Consumer subscribing to this myorders topic with group 1.\nkafka-console-consumer.sh --bootstrap-server localhost:9092 --topic myorders --group 1 Open a new terminal, and run another Kafka Consumer with the same command.\nWe can check if these consumers run successfully by:\ndocker logs broker-1 If there is some logs like the following, then it\u0026rsquo;s successful. They are both in the same group listening to the myorders topic.\n[2024-11-17 02:40:35,317] INFO [GroupCoordinator 1]: Assignment received from leader console-consumer-2110450b-b5f1-42d1-a80f-a66c540b2a7b for group 1 for generation 1. The group has 1 members, 0 of which are static. (kafka.coordinator.group.GroupCoordinator) ... [2024-11-17 02:42:50,507] INFO [GroupCoordinator 1]: Assignment received from leader console-consumer-2110450b-b5f1-42d1-a80f-a66c540b2a7b for group 1 for generation 2. The group has 2 members, 0 of which are static. (kafka.coordinator.group.GroupCoordinator) Send Messages Run a Kafka Producer with some properties to parse the messages with key and value seperated by :\nkafka-console-producer.sh --bootstrap-server localhost:9092 --topic myorders --property parse.key=true --property key.separator=: Then, send some messages with the same key:\n\u0026gt;Wxk:Hello \u0026gt;Wxk:from \u0026gt;Wxk:Wxk \u0026gt; We will find that one consumer get all the messages, but the other get nothing.\nConsumer 1:\nâ¯ kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic myorders --group 1 Hello from Wxk Consumer 2:\nâ¯ kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic myorders --group 1 The consumer 2 didn\u0026rsquo;t get anything because messages with the same key always go to the same partition, which is assigned to the same consumer.\nIf we send some messages with other keys, the consumer 2 will get some messages.\nâ¯ kafka-console-producer.sh --bootstrap-server localhost:9092 --topic myorders --property parse.key=true --property key.separator=: \u0026gt;Wxk:Hello \u0026gt;Wxk:from \u0026gt;Wxk:Wxk \u0026gt;Bob:Hello \u0026gt;Tim:from \u0026gt;John:others \u0026gt; Consumer 2:\nâ¯ kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic myorders --group 1 from others Show Consumer Groups We can show consumer groups and their descriptions by:\nkafka-consumer-groups.sh --all-groups --all-topics --bootstrap-server localhost:9092 --describe The consumer groups should show like this:\nGROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAG CONSUMER-ID HOST CLIENT-ID 1 myorders 1 1 1 0 console-consumer-2110450b-b5f1-42d1-a80f-a66c540b2a7b /172.21.0.1 console-consumer 1 myorders 0 1 1 0 console-consumer-2110450b-b5f1-42d1-a80f-a66c540b2a7b /172.21.0.1 console-consumer 1 myorders 2 4 4 0 console-consumer-b8c1facf-2db9-4edf-8732-2e9349665caf /172.21.0.1 console-consumer% These three consumers belong to the same group so that they share the load. The partitions 0 and 1 are assigned to a same consumer, and partition 2 is assigned to the other.\nDemo: Producing Messages with Java Serializers and Producer Configuration Provide a Serializer for the key:\nProperties properties = new Properties(); properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;localhost:9092\u0026#34;); properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, IntegerSerializer.class); Producer Object:\nKafkaProducer producer = new KafkaProducer\u0026lt;\u0026gt;(properties); Create a Record:\nProducerRecord producerRecord = new ProducerRecord\u0026lt;\u0026gt;(\u0026#34;my_orders\u0026#34;, state, amount); Sending a Message\nFuture send = producer.send(producerRecord); Contains information about your send including the messages:\nif (metadata.hasOffset()) { System.out.format(\u0026#34;offset: %d\\n\u0026#34;, metadata.offset()); } System.out.format(\u0026#34;partition: %d\\n\u0026#34;, metadata.partition()); System.out.format(\u0026#34;timestamp: %d\\n\u0026#34;, metadata.timestamp()); System.out.format(\u0026#34;topic: %s\\n\u0026#34;, metadata.topic()); System.out.format(\u0026#34;toString: %s\\n\u0026#34;, metadata.toString()); Capturing a Callback:\nproducer.send(producerRecord, new Callback() { @Override public void onCompletion(RecordMetadata metadata, Exception e) { ... } }) Using Lambdas:\nproducer.send(producerRecord, (metadata, e) -\u0026gt; { if (metadata != null) { System.out.println(producerRecord.key()); System.out.println(producerRecord.value()); } }) Flush messages in the buffer and close connection:\nproducer.flush(); producer.close(); Sample code public class Main { private static final Logger log = LoggerFactory.getLogger(Main.class); private static final String TOPIC = \u0026#34;myorders\u0026#34;; public static void main(String[] args) throws InterruptedException { Properties props = new Properties(); props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \u0026#34;http://localhost:9092,http://localhost:9093,http://localhost:9094\u0026#34;); props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, DoubleSerializer.class.getName()); KafkaProducer\u0026lt;String, Double\u0026gt; producer = new KafkaProducer\u0026lt;\u0026gt;(props); String stateString = \u0026#34;AK,AL,AZ,AR,CA,CO,CT,DE,FL,GA,\u0026#34; + \u0026#34;HI,ID,IL,IN,IA,KS,KY,LA,ME,MD,\u0026#34; + \u0026#34;MA,MI,MN,MS,MO,MT,NE,NV,NH,NJ,\u0026#34; + \u0026#34;NM,NY,NC,ND,OH,OK,OR,PA,RI,SC,\u0026#34; + \u0026#34;SD,TN,TX,UT,VT,VA,WA,WV,WI,WY\u0026#34;; String[] stateArray = stateString.split(\u0026#34;,\u0026#34;); for (int i = 0; i \u0026lt; 25000; i++) { String key = stateArray[(int) Math.floor(Math.random()*(50))]; double value = Math.floor(Math.random()* (10000-10+1)+10); ProducerRecord\u0026lt;String, Double\u0026gt; producerRecord = new ProducerRecord\u0026lt;\u0026gt;(TOPIC, key, value); log.info(\u0026#34;Sending message with key \u0026#34; + key + \u0026#34; to Kafka\u0026#34;); producer.send(producerRecord, (metadata, e) -\u0026gt; { if (metadata != null) { System.out.println(producerRecord.key()); System.out.println(producerRecord.value()); System.out.println(metadata.toString()); } }); Thread.sleep(1000); } producer.flush(); producer.close(); log.info(\u0026#34;Successfully produced messages to \u0026#34; + TOPIC + \u0026#34; topic\u0026#34;); } } Demo Run a Kafka Consumer listening to the topic myorders and deserialize the messages by string key and double value separated by ,.\nkafka-console-consumer.sh \\ --bootstrap-server localhost:9092 \\ --topic myorders --from-beginning \\ --key-deserializer org.apache.kafka.common.serialization.StringDeserializer \\ --value-deserializer org.apache.kafka.common.serialization.DoubleDeserializer \\ --property print.key=true \\ --property key.separator=, \\ --group 1 Run the Java Main class. The console will print information like:\n[main] INFO com.globomantics.Main - Sending message with key UT to Kafka UT 8272.0 myorders-1@38 [main] INFO com.globomantics.Main - Sending message with key IL to Kafka IL 7659.0 myorders-0@39 [main] INFO com.globomantics.Main - Sending message with key CO to Kafka CO 8457.0 myorders-1@39 And the consumer will receive messages like:\nUT,8272.0 IL,7659.0 CO,8457.0 Takeaways The producer protocol implies the existence of a Partitioner that redirects messages to the correct partition. The partition information is caught on the initial instantiation of the Producer Object. The response from the producer.send() method is a Future, but you can capture it in a Callback or Lambda. There are retryable and not retryable Exceptions and based on that the Protocol will automatically retry. ","permalink":"https://zjxjwxk.github.io/posts/mq/kafka/getting-started-with-apache-kafka/3-kafka-producer/","summary":"\u003ch2 id=\"kafka-producer-overview\"\u003eKafka Producer Overview\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241116183122165\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/3-kafka-producer/images/image-20241116183122165.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"demo-producing-messages-with-kafka-cli\"\u003eDemo: Producing Messages with Kafka CLI\u003c/h2\u003e\n\u003ch3 id=\"run-kafka-containers\"\u003eRun Kafka Containers\u003c/h3\u003e\n\u003cp\u003eCreate a docker-compose file \u003ccode\u003edocker-compose.yaml\u003c/code\u003e containing three Zookeepers, three Kafka Brokers, and a Kafka REST Proxy:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eversion\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;3\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eservices\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ezookeeper-1\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-zookeeper:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-1_data:/var/lib/zookeeper/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-1_log:/var/lib/zookeeper/log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_CLIENT_PORT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_TICK_TIME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_MY_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_SERVERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eserver.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ezookeeper-2\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-zookeeper:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-2_data:/var/lib/zookeeper/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-2_log:/var/lib/zookeeper/log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_CLIENT_PORT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_TICK_TIME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_MY_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_SERVERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eserver.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ezookeeper-3\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-zookeeper:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-3_data:/var/lib/zookeeper/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-3_log:/var/lib/zookeeper/log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_CLIENT_PORT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_TICK_TIME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_MY_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_SERVERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eserver.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ebroker-1\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-kafka:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./broker-1-data:/var/lib/kafka/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e9092\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e9092\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e29092\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e29092\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_BROKER_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ZOOKEEPER_CONNECT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1:2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ADVERTISED_LISTENERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST://localhost:9092,INTERNAL://broker-1:29092\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_LISTENER_SECURITY_PROTOCOL_MAP\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST:PLAINTEXT,INTERNAL:PLAINTEXT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_INTER_BROKER_LISTENER_NAME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eINTERNAL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_SNAPSHOT_TRUST_EMPTY\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ebroker-2\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-kafka:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./broker-2-data:/var/lib/kafka/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e9093\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e9093\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e29093\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e29093\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_BROKER_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ZOOKEEPER_CONNECT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1:2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ADVERTISED_LISTENERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST://localhost:9093,INTERNAL://broker-2:29093\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_LISTENER_SECURITY_PROTOCOL_MAP\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST:PLAINTEXT,INTERNAL:PLAINTEXT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_INTER_BROKER_LISTENER_NAME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eINTERNAL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_SNAPSHOT_TRUST_EMPTY\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ebroker-3\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-kafka:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./broker-3-data:/var/lib/kafka/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e9094\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e9094\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e29094\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e29094\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_BROKER_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ZOOKEEPER_CONNECT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1:2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ADVERTISED_LISTENERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST://localhost:9094,INTERNAL://broker-3:29094\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_LISTENER_SECURITY_PROTOCOL_MAP\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST:PLAINTEXT,INTERNAL:PLAINTEXT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_INTER_BROKER_LISTENER_NAME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eINTERNAL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_SNAPSHOT_TRUST_EMPTY\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003erest-proxy\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-kafka-rest:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;8082:8082\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003erest-proxy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003erest-proxy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_REST_HOST_NAME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003erest-proxy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_REST_BOOTSTRAP_SERVERS\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_REST_LISTENERS\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;http://0.0.0.0:8082\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRun composed containers:\u003c/p\u003e","title":"Kafka Producer"},{"content":"Kafka Architecture Kafka Message Deploy Kafka Create a docker-compose file docker-compose.yaml containing three Zookeepers, three Kafka Brokers, and a Kafka REST Proxy:\n--- version: \u0026#39;3\u0026#39; services: zookeeper-1: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-1 container_name: zookeeper-1 volumes: - ./zookeeper-1_data:/var/lib/zookeeper/data - ./zookeeper-1_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 1 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-2: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-2 container_name: zookeeper-2 volumes: - ./zookeeper-2_data:/var/lib/zookeeper/data - ./zookeeper-2_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 2 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 zookeeper-3: image: confluentinc/cp-zookeeper:7.4.1 hostname: zookeeper-3 container_name: zookeeper-3 volumes: - ./zookeeper-3_data:/var/lib/zookeeper/data - ./zookeeper-3_log:/var/lib/zookeeper/log environment: ZOOKEEPER_CLIENT_PORT: 2181 ZOOKEEPER_TICK_TIME: 2000 ZOO_MY_ID: 3 ZOO_SERVERS: server.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181 broker-1: image: confluentinc/cp-kafka:7.4.1 hostname: broker-1 container_name: broker-1 volumes: - ./broker-1-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 ports: - 9092:9092 - 29092:29092 environment: KAFKA_BROKER_ID: 1 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9092,INTERNAL://broker-1:29092 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-2: image: confluentinc/cp-kafka:7.4.1 hostname: broker-2 container_name: broker-2 volumes: - ./broker-2-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 ports: - 9093:9093 - 29093:29093 environment: KAFKA_BROKER_ID: 2 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9093,INTERNAL://broker-2:29093 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true broker-3: image: confluentinc/cp-kafka:7.4.1 hostname: broker-3 container_name: broker-3 volumes: - ./broker-3-data:/var/lib/kafka/data depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 ports: - 9094:9094 - 29094:29094 environment: KAFKA_BROKER_ID: 3 KAFKA_ZOOKEEPER_CONNECT: zookeeper-1:2181 KAFKA_ADVERTISED_LISTENERS: HOST://localhost:9094,INTERNAL://broker-3:29094 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: HOST:PLAINTEXT,INTERNAL:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL KAFKA_SNAPSHOT_TRUST_EMPTY: true rest-proxy: image: confluentinc/cp-kafka-rest:7.4.1 ports: - \u0026#34;8082:8082\u0026#34; depends_on: - zookeeper-1 - zookeeper-2 - zookeeper-3 - broker-1 - broker-2 - broker-3 hostname: rest-proxy container_name: rest-proxy environment: KAFKA_REST_HOST_NAME: rest-proxy KAFKA_REST_BOOTSTRAP_SERVERS: \u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39; KAFKA_REST_LISTENERS: \u0026#34;http://0.0.0.0:8082\u0026#34; Run composed containers:\ndocker compose up -d When all containers run like this:\n[+] Running 8/8 â ¿ Network demo1_default Created 0.1s â ¿ Container zookeeper-1 Started 2.6s â ¿ Container zookeeper-2 Started 2.5s â ¿ Container zookeeper-3 Started 2.6s â ¿ Container broker-1 Started 3.6s â ¿ Container broker-2 Started 4.4s â ¿ Container broker-3 Started 5.2s â ¿ Container rest-proxy Started 5.7s We can check the docker logs:\ndocker logs broker-1 We can also check all service statuses:\ndocker compose ps It should show that all services are up:\nNAME IMAGE COMMAND SERVICE CREATED STATUS PORTS broker-1 confluentinc/cp-kafka:7.4.1 \u0026#34;/etc/confluent/dockâ€¦\u0026#34; broker-1 3 minutes ago Up 3 minutes 0.0.0.0:9092-\u0026gt;9092/tcp, 0.0.0.0:29092-\u0026gt;29092/tcp broker-2 confluentinc/cp-kafka:7.4.1 \u0026#34;/etc/confluent/dockâ€¦\u0026#34; broker-2 3 minutes ago Up 3 minutes 0.0.0.0:9093-\u0026gt;9093/tcp, 9092/tcp, 0.0.0.0:29093-\u0026gt;29093/tcp broker-3 confluentinc/cp-kafka:7.4.1 \u0026#34;/etc/confluent/dockâ€¦\u0026#34; broker-3 3 minutes ago Up 3 minutes 0.0.0.0:9094-\u0026gt;9094/tcp, 9092/tcp, 0.0.0.0:29094-\u0026gt;29094/tcp rest-proxy confluentinc/cp-kafka-rest:7.4.1 \u0026#34;/etc/confluent/dockâ€¦\u0026#34; rest-proxy 3 minutes ago Up 3 minutes 0.0.0.0:8082-\u0026gt;8082/tcp zookeeper-1 confluentinc/cp-zookeeper:7.4.1 \u0026#34;/etc/confluent/dockâ€¦\u0026#34; zookeeper-1 3 minutes ago Up 3 minutes 2181/tcp, 2888/tcp, 3888/tcp zookeeper-2 confluentinc/cp-zookeeper:7.4.1 \u0026#34;/etc/confluent/dockâ€¦\u0026#34; zookeeper-2 3 minutes ago Up 3 minutes 2181/tcp, 2888/tcp, 3888/tcp zookeeper-3 confluentinc/cp-zookeeper:7.4.1 \u0026#34;/etc/confluent/dockâ€¦\u0026#34; zookeeper-3 3 minutes ago Up 3 minutes 2181/tcp, 2888/tcp, 3888/tcp We can also call the REST APIs provided by the Kafka REST Proxy. For example, display alive brokers:\ncurl localhost:8082/brokers It should show that there are three living brokers:\n{\u0026#34;brokers\u0026#34;:[1,2,3]}% Kafka Ecosystem Packaging Versions:\nConfluent Cloud Cloudera Strimzi offers the Helm charts to deploy Kafka to Kubernetes Logging Plugins:\nSyslog Fluentd Logstash Filebeat DBs:\nJDBC connector to cover RDBMS Dos. Debezium also offers a connector that includes no-SQL Dos. Presto connector that allows us to query Kafka using Presto queries. Demo: Interaction with Kafka via the CLI Run Kafka Containers Run composed containers (if not):\ndocker compose up -d Add Kafka PATH Download Kafka from the official website https://kafka.apache.org/downloads:\nAdd Kafka to your PATH. (I use zsh, so it\u0026rsquo;s configured in the ~/.zshrc for me)\nexport KAFKA_HOME=/Users/zjxjwxk/Library/kafka_2.13-3.9.0 export PATH=$PATH:$KAFKA_HOME/bin Then run this command (if you are using a Linux-like OS):\nsource ~/.zshrc Send Messages Send messages by running Kafka Producer:\nâ¯ kafka-console-producer.sh --bootstrap-server localhost:9092 --topic first_topic \u0026gt;Hello [2024-11-16 15:41:58,970] WARN [Producer clientId=console-producer] The metadata response from the cluster reported a recoverable issue with correlation id 7 : {first_topic=LEADER_NOT_AVAILABLE} (org.apache.kafka.clients.NetworkClient) \u0026gt;Kafka \u0026gt;I\u0026#39;m Xinkang \u0026gt; Receive Messages Receive messages by running Kafka Consumer:\nâ¯ kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic first_topic --from-beginning Hello Kafka I\u0026#39;m Xinkang Display topics by Kafka REST Proxy:\nâ¯ curl localhost:8082/topics [\u0026#34;first_topic\u0026#34;]% Topics Kafka Producers send messages to topics of Kafka Brokers:\nRetention Can Be Set To:\nDays: This means only keeping messages of up to N days and then deleting them. Bytes: This means only keeping messages until the topic has more than X bytes and then delete. None: This means storing all messages from the beginning of time. Kafka Consumers consume messages from topics of Kafka Brokers:\nPartitions A topic can be split into partitions and distributed within brokers in the cluster:\nThe partitioner uses the key to distribute the messages to the correct partition:\nConsumer Read Scenarios Consumer Offset: From the Beginning\nConsumer Offset: From the End\nConsumer Offset: Already Have Been Here\nSummary:\nTopics can be partitioned. The partitioner uses the message key to redirect messages to partitions. Consumers read them from partitions and have an offset. Therefore, more partitions enable more consumers, which makes it more scalable. Topic Replication Each topic has a number called the replication factor, which replicates each partition of that topic:\nEach partition is on a different broker. Therefore, a single topic is scaled.\nDemo: Interaction with Kafka via the REST Proxy Run Kafka Containers Run composed containers (if not):\ndocker compose up -d Import Postman Collection Use this Open API yaml for Kafka REST Proxy: https://github.com/axel-sirota/getting-started-kafka/blob/main/rest_proxy.yaml, which provides RESTful interfaces to a Kafka cluster.\nWe can import this yaml to the Postman as a collection:\nThen, add an environment for variables like baseUrl and use the environment.\nCreate Topic Create a topic myorders with one replication and three partitions:\nkafka-topics.sh --create --bootstrap-server localhost:9092 --replication-factor 1 --partitions 3 --topic myorders The created topic can be displayed by calling {{baseUrl}}/topics/:topicName via Postman. The path variable :topicName should be myorders. The response will be like:\n{ \u0026#34;name\u0026#34;: \u0026#34;myorders\u0026#34;, ... \u0026#34;partitions\u0026#34;: [ { \u0026#34;partition\u0026#34;: 0, \u0026#34;leader\u0026#34;: 1, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 1, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true } ] }, { \u0026#34;partition\u0026#34;: 1, \u0026#34;leader\u0026#34;: 2, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true } ] }, { \u0026#34;partition\u0026#34;: 2, \u0026#34;leader\u0026#34;: 3, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 3, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true } ] } ] } This is a pretty fragile scenario because if any broker goes down, there is no replica.\nIncrease Replication Prepare a json file increase-replication.json for reassigning partitions of topic myorders:\n{\u0026#34;version\u0026#34;:1, \u0026#34;partitions\u0026#34;:[ {\u0026#34;topic\u0026#34;:\u0026#34;myorders\u0026#34;,\u0026#34;partition\u0026#34;:0,\u0026#34;replicas\u0026#34;:[1,2]}, {\u0026#34;topic\u0026#34;:\u0026#34;myorders\u0026#34;,\u0026#34;partition\u0026#34;:1,\u0026#34;replicas\u0026#34;:[1,2]}, {\u0026#34;topic\u0026#34;:\u0026#34;myorders\u0026#34;,\u0026#34;partition\u0026#34;:2,\u0026#34;replicas\u0026#34;:[2]} ] } Reassign partitions with the json file:\nkafka-reassign-partitions.sh --bootstrap-server localhost:9092 --reassignment-json-file increase_replication.json --execute Then, we can see the replication of partition 0 and 1 are increased, and a leader is elected for each replica.\n{ \u0026#34;name\u0026#34;: \u0026#34;myorders\u0026#34;, ... \u0026#34;partitions\u0026#34;: [ { \u0026#34;partition\u0026#34;: 0, \u0026#34;leader\u0026#34;: 1, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 1, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true }, { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: false, \u0026#34;in_sync\u0026#34;: true } ] }, { \u0026#34;partition\u0026#34;: 1, \u0026#34;leader\u0026#34;: 2, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 1, \u0026#34;leader\u0026#34;: false, \u0026#34;in_sync\u0026#34;: true }, { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true } ] }, { \u0026#34;partition\u0026#34;: 2, \u0026#34;leader\u0026#34;: 2, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true } ] } ] } Stop a Broker Stop the broker 2 to test the system resilience.\ndocker stop broker-2 We can see that for partitions 0 and 1, the broker 2 is not in_sync. For partition 2, the leader is -1, which means there is no leader and cannot take any new message.\n{ \u0026#34;name\u0026#34;: \u0026#34;myorders\u0026#34;, ... \u0026#34;partitions\u0026#34;: [ { \u0026#34;partition\u0026#34;: 0, \u0026#34;leader\u0026#34;: 1, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 1, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true }, { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: false, \u0026#34;in_sync\u0026#34;: false } ] }, { \u0026#34;partition\u0026#34;: 1, \u0026#34;leader\u0026#34;: 1, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 1, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true }, { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: false, \u0026#34;in_sync\u0026#34;: false } ] }, { \u0026#34;partition\u0026#34;: 2, \u0026#34;leader\u0026#34;: -1, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: false, \u0026#34;in_sync\u0026#34;: true } ] } ] } Try to send messages to the topic myorders by running Kafka Producer:\nâ¯ kafka-console-producer.sh --bootstrap-server localhost:9092 --topic myorders \u0026gt;Hello \u0026gt;again \u0026gt;from \u0026gt;Wxk And try to receive messages from topic myorders:\nkafka-console-consumer.sh --bootstrap-server localhost:9092 --topic myorders --from-beginning We will find there is no response returned. The topic will be offline if one partition doesn\u0026rsquo;t have any replica online.\nRestart the Broker If we restart the stopped broker, Kafka will self-heal:\ndocker compose up -d We can see that for partitions 0 and 1, broker 2 is in_sync again. And for partition 2, the leader 2 is elected again.\n{ \u0026#34;name\u0026#34;: \u0026#34;myorders\u0026#34;, ... \u0026#34;partitions\u0026#34;: [ { \u0026#34;partition\u0026#34;: 0, \u0026#34;leader\u0026#34;: 1, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 1, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true }, { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: false, \u0026#34;in_sync\u0026#34;: true } ] }, { \u0026#34;partition\u0026#34;: 1, \u0026#34;leader\u0026#34;: 1, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 1, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true }, { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: false, \u0026#34;in_sync\u0026#34;: true } ] }, { \u0026#34;partition\u0026#34;: 2, \u0026#34;leader\u0026#34;: 2, \u0026#34;replicas\u0026#34;: [ { \u0026#34;broker\u0026#34;: 2, \u0026#34;leader\u0026#34;: true, \u0026#34;in_sync\u0026#34;: true } ] } ] } Then we can receive messages successfully:\nâ¯ kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic myorders --from-beginning Hello again from Wxk ","permalink":"https://zjxjwxk.github.io/posts/mq/kafka/getting-started-with-apache-kafka/2-meet-kafka/","summary":"\u003ch2 id=\"kafka-architecture\"\u003eKafka Architecture\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241116015015788\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/2-meet-kafka/images/image-20241116015015788.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"kafka-message\"\u003eKafka Message\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241116015252987\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/2-meet-kafka/images/image-20241116015252987.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"deploy-kafka\"\u003eDeploy Kafka\u003c/h2\u003e\n\u003cp\u003eCreate a docker-compose file \u003ccode\u003edocker-compose.yaml\u003c/code\u003e containing three Zookeepers, three Kafka Brokers, and a Kafka REST Proxy:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eversion\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;3\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eservices\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ezookeeper-1\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-zookeeper:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-1_data:/var/lib/zookeeper/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-1_log:/var/lib/zookeeper/log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_CLIENT_PORT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_TICK_TIME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_MY_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_SERVERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eserver.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ezookeeper-2\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-zookeeper:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-2_data:/var/lib/zookeeper/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-2_log:/var/lib/zookeeper/log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_CLIENT_PORT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_TICK_TIME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_MY_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_SERVERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eserver.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ezookeeper-3\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-zookeeper:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-3_data:/var/lib/zookeeper/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./zookeeper-3_log:/var/lib/zookeeper/log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_CLIENT_PORT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOOKEEPER_TICK_TIME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_MY_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eZOO_SERVERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eserver.1=zookeeper-1:2888:3888;2181 server.2=zookeeper-2:2888:3888;2181 server.3=zookeeper-3:2888:3888;2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ebroker-1\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-kafka:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./broker-1-data:/var/lib/kafka/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e9092\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e9092\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e29092\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e29092\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_BROKER_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ZOOKEEPER_CONNECT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1:2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ADVERTISED_LISTENERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST://localhost:9092,INTERNAL://broker-1:29092\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_LISTENER_SECURITY_PROTOCOL_MAP\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST:PLAINTEXT,INTERNAL:PLAINTEXT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_INTER_BROKER_LISTENER_NAME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eINTERNAL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_SNAPSHOT_TRUST_EMPTY\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ebroker-2\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-kafka:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./broker-2-data:/var/lib/kafka/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e9093\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e9093\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e29093\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e29093\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_BROKER_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ZOOKEEPER_CONNECT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1:2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ADVERTISED_LISTENERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST://localhost:9093,INTERNAL://broker-2:29093\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_LISTENER_SECURITY_PROTOCOL_MAP\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST:PLAINTEXT,INTERNAL:PLAINTEXT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_INTER_BROKER_LISTENER_NAME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eINTERNAL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_SNAPSHOT_TRUST_EMPTY\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003ebroker-3\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-kafka:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ebroker-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003evolumes\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e./broker-3-data:/var/lib/kafka/data\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e9094\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e9094\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003e29094\u003c/span\u003e:\u003cspan style=\"color:#ae81ff\"\u003e29094\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_BROKER_ID\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ZOOKEEPER_CONNECT\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1:2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_ADVERTISED_LISTENERS\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST://localhost:9094,INTERNAL://broker-3:29094\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_LISTENER_SECURITY_PROTOCOL_MAP\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eHOST:PLAINTEXT,INTERNAL:PLAINTEXT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_INTER_BROKER_LISTENER_NAME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eINTERNAL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_SNAPSHOT_TRUST_EMPTY\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003erest-proxy\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eimage\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003econfluentinc/cp-kafka-rest:7.4.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eports\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;8082:8082\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003edepends_on\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ezookeeper-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      - \u003cspan style=\"color:#ae81ff\"\u003ebroker-3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ehostname\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003erest-proxy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003econtainer_name\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003erest-proxy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eenvironment\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_REST_HOST_NAME\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003erest-proxy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_REST_BOOTSTRAP_SERVERS\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;broker-1:29092,broker-2:29093,broker-3:29094\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003eKAFKA_REST_LISTENERS\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;http://0.0.0.0:8082\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRun composed containers:\u003c/p\u003e","title":"Meet Kafka"},{"content":"We Call The entity/app creates a message, a publisher, or a producer. The entity/app consuming messages from a channel as a consumer. The system where the channels live and handle these requests as an Event Bus or, more recently, a streaming platform. The channel where messages flow as channel or topic. Definitions We say the pub-sub system is reliable when you ensure there is no message loss. Has at most one processing when you ensure there is no message duplication. And has exactly one processing when you only process a message once ensuring it wasn\u0026rsquo;t lost. Of course, this is the holy grail. We Had a Ton of Other Pub/Sub Systems Before What is Kafka? Event Streaming Platform Scalable High Throughput Difference between Kafka and the Rest of Solutions RabbitMQ: As Kafka uses topics in a unidirectional log without a handshake, the difference in performance is brutal, easily 1000x. Mulesoft: Kafka makes it simple to create a channel of communication. Simply producing a message, the topic will be auto-created. Redis: Redis does not handle streaming data nor has a history past messages. Amazon SQS: It is based on queues, which is way better than RabbitMQ, but still, there is an order of magnitude in throughput and speed between Kafka and SQS. Plus, SQS is not exactly cheap. Amazon SNS: Very, very similar; but way pricer. Azure Streaming Services: This service in particular is not exactly meant for pub-sub in general. Google Pub/Sub: The same as Amazon SNS, very similar but pricer. ","permalink":"https://zjxjwxk.github.io/posts/mq/kafka/getting-started-with-apache-kafka/1-pub-sub-system/","summary":"\u003ch2 id=\"we-call\"\u003eWe Call\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eThe entity/app creates a message, a publisher, or a producer.\u003c/li\u003e\n\u003cli\u003eThe entity/app consuming messages from a channel as a consumer.\u003c/li\u003e\n\u003cli\u003eThe system where the channels live and handle these requests as an Event Bus or, more recently, a streaming platform.\u003c/li\u003e\n\u003cli\u003eThe channel where messages flow as channel or topic.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"definitions\"\u003eDefinitions\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eWe say the pub-sub system is reliable when you ensure there is no message loss.\u003c/li\u003e\n\u003cli\u003eHas at most one processing when you ensure there is no message duplication.\u003c/li\u003e\n\u003cli\u003eAnd has exactly one processing when you only process a message once ensuring it wasn\u0026rsquo;t lost. Of course, this is the holy grail.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"we-had-a-ton-of-other-pubsub-systems-before\"\u003eWe Had a Ton of Other Pub/Sub Systems Before\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"image-20241116003710435\" loading=\"lazy\" src=\"/posts/mq/kafka/getting-started-with-apache-kafka/1-pub-sub-system/images/image-20241116003710435.png\"\u003e\u003c/p\u003e","title":"Pub-sub System"},{"content":"å­¦ä¹ ç›®æ ‡ è®¤è¯† Shiro çš„æ•´ä½“æ¶æ„ï¼Œå„ç»„ä»¶çš„æ¦‚å¿µ Shiro è®¤è¯ï¼Œæˆæƒçš„è¿‡ç¨‹ Shiro è‡ªå®šä¹‰çš„ Realmï¼ŒFilter Shiro Session ç®¡ç† Shiro ç¼“å­˜ç®¡ç† Shiro é›†æˆ Spring Shiro ç®€ä»‹ Apache çš„å¼ºå¤§çµæ´»çš„å¼€æºå®‰å…¨æ¡†æ¶ è®¤è¯ã€æˆæƒã€ä¼ä¸šä¼šè¯ç®¡ç†ã€å®‰å…¨åŠ å¯† Shiro ä¸ Spring Security æ¯”è¾ƒ Shiro ç®€å•ã€çµæ´» å¯è„±ç¦» Spring ç²’åº¦è¾ƒç²— Spring Security å¤æ‚ã€ç¬¨é‡ ä¸å¯è„±ç¦» Spring ç²’åº¦æ›´ç»† Shiro æ•´ä½“æ¶æ„ Shiro è®¤è¯å’Œæˆæƒ è®¤è¯è¿‡ç¨‹ åˆ›å»º SecurityManager -\u0026gt; ä¸»ä½“æäº¤è®¤è¯ -\u0026gt; SecurityManager è®¤è¯ -\u0026gt; Authenticator è®¤è¯ -\u0026gt; Realm éªŒè¯ æˆæƒè¿‡ç¨‹ åˆ›å»º SecurityManager -\u0026gt; ä¸»ä½“æäº¤æˆæƒ -\u0026gt; SecurityManager æˆæƒ -\u0026gt; Authorizer æˆæƒ -\u0026gt; Realm è·å–è§’è‰²æƒé™æ•°æ® æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼ˆè¿™é‡Œå…ˆä½¿ç”¨ SimpleAccountRealm ä½œä¸º Realmï¼‰ï¼š\npublic class AuthenticationTest { private final SimpleAccountRealm simpleAccountRealm = new SimpleAccountRealm(); @Before public void addUser() { simpleAccountRealm.addAccount(\u0026#34;Wxk\u0026#34;, \u0026#34;123456\u0026#34;, \u0026#34;admin\u0026#34;, \u0026#34;user\u0026#34;); } @Test public void testAuthentication() { // 1. æ„å»ºSecurityManagerç¯å¢ƒ DefaultSecurityManager defaultSecurityManager = new DefaultSecurityManager(); // 2. ç»™SecurityManagerè®¾ç½®Realm defaultSecurityManager.setRealm(simpleAccountRealm); // 3. ç»™SecurityUtilsè®¾ç½®SecurityManager SecurityUtils.setSecurityManager(defaultSecurityManager); // 4. è·å–Subject Subject subject = SecurityUtils.getSubject(); // 5. Subjectæäº¤è®¤è¯è¯·æ±‚ UsernamePasswordToken token = new UsernamePasswordToken(\u0026#34;Wxk\u0026#34;, \u0026#34;123456\u0026#34;); subject.login(token); /* è®¤è¯ */ System.out.println(\u0026#34;isAuthenticated: \u0026#34; + subject.isAuthenticated()); /* æˆæƒ */ subject.checkRoles(\u0026#34;admin\u0026#34;, \u0026#34;user\u0026#34;); } } Realm å†…ç½® Realm IniRealm JdbcRealm è‡ªå®šä¹‰ Realm IniRealm åœ¨ resources ä¸‹åˆ›å»ºä¸€ä¸ª user.ini æ–‡ä»¶ï¼š [users] Wxk=123456,admin [roles] admin=user:delete ä½¿ç”¨ IniRealm ä½œä¸º Realm æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š\npublic class IniRealmTest { private final IniRealm iniRealm = new IniRealm(\u0026#34;classpath:user.ini\u0026#34;); @Test public void testAuthentication() { // 1. æ„å»ºSecurityManagerç¯å¢ƒ DefaultSecurityManager defaultSecurityManager = new DefaultSecurityManager(); // 2. ç»™SecurityManagerè®¾ç½®Realm defaultSecurityManager.setRealm(iniRealm); // 3. ç»™SecurityUtilsè®¾ç½®SecurityManager SecurityUtils.setSecurityManager(defaultSecurityManager); // 4. è·å–Subject Subject subject = SecurityUtils.getSubject(); // 5. Subjectæäº¤è®¤è¯è¯·æ±‚ UsernamePasswordToken token = new UsernamePasswordToken(\u0026#34;Wxk\u0026#34;, \u0026#34;123456\u0026#34;); subject.login(token); /* è®¤è¯ */ System.out.println(\u0026#34;isAuthenticated: \u0026#34; + subject.isAuthenticated()); /* æˆæƒ */ // æ£€æŸ¥è§’è‰²æˆæƒ subject.checkRole(\u0026#34;admin\u0026#34;); // æ£€æŸ¥æƒé™æˆæƒ subject.checkPermission(\u0026#34;user:delete\u0026#34;); } } JdbcRealm åˆ†åˆ«åˆ›å»ºæ•°æ®åº“è¡¨ï¼šç”¨æˆ·è¡¨ test_user, ç”¨æˆ·è§’è‰²è¡¨ test_user_roles, ç”¨æˆ·æƒé™è¡¨ test_users_permissionsã€‚ ç»™ JdbcRealm è®¾ç½®æ•°æ®æº æ‰“å¼€æƒé™æŸ¥è¯¢å¼€å…³ ç»™ JdbcRealm è‡ªå®šä¹‰è®¤è¯ã€è§’è‰²å’Œæƒé™SQLæŸ¥è¯¢è¯­å¥ ä½¿ç”¨ JdbcRealm ä½œä¸º Realm æ•°æ®åº“è¡¨å¦‚ä¸‹ï¼š\næµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š\npublic class JdbcRealmTest { private final DruidDataSource dataSource = new DruidDataSource(); private final JdbcRealm jdbcRealm = new JdbcRealm(); @Test public void testAuthentication() { // è®¾ç½®æ•°æ®æº dataSource.setUrl(\u0026#34;jdbc:mysql://localhost:3306/test\u0026#34;); dataSource.setUsername(\u0026#34;root\u0026#34;); dataSource.setPassword(\u0026#34;123456\u0026#34;); jdbcRealm.setDataSource(dataSource); // æ‰“å¼€æƒé™æŸ¥è¯¢å¼€å…³ jdbcRealm.setPermissionsLookupEnabled(true); // è‡ªå®šä¹‰è®¤è¯æŸ¥è¯¢SQL String AuthenticationSQL = \u0026#34;SELECT password FROM test_user WHERE username = ?\u0026#34;; jdbcRealm.setAuthenticationQuery(AuthenticationSQL); // è‡ªå®šä¹‰è§’è‰²æŸ¥è¯¢SQL String rolesSQL = \u0026#34;SELECT role_name FROM test_user_roles WHERE username = ?\u0026#34;; jdbcRealm.setUserRolesQuery(rolesSQL); // è‡ªå®šä¹‰æƒé™æŸ¥è¯¢SQL String permissionsSQL = \u0026#34;SELECT permission FROM test_roles_permissions WHERE role_name = ?\u0026#34;; jdbcRealm.setPermissionsQuery(permissionsSQL); // 1. æ„å»ºSecurityManagerç¯å¢ƒ DefaultSecurityManager defaultSecurityManager = new DefaultSecurityManager(); // 2. ç»™SecurityManagerè®¾ç½®Realm defaultSecurityManager.setRealm(jdbcRealm); // 3. ç»™SecurityUtilsè®¾ç½®SecurityManager SecurityUtils.setSecurityManager(defaultSecurityManager); // 4. è·å–Subject Subject subject = SecurityUtils.getSubject(); // 5. Subjectæäº¤è®¤è¯è¯·æ±‚ UsernamePasswordToken token = new UsernamePasswordToken(\u0026#34;Wxk\u0026#34;, \u0026#34;123456\u0026#34;); subject.login(token); /* è®¤è¯ */ System.out.println(\u0026#34;isAuthenticated: \u0026#34; + subject.isAuthenticated()); /* æˆæƒ */ // æ£€æŸ¥è§’è‰²æˆæƒ subject.checkRoles(\u0026#34;admin\u0026#34;, \u0026#34;user\u0026#34;); // æ£€æŸ¥æƒé™æˆæƒ subject.checkPermission(\u0026#34;user:delete\u0026#34;); } } è‡ªå®šä¹‰ Realm è‡ªå®šä¹‰ MyRealm ç±»ç»§æ‰¿è‡ª AuthorizingRealmï¼Œé‡å†™ doGetAuthenticationInfo å’Œ doGetAuthorizationInfo æ–¹æ³•æ¥è¿”å›è®¤è¯å’ŒæˆæƒéªŒè¯ä¿¡æ¯ï¼š public class MyRealm extends AuthorizingRealm { /** * æ¨¡æ‹Ÿæ•°æ®åº“æˆ–ç¼“å­˜ */ Map\u0026lt;String, String\u0026gt; userMap = new HashMap\u0026lt;String, String\u0026gt;(16){{ put(\u0026#34;Wxk\u0026#34;, \u0026#34;123456\u0026#34;); }}; { // è®¾ç½®Realmåç§° super.setName(\u0026#34;myRealm\u0026#34;); } @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) { // 1. è·å¾—ç”¨æˆ·å String username = (String) principals.getPrimaryPrincipal(); // 2. é€šè¿‡ç”¨æˆ·ååˆ°æ•°æ®åº“æˆ–ç¼“å­˜ä¸­è·å–è§’è‰²é›†åˆå’Œæƒé™é›†åˆ Set\u0026lt;String\u0026gt; roles = getRolesByUsername(username); Set\u0026lt;String\u0026gt; permissions = getPermissionsByUsername(username); // 3. ç»™AuthorizationInfoè®¾ç½®è§’è‰²é›†åˆå’Œæƒé™ç»“åˆ SimpleAuthorizationInfo simpleAuthorizationInfo = new SimpleAuthorizationInfo(); simpleAuthorizationInfo.setRoles(roles); simpleAuthorizationInfo.setStringPermissions(permissions); // 4. è¿”å›AuthorizationInfo return simpleAuthorizationInfo; } @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException { // 1. ä»Subjectä¼ æ¥çš„è®¤è¯ä¿¡æ¯ä¸­è·å¾—ç”¨æˆ·å String username = (String) token.getPrincipal(); // 2. é€šè¿‡ç”¨æˆ·ååˆ°æ•°æ®åº“ä¸­è·å–å‡­è¯ String password = getPasswordByUsername(username); if (password == null) { return null; } // 3. è¿”å›AuthenticationInfoï¼ˆå°†ä¼šå’Œtokenè¿›è¡ŒåŒ¹é…ï¼‰ return new SimpleAuthenticationInfo(username, password, getName()); } /** * æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢å¯†ç  * @param username ç”¨æˆ·å * @return å¯†ç  */ private String getPasswordByUsername(String username) { return userMap.get(username); } /** * æ¨¡æ‹Ÿæ•°æ®åº“æˆ–ç¼“å­˜æŸ¥è¯¢è§’è‰²é›†åˆ * @param username ç”¨æˆ·å * @return è§’è‰²é›†åˆ */ private Set\u0026lt;String\u0026gt; getRolesByUsername(String username) { Set\u0026lt;String\u0026gt; roles = new HashSet\u0026lt;String\u0026gt;(); roles.add(\u0026#34;admin\u0026#34;); roles.add(\u0026#34;user\u0026#34;); return roles; } /** * æ¨¡æ‹Ÿæ•°æ®åº“æˆ–ç¼“å­˜æŸ¥è¯¢æƒé™é›†åˆ * @param username ç”¨æˆ·å * @return æƒé™é›†åˆ */ private Set\u0026lt;String\u0026gt; getPermissionsByUsername(String username) { Set\u0026lt;String\u0026gt; permissions = new HashSet\u0026lt;String\u0026gt;(); permissions.add(\u0026#34;user:delete\u0026#34;); return permissions; } } æµ‹è¯•ä»£ç ï¼š public class MyRealmTest { private final MyRealm myRealm = new MyRealm(); @Test public void testAuthentication() { // 1. æ„å»ºSecurityManagerç¯å¢ƒ DefaultSecurityManager defaultSecurityManager = new DefaultSecurityManager(); // 2. ç»™SecurityManagerè®¾ç½®Realm defaultSecurityManager.setRealm(myRealm); // 3. ç»™SecurityUtilsè®¾ç½®SecurityManager SecurityUtils.setSecurityManager(defaultSecurityManager); // 4. è·å–Subject Subject subject = SecurityUtils.getSubject(); // 5. Subjectæäº¤è®¤è¯è¯·æ±‚ UsernamePasswordToken token = new UsernamePasswordToken(\u0026#34;Wxk\u0026#34;, \u0026#34;123456\u0026#34;); subject.login(token); /* è®¤è¯ */ System.out.println(\u0026#34;isAuthenticated: \u0026#34; + subject.isAuthenticated()); /* æˆæƒ */ // æ£€æŸ¥è§’è‰²æˆæƒ subject.checkRoles(\u0026#34;admin\u0026#34;, \u0026#34;user\u0026#34;); // æ£€æŸ¥æƒé™æˆæƒ subject.checkPermission(\u0026#34;user:delete\u0026#34;); } } Shiro åŠ å¯† Shiro æ•£åˆ—é…ç½® HashedCredentialsMatcher è‡ªå®šä¹‰ Realm ä¸­ä½¿ç”¨æ•£åˆ— ç›çš„ä½¿ç”¨ æ•°æ®åº“ä¸­çš„å¯†ç åŠ ç›å md5 å“ˆå¸ŒåŠ å¯†ã€‚ åœ¨ Realm è¿”å› AuthenticationInfo å‰ç»™å…¶è®¾ç½®ç›å€¼ï¼š SimpleAuthenticationInfo simpleAuthenticationInfo = new SimpleAuthenticationInfo(username, password, getName()); // è®¾ç½®ç›å€¼ simpleAuthenticationInfo.setCredentialsSalt(ByteSource.Util.bytes(\u0026#34;salt\u0026#34;)); return simpleAuthenticationInfo; è¿›è¡Œè®¤è¯æ—¶ï¼Œç»™ Realm è®¾ç½® HashedCredentialsMatcherã€‚ // ç»™Realmè®¾ç½®HashedCredentialsMatcher HashedCredentialsMatcher matcher = new HashedCredentialsMatcher(); // å“ˆå¸Œç®—æ³• matcher.setHashAlgorithmName(\u0026#34;md5\u0026#34;); // å“ˆå¸Œæ¬¡æ•° matcher.setHashIterations(1); myRealm.setCredentialsMatcher(matcher); å®Œæ•´ MyRealm ä»£ç ï¼š\npublic class MyRealm extends AuthorizingRealm { /** * æ¨¡æ‹Ÿæ•°æ®åº“æˆ–ç¼“å­˜ */ Map\u0026lt;String, String\u0026gt; userMap = new HashMap\u0026lt;String, String\u0026gt;(16){{ put(\u0026#34;Wxk\u0026#34;, \u0026#34;f51703256a38e6bab3d9410a070c32ea\u0026#34;); }}; { // è®¾ç½®Realmåç§° super.setName(\u0026#34;myRealm\u0026#34;); } @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principals) { // 1. è·å¾—ç”¨æˆ·å String username = (String) principals.getPrimaryPrincipal(); // 2. é€šè¿‡ç”¨æˆ·ååˆ°æ•°æ®åº“æˆ–ç¼“å­˜ä¸­è·å–è§’è‰²é›†åˆå’Œæƒé™é›†åˆ Set\u0026lt;String\u0026gt; roles = getRolesByUsername(username); Set\u0026lt;String\u0026gt; permissions = getPermissionsByUsername(username); // 3. ç»™AuthorizationInfoè®¾ç½®è§’è‰²é›†åˆå’Œæƒé™ç»“åˆ SimpleAuthorizationInfo simpleAuthorizationInfo = new SimpleAuthorizationInfo(); simpleAuthorizationInfo.setRoles(roles); simpleAuthorizationInfo.setStringPermissions(permissions); // 4. è¿”å›AuthorizationInfo return simpleAuthorizationInfo; } @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException { // 1. ä»Subjectä¼ æ¥çš„è®¤è¯ä¿¡æ¯ä¸­è·å¾—ç”¨æˆ·å String username = (String) token.getPrincipal(); // 2. é€šè¿‡ç”¨æˆ·ååˆ°æ•°æ®åº“ä¸­è·å–å‡­è¯ String password = getPasswordByUsername(username); if (password == null) { return null; } // 3. è¿”å›AuthenticationInfoï¼ˆå°†ä¼šå’Œtokenè¿›è¡ŒåŒ¹é…ï¼‰ SimpleAuthenticationInfo simpleAuthenticationInfo = new SimpleAuthenticationInfo(username, password, getName()); // è®¾ç½®ç›å€¼ simpleAuthenticationInfo.setCredentialsSalt(ByteSource.Util.bytes(\u0026#34;salt\u0026#34;)); return simpleAuthenticationInfo; } /** * æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢å¯†ç  * @param username ç”¨æˆ·å * @return å¯†ç  */ private String getPasswordByUsername(String username) { return userMap.get(username); } /** * æ¨¡æ‹Ÿæ•°æ®åº“æˆ–ç¼“å­˜æŸ¥è¯¢è§’è‰²é›†åˆ * @param username ç”¨æˆ·å * @return è§’è‰²é›†åˆ */ private Set\u0026lt;String\u0026gt; getRolesByUsername(String username) { Set\u0026lt;String\u0026gt; roles = new HashSet\u0026lt;String\u0026gt;(); roles.add(\u0026#34;admin\u0026#34;); roles.add(\u0026#34;user\u0026#34;); return roles; } /** * æ¨¡æ‹Ÿæ•°æ®åº“æˆ–ç¼“å­˜æŸ¥è¯¢æƒé™é›†åˆ * @param username ç”¨æˆ·å * @return æƒé™é›†åˆ */ private Set\u0026lt;String\u0026gt; getPermissionsByUsername(String username) { Set\u0026lt;String\u0026gt; permissions = new HashSet\u0026lt;String\u0026gt;(); permissions.add(\u0026#34;user:delete\u0026#34;); return permissions; } public static void main(String[] args) { Md5Hash md5Hash = new Md5Hash(\u0026#34;123456\u0026#34;, \u0026#34;salt\u0026#34;); System.out.println(md5Hash); } } å®Œæ•´æµ‹è¯•ä»£ç ï¼š\npublic class MyRealmTest { private final MyRealm myRealm = new MyRealm(); @Test public void testAuthentication() { // 1. æ„å»ºSecurityManagerç¯å¢ƒ DefaultSecurityManager defaultSecurityManager = new DefaultSecurityManager(); // 2. ç»™SecurityManagerè®¾ç½®Realm defaultSecurityManager.setRealm(myRealm); // ç»™Realmè®¾ç½®HashedCredentialsMatcher HashedCredentialsMatcher matcher = new HashedCredentialsMatcher(); // å“ˆå¸Œç®—æ³• matcher.setHashAlgorithmName(\u0026#34;md5\u0026#34;); // å“ˆå¸Œæ¬¡æ•° matcher.setHashIterations(1); myRealm.setCredentialsMatcher(matcher); // 3. ç»™SecurityUtilsè®¾ç½®SecurityManager SecurityUtils.setSecurityManager(defaultSecurityManager); // 4. è·å–Subject Subject subject = SecurityUtils.getSubject(); // 5. Subjectæäº¤è®¤è¯è¯·æ±‚ UsernamePasswordToken token = new UsernamePasswordToken(\u0026#34;Wxk\u0026#34;, \u0026#34;123456\u0026#34;); subject.login(token); /* è®¤è¯ */ System.out.println(\u0026#34;isAuthenticated: \u0026#34; + subject.isAuthenticated()); /* æˆæƒ */ // æ£€æŸ¥è§’è‰²æˆæƒ subject.checkRoles(\u0026#34;admin\u0026#34;, \u0026#34;user\u0026#34;); // æ£€æŸ¥æƒé™æˆæƒ subject.checkPermission(\u0026#34;user:delete\u0026#34;); } } Shiro è¿‡æ»¤å™¨ anon, authBasic, authc, user, logout perms, roles, ssl, port è‡ªå®šä¹‰ Filter å¦‚åˆ›å»º RolesOrFilter ç»§æ‰¿è‡ª AuthorizationFilterï¼Œè¿‡æ»¤æ¡ä»¶ä¸ºæ»¡è¶³ roles é›†åˆå…¶ä¸­ä»»ä½•ä¸€ä¸ªå³å¯ï¼šï¼š\npublic class RolesOrFilter extends AuthorizationFilter { @Override protected boolean isAccessAllowed(javax.servlet.ServletRequest servletRequest, javax.servlet.ServletResponse servletResponse, Object o) throws Exception { Subject subject = getSubject(servletRequest, servletResponse); String[] roles = (String[]) o; if (roles == null || roles.length == 0) { return true; } for (String role : roles) { if (subject.hasRole(role)) { return true; } } return false; } } Shiro ä¼šè¯ç®¡ç† SessionManagerã€SessionDAO Redis å®ç° Session å…±äº« 1. SessionDAO å®ç°è‡ªå®šä¹‰çš„ SessionDao ç»§æ‰¿è‡ª AbstractSessionDAOï¼š\npublic class RedisSessionDao extends AbstractSessionDAO { @Resource private JedisUtil jedisUtil; private final static String SHIRO_SESSION_PREFIX = \u0026#34;session:\u0026#34;; private byte[] getKey(String key) { return (SHIRO_SESSION_PREFIX + key).getBytes(); } private void saveSession(Session session) { if (session != null \u0026amp;\u0026amp; session.getId() != null) { byte[] key = getKey(session.getId().toString()); byte[] value = SerializationUtils.serialize(session); jedisUtil.set(key, value); jedisUtil.expire(key, 600); } } @Override protected Serializable doCreate(Session session) { Serializable sessionId = generateSessionId(session); assignSessionId(session, sessionId); saveSession(session); return sessionId; } @Override protected Session doReadSession(Serializable sessionId) { if (sessionId == null) { return null; } byte[] key = getKey(sessionId.toString()); byte[] value = jedisUtil.get(key); return (Session) SerializationUtils.deserialize(value); } @Override public void update(Session session) throws UnknownSessionException { saveSession(session); } @Override public void delete(Session session) { if (session == null || session.getId() == null) { return; } byte[] key = getKey(session.getId().toString()); jedisUtil.del(key); } @Override public Collection\u0026lt;Session\u0026gt; getActiveSessions() { Set\u0026lt;byte[]\u0026gt; keys = jedisUtil.keys(SHIRO_SESSION_PREFIX); Set\u0026lt;Session\u0026gt; sessions = new HashSet\u0026lt;\u0026gt;(); if (CollectionUtils.isEmpty(keys)) { return sessions; } for (byte[] key : keys) { Session session = (Session) SerializationUtils.deserialize(jedisUtil.get(key)); sessions.add(session); } return sessions; } } 2. SessionManager å®ç°è‡ªå®šä¹‰çš„ SessionManager ç»§æ‰¿è‡ª DefaultSessionManagerï¼š\npublic class MySessionManager extends DefaultWebSessionManager { @Override protected Session retrieveSession(SessionKey sessionKey) throws UnknownSessionException { Serializable sessionId = getSessionId(sessionKey); if (sessionId == null) { return null; } ServletRequest request = null; if (sessionKey instanceof WebSessionKey) { request = ((WebSessionKey) sessionKey).getServletRequest(); } Session session = null; if (request != null) { // å…ˆå°è¯•ä»requestä¸­è·å–ï¼Œä»¥å‡å°‘ä»redisä¸­è·å–çš„æ¬¡æ•° session = (Session) request.getAttribute(sessionId.toString()); // è‹¥ä»requestè·å–ä¸åˆ°ï¼Œå†æŒ‰ç…§è‡ªå·±é‡å†™çš„readSession()æ–¹æ³•çš„æ–¹å¼è·å–ï¼Œå¹¶å­˜å…¥request if (session == null) { session = super.retrieveSession(sessionKey); request.setAttribute(sessionId.toString(), session); } } if (session == null) { String msg = \u0026#34;Could not find session with ID [\u0026#34; + sessionId + \u0026#34;]\u0026#34;; throw new UnknownSessionException(msg); } return session; } } ç»™ securityManager è®¾ç½® sessionManagerã€‚ Shiro ç¼“å­˜ç®¡ç† CacheManagerã€Cache Redis å®ç° CacheManager 1. RedisCache è‡ªå®šä¹‰ RedisCache ç»§æ‰¿è‡ª Cacheï¼š\npublic class RedisCache\u0026lt;K, V\u0026gt; implements Cache\u0026lt;K, V\u0026gt; { @Resource private JedisUtil jedisUtil; private final static String CACHE_PREFIX = \u0026#34;cache:\u0026#34;; private byte[] getKey(K k) { if (k instanceof String) { return (CACHE_PREFIX + k).getBytes(); } return SerializationUtils.serialize(k); } @Override public V get(K k) throws CacheException { byte[] value = jedisUtil.get(getKey(k)); if (value != null) { return (V) SerializationUtils.deserialize(value); } return null; } @Override public V put(K k, V v) throws CacheException { byte[] key = getKey(k); byte[] value = SerializationUtils.serialize(v); jedisUtil.set(key, value); jedisUtil.expire(key, 600); return v; } @Override public V remove(K k) throws CacheException { byte[] key = getKey(k); byte[] value = jedisUtil.get(key); jedisUtil.del(key); if (value != null) { return (V) SerializationUtils.deserialize(value); } return null; } @Override public void clear() throws CacheException { } @Override public int size() { return 0; } @Override public Set\u0026lt;K\u0026gt; keys() { return null; } @Override public Collection\u0026lt;V\u0026gt; values() { return null; } } 2. RedisCacheManager è‡ªå®šä¹‰ RedisCacheManager ç»§æ‰¿è‡ª CacheManagerï¼š\npublic class RedisCacheManager implements CacheManager { @Resource private RedisCache redisCache; @Override public \u0026lt;K, V\u0026gt; Cache\u0026lt;K, V\u0026gt; getCache(String s) throws CacheException { return redisCache; } } ç»™ securityManager è®¾ç½® cacheManagerã€‚ Shiro RememberMe é…ç½® Beanï¼šCookieRememberMeManager å’Œ SimpleCookieã€‚ è®¾ç½® CookieRememberMeManager çš„ cookie ä¸º SimpleCookieã€‚ ç»™ securityManager è®¾ç½® rememberMeManagerã€‚ æäº¤è®¤è¯å‰ï¼Œè®¾ç½® rememberMeã€‚ token.setRememberMe(true); subject.login(token); ","permalink":"https://zjxjwxk.github.io/posts/shiro/","summary":"\u003ch1 id=\"å­¦ä¹ ç›®æ ‡\"\u003eå­¦ä¹ ç›®æ ‡\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eè®¤è¯† Shiro çš„æ•´ä½“æ¶æ„ï¼Œå„ç»„ä»¶çš„æ¦‚å¿µ\u003c/li\u003e\n\u003cli\u003eShiro è®¤è¯ï¼Œæˆæƒçš„è¿‡ç¨‹\u003c/li\u003e\n\u003cli\u003eShiro è‡ªå®šä¹‰çš„ Realmï¼ŒFilter\u003c/li\u003e\n\u003cli\u003eShiro Session ç®¡ç†\u003c/li\u003e\n\u003cli\u003eShiro ç¼“å­˜ç®¡ç†\u003c/li\u003e\n\u003cli\u003eShiro é›†æˆ Spring\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"shiro-ç®€ä»‹\"\u003eShiro ç®€ä»‹\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eApache çš„å¼ºå¤§çµæ´»çš„å¼€æºå®‰å…¨æ¡†æ¶\u003c/li\u003e\n\u003cli\u003eè®¤è¯ã€æˆæƒã€ä¼ä¸šä¼šè¯ç®¡ç†ã€å®‰å…¨åŠ å¯†\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"shiro-ä¸-spring-security-æ¯”è¾ƒ\"\u003eShiro ä¸ Spring Security æ¯”è¾ƒ\u003c/h1\u003e\n\u003ch2 id=\"shiro\"\u003eShiro\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eç®€å•ã€çµæ´»\u003c/li\u003e\n\u003cli\u003eå¯è„±ç¦» Spring\u003c/li\u003e\n\u003cli\u003eç²’åº¦è¾ƒç²—\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"spring-security\"\u003eSpring Security\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eå¤æ‚ã€ç¬¨é‡\u003c/li\u003e\n\u003cli\u003eä¸å¯è„±ç¦» Spring\u003c/li\u003e\n\u003cli\u003eç²’åº¦æ›´ç»†\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"shiro-æ•´ä½“æ¶æ„\"\u003eShiro æ•´ä½“æ¶æ„\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"Shiro æ•´ä½“æ¶æ„\" loading=\"lazy\" src=\"/posts/shiro/images/ShiroArchitecture-20210319212652355.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"shiro-è®¤è¯å’Œæˆæƒ\"\u003eShiro è®¤è¯å’Œæˆæƒ\u003c/h1\u003e\n\u003ch2 id=\"è®¤è¯è¿‡ç¨‹\"\u003eè®¤è¯è¿‡ç¨‹\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eåˆ›å»º SecurityManager -\u0026gt; ä¸»ä½“æäº¤è®¤è¯ -\u0026gt; SecurityManager è®¤è¯ -\u0026gt; Authenticator è®¤è¯ -\u0026gt; Realm éªŒè¯\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"æˆæƒè¿‡ç¨‹\"\u003eæˆæƒè¿‡ç¨‹\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eåˆ›å»º SecurityManager -\u0026gt; ä¸»ä½“æäº¤æˆæƒ -\u0026gt; SecurityManager æˆæƒ -\u0026gt; Authorizer æˆæƒ -\u0026gt; Realm è·å–è§’è‰²æƒé™æ•°æ®\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼ˆè¿™é‡Œå…ˆä½¿ç”¨ SimpleAccountRealm ä½œä¸º Realmï¼‰ï¼š\u003c/p\u003e","title":"Shiroå…¥é—¨"},{"content":"1. ä»¥å¤ªåŠå¼€å‘ç¯å¢ƒæ­å»º 1.1 é…ç½®ä»¥å¤ªåŠç¯å¢ƒ 1.1.1 å®‰è£… Go ç¯å¢ƒ å¯åœ¨ Go å®˜ç½‘ https://golang.org/dl/ ç›´æ¥ä¸‹è½½ç›¸åº”æ“ä½œç³»ç»Ÿçš„å®‰è£…åŒ…ï¼Œæœ¬äººä½¿ç”¨ MacOS ç³»ç»Ÿï¼Œæ•…ç‚¹å‡»å¦‚ä¸‹æŒ‰é’®ä¸‹è½½ï¼š\næ ¹æ®å…¶æç¤ºä¿¡æ¯è¿›è¡Œå®‰è£…ï¼Œæ— éœ€é…ç½®ç¯å¢ƒå˜é‡ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ go version ï¼Œè‹¥å‡ºç°å¦‚ä¸‹ç‰ˆæœ¬ä¿¡æ¯åˆ™ Go ç¯å¢ƒå®‰è£…æˆåŠŸã€‚\n1.1.2 å®‰è£… Node.jsã€NPM ç”±äº Node.js çš„å®‰è£…åŒ…å·²ç»åŒ…å«äº† NPMï¼Œæ•…åªéœ€ä¸‹è½½æœ€æ–°ç¨³å®šç‰ˆæœ¬çš„ Node.js å®‰è£…åŒ…å³å¯ã€‚\nåŒæ ·æ ¹æ®æç¤ºå®‰è£…ï¼Œæ— éœ€é…ç½®ç¯å¢ƒå˜é‡ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ node -v å’Œ npm -v ï¼Œè‹¥åˆ†åˆ«å‡ºç°å¦‚ä¸‹ Node.js å’Œ NPM çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™å®‰è£…æˆåŠŸã€‚\n1.1.3 å®‰è£…ä»¥å¤ªåŠ Ethereum ç”±äºæœ¬äººä½¿ç”¨ MacOS ç³»ç»Ÿï¼Œæ•…ä½¿ç”¨ brew å®‰è£…ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ brew install ethereum å³å¯å®‰è£…ã€‚å®‰è£…å®Œæˆåï¼Œè‹¥è¾“å…¥ geth version å‡ºç°å¦‚ä¸‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™ Ethereum å®‰è£…æˆåŠŸã€‚\n1.1.4 å®‰è£… solc ç¼–è¯‘å™¨ solc æ˜¯æ™ºèƒ½åˆçº¦ Solidity çš„ç¼–è¯‘å™¨ï¼Œå¯ä»¥ä½¿ç”¨ npm å®‰è£…ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ sudo npm install solc è¿›è¡Œå®‰è£…ã€‚\nå®‰è£…å®Œæˆåï¼Œè‹¥è¾“å…¥ solcjs --version å‡ºç°å¦‚ä¸‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™ solc ç¼–è¯‘å™¨å®‰è£…æˆåŠŸã€‚\n1.2 æ­å»ºä»¥å¤ªåŠç§æœ‰é“¾ 1.2.1 åˆ›å»ºè´¦æˆ·ï¼ˆå…¬é’¥ï¼‰ åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä»¥å¤ªåŠè´¦æˆ·ï¼Œåœ¨åˆ›å»ºæ—¶éœ€è¦è¾“å…¥è¯¥è´¦æˆ·çš„å¯†ç ï¼š\næ‰€æœ‰çš„è´¦æˆ·çš„å…¬é’¥éƒ½å¯ä»¥åœ¨ Ethereum å®‰è£…ç›®å½•çš„ keystore ä¸‹æŸ¥çœ‹ï¼Œæœ¬äººçš„åœ°å€ä¸º /Users/zjxjwxk/Library/Ethereum/keystoreã€‚\n1.2.2 ç¼–å†™åˆ›ä¸–å—æ–‡ä»¶ åœ¨æ ¹ç›®å½•ä¸‹ ~/ ä¸‹åˆ›å»º genesis.json æ–‡ä»¶ï¼Œå¦‚ä¸‹é…ç½®ï¼š\n{ \u0026#34;config\u0026#34;: { \u0026#34;chainId\u0026#34;: 11, \u0026#34;homesteadBlock\u0026#34; : 0, \u0026#34;eip150Block\u0026#34;: 0, \u0026#34;eip155Block\u0026#34;: 0, \u0026#34;eip158Block\u0026#34;: 0 }, \u0026#34;alloc\u0026#34;: { \u0026#34;e68c39884e87fa216b8a9dafbc7f4a5398b648e2\u0026#34;: { \u0026#34;balance\u0026#34;: \u0026#34;20000000000000000000000000000\u0026#34; }, \u0026#34;ffcb1e2a08abca5b5d8a68077441125b8ffe97cd\u0026#34;: { \u0026#34;balance\u0026#34;: \u0026#34;20000000000000000000000000000\u0026#34; }, \u0026#34;24d2a6dd2c503c5dcc1cac7b30028ab3bc44756c\u0026#34;: { \u0026#34;balance\u0026#34;: \u0026#34;20000000000000000000000000000\u0026#34; } }, \u0026#34;coinbase\u0026#34;: \u0026#34;0x0000000000000000000000000000000000000000\u0026#34;, \u0026#34;difficulty\u0026#34;: \u0026#34;0x20000\u0026#34;, \u0026#34;extraData\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;gasLimit\u0026#34;: \u0026#34;0x2fefd8\u0026#34;, \u0026#34;nonce\u0026#34;: \u0026#34;0x0000000000000042\u0026#34;, \u0026#34;mixhash\u0026#34;: \u0026#34;0x0000000000000000000000000000000000000000000000000000000000000000\u0026#34;, \u0026#34;parentHash\u0026#34;: \u0026#34;0x0000000000000000000000000000000000000000000000000000000000000000\u0026#34;, \u0026#34;timestamp\u0026#34;: \u0026#34;0x00\u0026#34; } 1.2.3 åˆå§‹åŒ–åˆ›ä¸–å— Ethereum é»˜è®¤å®‰è£…åœ¨ ï½/Library/Ethereum ç›®å½•ä¸‹ï¼Œæœ¬äººå°†ç§é“¾åˆå§‹åŒ–åœ¨ ï½/Library/Ethereum/privatechain ä¸­ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥åˆå§‹åŒ–åˆšåˆšåˆ›å»ºçš„åˆ›ä¸–å—æ–‡ä»¶ï¼š\ngeth --datadir \u0026#34;~/Library/Ethereum/privatechain\u0026#34; init ~/genesis.json 1.2.4 é…ç½®è‡ªåŠ¨è§£é”è´¦æˆ·çš„è„šæœ¬ è¿›å…¥ç§é“¾å®‰è£…ç›®å½•ï¼Œåˆ›å»º password æ–‡ä»¶ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶ä¸­è¾“å…¥åœ¨ genesis.json ä¸­æ¯ä¸ªè´¦æˆ·å¯¹åº”çš„å¯†ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n123456 123456 123456 1.2.5 ç¼–å†™ä»¥å¤ªåŠå¯åŠ¨è„šæœ¬ åˆ›å»ºå¯åŠ¨è„šæœ¬æ–‡ä»¶ private_blockchain.sh æ–‡ä»¶ï¼Œå¹¶åœ¨æ–‡ä»¶ä¸­ç¼–å†™å¦‚ä¸‹å†…å®¹ï¼š\ngeth --rpc --rpcaddr=\u0026#34;0.0.0.0\u0026#34; --rpccorsdomain=\u0026#34;*\u0026#34; --unlock \u0026#39;0,1,2\u0026#39; --password ~/Library/Ethereum/privatechain/password --nodiscover --maxpeers \u0026#39;5\u0026#39; --networkid \u0026#39;0\u0026#39; --datadir \u0026#39;~/Library/Ethereum/privatechain\u0026#39; console ä»¥åæ¯æ¬¡å¯åŠ¨ geth ç»“ç‚¹æ—¶ï¼Œåªéœ€è¦åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š\nsh private_blockchain.sh 1.2.6 å¯åŠ¨ä»¥å¤ªåŠ æˆåŠŸå¯åŠ¨ä»¥å¤ªåŠç§æœ‰é“¾çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š\n1.2.7 å¯åŠ¨æŒ–çŸ¿ æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼€å§‹æŒ–çŸ¿ï¼š\nminer.start() æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æç¤ºæŒ–çŸ¿ï¼š\nminer.stop() æŒ–çŸ¿æ—¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n2. æ™ºèƒ½åˆçº¦ 2.1 ç¼–å†™åˆçº¦ ç¼–å†™ä¸€ä¸ªéå¸¸ç®€å•çš„åˆçº¦ Multiply7 ä¸ºä¾‹ï¼Œè¯¥åˆçº¦æœ‰ä¸€ä¸ª multiply() æ–¹æ³•ï¼Œä¼ å…¥ä¸€ä¸ª uint ç±»å‹æ•°æ®ï¼Œä¹˜ 7 åè¿”å›ç»“æœã€‚\ncontract Multiply7 { event Print(uint); function multiply(uint input) returns (uint) { Print(input * 7); return input * 7; } } 2.2 ç¼–è¯‘åˆçº¦ ç¼–è¯‘åˆçº¦æ˜¯ä¸ºäº†è·å–åˆçº¦çš„å­—èŠ‚ç ï¼Œç”¨äºåé¢åˆçº¦çš„éƒ¨ç½²ï¼Œç”±äº go-ethereum åœ¨å…¶ 1.6 ç‰ˆæœ¬ä¸­æ”¾å¼ƒä½¿ç”¨ eth_compileSolidity æ–¹æ³•ï¼Œå½“ä¼å›¾ç”¨ curl æ–¹å¼è°ƒç”¨æ—¶ä¼šè¿”å› The method eth_compileSolidity does not exist/is not available çš„æç¤ºï¼Œå› æ­¤ä½¿ç”¨ Remix è¿›è¡Œåœ¨çº¿ç¼–è¯‘åˆçº¦ï¼Œå¾—åˆ°æœ€é‡è¦çš„æ•°æ®å­—èŠ‚ç å’Œ abiDefinition æ•°æ®ã€‚\nç‚¹å‡»ä¸‹æ–¹ \u0026ldquo;ABI\u0026rdquo; å’Œ \u0026ldquo;Bytecode\u0026rdquo; å¯å¤åˆ¶ ABI å’Œ Bytecodeï¼Œç‚¹å‡» Compilation Details å¯è·å–ç¼–è¯‘ç›¸å…³æ•°æ®ï¼š\n2.3 è·å¾—è°ƒç”¨è´¦æˆ· å½“å‰ä»¥å¤ªåŠç§é“¾ä¸­å¯èƒ½æœ‰å¤šä¸ªåˆ›å»ºè´¦æˆ·ï¼Œéœ€è¦é€‰å®šä¸€ä¸ªè´¦æˆ·ä½œä¸ºè°ƒç”¨éƒ¨ç½²åˆçº¦ã€è°ƒç”¨åˆçº¦æ–¹æ³•çš„å‘èµ·è€…ã€‚å¹¶ä¸”è¯¥è´¦æˆ·ä¸­è¦åŒ…å«è¶³å¤Ÿçš„ä»¥å¤ªå¸ã€‚è¿™é‡Œä½¿ç”¨æŒ–çŸ¿åŸºåœ°å€ä½œä¸ºäº¤æ˜“çš„å‘èµ·è€…ï¼Œè¯¥åœ°å€ä¹Ÿå°±æ˜¯é»˜è®¤å½“å‰è´¦æˆ·ä¸­çš„ç¬¬ä¸€ä¸ªè´¦æˆ·ã€‚åœ¨ä¸€ä¸ªç»ˆç«¯ A å¯åŠ¨ä»¥å¤ªåŠï¼Œå¹¶åœ¨å¦ä¸€ä¸ªç»ˆç«¯ B ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:\ncurl --data \u0026#39;{\u0026#34;jsonrpc\u0026#34;: \u0026#34;2.0\u0026#34;, \u0026#34;method\u0026#34;: \u0026#34;eth_coinbase\u0026#34;, \u0026#34;id\u0026#34;: 1}\u0026#39; -H \u0026#34;Content-Type: application/json\u0026#34; -X POST localhost:8545 è¿”å›ç»“æœï¼š\nè¿”å›ç»“æœä¸­çš„ 0xe68c39884e87fa216b8a9dafbc7f4a5398b648e2 å°±æ˜¯è¦ä½¿ç”¨çš„å‘èµ·äº¤æ˜“çš„è´¦æˆ·ã€‚\n2.4 éƒ¨ç½²åˆçº¦ æ‰§è¡Œä»¥ä¸‹ä»£ç åˆ›å»ºåˆçº¦ï¼Œå‚æ•°ä¸ºæ‰€è·å¾—çš„ ABIï¼š\nvar multiply7Contract = web3.eth.contract([ { \u0026#34;constant\u0026#34;: false, \u0026#34;inputs\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;input\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;uint256\u0026#34; } ], \u0026#34;name\u0026#34;: \u0026#34;multiply\u0026#34;, \u0026#34;outputs\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;uint256\u0026#34; } ], \u0026#34;payable\u0026#34;: false, \u0026#34;stateMutability\u0026#34;: \u0026#34;nonpayable\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;function\u0026#34; }, { \u0026#34;anonymous\u0026#34;: false, \u0026#34;inputs\u0026#34;: [ { \u0026#34;indexed\u0026#34;: false, \u0026#34;name\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;uint256\u0026#34; } ], \u0026#34;name\u0026#34;: \u0026#34;Print\u0026#34;, \u0026#34;type\u0026#34;: \u0026#34;event\u0026#34; } ]); ç„¶åæ‰§è¡Œä»¥ä¸‹ä»£ç æäº¤åˆçº¦éƒ¨ç½²ï¼š\nvar multiply7 = multiply7Contract.new({ from: web3.eth.accounts[0], data: \u0026#39;0x608060405234801561001057600080fd5b5060fc8061001f6000396000f3fe6080604052600436106039576000357c010000000000000000000000000000000000000000000000000000000090048063c6888fa114603e575b600080fd5b348015604957600080fd5b50607360048036036020811015605e57600080fd5b81019080803590602001909291905050506089565b6040518082815260200191505060405180910390f35b60007f24abdb5865df5079dcc5ac590ff6f01d5c16edbc5fab4e195d9febd1114503da600783026040518082815260200191505060405180910390a160078202905091905056fea165627a7a7230582038bd52c038b56d86557d4dada43f00d8f45736557fb735e6a4519026d96be4800029\u0026#39;, gas: \u0026#39;3100000\u0026#39;, }, function (e, contract) { console.log(e, contract); if (typeof contract.address != \u0026#39;undefined\u0026#39;) { console.log(\u0026#39;Contract mined! address\u0026#39; + contract.address + \u0026#39; transactionHash: \u0026#39; + contract.transactionHash); } } ) è¾“å…¥åˆçº¦åç§°ï¼Œå¯ä»¥æŸ¥çœ‹åˆçº¦ä¿¡æ¯ã€‚å¯ä»¥å‘ç°åˆçº¦ address ä¸º undefinedï¼Œè¿™æ—¶åˆçº¦è¿˜æ²¡æœ‰éƒ¨ç½²ï¼Œéœ€è¦çŸ¿å·¥æŒ–çŸ¿å…±è¯†ï¼š\nçŸ¿å·¥å¼€å§‹æŒ–çŸ¿ï¼Œå°†åˆçº¦éƒ¨ç½²åˆ°åŒºå—ä¸­ï¼š\nè¿‡ä¸€æ®µæ—¶é—´åï¼Œå†æŸ¥çœ‹åˆçº¦ä¿¡æ¯ï¼Œå‘ç°åˆçº¦ address å·²ç»ç”Ÿæˆï¼Œåˆçº¦éƒ¨ç½²æˆåŠŸï¼š\n2.5 è°ƒç”¨åˆçº¦ è¾“å…¥ä»¥ä¸‹å‘½ä»¤è°ƒç”¨éƒ¨ç½²çš„ multiply7 åˆçº¦çš„ multiply å‡½æ•°ï¼Œå‚æ•°ä¸º 5ï¼Œåº”è¯¥è¿”å› 5 * 7ï¼Œå³ 35ï¼š\nmultiply7.multiply.call(5) ä»¥ä¸Šï¼Œå°±æ˜¯ä»¥å¤ªåŠç§æœ‰é“¾çš„æ­å»ºä»¥åŠåˆçº¦éƒ¨ç½²å’Œè°ƒç”¨çš„è¿‡ç¨‹ã€‚\n","permalink":"https://zjxjwxk.github.io/posts/blockchain/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA/","summary":"\u003ch1 id=\"1-ä»¥å¤ªåŠå¼€å‘ç¯å¢ƒæ­å»º\"\u003e1. ä»¥å¤ªåŠå¼€å‘ç¯å¢ƒæ­å»º\u003c/h1\u003e\n\u003ch2 id=\"11-é…ç½®ä»¥å¤ªåŠç¯å¢ƒ\"\u003e1.1 é…ç½®ä»¥å¤ªåŠç¯å¢ƒ\u003c/h2\u003e\n\u003ch3 id=\"111-å®‰è£…-go-ç¯å¢ƒ\"\u003e1.1.1 å®‰è£… Go ç¯å¢ƒ\u003c/h3\u003e\n\u003cp\u003eå¯åœ¨ Go å®˜ç½‘ \u003ca href=\"https://golang.org/dl/\"\u003ehttps://golang.org/dl/\u003c/a\u003e ç›´æ¥ä¸‹è½½ç›¸åº”æ“ä½œç³»ç»Ÿçš„å®‰è£…åŒ…ï¼Œæœ¬äººä½¿ç”¨ MacOS ç³»ç»Ÿï¼Œæ•…ç‚¹å‡»å¦‚ä¸‹æŒ‰é’®ä¸‹è½½ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Goå®‰è£…åŒ…ä¸‹è½½\" loading=\"lazy\" src=\"/posts/blockchain/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA/images/image-20201103124547934.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæ ¹æ®å…¶æç¤ºä¿¡æ¯è¿›è¡Œå®‰è£…ï¼Œæ— éœ€é…ç½®ç¯å¢ƒå˜é‡ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ \u003ccode\u003ego version\u003c/code\u003e ï¼Œè‹¥å‡ºç°å¦‚ä¸‹ç‰ˆæœ¬ä¿¡æ¯åˆ™ Go ç¯å¢ƒå®‰è£…æˆåŠŸã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Go ç‰ˆæœ¬ä¿¡æ¯\" loading=\"lazy\" src=\"/posts/blockchain/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA/images/image-20201103132116806.png\"\u003e\u003c/p\u003e\n\u003ch3 id=\"112-å®‰è£…-nodejsnpm\"\u003e1.1.2 å®‰è£… Node.jsã€NPM\u003c/h3\u003e\n\u003cp\u003eç”±äº Node.js çš„å®‰è£…åŒ…å·²ç»åŒ…å«äº† NPMï¼Œæ•…åªéœ€ä¸‹è½½æœ€æ–°ç¨³å®šç‰ˆæœ¬çš„ Node.js å®‰è£…åŒ…å³å¯ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Node.js å’Œ NPM å®‰è£…\" loading=\"lazy\" src=\"/posts/blockchain/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA/images/image-20201103125435679.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåŒæ ·æ ¹æ®æç¤ºå®‰è£…ï¼Œæ— éœ€é…ç½®ç¯å¢ƒå˜é‡ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ \u003ccode\u003enode -v\u003c/code\u003e å’Œ \u003ccode\u003enpm -v\u003c/code\u003e ï¼Œè‹¥åˆ†åˆ«å‡ºç°å¦‚ä¸‹ Node.js å’Œ NPM çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™å®‰è£…æˆåŠŸã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Node.js å’Œ NPM ç‰ˆæœ¬ä¿¡æ¯\" loading=\"lazy\" src=\"/posts/blockchain/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA/images/image-20201103132211802.png\"\u003e\u003c/p\u003e\n\u003ch3 id=\"113-å®‰è£…ä»¥å¤ªåŠ-ethereum\"\u003e1.1.3 å®‰è£…ä»¥å¤ªåŠ Ethereum\u003c/h3\u003e\n\u003cp\u003eç”±äºæœ¬äººä½¿ç”¨ MacOS ç³»ç»Ÿï¼Œæ•…ä½¿ç”¨ brew å®‰è£…ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ \u003ccode\u003ebrew install ethereum\u003c/code\u003e å³å¯å®‰è£…ã€‚å®‰è£…å®Œæˆåï¼Œè‹¥è¾“å…¥ \u003ccode\u003egeth version\u003c/code\u003e å‡ºç°å¦‚ä¸‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™ Ethereum å®‰è£…æˆåŠŸã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"geth ç‰ˆæœ¬ä¿¡æ¯\" loading=\"lazy\" src=\"/posts/blockchain/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E7%A7%81%E6%9C%89%E9%93%BE%E6%90%AD%E5%BB%BA/images/image-20201103132306255.png\"\u003e\u003c/p\u003e","title":"ä»¥å¤ªåŠç§æœ‰é“¾æ­å»º"},{"content":"æƒ³è¦ä¸€æ¢ JDK å†…éƒ¨çš„å®ç°æœºåˆ¶ï¼Œæœ€ä¾¿æ·çš„æ·å¾„ä¹‹ä¸€å°±æ˜¯è‡ªå·±ç¼–è¯‘ä¸€å¥— JDKï¼Œé€šè¿‡é˜…è¯»å’Œè·Ÿè¸ªè°ƒè¯• JDK æºç å»äº†è§£ Java æŠ€æœ¯ä½“ç³»çš„åŸç†ã€‚æœ¬äººé€‰æ‹©äº† OpenJDK è¿›è¡Œç¼–è¯‘ã€‚\nç”±äºåœ¨ç¼–è¯‘ OpenJDK 7 æ—¶å‡ºç°äº†å¦‚ä¸‹ä¸çŸ¥å¦‚ä½•è§£å†³çš„é—®é¢˜ï¼š\nllvm-gcc -m64 -m64 -L`pwd` -framework CoreFoundation -o gamma launcher/java_md.o launcher/java.o launcher/jli_util.o launcher/wildcard.o -ljvm -lm -pthread Undefined symbols for architecture x86_64: \u0026#34;_JNI_CreateJavaVM\u0026#34;, referenced from: _LoadJavaVM in java_md.o \u0026#34;_JNI_GetDefaultJavaVMInitArgs\u0026#34;, referenced from: _LoadJavaVM in java_md.o ld: symbol(s) not found for architecture x86_64 clang: error: linker command failed with exit code 1 (use -v to see invocation) make[8]: *** [gamma] Error 1 make[7]: *** [the_vm] Error 2 make[6]: *** [product] Error 2 make[5]: *** [generic_build2] Error 2 make[4]: *** [product] Error 2 make[3]: *** [all_product_universal] Error 2 make[2]: *** [universal_product] Error 2 make[1]: *** [hotspot-build] Error 2 make: *** [build_product_image] Error 2 ä¸ªäººçŒœæƒ³æ˜¯ç”±äºæˆ‘ Mac OS ç³»ç»Ÿç‰ˆæœ¬å¤ªé«˜çš„é—®é¢˜ï¼ˆCatalina 10.15.5ï¼‰ï¼ŒXCode ç‰ˆæœ¬ä¹Ÿæ˜¯æœ€æ–°çš„ 11.6ã€‚\näºæ˜¯ï¼Œæˆ‘å°è¯•ç¼–è¯‘æ›´é«˜ç‰ˆæœ¬çš„ OpenJDK 8ï¼Œåœ¨è§£å†³ä¸€ç³»åˆ—ç¼–è¯‘é—®é¢˜åï¼ŒæˆåŠŸäº†ã€‚\nè·å– JDK æºç  è·å– JDK æºç æœ‰ä¸¤ç§æ–¹å¼ï¼š\nï¼ˆ1ï¼‰é€šè¿‡ Mercurial ä»£ç ç‰ˆæœ¬ç®¡ç†å·¥å…·ä» Repository ä¸­ç›´æ¥å–å¾—æºç \nRepository åœ°å€ï¼šhttp://hg.openjdk.java.net/jdk8/jdk8\nè·å–è¿‡ç¨‹å¦‚ä»¥ä¸‹ä»£ç æ‰€ç¤º\nhg clone http://hg.openjdk.java.net/jdk8/jdk8 cd jdk7u-dev chmod 755 get_source.sh ./get_source.sh ä»ç‰ˆæœ¬ç®¡ç†ä¸­çœ‹å˜æ›´è½¨è¿¹æ•ˆæœè¾ƒå¥½ï¼Œä½†ä¸è¶³ä¹‹å¤„æ˜¯é€Ÿåº¦å¤ªæ…¢ï¼Œè€Œä¸” Mercurial ä¸å¦‚ Gitã€SVN ç­‰ç‰ˆæœ¬æ§åˆ¶å·¥å…·é‚£æ ·æ™®åŠã€‚\nï¼ˆ2ï¼‰é€šè¿‡ OpenJDKâ„¢ Source Releases é¡µé¢å–å¾—æ‰“åŒ…å¥½çš„æºç \né¡µé¢åœ°å€ï¼šhttps://download.java.net/openjdk/jdk8/\nç³»ç»Ÿéœ€æ±‚ å»ºè®®åœ¨ Linuxã€MacOS æˆ– Solaris ä¸Šæ„å»º OpenJDK\næœ¬äººé‡‡ç”¨çš„æ˜¯ 64 ä½æ“ä½œç³»ç»Ÿï¼Œç¼–è¯‘çš„ä¹Ÿæ˜¯ 64 ä½çš„ OpenJDK\næ„å»ºç¼–è¯‘ç¯å¢ƒ æœ¬äººä½¿ç”¨çš„æ˜¯ MacOS ï¼Œéœ€è¦å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ XCode å’Œ Command Line Tools for Xcodeï¼Œå¦å¤–è¿˜è¦å‡†å¤‡ä¸€ä¸ª N-1 ï¼ˆN ä¸ºè¦ç¼–è¯‘çš„OpenJDK ç‰ˆæœ¬å·ï¼‰ä»¥ä¸Šç‰ˆæœ¬çš„ JDKï¼Œå®˜æ–¹ç§°è¿™ä¸ª JDK ä¸º â€œBootstrap JDKâ€ ã€‚æ­¤å¤„ç”±äºç¼–è¯‘çš„æ˜¯ OpenJDK 8ï¼Œæˆ‘é€‰ç”¨ JDK 7 ä½œä¸º Bootstrap JDKã€‚æœ€åï¼Œéœ€è¦ä¸‹è½½ä¸€ä¸ª 1.7.1 ä»¥ä¸Šç‰ˆæœ¬çš„ Apache Antï¼Œå¹¶æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œç”¨äºæ‰§è¡Œ Java ç¼–è¯‘ä»£ç ä¸­çš„ Ant è„šæœ¬ã€‚ç”¨ brew å®‰è£… freetype å’Œ CUPSã€‚\nè¿›è¡Œç¼–è¯‘ æœ€åæˆ‘ä»¬è¿˜éœ€è¦å¯¹ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡åšä¸€äº›ç®€å•è®¾ç½®ä»¥ä¾¿ç¼–è¯‘èƒ½å¤Ÿé¡ºåˆ©é€šè¿‡ï¼Œè¿™é‡Œç»™å‡ºä½¿ç”¨çš„ç¼–è¯‘ Shell è„šæœ¬ã€‚å…¶ä¸­æ·»åŠ å¯¼å‡ºäº†ä¸€äº› ALT_ ç¯å¢ƒå˜é‡ï¼ˆåœ¨ç¼–è¯‘ OpenJDK 8 çš„æ—¶å€™è­¦å‘Š ALT_ è¢«å¼ƒç”¨äº†ï¼Œå› æ­¤è¿™é‡Œæ³¨é‡Šæ‰äº†ï¼‰ï¼Œå¦‚ freetype å’Œ CUPSã€‚\nå¹¶å°† COMPILER_WARNINGS_FATAL=false ä»¥é¿å…ç¼–è¯‘å™¨çš„è¯­æ³•æ ¡éªŒå¤ªä¸¥æ ¼ï¼š\n#è¯­è¨€é€‰é¡¹,è¿™ä¸ªå¿…é¡»è®¾ç½®,å¦åˆ™ç¼–è¯‘å¥½åä¼šå‡ºç°ä¸€ä¸ªHashTableçš„NPEé”™ export LANG=C #Bootstrap JDKçš„å®‰è£…è·¯å¾„ã€‚å¿…é¡»è®¾ç½® #export ALT_BOOTDIR=/Library/Java/JavaVirtualMachines/jdk1.7.0_80.jdk/Contents/Home #å…è®¸è‡ªåŠ¨ä¸‹è½½ä¾èµ– export ALLOW_DOWNLOADS=true #å¹¶è¡Œç¼–è¯‘çš„çº¿ç¨‹æ•°,è®¾ç½®ä¸ºå’ŒCPUå†…æ ¸æ•°é‡ä¸€è‡´å³å¯ export HOTSPOT_BUILD_J0BS=8 #export ALT_PARALLEL_COMPILE_JOBS=8 #æ¯”è¾ƒæœ¬æ¬¡buildå‡ºæ¥çš„æ˜ åƒä¸å…ˆå‰ç‰ˆæœ¬çš„å·®å¼‚ã€‚è¿™å¯¹æˆ‘ä»¬æ¥è¯´æ²¡æœ‰æ„ä¹‰, #å¿…é¡»è®¾ç½®ä¸ºfalse,é¦™åˆ™sanityæ£€æŸ¥ä¼šæŠ¥ç¼ºå°‘å…ˆå‰ç‰ˆæœ¬JDKçš„æ˜ åƒçš„é”™è¯¯æç¤ºã€‚ #å¦‚æ¡Œå·²ç»è®¾ç½®devæˆ–è€…DEV_ONLY=true,è¿™ä¸ªä¸æ˜¾å¼è®¾ç½®ä¹Ÿè¡Œ export SKIP_COMPARE_IMAGES=true #ä½¿ç”¨é¢„ç¼–è¯‘å¤´æ–‡ä»¶,ä¸åŠ è¿™ä¸ªç¼–è¯‘ä¼šæ›´æ…¢ä¸€äº› export USE_PRECOMPILED_HEADER=true #è¦ç¼–è¯‘çš„å†…å®¹ export BUILD_LANGTOOLS=true #export BUILD_JAXP=false #export BUILD_JAXWS=fa1se #export BUILD_CORBA=false export BUILD_HOTSPOT=true export BUILD_JDK=true #è¦ç¼–è¯‘çš„ç‰ˆæœ¬ #export SKIP_DEBUG_BUILD=false #export SKIP_FASTDEBUG_BUILD=true #export DEBUG_NAME=debug #æŠŠå®ƒè®¾ç½®ä¸ºfalseå¯ä»¥é¿å¼€javawså’Œæµè§ˆå™¨Javaæ’ä»¶ä¹‹ç±»çš„éƒ¨åˆ†çš„build BUILD_DEPLOY=false #æŠŠå®ƒè®¾ç½®ä¸ºfalseå°±ä¸ä¼šbuildå‡ºå®‰è£…åŒ…ã€‚å› ä¸ºå®‰è£…åŒ…é‡Œæœ‰äº›å¥‡æ€ªçš„ä¾èµ–, #ä½†å³ä¾¿ä¸buildå‡ºå®ƒä¹Ÿå·²ç»èƒ½å¾—åˆ°å®Œæ•´çš„JDKæ˜ åƒ,æ‰€ä»¥è¿˜æ˜¯åˆ«buildå®ƒå¥½äº† BUILD_INSTALL=false #ç¼–è¯‘ç»“æœæ‰€å­˜æ”¾çš„è·¯å¾„ #export ALT_OUTPUTDIR=/Users/zjxjwxk/Documents/JVM/JDK-Build/build #export ALT_FREETYPE_HEADERS_PATH=/usr/local/Cellar/freetype/2.6.2/include/freetype2 #export ALT_FREETYPE_LIB_PATH=/usr/local/Cellar/freetype/2.6.2/lib #export ALT_CUPS_HEADERS_PATH=/usr/local/Cellar/cups/2.3.3/include export COMPILER_WARNINGS_FATAL=false #è¿™ä¸¤ä¸ªç¯å¢ƒå˜é‡å¿…é¡»å»æ‰,ä¸ç„¶ä¼šæœ‰å¾ˆè¯¡å¼‚çš„äº‹æƒ…å‘ç”Ÿï¼ˆæˆ‘æ²¡æœ‰å…·ä½“æŸ¥è¿‡è¿™äº› \u0026#34;è¯¡å¼‚çš„ #äº‹æƒ…â€ ,Makefileè„šæœ¬è££æŸ¥åˆ°æœ‰è¿™2ä¸ªå˜é‡å°±ä¼šæç¤ºè­¦å‘Š) unset JAVA_HOME unset CLASSPATH make 2\u0026gt;\u0026amp;1 | tee build/build.log æ£€æŸ¥ å…¨éƒ¨è®¾ç½®ç»“æŸä¹‹åï¼Œå¯ä»¥è¾“å…¥ make sanity æ¥æ£€æŸ¥æˆ‘ä»¬æ‰€åšçš„è®¾ç½®æ˜¯å¦å…¨éƒ¨æ­£ç¡®ã€‚å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œé‚£ä¹ˆå‡ ç§’é’Ÿä¹‹åä¼šæœ‰ç±»ä¼¼ä»£ç æ¸…å•1-2æ‰€ç¤ºçš„è¾“å‡ºã€‚\n~/Develop/JVM/jdkBuild/openjdk_7u4$ make sanity Build Machine Information: build machine = IcyFenix-RMBP.local Build Directory Structure: CWD = /Users/IcyFenix/Develop/JVM/jdkBuild/openjdk_7u4 TOPDIR = . LANGTOOLS_TOPDIR = ./langtools JAXP_TOPDIR = ./jaxp JAXWS_TOPDIR = ./jaxws CORBA_TOPDIR = ./corba HOTSPOT_TOPDIR = ./hotspot JDK_TOPDIR = ./jdk Build Directives: BUILD_LANGTOOLS = true BUILD_JAXP = true BUILD_JAXWS = true BUILD_CORBA = true BUILD_HOTSPOT = true BUILD_JDK = true DEBUG_CLASSFILES = DEBUG_BINARIES = â€¦â€¦å› ç¯‡å¹…å…³ç³»ï¼Œä¸­é—´çœç•¥äº†å¤§é‡çš„è¾“å‡ºå†…å®¹â€¦â€¦ OpenJDK-specific settings: FREETYPE_HEADERS_PATH = /usr/X11R6/include ALT_FREETYPE_HEADERS_PATH = FREETYPE_LIB_PATH = /usr/X11R6/lib ALT_FREETYPE_LIB_PATH = Previous JDK Settings: PREVIOUS_RELEASE_PATH = USING-PREVIOUS_RELEASE_IMAGE ALT_PREVIOUS_RELEASE_PATH = PREVIOUS_JDK_VERSION = 1.6.0 ALT_PREVIOUS_JDK_VERSION = PREVIOUS_JDK_FILE = ALT_PREVIOUS_JDK_FILE = PREVIOUS_JRE_FILE = ALT_PREVIOUS_JRE_FILE = PREVIOUS_RELEASE_IMAGE = /Library/Java/JavaVirtualMachines/jdk1.7.0_04.jdk/Contents/Home ALT_PREVIOUS_RELEASE_IMAGE = Sanity check passed. Makefile çš„ Sanity æ£€æŸ¥è¿‡ç¨‹è¾“å‡ºäº†ç¼–è¯‘æ‰€éœ€çš„æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼Œå¦‚æœçœ‹åˆ° â€œSanity check passedâ€ è¯´æ˜æ£€æŸ¥è¿‡ç¨‹é€šè¿‡äº†ï¼Œå¯ä»¥è¾“å…¥ make æ‰§è¡Œæ•´ä¸ª OpenJDK ç¼–è¯‘ (make ä¸åŠ å‚æ•°ï¼Œé»˜è®¤ç¼–è¯‘ make all)ã€‚\nå¯èƒ½å‡ºç°çš„ç¼–è¯‘é”™è¯¯ error: equality comparison with extraneous error: \u0026#39;\u0026amp;\u0026amp;\u0026#39; within \u0026#39;||\u0026#39; è¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨è¯­æ³•æ ¡éªŒå¤ªä¸¥æ ¼äº†ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡ export COMPILER_WARNINGS_FATAL=false å³å¯ã€‚\nclang: error: unknown argument: \u0026#39;-fpch-deps\u0026#39; è¿™æ˜¯å› ä¸ºæ–°çš„ç¼–è¯‘å™¨å·²ç»ä¸å†æ”¯æŒè¿™ä¸ªé€‰é¡¹äº†ï¼Œæ‰“å¼€ hotspot/make/bsd/makefiles/gcc.makeï¼Œæ‰¾åˆ° -fpch-deps æ‰€åœ¨çš„é‚£ä¸€è¡Œï¼Œæ³¨é‡Šæ‰å³å¯ã€‚\ninvalid argument \u0026#39;-std=gnu++98\u0026#39; not allowed with \u0026#39;C/ObjC\u0026#39; åœ¨ common/autoconf/generated-configure.sh ä¸­ï¼Œæ³¨é‡Šæ‰ CXXSTD_CXXFLAG=\u0026quot;-std=gnu++98\u0026quot; è¿™ä¸€è¡Œï¼Œç„¶åé‡æ–°æ‰§è¡Œ configureã€‚\n./configure --with-freetype-include=/usr/local/Cellar/freetype/2.6.2/include/freetype2 --with-freetype-lib=/usr/local/Cellar/freetype/2.6.2/lib ç¼–è¯‘å®Œæˆ ç¼–è¯‘æˆåŠŸåï¼Œæ˜¾ç¤ºï¼š\n----- Build times ------- Start 2020-07-16 12:38:50 End 2020-07-16 12:48:23 00:00:17 corba 00:05:36 hotspot 00:00:11 jaxp 00:00:19 jaxws 00:02:44 jdk 00:00:25 langtools 00:09:33 TOTAL ------------------------- Finished building OpenJDK for target \u0026#39;default\u0026#39; è¿è¡Œ java å‘½ä»¤ ç¼–è¯‘å®Œæˆåï¼Œè¿›å…¥ OpenJDK æºç ä¸‹çš„ build/macosx-x86_64-normal-server-release/jdk ç›®å½•ï¼Œè¿™æ˜¯æ•´ä¸ª JDK çš„å®Œæ•´ç¼–è¯‘ç»“æœï¼Œå¤åˆ¶åˆ° JAVA_HOME ç›®å½•ï¼Œå°±å¯ä»¥ä½œä¸ºä¸€ä¸ªå®Œæ•´çš„ JDK ä½¿ç”¨ï¼Œç¼–è¯‘å‡ºæ¥çš„è™šæ‹Ÿæœºï¼Œåœ¨ -version å‘½ä»¤ä¸­å¸¦æœ‰ç”¨æˆ·çš„æœºå™¨åã€‚\n\u0026gt; ./java -version openjdk version \u0026#34;1.8.0-internal\u0026#34; OpenJDK Runtime Environment (build 1.8.0-internal-zjxjxk_2020_07_16_13_03-b00) OpenJDK 64-Bit Server VM (build 25.71-b00, mixed mode) å¯èƒ½å‡ºç°çš„è¿è¡Œé—®é¢˜ æˆ‘è¿™é‡Œè¿è¡Œæ—¶å‡ºç°äº†ä¸€ä¸ªç±»ä¼¼ä»¥ä¸‹çš„é—®é¢˜ï¼š\nError: A fatal exception has occurred. Program will exit. localhost:bin jjchen$ ./java -version openjdk version \u0026#34;1.8.0-internal\u0026#34; OpenJDK Runtime Environment (build 1.8.0-internal-jjchen_2018_09_13_10_00-b00) OpenJDK 64-Bit Server VM (build 25.71-b00, mixed mode) # # A fatal error has been detected by the Java Runtime Environment: # # SIGILL (0x4) at pc=0x0000000107487f47, pid=88445, tid=0x0000000000002603 # # JRE version: OpenJDK Runtime Environment (8.0) (build 1.8.0-internal-jjchen_2018_09_13_10_00-b00) # Java VM: OpenJDK 64-Bit Server VM (25.71-b00 mixed mode bsd-amd64 compressed oops) # Problematic frame: # V [libjvm.dylib+0x487f47] # # Failed to write core dump. Core dumps have been disabled. To enable core dumping, try \u0026#34;ulimit -c unlimited\u0026#34; before starting Java again # # An error report file with more information is saved as: # /Users/jjchen/jvm/jdk8u-dev/build/macosx-x86_64-normal-server-release/jdk/bin/hs_err_pid88445.log # # If you would like to submit a bug report, please visit: # http://bugreport.java.com/bugreport/crash.jsp # åœ¨å°† hotspot/src/share/vm/runtime/perfData.cpp ä¸­çš„ delete p æ³¨é‡Šæ‰ï¼Œå¹¶é‡æ–°ç¼–è¯‘åï¼Œå¾—ä»¥æ­£å¸¸è¿è¡Œã€‚\nvoid PerfDataManager::destroy() { if (_all == NULL) // destroy already called, or initialization never happened return; for (int index = 0; index \u0026lt; _all-\u0026gt;length(); index++) { PerfData* p = _all-\u0026gt;at(index); // delete p; } delete(_all); delete(_sampled); delete(_constants); _all = NULL; _sampled = NULL; _constants = NULL; } å•ç‹¬ç¼–è¯‘ HotSpot è™šæ‹Ÿæœº åœ¨å¤§å¤šæ•°æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬ä¸å…³å¿ƒ JDK ä¸­ HotSpot è™šæ‹Ÿæœºä»¥å¤–çš„å†…å®¹ï¼Œåªæƒ³å•ç‹¬ç¼–è¯‘ HotSpot è™šæ‹Ÿæœºçš„è¯ï¼ˆä¾‹å¦‚è°ƒè¯•è™šæ‹Ÿæœºæ—¶ï¼Œæ¯æ¬¡æ”¹åŠ¨ç¨‹åºéƒ½æ‰§è¡Œæ•´ä¸ª OpenJDK çš„Makefileï¼Œé€Ÿåº¦è‚¯å®šå—ä¸äº†ï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨ hotspot/make ç›®å½• ä¸‹çš„ Makefile è¿›è¡Œæ›¿æ¢å³å¯ï¼Œå…¶ä»–å‚æ•°è®¾ç½®ä¸å‰é¢æ˜¯ä¸€è‡´çš„ï¼Œè¿™æ—¶å€™è™šæ‹Ÿæœºçš„è¾“å‡ºç»“æœå­˜æ”¾åœ¨ build/macosx-x86_64-normal-server-release/hotspot/bsd_amd64_compiler2 ç›®å½•ä¸­ï¼Œè¿›å…¥åå¯ä»¥è§åˆ°ä»¥ä¸‹å‡ ä¸ªç›®å½•ã€‚\ndrwxr-xr-x 11 zjxjwxk staff 352 7 16 13:04 debug drwxr-xr-x 11 zjxjwxk staff 352 7 16 13:04 fastdebug drwxr-xr-x 17 zjxjwxk staff 544 7 16 13:04 generated drwxr-xr-x 11 zjxjwxk staff 352 7 16 13:04 optimized drwxr-xr-x 643 zjxjwxk staff 20576 7 16 13:09 product è¿™äº›ç›®å½•å¯¹åº”äº†ä¸åŒçš„ä¼˜åŒ–çº§åˆ«ï¼Œä¼˜åŒ–çº§åˆ«è¶Šé«˜ï¼Œæ€§èƒ½è‡ªç„¶è¶Šå¥½ï¼Œä½†æ˜¯è¾“å‡ºä»£ç ä¸æºç çš„å·®åˆ«å°±è¶Šå¤§ï¼Œéš¾äºè°ƒè¯•ï¼Œå…·ä½“å“ªä¸ªç›®å½•æœ‰å†…å®¹ï¼Œå–å†³äº make å‘½ä»¤åé¢çš„å‚æ•°ã€‚\nåœ¨ç¼–è¯‘ç»“æŸä¹‹åã€è¿è¡Œè™šæ‹Ÿæœºä¹‹å‰ï¼Œè¿˜è¦æ‰‹å·¥ç¼–è¾‘ç›®å½•ä¸‹çš„ env.sh æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ç”±ç¼–è¯‘è„šæœ¬è‡ªåŠ¨äº§ç”Ÿï¼Œç”¨äºè®¾ç½®è™šæ‹Ÿæœºçš„ç¯å¢ƒå˜é‡ï¼Œé‡Œé¢å·²ç»å‘å¸ƒäº† â€œJAVA_HOMEã€CLASSPATHã€HOTSPOT_BUILD_USERâ€ 3ä¸ªç¯å¢ƒå˜é‡ï¼Œè¿˜éœ€è¦å¢åŠ ä¸€ä¸ªâ€œLD_LIBRARY_PATHâ€ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\nLD_LIBRARY_PATH=.:${JAVA_HOME}/jre/lib/amd64/native_threads:${JAVA_HOME}/jre/lib/amd64: export LD_LIBRARY_PATH ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨è™šæ‹Ÿæœºï¼ˆè¿™æ—¶çš„å¯åŠ¨å™¨åä¸ºgammaï¼‰ï¼Œè¾“å‡ºç‰ˆæœ¬å·ã€‚\n. ./env.sh ./gamma -version Using java runtime at: /Library/Java/JavaVirtualMachines/jdk1.7.0_04.jdk/Contents/Home/jre java version \u0026#34;1.7.0_04\u0026#34; Java(TM) SE Runtime Environment (build 1.7.0_04-b21) OpenJDK 64-Bit Server VM (build 23.0-b21, mixed mode) çœ‹åˆ°è‡ªå·±ç¼–è¯‘çš„è™šæ‹ŸæœºæˆåŠŸè¿è¡Œèµ·æ¥ï¼Œå¾ˆæœ‰æˆå°±æ„Ÿå§!\nå‚è€ƒï¼šã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬2ç‰ˆï¼‰ã€‹\nä½œè€…ï¼šå‘¨å¿—æ˜\n","permalink":"https://zjxjwxk.github.io/posts/java/jvm/%E8%87%AA%E5%B7%B1%E7%BC%96%E8%AF%91openjdk-8/","summary":"\u003cp\u003eæƒ³è¦ä¸€æ¢ JDK å†…éƒ¨çš„å®ç°æœºåˆ¶ï¼Œæœ€ä¾¿æ·çš„æ·å¾„ä¹‹ä¸€å°±æ˜¯è‡ªå·±ç¼–è¯‘ä¸€å¥— JDKï¼Œé€šè¿‡é˜…è¯»å’Œè·Ÿè¸ªè°ƒè¯• JDK æºç å»äº†è§£ Java æŠ€æœ¯ä½“ç³»çš„åŸç†ã€‚æœ¬äººé€‰æ‹©äº† OpenJDK è¿›è¡Œç¼–è¯‘ã€‚\u003c/p\u003e\n\u003cp\u003eç”±äºåœ¨ç¼–è¯‘ OpenJDK 7 æ—¶å‡ºç°äº†å¦‚ä¸‹ä¸çŸ¥å¦‚ä½•è§£å†³çš„é—®é¢˜ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ellvm-gcc -m64   -m64  -L\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003epwd\u003cspan style=\"color:#e6db74\"\u003e`\u003c/span\u003e  -framework CoreFoundation  -o gamma launcher/java_md.o launcher/java.o launcher/jli_util.o launcher/wildcard.o -ljvm -lm -pthread\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eUndefined symbols \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e architecture x86_64:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;_JNI_CreateJavaVM\u0026#34;\u003c/span\u003e, referenced from:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      _LoadJavaVM in java_md.o\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;_JNI_GetDefaultJavaVMInitArgs\u0026#34;\u003c/span\u003e, referenced from:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      _LoadJavaVM in java_md.o\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eld: symbol\u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003es\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e not found \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e architecture x86_64\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eclang: error: linker command failed with exit code \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e(\u003c/span\u003euse -v to see invocation\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e8\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: *** \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003egamma\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Error \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e7\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: *** \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ethe_vm\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Error \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e6\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: *** \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eproduct\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Error \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e5\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: *** \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003egeneric_build2\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Error \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e4\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: *** \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eproduct\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Error \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e3\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: *** \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eall_product_universal\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Error \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e2\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: *** \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003euniversal_product\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Error \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003e1\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e: *** \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ehotspot-build\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Error \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake: *** \u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003ebuild_product_image\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e Error \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eä¸ªäººçŒœæƒ³æ˜¯ç”±äºæˆ‘ Mac OS ç³»ç»Ÿç‰ˆæœ¬å¤ªé«˜çš„é—®é¢˜ï¼ˆCatalina 10.15.5ï¼‰ï¼ŒXCode ç‰ˆæœ¬ä¹Ÿæ˜¯æœ€æ–°çš„ 11.6ã€‚\u003c/p\u003e","title":"è‡ªå·±ç¼–è¯‘OpenJDK 8"},{"content":"ä¸»è¦é—®é¢˜ å‰åç«¯åˆ†ç¦»åï¼Œå‰ç«¯ä½¿ç”¨ Ajax è¿›è¡Œè¯·æ±‚ï¼Œå­˜åœ¨ä¸€äº›è·¨åŸŸçš„é—®é¢˜ã€‚\nåŸºäº Spring Boot çš„åç«¯é€šè¿‡ç»™ Controlleç±»æˆ–å…¶ä¸­çš„æ–¹æ³•æ·»åŠ  @CrossOrigin æ³¨è§£æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼š\n@CrossOrigin @RequestMapping(\u0026#34;/user/\u0026#34;) public class UserController { ... } æ·»åŠ è¯¥æ³¨è§£ä¹‹åï¼Œå¯ä»¥é€šè¿‡åŒ¿åè®¿é—®çš„æ¥å£éƒ½æ²¡æœ‰è·¨åŸŸé—®é¢˜äº†ï¼Œè€Œéœ€è¦é€šè¿‡ JWT éªŒè¯çš„æ¥å£ä»ç„¶å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚\nå…¶ä¸­ï¼Œè§£å†³é—®é¢˜çš„å…³é”®åœ¨äºï¼Œæµè§ˆå™¨ä¼šåœ¨å‘é€ Ajax è¯·æ±‚ä¹‹å‰å‘é€ä¸€ä¸ªé¢„è¯·æ±‚ï¼Œç¡®è®¤å½“å‰çš„æ¥å£æ˜¯ä¸æ˜¯æœ‰æ•ˆçš„æ¥å£ï¼Œæ­¤æ—¶çš„è¯·æ±‚æ–¹å¼æ˜¯ OPTIONS çš„è¯·æ±‚æ–¹å¼ã€‚\nå› æ­¤ï¼ŒJWT çš„è¿‡æ»¤å™¨éœ€è¦å…ˆåˆ¤æ–­è¯¥è¯·æ±‚æ˜¯å¦ä¸ºé¢„è¯·æ±‚ï¼Œå¦‚æœæ˜¯åˆ™éœ€è¦ç»™è¿”å›çš„å“åº”å¤´ä¸­æ·»åŠ è·¨åŸŸç›¸å…³çš„ä¿¡æ¯ï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™æŒ‰ç…§ä¸€èˆ¬æ¥å£è¿›è¡Œ JWT éªŒè¯ã€‚\npublic class AuthFilter extends OncePerRequestFilter { ...... @Override protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws IOException, ServletException { // å¤„ç†æµè§ˆå™¨çš„é¢„è¯·æ±‚ if (request.getMethod().equals(\u0026#34;OPTIONS\u0026#34;)) { response.setHeader(\u0026#34;Access-Control-Allow-Origin\u0026#34;, \u0026#34;*\u0026#34;); response.setHeader(\u0026#34;Access-Control-Allow-Methods\u0026#34;, \u0026#34;POST,GET,PUT,OPTIONS,DELETE\u0026#34;); response.setHeader(\u0026#34;Access-Control-Max-Age\u0026#34;, \u0026#34;3600\u0026#34;); response.setHeader(\u0026#34;Access-Control-Allow-Headers\u0026#34;, \u0026#34;Origin,X-Requested-With,Content-Type,Accept,Authorization,token\u0026#34;); return; } // éªŒè¯ JWT ...... } } ","permalink":"https://zjxjwxk.github.io/posts/spring-boot/spring-boot-%E4%B8%AD%E7%9A%84-jwt-%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/","summary":"\u003ch1 id=\"ä¸»è¦é—®é¢˜\"\u003eä¸»è¦é—®é¢˜\u003c/h1\u003e\n\u003cp\u003eå‰åç«¯åˆ†ç¦»åï¼Œå‰ç«¯ä½¿ç”¨ Ajax è¿›è¡Œè¯·æ±‚ï¼Œå­˜åœ¨ä¸€äº›è·¨åŸŸçš„é—®é¢˜ã€‚\u003c/p\u003e\n\u003cp\u003eåŸºäº Spring Boot çš„åç«¯é€šè¿‡ç»™ Controlleç±»æˆ–å…¶ä¸­çš„æ–¹æ³•æ·»åŠ  \u003ccode\u003e@CrossOrigin\u003c/code\u003e æ³¨è§£æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@CrossOrigin\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@RequestMapping\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/user/\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003epublic\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eUserController\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t...\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæ·»åŠ è¯¥æ³¨è§£ä¹‹åï¼Œå¯ä»¥é€šè¿‡åŒ¿åè®¿é—®çš„æ¥å£éƒ½æ²¡æœ‰è·¨åŸŸé—®é¢˜äº†ï¼Œè€Œéœ€è¦é€šè¿‡ JWT éªŒè¯çš„æ¥å£ä»ç„¶å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚\u003c/p\u003e\n\u003cp\u003eå…¶ä¸­ï¼Œ\u003cstrong\u003eè§£å†³é—®é¢˜çš„å…³é”®\u003c/strong\u003eåœ¨äºï¼Œæµè§ˆå™¨ä¼šåœ¨å‘é€ Ajax è¯·æ±‚ä¹‹å‰å‘é€ä¸€ä¸ªé¢„è¯·æ±‚ï¼Œç¡®è®¤å½“å‰çš„æ¥å£æ˜¯ä¸æ˜¯æœ‰æ•ˆçš„æ¥å£ï¼Œæ­¤æ—¶çš„è¯·æ±‚æ–¹å¼æ˜¯ OPTIONS çš„è¯·æ±‚æ–¹å¼ã€‚\u003c/p\u003e\n\u003cp\u003eå› æ­¤ï¼ŒJWT çš„è¿‡æ»¤å™¨éœ€è¦å…ˆåˆ¤æ–­è¯¥è¯·æ±‚æ˜¯å¦ä¸ºé¢„è¯·æ±‚ï¼Œå¦‚æœæ˜¯åˆ™éœ€è¦ç»™è¿”å›çš„å“åº”å¤´ä¸­æ·»åŠ è·¨åŸŸç›¸å…³çš„ä¿¡æ¯ï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™æŒ‰ç…§ä¸€èˆ¬æ¥å£è¿›è¡Œ JWT éªŒè¯ã€‚\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003epublic\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eAuthFilter\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eextends\u003c/span\u003e OncePerRequestFilter {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \t......\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003e@Override\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eprotected\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003evoid\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003edoFilterInternal\u003c/span\u003e(HttpServletRequest request, HttpServletResponse response, FilterChain chain) \u003cspan style=\"color:#66d9ef\"\u003ethrows\u003c/span\u003e IOException, ServletException {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// å¤„ç†æµè§ˆå™¨çš„é¢„è¯·æ±‚\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (request.\u003cspan style=\"color:#a6e22e\"\u003egetMethod\u003c/span\u003e().\u003cspan style=\"color:#a6e22e\"\u003eequals\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;OPTIONS\u0026#34;\u003c/span\u003e)) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            response.\u003cspan style=\"color:#a6e22e\"\u003esetHeader\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Access-Control-Allow-Origin\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            response.\u003cspan style=\"color:#a6e22e\"\u003esetHeader\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Access-Control-Allow-Methods\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;POST,GET,PUT,OPTIONS,DELETE\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            response.\u003cspan style=\"color:#a6e22e\"\u003esetHeader\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Access-Control-Max-Age\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;3600\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            response.\u003cspan style=\"color:#a6e22e\"\u003esetHeader\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Access-Control-Allow-Headers\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Origin,X-Requested-With,Content-Type,Accept,Authorization,token\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// éªŒè¯ JWT\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ......\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","title":"Spring Boot ä¸­çš„ JWT è·¨åŸŸé—®é¢˜"},{"content":"æœåŠ¡ Docker åŒ– ä¿®æ”¹é¡¹ç›®é…ç½® ç”±äºé•œåƒè¿è¡Œæ—¶ MySQL æ•°æ®åº“æ‰€åœ¨çš„ä¸»æœºåœ°å€æ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥å°†é¡¹ç›®ä¸­çš„ MySQL æ•°æ®åº“åœ°å€å’Œ Zookeeper æ³¨å†Œä¸­å¿ƒåœ°å€é…ç½®ä¸ºåŠ¨æ€å˜é‡ï¼š\nspring: dubbo: registry: zookeeper://${zk.address}:2181 datasource: url: jdbc:mysql://{mysql.address}:3306/cinema?autoReconnect=true\u0026amp;useUnicode=true\u0026amp;characterEncoding=utf8\u0026amp;serverTimezone=GMT%2B8 è·å– Java é•œåƒ docker pull openjdk:8-jre æ‰“åŒ… Maven é¡¹ç›® åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œ Maven çš„æ¸…é™¤å’Œæ‰“åŒ…å‘½ä»¤ï¼ˆè·³è¿‡æµ‹è¯•ï¼‰ï¼š\nmvn clean \u0026amp;\u0026amp; mvn package -Dmaven.test.skip=true è¿™æ ·å°±ä¼šåœ¨ target ç›®å½•ä¸‹ç”Ÿæˆ jar åŒ…ï¼ˆSpring Boot é¡¹ç›®ï¼‰ã€‚\nç¼–å†™ Dockerfile åœ¨ user å­æ¨¡å—çš„æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»º Dockerfile æ–‡ä»¶ï¼Œå¹¶ç¼–è¾‘å¦‚ä¸‹ï¼ŒDockerfile æ–‡ä»¶ç”¨äºæ„å»º Docker é•œåƒï¼š\nFROM openjdk:8-jre MAINTAINER zjxjwxk zjxjwxk@gmail.com COPY target/user.jar /user.jar ENTRYPOINT [\u0026#34;java\u0026#34;, \u0026#34;-jar\u0026#34;, \u0026#34;/user.jar\u0026#34;] æ„å»ºé¡¹ç›® Docker é•œåƒ docker build -t user:latest . ç¼–å†™ build è„šæœ¬ åœ¨å’Œ Dockerfile åŒä¸€ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª build.sh è„šæœ¬ï¼Œç”¨äºæ‰“åŒ…å’Œæ„å»º Docker é•œåƒï¼š\nmvn clean \u0026amp;\u0026amp; mvn package -Dmaven.test.skip=true docker build -t user:latest . å¯åŠ¨é•œåƒå®¹å™¨ docker run -it user:latest --mysql.address=172.20.10.3 --zk.address=172.20.10.3 æ³¨æ„ï¼šæ­¤å¤„ 172.20.10.3 ä¸ºæˆ‘çš„æœ¬æœºåœ°å€ï¼Œå¯é€šè¿‡ ifconfig æŸ¥çœ‹ï¼ˆä¸å¯ä¸º localhost æˆ– 127.0.0.1ï¼Œå› ä¸ºå®¹å™¨ä¸­çš„ç½‘ç»œå’Œæœ¬æœºæ˜¯éš”ç¦»çš„ï¼‰ã€‚\nDocker ä¸‹çš„æœåŠ¡é€šè®¯ Docker å®¹å™¨ä¹‹é—´çš„é€šè®¯æœ‰ä¸‰ç§æ–¹æ³•ï¼š\né€šè¿‡å®¹å™¨çš„ IP å’Œç«¯å£ç›´æ¥è®¿é—®ï¼ˆä¸ç¨³å®šï¼Œå®¹å™¨åœ¨æ¯æ¬¡é‡å¯æ—¶ IP å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼‰ é€šè¿‡ä¸»æœºå’Œå®¹å™¨çš„ç«¯å£æ˜ å°„æ¥è®¿é—® ä½¿ç”¨ Docker çš„ link æœºåˆ¶ï¼Œé€šè¿‡åå­—æ¥è®¿é—® å¯¹äºå¾®æœåŠ¡ä¹‹é—´ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¬¬ 3 ç§æ–¹å¼ï¼›å¯¹äºä¾èµ–çš„åŸºç¡€ç¯å¢ƒï¼Œå¦‚ MySQLã€Zookeeperï¼Œæˆ‘ä»¬ä½¿ç”¨ç¬¬ 2 ç§æ–¹å¼ã€‚\nå»ºç«‹æœåŠ¡ä¹‹é—´çš„ link å…³ç³» åˆ›å»º Docker Compose Compose æ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡ Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ YML æ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» YML æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚\nåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª docker-compose.yml æ–‡ä»¶ï¼Œç¼–è¾‘å¦‚ä¸‹ï¼š\nversion: \u0026#39;1\u0026#39; services: cinema-user: image: cinema-user:latest command: - \u0026#34;--mysql.address=172.20.10.3 --zk.address=172.20.10.3\u0026#34; cinema-film: image: cinema-film:latest command: - \u0026#34;--mysql.address=172.20.10.3 --zk.address=172.20.10.3\u0026#34; cinema-cinema: image: cinema-cinema:latest command: - \u0026#34;--mysql.address=172.20.10.3 --zk.address=172.20.10.3\u0026#34; cinema-order: image: cinema-order:latest command: - \u0026#34;--mysql.address=172.20.10.3 --zk.address=172.20.10.3\u0026#34; links: - cinema-cinema cinema-alipay: image: cinema-alipay:latest command: - \u0026#34;--mysql.address=172.20.10.3 --zk.address=172.20.10.3\u0026#34; links: - cinema-order cinema-gateway: image: cinema-gateway:latest command: - \u0026#34;--mysql.address=172.20.10.3 --zk.address=172.20.10.3\u0026#34; links: - cinema-user - cinema-film - cinema-cinema - cinema-order - cinema-alipay ports: - 8081:8081 å…¶ä¸­ï¼Œservices ä¸ºæ‰€æœ‰éœ€è¦æ„å»ºçš„æœåŠ¡ï¼Œcommand ä¸ºå¯åŠ¨æ—¶æ·»åŠ çš„å‘½ä»¤ï¼Œlinks ä¸ºè¯¥æœåŠ¡ä¾èµ–çš„æœåŠ¡ã€‚\næ‰§è¡Œ docker-compose åœ¨æœ‰ docker-compose.sh çš„ç›®å½•ä¸‹ï¼Œ\nåˆ›å»ºå¹¶è¿è¡Œæ‰€æœ‰å®¹å™¨ï¼š\ndocker-compose up -d å…³é—­å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨ï¼š\ndocker-compose down é•œåƒä»“åº“ ä¸Šä¼ é•œåƒ ç™»å½• Dockerï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¹¶è¾“å…¥ Docker Hub çš„è´¦å·å¯†ç ï¼š\ndocker login å°†ç°æœ‰çš„é•œåƒæ‰“ä¸ª tagï¼š\ndocker tag cinema-user:latest zjxjwxk/cinema-user:latest å°†è¯¥é•œåƒ push åˆ° Docker Hubï¼š\ndocker push zjxjwxk/cinema-user:latest æˆ–æ˜¯å°†é•œåƒä» Docker Hub pull ä¸‹æ¥ï¼š\ndocker pull zjxjwxk/cinema-user:latest ä½¿ç”¨ harbor ä» https://github.com/goharbor/harbor/releases ä¸‹è½½ harbor-offline-installerï¼Œè§£å‹ä¹‹ã€‚\né…ç½® harbor.yml é…ç½®å…¶ç›®å½•ä¸‹çš„ harbor.yml ï¼š\nå°†å…¶ä¸­çš„ hostname ä¸º hub.xxx.comï¼ˆxxx ä¸ºä½ çš„åŸŸåï¼‰ã€‚å°† http çš„ port ä¿®æ”¹ä¸º 8080ï¼ˆç”±äº MacOS 80 ç«¯å£ä¸å¯¹å¤–å¼€æ”¾ï¼‰ã€‚\nå¦‚æœæ˜¯ MacOS ç³»ç»Ÿï¼Œè¿˜éœ€è¦å°†å…¶ä¸­æœ¬æœº host ç›¸å…³çš„ç›®å½•ç”±æ ¹ç›®å½• / æ”¹ä¸º /Users/xxx/ (xxx ä¸ºä½ å½“å‰ç³»ç»Ÿçš„ç”¨æˆ·å)ï¼Œé¿å…æŒ‚è½½æƒé™ä¸è¶³çš„é—®é¢˜ã€‚\n# Configuration file of Harbor # The IP address or hostname to access admin UI and registry service. # DO NOT use localhost or 127.0.0.1, because Harbor needs to be accessed by external clients. hostname: hub.zjxjwxk.com # http related config http: # port for http, default is 80. If https enabled, this port will redirect to https port port: 8080 # https related config #https: # https port for harbor, default is 443 # port: 443 # The path of cert and key files for nginx # certificate: /your/certificate/path # private_key: /your/private/key/path # Uncomment external_url if you want to enable external proxy # And when it enabled the hostname will no longer used # external_url: https://reg.mydomain.com:8433 # The initial password of Harbor admin # It only works in first time to install harbor # Remember Change the admin password from UI after launching Harbor. harbor_admin_password: Harbor12345 # Harbor DB configuration database: # The password for the root user of Harbor DB. Change this before any production use. password: root123 # The maximum number of connections in the idle connection pool. If it \u0026lt;=0, no idle connections are retained. max_idle_conns: 50 # The maximum number of open connections to the database. If it \u0026lt;= 0, then there is no limit on the number of open connections. # Note: the default number of connections is 100 for postgres. max_open_conns: 100 # The default data volume data_volume: /Users/zjxjwxk/data # Harbor Storage settings by default is using /data dir on local filesystem # Uncomment storage_service setting If you want to using external storage # storage_service: # # ca_bundle is the path to the custom root ca certificate, which will be injected into the truststore # # of registry\u0026#39;s and chart repository\u0026#39;s containers. This is usually needed when the user hosts a internal storage with self signed certificate. # ca_bundle: # # storage backend, default is filesystem, options include filesystem, azure, gcs, s3, swift and oss # # for more info about this configuration please refer https://docs.docker.com/registry/configuration/ # filesystem: # maxthreads: 100 # # set disable to true when you want to disable registry redirect # redirect: # disabled: false # Clair configuration clair: # The interval of clair updaters, the unit is hour, set to 0 to disable the updaters. updaters_interval: 12 jobservice: # Maximum number of job workers in job service max_job_workers: 10 notification: # Maximum retry count for webhook job webhook_job_max_retry: 10 chart: # Change the value of absolute_url to enabled can enable absolute url in chart absolute_url: disabled # Log configurations log: # options are debug, info, warning, error, fatal level: info # configs for logs in local storage local: # Log files are rotated log_rotate_count times before being removed. If count is 0, old versions are removed rather than rotated. rotate_count: 50 # Log files are rotated only if they grow bigger than log_rotate_size bytes. If size is followed by k, the size is assumed to be in kilobytes. # If the M is used, the size is in megabytes, and if G is used, the size is in gigabytes. So size 100, size 100k, size 100M and size 100G # are all valid. rotate_size: 200M # The directory on your host that store log location: /Users/zjxjwxk/var/log/harbor # Uncomment following lines to enable external syslog endpoint. # external_endpoint: # # protocol used to transmit log to external endpoint, options is tcp or udp # protocol: tcp # # The host of external endpoint # host: localhost # # Port of external endpoint # port: 5140 #This attribute is for migrator to detect the version of the .cfg file, DO NOT MODIFY! _version: 1.10.0 # Uncomment external_database if using external database. # external_database: # harbor: # host: harbor_db_host # port: harbor_db_port # db_name: harbor_db_name # username: harbor_db_username # password: harbor_db_password # ssl_mode: disable # max_idle_conns: 2 # max_open_conns: 0 # clair: # host: clair_db_host # port: clair_db_port # db_name: clair_db_name # username: clair_db_username # password: clair_db_password # ssl_mode: disable # notary_signer: # host: notary_signer_db_host # port: notary_signer_db_port # db_name: notary_signer_db_name # username: notary_signer_db_username # password: notary_signer_db_password # ssl_mode: disable # notary_server: # host: notary_server_db_host # port: notary_server_db_port # db_name: notary_server_db_name # username: notary_server_db_username # password: notary_server_db_password # ssl_mode: disable # Uncomment external_redis if using external Redis server # external_redis: # host: redis # port: 6379 # password: # # db_index 0 is for core, it\u0026#39;s unchangeable # registry_db_index: 1 # jobservice_db_index: 2 # chartmuseum_db_index: 3 # clair_db_index: 4 # Uncomment uaa for trusting the certificate of uaa instance that is hosted via self-signed cert. # uaa: # ca_file: /path/to/ca # Global proxy # Config http proxy for components, e.g. http://my.proxy.com:3128 # Components doesn\u0026#39;t need to connect to each others via http proxy. # Remove component from `components` array if want disable proxy # for it. If you want use proxy for replication, MUST enable proxy # for core and jobservice, and set `http_proxy` and `https_proxy`. # Add domain to the `no_proxy` field, when you want disable proxy # for some special registry. proxy: http_proxy: https_proxy: # no_proxy endpoints will appended to 127.0.0.1,localhost,.local,.internal,log,db,redis,nginx,core,portal,postgresql,jobservice,registry,registryctl,clair,chartmuseum,notary-server no_proxy: components: - core - jobservice - clair å¯åŠ¨ harbar æ‰§è¡Œ sh install.sh è¿è¡Œ harbarã€‚\nå‡ºç°ä»¥ä¸‹åˆ™è¯´æ˜å¯åŠ¨æˆåŠŸï¼š\n[Step 5]: starting Harbor ... Creating network \u0026#34;harbor_harbor\u0026#34; with the default driver Creating harbor-log ... done Creating redis ... done Creating harbor-portal ... done Creating registryctl ... done Creating harbor-db ... done Creating registry ... done Creating harbor-core ... done Creating nginx ... done Creating harbor-jobservice ... done âœ” ----Harbor has been installed and started successfully.---- è®¿é—® localhost:8080 è¿›å…¥ Harbor UI ç•Œé¢ã€‚é»˜è®¤è´¦å·ä¸º adminï¼Œé»˜è®¤å¯†ç ä¸º harbor.yml ä¸­çš„ harbor_admin_password : Harbor12345ã€‚\n","permalink":"https://zjxjwxk.github.io/posts/docker/docker-+-k8s-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%8C%96/1.-%E6%9C%8D%E5%8A%A1%E7%BC%96%E6%8E%92%E5%89%8D%E5%A5%8F/","summary":"\u003ch1 id=\"æœåŠ¡-docker-åŒ–\"\u003eæœåŠ¡ Docker åŒ–\u003c/h1\u003e\n\u003ch2 id=\"ä¿®æ”¹é¡¹ç›®é…ç½®\"\u003eä¿®æ”¹é¡¹ç›®é…ç½®\u003c/h2\u003e\n\u003cp\u003eç”±äºé•œåƒè¿è¡Œæ—¶ MySQL æ•°æ®åº“æ‰€åœ¨çš„ä¸»æœºåœ°å€æ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥å°†é¡¹ç›®ä¸­çš„ MySQL æ•°æ®åº“åœ°å€å’Œ Zookeeper æ³¨å†Œä¸­å¿ƒåœ°å€é…ç½®ä¸ºåŠ¨æ€å˜é‡ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003espring\u003c/span\u003e: \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003edubbo\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003eregistry\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ezookeeper://${zk.address}:2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\u003cspan style=\"color:#f92672\"\u003edatasource\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\t\t\u003cspan style=\"color:#f92672\"\u003eurl\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ejdbc:mysql://{mysql.address}:3306/cinema?autoReconnect=true\u0026amp;useUnicode=true\u0026amp;characterEncoding=utf8\u0026amp;serverTimezone=GMT%2B8\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"è·å–-java-é•œåƒ\"\u003eè·å– Java é•œåƒ\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker pull openjdk:8-jre\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"æ‰“åŒ…-maven-é¡¹ç›®\"\u003eæ‰“åŒ… Maven é¡¹ç›®\u003c/h2\u003e\n\u003cp\u003eåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œ Maven çš„æ¸…é™¤å’Œæ‰“åŒ…å‘½ä»¤ï¼ˆè·³è¿‡æµ‹è¯•ï¼‰ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emvn clean \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e mvn package -Dmaven.test.skip\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè¿™æ ·å°±ä¼šåœ¨ target ç›®å½•ä¸‹ç”Ÿæˆ jar åŒ…ï¼ˆSpring Boot é¡¹ç›®ï¼‰ã€‚\u003c/p\u003e\n\u003ch2 id=\"ç¼–å†™-dockerfile\"\u003eç¼–å†™ Dockerfile\u003c/h2\u003e\n\u003cp\u003eåœ¨ user å­æ¨¡å—çš„æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»º Dockerfile æ–‡ä»¶ï¼Œå¹¶ç¼–è¾‘å¦‚ä¸‹ï¼ŒDockerfile æ–‡ä»¶ç”¨äºæ„å»º Docker é•œåƒï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-dockerfile\" data-lang=\"dockerfile\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eFROM\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e openjdk:8-jre\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eMAINTAINER\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e zjxjwxk zjxjwxk@gmail.com\u003c/span\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eCOPY\u003c/span\u003e target/user.jar /user.jar\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eENTRYPOINT\u003c/span\u003e [\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;java\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-jar\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;/user.jar\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#960050;background-color:#1e0010\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"æ„å»ºé¡¹ç›®-docker-é•œåƒ\"\u003eæ„å»ºé¡¹ç›® Docker é•œåƒ\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edocker build -t user:latest .\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"ç¼–å†™-build-è„šæœ¬\"\u003eç¼–å†™ build è„šæœ¬\u003c/h2\u003e\n\u003cp\u003eåœ¨å’Œ Dockerfile åŒä¸€ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª build.sh è„šæœ¬ï¼Œç”¨äºæ‰“åŒ…å’Œæ„å»º Docker é•œåƒï¼š\u003c/p\u003e","title":"å¾®æœåŠ¡å®¹å™¨åŒ–ç³»åˆ—ï¼ˆ1ï¼‰ï¼šæœåŠ¡ç¼–æ’å‰å¥"},{"content":"æ¦‚è¦ æ¦‚è¿° æ·±å…¥æ¢ç´¢ MapReduce è¿‡ç¨‹ Hadoop çš„åˆ†å¸ƒå¼ç¼“å­˜ Hadoop åº”ç”¨â€”â€”æ¨èç®—æ³• HDFS HDFS æ˜¯ Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„ç®€ç§°ï¼Œç”±è‹¥å¹²å°è®¡ç®—æœºç»„æˆï¼Œç”¨äºå­˜æ”¾ PBã€TB æ•°é‡çº§ä»¥ä¸Šçš„æ–‡ä»¶ï¼Œæ¯ä»½æ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªå‰¯æœ¬ï¼Œæ‰€ä»¥ HDFS æ˜¯ä¸€ä¸ªå…·æœ‰é«˜å†—ä½™ã€é«˜å®¹é”™çš„æ–‡ä»¶ç³»ç»Ÿã€‚\nHadoop Hadoop 1.x Hadoop 2.x Hadoop 1.0 åˆ° 2.0 çš„å˜åŒ–ï¼šHadoop 2.0 ä»¥åçš„ç‰ˆæœ¬ç§»é™¤äº†åŸæœ‰çš„ JobTracker å’Œ TaskTrackerï¼Œæ”¹ç”± Yarn å¹³å°çš„ ResourceManager è´Ÿè´£é›†ç¾¤ä¸­æ‰€æœ‰èµ„æºçš„ç»Ÿä¸€ç®¡ç†å’Œåˆ†é…ï¼ŒNodeManager ç®¡ç† Hadoop é›†ç¾¤ä¸­å•ä¸ªè®¡ç®—èŠ‚ç‚¹ã€‚\nYARN çš„è®¾è®¡å‡å°äº† JobTracker çš„èµ„æºæ¶ˆè€—ï¼Œå‡å°‘äº† Hadoop 1.0 ä¸­å‘ç”Ÿå•ç‚¹æ•…éšœçš„é£é™©ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨ YARN å¹³å°ä¸Šè¿è¡Œ Spark å’Œ Storm ä½œä¸šï¼Œå……åˆ†åˆ©ç”¨èµ„æºã€‚\næ·±å…¥æ¢ç´¢ MapReduce WordCount å®ä¾‹å›é¡¾ MapReduce ä½œä¸šæ˜¯ä¸€ç§å¤§è§„æ¨¡æ•°æ®é›†çš„å¹¶è¡Œè®¡ç®—çš„ç¼–ç¨‹æ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥å°† HDFS ä¸­å­˜æ”¾çš„æµ·é‡æ•°æ®ï¼Œé€šè¿‡ MapReduce ä½œä¸šè¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°ç›®æ ‡æ•°æ®ã€‚\nå››ä¸ªé˜¶æ®µ Split é˜¶æ®µ Map é˜¶æ®µï¼ˆéœ€è¦ç¼–ç ï¼‰ Shuffle é˜¶æ®µ Reduce é˜¶æ®µï¼ˆéœ€è¦ç¼–ç ï¼‰ Split é˜¶æ®µ Split åˆ†ç‰‡ï¼ˆè®¾ç½®æ–‡ä»¶è¾“å…¥ç±»å‹ä¸º CombineFileInputFormat ï¼Œå°†æ–‡ä»¶åˆå¹¶åå†åˆ†ç‰‡ï¼‰ï¼š\nåˆ†ç‰‡ç»“æœï¼Œåˆ†åˆ«ä½œä¸º Map é˜¶æ®µçš„è¾“å…¥ã€‚\nMap é˜¶æ®µï¼ˆéœ€è¦ç¼–ç ï¼‰ Shuffle é˜¶æ®µ Shuffle é˜¶æ®µè¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå¯ä»¥ç†è§£ä¸º Map è¾“å‡ºåˆ° Reduce è¾“å…¥çš„è¿‡ç¨‹ï¼Œè€Œä¸”æ¶‰åŠåˆ°ç½‘ç»œä¼ è¾“ã€‚\nReduce é˜¶æ®µï¼ˆéœ€è¦ç¼–ç ï¼‰ æ€»è¿‡ç¨‹ ä»åˆ†ç‰‡è¾“å…¥åˆ° Map è¾“å…¥æ–‡ä»¶ æ–‡ä»¶ä¿å­˜åœ¨ DataNode çš„ block å—ä¸­ï¼š\nHadoop 1.x é»˜è®¤çš„ block å¤§å°ï¼š64MB Hadoop 2.x é»˜è®¤çš„ block å¤§å°ï¼š128MB å¯ä»¥åœ¨ hdfs-site.xml ä¸­è®¾ç½®å‚æ•°ï¼šdfs.block.size\nåˆ†ç‰‡è¾“å…¥ï¼ˆSplitï¼‰ ç†æƒ³çš„è¾“å…¥æ–‡ä»¶ï¼šç”±äº NameNode å†…å­˜æœ‰é™ï¼Œå¤§é‡çš„å°æ–‡ä»¶ä¼šç»™ HDFS å¸¦æ¥æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚æ•… HDFS é€‚åˆå­˜æ”¾å¤§æ–‡ä»¶ï¼Œå¯¹äºå¤§é‡å°æ–‡ä»¶ï¼Œå¯ä»¥é‡‡ç”¨å‹ç¼©ã€åˆå¹¶å°æ–‡ä»¶çš„ä¼˜åŒ–ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œè®¾ç½®æ–‡ä»¶è¾“å…¥ç±»å‹ä¸º CombineFileInputFormat æ ¼å¼ã€‚\nèŠ‚ç‚¹ Map ä»»åŠ¡çš„ä¸ªæ•° åœ¨å®é™…æƒ…å†µä¸‹ï¼ŒMap ä»»åŠ¡çš„ä¸ªæ•°æ˜¯å—åˆ°å¤šä¸ªæ¡ä»¶çš„åˆ¶çº¦ï¼Œä¸€èˆ¬ä¸€ä¸ª DataNode çš„ Map ä»»åŠ¡æ•°é‡æ§åˆ¶åœ¨ 10 åˆ° 100 æ¯”è¾ƒåˆé€‚ã€‚\næ§åˆ¶ Map ä»»åŠ¡æ•°é‡çš„æ–¹æ³•ï¼š\nå¢åŠ  Map ä¸ªæ•°ï¼Œå¯å¢å¤§ mapred.map.tasks å‡å°‘ Map ä¸ªæ•°ï¼Œå¯å¢å¤§ mapred.min.split.size å¦‚æœè¦å‡å°‘ Map ä¸ªæ•°ï¼Œä½†æœ‰å¾ˆå¤šå°æ–‡ä»¶ï¼Œå¯å°†å°æ–‡ä»¶åˆå¹¶æˆå¤§æ–‡ä»¶ï¼Œå†ä½¿ç”¨å‡†åˆ™ 2 ","permalink":"https://zjxjwxk.github.io/posts/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/hadoop%E8%BF%9B%E9%98%B6%E7%AF%87/","summary":"\u003ch1 id=\"æ¦‚è¦\"\u003eæ¦‚è¦\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eæ¦‚è¿°\u003c/li\u003e\n\u003cli\u003eæ·±å…¥æ¢ç´¢ MapReduce è¿‡ç¨‹\u003c/li\u003e\n\u003cli\u003eHadoop çš„åˆ†å¸ƒå¼ç¼“å­˜\u003c/li\u003e\n\u003cli\u003eHadoop åº”ç”¨â€”â€”æ¨èç®—æ³•\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"hdfs\"\u003eHDFS\u003c/h1\u003e\n\u003cp\u003eHDFS æ˜¯ Hadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„ç®€ç§°ï¼Œç”±è‹¥å¹²å°è®¡ç®—æœºç»„æˆï¼Œç”¨äºå­˜æ”¾ PBã€TB æ•°é‡çº§ä»¥ä¸Šçš„æ–‡ä»¶ï¼Œæ¯ä»½æ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªå‰¯æœ¬ï¼Œæ‰€ä»¥ HDFS æ˜¯ä¸€ä¸ªå…·æœ‰é«˜å†—ä½™ã€é«˜å®¹é”™çš„æ–‡ä»¶ç³»ç»Ÿã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"HDFSæ¶æ„\" loading=\"lazy\" src=\"/posts/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/hadoop%E8%BF%9B%E9%98%B6%E7%AF%87/images/image-20200508165016013.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"hadoop\"\u003eHadoop\u003c/h1\u003e\n\u003ch2 id=\"hadoop-1x\"\u003eHadoop 1.x\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"Hadoop 1.x\" loading=\"lazy\" src=\"/posts/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/hadoop%E8%BF%9B%E9%98%B6%E7%AF%87/images/image-20200508165127618.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"hadoop-2x\"\u003eHadoop 2.x\u003c/h2\u003e\n\u003cp\u003eHadoop 1.0 åˆ° 2.0 çš„å˜åŒ–ï¼šHadoop 2.0 ä»¥åçš„ç‰ˆæœ¬ç§»é™¤äº†åŸæœ‰çš„ JobTracker å’Œ TaskTrackerï¼Œæ”¹ç”± Yarn å¹³å°çš„ ResourceManager è´Ÿè´£é›†ç¾¤ä¸­æ‰€æœ‰èµ„æºçš„ç»Ÿä¸€ç®¡ç†å’Œåˆ†é…ï¼ŒNodeManager ç®¡ç† Hadoop é›†ç¾¤ä¸­å•ä¸ªè®¡ç®—èŠ‚ç‚¹ã€‚\u003c/p\u003e\n\u003cp\u003eYARN çš„è®¾è®¡å‡å°äº† JobTracker çš„èµ„æºæ¶ˆè€—ï¼Œå‡å°‘äº† Hadoop 1.0 ä¸­å‘ç”Ÿå•ç‚¹æ•…éšœçš„é£é™©ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨ YARN å¹³å°ä¸Šè¿è¡Œ Spark å’Œ Storm ä½œä¸šï¼Œå……åˆ†åˆ©ç”¨èµ„æºã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Hadoop 1.0 =\u0026gt; Hadoop 2.0\" loading=\"lazy\" src=\"/posts/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/hadoop%E8%BF%9B%E9%98%B6%E7%AF%87/images/image-20200508165216140.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"æ·±å…¥æ¢ç´¢-mapreduce\"\u003eæ·±å…¥æ¢ç´¢ MapReduce\u003c/h1\u003e\n\u003ch2 id=\"wordcount-å®ä¾‹å›é¡¾\"\u003eWordCount å®ä¾‹å›é¡¾\u003c/h2\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"/posts/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/hadoop%E8%BF%9B%E9%98%B6%E7%AF%87/images/image-20200508170750118.png\"\u003e\u003c/p\u003e\n\u003cp\u003eMapReduce ä½œä¸šæ˜¯ä¸€ç§å¤§è§„æ¨¡æ•°æ®é›†çš„å¹¶è¡Œè®¡ç®—çš„ç¼–ç¨‹æ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥å°† HDFS ä¸­å­˜æ”¾çš„æµ·é‡æ•°æ®ï¼Œé€šè¿‡ MapReduce ä½œä¸šè¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°ç›®æ ‡æ•°æ®ã€‚\u003c/p\u003e","title":"Hadoop è¿›é˜¶ç¯‡"},{"content":"æ¦‚è¦ å¤§æ•°æ®æŠ€æœ¯çš„ç›¸å…³æ¦‚å¿µ Hadoop çš„æ¶æ„å’Œè¿è¡Œæœºåˆ¶ å®æˆ˜ï¼šHadoop çš„å®‰è£…å’Œé…ç½® å®æˆ˜ï¼šHadoop çš„å¼€å‘ ç›®æ ‡ æŒæ¡å¤§æ•°æ®å­˜å‚¨ä¸å¤„ç†æŠ€æœ¯çš„åŸç†ï¼ˆç†è®ºçŸ¥è¯†ï¼‰ æŒæ¡ Hadoop çš„ä½¿ç”¨å’Œå¼€å‘èƒ½åŠ›ï¼ˆå®è·µèƒ½åŠ›ï¼‰ ç»“åˆä¹¦æœ¬ï¼Œå¦‚ã€ŠHadoop æƒå¨æŒ‡å—ã€‹ Hadoop çš„å‰ä¸–ä»Šç”Ÿ ä¸ºäº†è§£å†³ç³»ç»Ÿå­˜åœ¨çš„ç“¶é¢ˆï¼šå­˜å‚¨å®¹é‡ã€è¯»å†™é€Ÿç‡ã€è®¡ç®—æ•ˆç‡\u0026hellip; Google æå‡ºäº†å¤§æ•°æ®æŠ€æœ¯ï¼šMapReduceã€BigTableã€GFSï¼Œè¿™ä¸‰æ ·æŠ€æœ¯å–å¾—äº†é©å‘½æ€§çš„å˜åŒ–ï¼š\næˆæœ¬é™ä½ï¼Œèƒ½ç”¨ PC æœºï¼Œå°±ä¸ç”¨å¤§å‹æœºå’Œé«˜ç«¯å­˜å‚¨ è½¯ä»¶å®¹é”™ç¡¬ä»¶æ•…éšœè§†ä¸ºå¸¸æ€ï¼Œé€šè¿‡è½¯ä»¶ä¿è¯å¯é æ€§ ç®€åŒ–å¹¶è¡Œåˆ†å¸ƒå¼è®¡ç®—ï¼Œæ— é¡»æ§åˆ¶èŠ‚ç‚¹åŒæ­¥å’Œæ•°æ®äº¤æ¢ ä½†æ˜¯ï¼ŒGoogle åªå‘è¡¨äº†ç›¸å…³çš„æŠ€æœ¯è®ºæ–‡ï¼Œæ²¡æœ‰å¼€æ”¾æºä»£ç ã€‚äºæ˜¯ï¼Œä¸€ä¸ªæ¨¡ä»¿ Google å¤§æ•°æ®æŠ€æœ¯çš„å¼€æºå®ç°å‡ºç°äº†ï¼šHadoopã€‚\nHadoop çš„åŠŸèƒ½å’Œä¼˜åŠ¿ Hadoop æ˜¯å¼€æºçš„åˆ†å¸ƒå¼å­˜å‚¨å’Œåˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ã€‚\nHadoop çš„ç»„æˆ åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š\nHDFSï¼šåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨æµ·é‡çš„æ•°æ® MapReduceï¼šå¹¶è¡Œå¤„ç†æ¡†æ¶ï¼Œå®ç°ä»»åŠ¡åˆ†è§£å’Œè°ƒåº¦ Hadoop å¯ä»¥ç”¨æ¥æ­å»ºå¤§å‹æ•°æ®ä»“åº“ï¼ŒPB çº§æ•°æ®çš„å­˜å‚¨ã€å¤„ç†ã€åˆ†æã€ç»Ÿè®¡ç­‰ä¸šåŠ¡ã€‚å¦‚ï¼šæœç´¢å¼•æ“ã€æ—¥å¿—åˆ†æã€å•†ä¸šæ™ºèƒ½ã€æ•°æ®æŒ–æ˜ã€‚\nHadoop çš„ä¼˜åŠ¿ é«˜æ‰©å±• ä½æˆæœ¬ æˆç†Ÿçš„ç”Ÿæ€åœˆï¼ˆHiveã€HBase ç­‰ï¼‰ Hadoop ç”Ÿæ€ç³»ç»ŸåŠç‰ˆæœ¬ Hadoop ç”Ÿæ€ç³»ç»Ÿ Hiveï¼šåªéœ€è¦ç¼–å†™ SQL è¯­å¥ï¼ŒHive å°±èƒ½å¤Ÿå°†å…¶è½¬åŒ–ä¸ºä¸€ä¸ª Hadoop ä»»åŠ¡å»æ‰§è¡Œï¼Œé™ä½äº†ä½¿ç”¨ Hadoop çš„é—¨æ§›ã€‚\nHBaseï¼šå’Œä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ä¸åŒï¼ŒHBase æ”¾å¼ƒäº‹åŠ¡ç‰¹æ€§ï¼Œè¿½æ±‚æ›´é«˜çš„æ‰©å±•ï¼›å’Œ HDFS ä¸åŒï¼ŒHBase æä¾›æ•°æ®çš„éšæœºè¯»å†™å’Œå®æ—¶è®¿é—®ï¼Œå®ç°å¯¹è¡¨æ•°æ®çš„è¯»å†™åŠŸèƒ½ã€‚\nZooKeeperï¼šç”¨äºç›‘æ§ Hadoop é›†ç¾¤çš„çŠ¶æ€ï¼Œç®¡ç†ä¸€äº›é…ç½®ï¼Œç»´æŠ¤æ•°æ®é—´èŠ‚ç‚¹çš„ä¸€è‡´æ€§ç­‰ã€‚\nHadoop ç‰ˆæœ¬ ver1.xè¾ƒä¸ºç¨³å®šä¸”å®¹æ˜“ä¸Šæ‰‹ï¼Œæœ¬äººå°†é€‰æ‹© ver1.xã€‚\nå®‰è£… Hadoop å‡†å¤‡ Linux ç¯å¢ƒ å®‰è£… JDK é…ç½® Hadoop ä¸‹è½½ Hadoop wget https://archive.apache.org/dist/hadoop/core/hadoop-1.2.1/hadoop-1.2.1.tar.gz å¹¶è§£å‹ä¹‹ã€‚\né…ç½® Hadoop åœ¨ conf ç›®å½•ä¸‹æ‰¾åˆ° hadoop-env.sh è„šæœ¬ï¼Œç¼–è¾‘ä¹‹ï¼Œå°† JAVA_HOME çš„æ³¨é‡Šå»æ‰å¹¶é…ç½®ä¸º Java ç›®å½•ï¼š\nexport JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_201.jdk/Contents/Home é…ç½® core.site.xml æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š\n\u0026lt;configuration\u0026gt; \u0026lt;!-- Hadoop çš„ä¸´æ—¶å·¥ä½œç›®å½• --\u0026gt; \u0026lt;property\u0026gt; \u0026lt;name\u0026gt;hadoop.tmp.dir\u0026lt;/name\u0026gt; \u0026lt;value\u0026gt;/hadoop\u0026lt;/value\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;!-- Hadoop çš„å…ƒæ•°æ®ç›®å½• --\u0026gt; \u0026lt;property\u0026gt; \u0026lt;name\u0026gt;dfs.name.dir\u0026lt;/name\u0026gt; \u0026lt;value\u0026gt;/hadoop/name\u0026lt;/value\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;!-- æ–‡ä»¶ç³»ç»Ÿ namenode çš„è®¿é—®åœ°å€ --\u0026gt; \u0026lt;property\u0026gt; \u0026lt;name\u0026gt;fs.default.name\u0026lt;/name\u0026gt; \u0026lt;value\u0026gt;hdfs://localhost:9000\u0026lt;/value\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/configuration\u0026gt; é…ç½® hdfs-site.xmlï¼š\n\u0026lt;configuration\u0026gt; \u0026lt;!-- dfs æ–‡ä»¶å—çš„å­˜æ”¾ç›®å½•ï¼Œæ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®ç›®å½• --\u0026gt; \u0026lt;property\u0026gt; \u0026lt;name\u0026gt;dfs.data.dir\u0026lt;/name\u0026gt; \u0026lt;value\u0026gt;/hadoop/data\u0026lt;/value\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/configuration\u0026gt; é…ç½® mapred-site.xml\n\u0026lt;configuration\u0026gt; \u0026lt;!-- MapReduce çš„ job tracker è®¿é—®åœ°å€ --\u0026gt; \u0026lt;property\u0026gt; \u0026lt;name\u0026gt;mapred.job.tracker\u0026lt;/name\u0026gt; \u0026lt;value\u0026gt;localhost:9001\u0026lt;/value\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/configuration\u0026gt; é…ç½® Hadoop ç¯å¢ƒå˜é‡ï¼Œç¼–è¾‘ /etc/profileï¼Œæ·»åŠ ä»¥ä¸‹ï¼š\nexport HADOOP_HOME=/Library/hadoop-1.2.1 export PATH=$PATH:$HADOOP_HOME/bin å¯åŠ¨ Hadoop å¯¹ NameNode è¿›è¡Œæ ¼å¼åŒ–æ“ä½œï¼š\nhadoop namenode -format å¯åŠ¨ Hadoopï¼Œæ‰§è¡Œ bin/start-all.sh ï¼Œä½¿ç”¨ jps å‘½ä»¤æŸ¥çœ‹æ˜¯å¦æœ‰ä»¥ä¸‹è¿›ç¨‹ï¼Œè‹¥æœ‰åˆ™è¡¨ç¤º Hadoop å·²æ­£å¸¸è¿è¡Œï¼š\n10690 NameNode 10773 DataNode 10920 JobTracker 10859 SecondaryNameNode 11003 TaskTracker 11101 Jps å¯ä»¥æŸ¥çœ‹ Hadoop ä¸‹æœ‰å“ªäº›æ–‡ä»¶ï¼š\nhadoop fs -ls / Hadoop çš„æ ¸å¿ƒâ€”â€”HDFSç®€ä»‹ HDFS è®¾è®¡æ¶æ„ å—ï¼ˆBlockï¼‰ NameNode DataNode å—ï¼ˆBlockï¼‰ HDFS çš„æ–‡ä»¶è¢«åˆ†æˆå—è¿›è¡Œå­˜å‚¨ï¼Œå—çš„é»˜è®¤å¤§å°ä¸º 64MBï¼Œå—æ˜¯æ–‡ä»¶å­˜å‚¨å¤„ç†çš„é€»è¾‘å•å…ƒã€‚\nèŠ‚ç‚¹ï¼ˆNodeï¼‰ HDFS ä¸­æœ‰ä¸¤ç±»èŠ‚ç‚¹ NameNode å’Œ DataNodeï¼š\nNameNode NameNode æ˜¯ç®¡ç†èŠ‚ç‚¹ï¼Œå­˜æ”¾æ–‡ä»¶å…ƒæ•°æ®ï¼š\næ–‡ä»¶ä¸æ•°æ®å—çš„æ˜ å°„è¡¨ æ•°æ®å—ä¸æ•°æ®èŠ‚ç‚¹çš„æ˜ å°„è¡¨ DataNode DateNode æ˜¯ HDFS çš„å·¥ä½œèŠ‚ç‚¹ï¼Œå­˜æ”¾æ•°æ®å—ï¼š\næ•°æ®ç®¡ç†ç­–ç•¥ å†—ä½™æ•°æ®å— æ¯ä¸ªæ•°æ®å— 3 ä¸ªå‰¯æœ¬ï¼Œåˆ†å¸ƒåœ¨ä¸¤ä¸ªæœºæ¶å†…çš„ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œå­˜å‚¨å†—ä½™æ•°æ®æ˜¯ä¸ºäº†é¢„é˜²æ•°æ®ä¸¢å¤±ã€‚\nå¿ƒè·³æ£€æµ‹ æ¯éš”ä¸€æ®µæ—¶é—´ï¼ŒDataNode å°±åƒ NameNode å‘é€è‡ªå·±çš„çŠ¶æ€ï¼š\näºŒçº§ NameNode äºŒçº§ NameNode å®šæœŸåŒæ­¥å…ƒæ•°æ®æ˜ åƒæ–‡ä»¶å’Œä¿®æ”¹æ—¥å¿—ï¼ŒNameNode å‘ç”Ÿæ•…éšœæ—¶ï¼Œå¤‡èƒè½¬æ­£ï¼Œä»¥ä¿è¯ NameNode çš„é«˜å¯ç”¨æ€§ã€‚\nHDFS ä¸­æ–‡ä»¶çš„è¯»å†™æ“ä½œ HDFS è¯»å–æ–‡ä»¶çš„æµç¨‹ å®¢æˆ·ç«¯ï¼ˆJava ç¨‹åºæˆ–å‘½ä»¤è¡Œï¼‰å‘ NameNode å‘èµ·æ–‡ä»¶è¯»å–è¯·æ±‚ï¼ŒæŠŠæ–‡ä»¶åå’Œè·¯å¾„å‘Šè¯‰ NameNode NameNode æŸ¥è¯¢å…ƒæ•°æ®ï¼Œå¹¶è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å°±çŸ¥é“äº†è¿™ä¸ªæ–‡ä»¶åŒ…å«å“ªäº›å—ï¼Œä»¥åŠè¿™äº›å—åˆ†åˆ«èƒ½åœ¨å“ªäº› DataNode é‡Œæ‰¾åˆ° ç„¶åï¼Œå®¢æˆ·ç«¯å°±èƒ½ä»è¿™äº› DataNode æ‰¾åˆ°è¿™äº›å—ï¼Œå¹¶è¯»å–ä¸‹è½½ï¼Œå†å¯¹å®ƒä»¬è¿›è¡Œç»„è£… HDFS å†™å…¥æ–‡ä»¶çš„æµç¨‹ å®¢æˆ·ç«¯å°†éœ€è¦å†™çš„æ–‡ä»¶æ‹†åˆ†æˆå—ï¼Œå¹¶é€šçŸ¥ NameNode NameNode ä¼šæ‰¾åˆ°å½“å‰å¯ç”¨çš„ç£ç›˜ç©ºé—´ä¸­çš„ DataNodesï¼Œå¹¶è¿”å›ç»™å®¢æˆ·ç«¯ æ ¹æ®è¿”å›çš„ DataNodesï¼Œå®¢æˆ·ç«¯å°†è¿™äº›å—å†™å…¥ DataNodes å®¢æˆ·ç«¯åœ¨å‘ DataNode å†™å…¥ä¸€ä¸ªå—åï¼ŒDataNode å°±è¦é€šè¿‡ç®¡é“è¿›è¡Œæµæ°´çº¿å¤åˆ¶ å¤åˆ¶å®Œä¹‹åï¼Œå°±å¯¹ NameNode æ›´æ–°å…ƒæ•°æ® HDFS çš„ç‰¹ç‚¹ ç‰¹ç‚¹ æ•°æ®å†—ä½™ï¼Œç¡¬ä»¶å®¹é”™ æµå¼çš„æ•°æ®è®¿é—®ï¼ˆå†™ä¸€æ¬¡ï¼Œè¯»å¤šæ¬¡ï¼‰ å­˜å‚¨å¤§æ–‡ä»¶ é€‚ç”¨æ€§å’Œå±€é™æ€§ é€‚åˆæ•°æ®æ‰¹é‡è¯»å†™ï¼Œååº¦é‡é«˜ï¼ˆä½†ä¸é€‚åˆäº¤äº’å¼åº”ç”¨ï¼Œä½å»¶è¿Ÿå¾ˆéš¾æ»¡è¶³ï¼‰ é€‚åˆä¸€æ¬¡å†™å…¥å¤šæ¬¡è¯»å–ï¼Œé¡ºåºè¯»å†™ï¼ˆä½†ä¸æ”¯æŒå¤šç”¨æˆ·å¹¶å‘å†™ç›¸åŒæ–‡ä»¶ï¼‰ HDFS çš„ä½¿ç”¨ æ ¼å¼åŒ– NameNode å…ˆå¯¹ NameNode è¿›è¡Œæ ¼å¼åŒ–æ“ä½œï¼š\nhadoop namenode -format åˆ›å»ºæ–‡ä»¶å¤¹ åœ¨ HDFS ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ inputï¼š\nhadoop fs -mkdir input input æ–‡ä»¶å¤¹å°†ä¼šåœ¨ HDFS ä¸­çš„ /user/root/ ä¸‹\nMacBook-Pro-of-Wxk:~ root# hadoop fs -ls /user/root/input Found 1 items -rw-r--r-- 3 root supergroup 0 2020-05-07 15:26 /user/root/input ä¸Šä¼ æ–‡ä»¶ å°†æœ¬åœ° test.txt æ–‡ä»¶ä¸Šä¼ åˆ° HDFS ä¸­åˆšåˆšåˆ›å»ºçš„ input ä¸­ï¼š\nhadoop fs -put test.txt input/ è¿™æ ·å°±èƒ½åœ¨ /user/root/input/ ä¸‹æ‰¾åˆ°è¯¥æ–‡ä»¶äº†\nMacBook-Pro-of-Wxk:~ root# hadoop fs -ls /user/root/input Found 1 items -rw-r--r-- 3 root supergroup 14 2020-05-07 16:00 /user/root/input/test.txt è¯»å–æ–‡ä»¶ è¾“å‡º HDFS ä¸­çš„æ–‡ä»¶ï¼š\nMacBook-Pro-of-Wxk:~ root# hadoop fs -cat input/test.txt Hello Hadoop! ä¸‹è½½æ–‡ä»¶ ä» HDFS ä¸‹è½½æŒ‡å®šè·¯å¾„ä¸‹çš„æ–‡ä»¶åˆ°æœ¬åœ°ï¼š\nhadoop fs -get input/test.txt test2.txt å³å¯åœ¨æœ¬åœ°æ‰¾åˆ°è¯¥æ–‡ä»¶ï¼š\nMacBook-Pro-of-Wxk:~ root# cat test2.txt Hello Hadoop! æŸ¥çœ‹ NameNode ä¿¡æ¯ MacBook-Pro-of-Wxk:~ root# hadoop dfsadmin -report Configured Capacity: 249531727872 (232.39 GB) Present Capacity: 83015577640 (77.31 GB) DFS Remaining: 83015569408 (77.31 GB) DFS Used: 8232 (8.04 KB) DFS Used%: 0% Under replicated blocks: 2 Blocks with corrupt replicas: 0 Missing blocks: 0 ------------------------------------------------- Datanodes available: 1 (1 total, 0 dead) Name: 127.0.0.1:50010 Decommission Status : Normal Configured Capacity: 249531727872 (232.39 GB) DFS Used: 8232 (8.04 KB) Non DFS Used: 166516150232 (155.08 GB) DFS Remaining: 83015569408(77.31 GB) DFS Used%: 0% DFS Remaining%: 33.27% Last contact: Thu May 07 16:09:02 CST 2020 Hadoop çš„æ ¸å¿ƒâ€”â€”MapReduce åŸç†ä¸å®ç° MapReduce åŸç† åˆ†è€Œæ²»ä¹‹ï¼Œä¸€ä¸ªå¤§ä»»åŠ¡åˆ†æˆå¤šä¸ªå°çš„å­ä»»åŠ¡ï¼ˆmapï¼‰ï¼Œå¹¶è¡Œæ‰§è¡Œåï¼Œåˆå¹¶ç»“æœï¼ˆreduceï¼‰ã€‚\nå‡å¦‚æœ‰ 100 å‰¯æ‰‘å…‹ç‰Œæ··åœ¨äº†ä¸€èµ·ï¼Œå…¶ä¸­å°‘äº†ä¸€å¼ ï¼Œæ€ä¹ˆæ‰¾å‡ºç¼ºå°‘çš„é‚£ä¸€å¼ ï¼Ÿ\nMapï¼šéšæœºåˆ†ä¸º 100 å‰¯æ‰‘å…‹ç‰Œï¼Œå„è‡ªç»Ÿè®¡è¯¥å‰¯ç‰Œæ€»æ¯å¼ ç‰Œçš„å‡ºç°æ¬¡æ•°ã€‚ Reduceï¼šé€šè¿‡äº¤æ¢æ¯å‰¯ç‰Œå„è‡ªç»Ÿè®¡çš„ç»“æœï¼Œå†æ¬¡ç»Ÿè®¡æ€»çš„æ¯å¼ ç‰Œå‡ºç°æ¬¡æ•°ã€‚ä¸€ä¸ª Reduce ç»Ÿè®¡ä¸€å¼ ç‰Œçš„æ€»å‡ºç°æ¬¡æ•°ã€‚ æœ€åå¯¹æ¯å¼ ç‰Œçš„æ€»å‡ºç°æ¬¡æ•°è¿›è¡Œæ’åºï¼Œç­›é€‰å‡ºç»“æœã€‚\nå†å¦‚ï¼š100 GB çš„ç½‘ç«™è®¿é—®æ—¥å¿—æ–‡ä»¶ï¼Œæ‰¾å‡ºè®¿é—®æ¬¡æ•°æœ€å¤šçš„ IP åœ°å€ï¼›SELECT è¡¨æŸ¥è¯¢æ“ä½œã€JOIN è¡¨è¿æ¥æ“ä½œï¼Œéƒ½å¯ä»¥é€šè¿‡ MapReduce æ¥å®ç°ã€‚\nMapReduce çš„è¿è¡Œæµç¨‹ Job \u0026amp; Task JobTracker TaskTracker Job \u0026amp; Task ä¸€ä¸ª Job æ‹†åˆ†ä¸ºå¤šä¸ª Task æ¥è§£å†³ï¼ŒTask åˆåˆ†ä¸º MapTask å’Œ ReduceTaskã€‚\nJobTracker ä½œä¸šè°ƒåº¦ åˆ†é…ä»»åŠ¡ã€ç›‘æ§ä»»åŠ¡æ‰§è¡Œè¿›åº¦ ç›‘æ§ TaskTracker çš„çŠ¶æ€ TaskTracker æ‰§è¡Œä»»åŠ¡ æ±‡æŠ¥ä»»åŠ¡çŠ¶æ€ MapReduce çš„å®¹é”™æœºåˆ¶ é‡å¤æ‰§è¡Œ é‡å¤æ‰§è¡Œå°†ä¼šæœ€å¤šé‡å¤æ‰§è¡Œå››æ¬¡ä»»åŠ¡ï¼Œè‹¥ä»ç„¶å¤±è´¥åˆ™æ”¾å¼ƒæ‰§è¡Œã€‚\næ¨æµ‹æ‰§è¡Œ å½“ JobTracker å‘ç°å…¶ä¸­æŸä¸ª TaskTracker æ‰§è¡Œç‰¹åˆ«æ…¢çš„æ—¶å€™ï¼Œå°±ä¼šå¦å¼€ä¸€ä¸ª TaskTracker æ‰§è¡Œè¯¥ä»»åŠ¡ï¼Œè¿™ä¸¤ä¸ª Task è°å…ˆæ‰§è¡Œå®Œï¼Œåˆ™ç»ˆæ­¢å¦ä¸€ä¸ªã€‚\nå¼€å‘ Hadoop åº”ç”¨ç¨‹åº WordCount å•è¯è®¡æ•° WordCount å•æ¬¡è®¡æ•°ï¼šè®¡ç®—æ–‡ä»¶ä¸­å‡ºç°æ¯ä¸ªå•è¯çš„é¢‘æ•°ï¼Œè¾“å‡ºç»“æœæŒ‰ç…§å­—æ¯é¡ºåºè¿›è¡Œæ’åºã€‚\nMapReduce è¿‡ç¨‹ æºç  package com.zjut; import java.io.IOException; import java.util.StringTokenizer; import org.apache.hadoop.conf.Configuration; import org.apache.hadoop.fs.Path; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.LongWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Job; import org.apache.hadoop.mapreduce.Mapper; import org.apache.hadoop.mapreduce.Reducer; import org.apache.hadoop.mapreduce.lib.input.FileInputFormat; import org.apache.hadoop.mapreduce.lib.input.TextInputFormat; import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat; import org.apache.hadoop.mapreduce.lib.output.TextOutputFormat; /** * @author zjxjwxk */ public class WordCount { public static class WordCountMap extends Mapper\u0026lt;LongWritable, Text, Text, IntWritable\u0026gt; { private final IntWritable one = new IntWritable(1); private Text word = new Text(); @Override public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException { String line = value.toString(); StringTokenizer token = new StringTokenizer(line); while (token.hasMoreTokens()) { word.set(token.nextToken()); context.write(word, one); } } } public static class WordCountReduce extends Reducer\u0026lt;Text, IntWritable, Text, IntWritable\u0026gt; { @Override public void reduce(Text key, Iterable\u0026lt;IntWritable\u0026gt; values, Context context) throws IOException, InterruptedException { int sum = 0; for (IntWritable val : values) { sum += val.get(); } context.write(key, new IntWritable(sum)); } } public static void main(String[] args) throws Exception { Configuration conf = new Configuration(); Job job = new Job(conf); job.setJarByClass(WordCount.class); job.setJobName(\u0026#34;wordcount\u0026#34;); job.setOutputKeyClass(Text.class); job.setOutputValueClass(IntWritable.class); job.setMapperClass(WordCountMap.class); job.setReducerClass(WordCountReduce.class); job.setInputFormatClass(TextInputFormat.class); job.setOutputFormatClass(TextOutputFormat.class); FileInputFormat.addInputPath(job, new Path(args[0])); FileOutputFormat.setOutputPath(job, new Path(args[1])); job.waitForCompletion(true); } } ç¼–è¯‘å’Œæ‰“åŒ… ç¼–è¯‘ï¼ˆæ·»åŠ  classpath ä¾èµ–åŒ…ï¼‰ï¼š\njavac -classpath /Library/hadoop-1.2.1/hadoop-core-1.2.1.jar:/Library/hadoop-1.2.1/lib/commons-cli-1.2.jar -d WordCountClass/ WordCount.java æ‰“åŒ…æ‰€æœ‰ class æ–‡ä»¶ä¸º jar åŒ…ï¼š\njar -cvf WordCount.jar *.class å‡†å¤‡æ–‡ä»¶ åˆ›å»ºä¸€ä¸ª input æ–‡ä»¶å¤¹ï¼Œåœ¨é‡Œé¢æ·»åŠ ä¸¤ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼š\nHello.txt\nHello World Hello Hadoop Hello HDFS Hello Map Hello Reduce Hello2.txt\nHadoop World Hadoop NameNode Hadoop DataNode Hadoop MapReduce Hello BigData ä¸Šä¼ æ–‡ä»¶ åœ¨ HDFS ä¸­åˆ›å»ºä¸€ä¸ª input_wordcount æ–‡ä»¶å¤¹ï¼š\nhadoop fs -mkdir input_wordcount å°†ä¸¤ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸Šä¼ åˆ° HDFSï¼š\nhadoop fs -put input/* input_wordcount/ å¯ä»¥åœ¨ HDFS ä¸­æ‰¾åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼š\nMacBook-Pro-of-Wxk:Project root# hadoop fs -ls input_wordcount Found 2 items -rw-r--r-- 3 root supergroup 59 2020-05-08 13:51 /user/root/input_wordcount/Hello.txt -rw-r--r-- 3 root supergroup 76 2020-05-08 13:51 /user/root/input_wordcount/Hello2.txt æ‰§è¡Œ MapReduce hadoop jar Hadoop/WordCount/WordCountClass/WordCount.jar WordCount input_wordcount output_wordcount hadoop ä¸­æ‰§è¡Œæœ¬åœ° jar åŒ…ï¼Œæœ€åæœ‰ä¸¤ä¸ªå‚æ•° input_wordcount, output_wordcountï¼Œåˆ†åˆ«ä¸ºè¾“å…¥è·¯å¾„å’Œè¾“å‡ºè·¯å¾„ã€‚\næ‰§è¡Œè¿‡ç¨‹å’Œç»“æœï¼š\n20/05/08 13:59:11 WARN mapred.JobClient: Use GenericOptionsParser for parsing the arguments. Applications should implement Tool for the same. 20/05/08 13:59:11 INFO input.FileInputFormat: Total input paths to process : 2 20/05/08 13:59:11 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable 20/05/08 13:59:11 WARN snappy.LoadSnappy: Snappy native library not loaded 20/05/08 13:59:11 INFO mapred.JobClient: Running job: job_202005081303_0001 20/05/08 13:59:12 INFO mapred.JobClient: map 0% reduce 0% 20/05/08 13:59:15 INFO mapred.JobClient: map 100% reduce 0% 20/05/08 13:59:22 INFO mapred.JobClient: map 100% reduce 33% 20/05/08 13:59:23 INFO mapred.JobClient: map 100% reduce 100% 20/05/08 13:59:24 INFO mapred.JobClient: Job complete: job_202005081303_0001 20/05/08 13:59:24 INFO mapred.JobClient: Counters: 26 20/05/08 13:59:24 INFO mapred.JobClient: Map-Reduce Framework 20/05/08 13:59:24 INFO mapred.JobClient: Spilled Records=40 20/05/08 13:59:24 INFO mapred.JobClient: Map output materialized bytes=267 20/05/08 13:59:24 INFO mapred.JobClient: Reduce input records=20 20/05/08 13:59:24 INFO mapred.JobClient: Map input records=10 20/05/08 13:59:24 INFO mapred.JobClient: SPLIT_RAW_BYTES=245 20/05/08 13:59:24 INFO mapred.JobClient: Map output bytes=215 20/05/08 13:59:24 INFO mapred.JobClient: Reduce shuffle bytes=267 20/05/08 13:59:24 INFO mapred.JobClient: Reduce input groups=10 20/05/08 13:59:24 INFO mapred.JobClient: Combine output records=0 20/05/08 13:59:24 INFO mapred.JobClient: Reduce output records=10 20/05/08 13:59:24 INFO mapred.JobClient: Map output records=20 20/05/08 13:59:24 INFO mapred.JobClient: Combine input records=0 20/05/08 13:59:24 INFO mapred.JobClient: Total committed heap usage (bytes)=578813952 20/05/08 13:59:24 INFO mapred.JobClient: File Input Format Counters 20/05/08 13:59:24 INFO mapred.JobClient: Bytes Read=135 20/05/08 13:59:24 INFO mapred.JobClient: FileSystemCounters 20/05/08 13:59:24 INFO mapred.JobClient: HDFS_BYTES_READ=380 20/05/08 13:59:24 INFO mapred.JobClient: FILE_BYTES_WRITTEN=156788 20/05/08 13:59:24 INFO mapred.JobClient: FILE_BYTES_READ=261 20/05/08 13:59:24 INFO mapred.JobClient: HDFS_BYTES_WRITTEN=91 20/05/08 13:59:24 INFO mapred.JobClient: Job Counters 20/05/08 13:59:24 INFO mapred.JobClient: Launched map tasks=2 20/05/08 13:59:24 INFO mapred.JobClient: Launched reduce tasks=1 20/05/08 13:59:24 INFO mapred.JobClient: SLOTS_MILLIS_REDUCES=8065 20/05/08 13:59:24 INFO mapred.JobClient: Total time spent by all reduces waiting after reserving slots (ms)=0 20/05/08 13:59:24 INFO mapred.JobClient: SLOTS_MILLIS_MAPS=4142 20/05/08 13:59:24 INFO mapred.JobClient: Total time spent by all maps waiting after reserving slots (ms)=0 20/05/08 13:59:24 INFO mapred.JobClient: Data-local map tasks=2 20/05/08 13:59:24 INFO mapred.JobClient: File Output Format Counters 20/05/08 13:59:24 INFO mapred.JobClient: Bytes Written=91 æŸ¥çœ‹æ‰§è¡Œç»“æœ MacBook-Pro-of-Wxk:Project root# hadoop fs -ls output_wordcount Found 3 items -rw-r--r-- 3 root supergroup 0 2020-05-08 13:59 /user/root/output_wordcount/_SUCCESS drwxr-xr-x - root supergroup 0 2020-05-08 13:59 /user/root/output_wordcount/_logs -rw-r--r-- 3 root supergroup 91 2020-05-08 13:59 /user/root/output_wordcount/part-r-00000 å…¶ä¸­ï¼Œpart-r-00000 å°±åŒ…å«æ‰§è¡Œçš„ç»“æœï¼Œå³ç»Ÿè®¡äº†ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªå•è¯çš„æ€»ä¸ªæ•°ï¼Œå¹¶ä¸”æŒ‰ç…§å­—å…¸é¡ºåºæ’åºï¼š\nMacBook-Pro-of-Wxk:Project root# hadoop fs -cat output_wordcount/part-r-00000 BigData\t1 DataNode\t1 HDFS\t1 Hadoop\t5 Hello\t6 Map\t1 MapReduce\t1 NameNode\t1 Reduce\t1 World\t2 åˆ©ç”¨ MapReduce è¿›è¡Œæ’åº å°†å¤šä¸ªæ–‡ä»¶ä¸­çš„æ•°å­—æ’åºã€‚\nMapReduce è¿‡ç¨‹ Mapï¼šå°†æ•°æ®åˆ†ç‰‡åï¼Œå°†æ•°å­—æŒ‰ç…§åŒºé—´è¿›è¡Œæ ‡è®°ã€‚ Reduceï¼šå°†æ¯ä¸ªåˆ†åŒºçš„æ•°å­—åˆ†åˆ«è¿›è¡Œæ’åºï¼Œæœ€ååˆå¹¶ã€‚ æºç  import java.io.IOException; import java.util.StringTokenizer; import org.apache.hadoop.conf.Configuration; import org.apache.hadoop.fs.Path; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Job; import org.apache.hadoop.mapreduce.Mapper; import org.apache.hadoop.mapreduce.Reducer; import org.apache.hadoop.mapreduce.Partitioner; import org.apache.hadoop.mapreduce.lib.input.FileInputFormat; import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat; import org.apache.hadoop.util.GenericOptionsParser; public class Sort { public static class Map extends Mapper\u0026lt;Object, Text, IntWritable, IntWritable\u0026gt; { private static IntWritable data = new IntWritable(); public void map(Object key, Text value, Context context) throws IOException, InterruptedException { String line = value.toString(); data.set(Integer.parseInt(line)); context.write(data, new IntWritable(1)); } } public static class Reduce extends Reducer\u0026lt;IntWritable, IntWritable, IntWritable, IntWritable\u0026gt; { private static IntWritable linenum = new IntWritable(1); public void reduce(IntWritable key, Iterable\u0026lt;IntWritable\u0026gt; values, Context context) throws IOException, InterruptedException { for (IntWritable val : values) { context.write(linenum, key); linenum = new IntWritable(linenum.get() + 1); } } } public static class Partition extends Partitioner\u0026lt;IntWritable, IntWritable\u0026gt; { @Override public int getPartition(IntWritable key, IntWritable value, int numPartitions) { int MaxNumber = 65223; int bound = MaxNumber / numPartitions + 1; int keynumber = key.get(); for (int i = 0; i \u0026lt; numPartitions; i++) { if (keynumber \u0026lt; bound * i \u0026amp;\u0026amp; keynumber \u0026gt;= bound * (i - 1)) return i - 1; } return 0; } } /** * @param args */ public static void main(String[] args) throws Exception { // TODO Auto-generated method stub Configuration conf = new Configuration(); String[] otherArgs = new GenericOptionsParser(conf, args) .getRemainingArgs(); if (otherArgs.length != 2) { System.err.println(\u0026#34;Usage Sort \u0026lt;int\u0026gt; \u0026lt;out\u0026gt;\u0026#34;); System.exit(2); } Job job = new Job(conf, \u0026#34;Sort\u0026#34;); job.setJarByClass(Sort.class); job.setMapperClass(Map.class); job.setPartitionerClass(Partition.class); job.setReducerClass(Reduce.class); job.setOutputKeyClass(IntWritable.class); job.setOutputValueClass(IntWritable.class); FileInputFormat.addInputPath(job, new Path(otherArgs[0])); FileOutputFormat.setOutputPath(job, new Path(otherArgs[1])); System.exit(job.waitForCompletion(true) ? 0 : 1); } } ç¼–è¯‘å’Œæ‰“åŒ… ç¼–è¯‘ï¼š\njavac -classpath /Library/hadoop-1.2.1/hadoop-core-1.2.1.jar:/Library/hadoop-1.2.1/lib/commons-cli-1.2.jar -d SortClass/ Sort.java æ‰“åŒ…ï¼š\njar -cvf Sort.jar *.class å‡†å¤‡æ–‡ä»¶ Numbers.txt\n199 3 609 456 789 119 Numbers2.txt\n478 971 988 125 9 3 1 ä¸Šä¼ æ–‡ä»¶ åœ¨ HDFS ä¸­åˆ›å»º input_sort æ–‡ä»¶å¤¹ï¼š\nhadoop fs -mkdir input_sort å°†ä¸¤ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸Šä¼ åˆ° HDFSï¼š\nhadoop fs -put Sort/* input_sort/ æ‰§è¡Œ MapReduce hadoop jar Hadoop/WordCount/WordCountClass/WordCount.jar WordCount input_wordcount output_wordcount æ‰§è¡Œè¿‡ç¨‹å’Œç»“æœï¼š\nMacBook-Pro-of-Wxk:Project root# hadoop jar Hadoop/Sort/SortClass/Sort.jar Sort input_sort output_sort 20/05/08 14:58:36 INFO input.FileInputFormat: Total input paths to process : 2 20/05/08 14:58:36 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable 20/05/08 14:58:36 WARN snappy.LoadSnappy: Snappy native library not loaded 20/05/08 14:58:36 INFO mapred.JobClient: Running job: job_202005081303_0002 20/05/08 14:58:37 INFO mapred.JobClient: map 0% reduce 0% 20/05/08 14:58:40 INFO mapred.JobClient: map 100% reduce 0% 20/05/08 14:58:48 INFO mapred.JobClient: map 100% reduce 100% 20/05/08 14:58:48 INFO mapred.JobClient: Job complete: job_202005081303_0002 20/05/08 14:58:48 INFO mapred.JobClient: Counters: 26 20/05/08 14:58:48 INFO mapred.JobClient: Map-Reduce Framework 20/05/08 14:58:48 INFO mapred.JobClient: Spilled Records=26 20/05/08 14:58:48 INFO mapred.JobClient: Map output materialized bytes=142 20/05/08 14:58:48 INFO mapred.JobClient: Reduce input records=13 20/05/08 14:58:48 INFO mapred.JobClient: Map input records=13 20/05/08 14:58:48 INFO mapred.JobClient: SPLIT_RAW_BYTES=239 20/05/08 14:58:48 INFO mapred.JobClient: Map output bytes=104 20/05/08 14:58:48 INFO mapred.JobClient: Reduce shuffle bytes=142 20/05/08 14:58:48 INFO mapred.JobClient: Reduce input groups=12 20/05/08 14:58:48 INFO mapred.JobClient: Combine output records=0 20/05/08 14:58:48 INFO mapred.JobClient: Reduce output records=13 20/05/08 14:58:48 INFO mapred.JobClient: Map output records=13 20/05/08 14:58:48 INFO mapred.JobClient: Combine input records=0 20/05/08 14:58:48 INFO mapred.JobClient: Total committed heap usage (bytes)=578813952 20/05/08 14:58:48 INFO mapred.JobClient: File Input Format Counters 20/05/08 14:58:48 INFO mapred.JobClient: Bytes Read=44 20/05/08 14:58:48 INFO mapred.JobClient: FileSystemCounters 20/05/08 14:58:48 INFO mapred.JobClient: HDFS_BYTES_READ=283 20/05/08 14:58:48 INFO mapred.JobClient: FILE_BYTES_WRITTEN=156172 20/05/08 14:58:48 INFO mapred.JobClient: FILE_BYTES_READ=136 20/05/08 14:58:48 INFO mapred.JobClient: HDFS_BYTES_WRITTEN=74 20/05/08 14:58:48 INFO mapred.JobClient: Job Counters 20/05/08 14:58:48 INFO mapred.JobClient: Launched map tasks=2 20/05/08 14:58:48 INFO mapred.JobClient: Launched reduce tasks=1 20/05/08 14:58:48 INFO mapred.JobClient: SLOTS_MILLIS_REDUCES=7980 20/05/08 14:58:48 INFO mapred.JobClient: Total time spent by all reduces waiting after reserving slots (ms)=0 20/05/08 14:58:48 INFO mapred.JobClient: SLOTS_MILLIS_MAPS=3902 20/05/08 14:58:48 INFO mapred.JobClient: Total time spent by all maps waiting after reserving slots (ms)=0 20/05/08 14:58:48 INFO mapred.JobClient: Data-local map tasks=2 20/05/08 14:58:48 INFO mapred.JobClient: File Output Format Counters 20/05/08 14:58:48 INFO mapred.JobClient: Bytes Written=74 æŸ¥çœ‹æ‰§è¡Œç»“æœ MacBook-Pro-of-Wxk:Project root# hadoop fs -ls output_sort Found 3 items -rw-r--r-- 3 root supergroup 0 2020-05-08 14:58 /user/root/output_sort/_SUCCESS drwxr-xr-x - root supergroup 0 2020-05-08 14:58 /user/root/output_sort/_logs -rw-r--r-- 3 root supergroup 74 2020-05-08 14:58 /user/root/output_sort/part-r-00000 å…¶ä¸­ï¼Œpart-r-00000 å°±åŒ…å«æ‰§è¡Œçš„ç»“æœï¼Œå³ä¸¤ä¸ªæ–‡ä»¶ä¸­æ‰€æœ‰æ•°å­—ä»å°åˆ°å¤§æ’åºåçš„æ’åå’Œæ•°å­—ã€‚\nMacBook-Pro-of-Wxk:Project root# hadoop fs -cat output_sort/part-r-00000 1\t1 2\t3 3\t3 4\t9 5\t119 6\t125 7\t199 8\t456 9\t478 10\t609 11\t789 12\t971 13\t988 ","permalink":"https://zjxjwxk.github.io/posts/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/hadoop%E5%9F%BA%E7%A1%80%E7%AF%87/","summary":"\u003ch1 id=\"æ¦‚è¦\"\u003eæ¦‚è¦\u003c/h1\u003e\n\u003col\u003e\n\u003cli\u003eå¤§æ•°æ®æŠ€æœ¯çš„ç›¸å…³æ¦‚å¿µ\u003c/li\u003e\n\u003cli\u003eHadoop çš„æ¶æ„å’Œè¿è¡Œæœºåˆ¶\u003c/li\u003e\n\u003cli\u003eå®æˆ˜ï¼šHadoop çš„å®‰è£…å’Œé…ç½®\u003c/li\u003e\n\u003cli\u003eå®æˆ˜ï¼šHadoop çš„å¼€å‘\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch1 id=\"ç›®æ ‡\"\u003eç›®æ ‡\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eæŒæ¡å¤§æ•°æ®å­˜å‚¨ä¸å¤„ç†æŠ€æœ¯çš„åŸç†ï¼ˆç†è®ºçŸ¥è¯†ï¼‰\u003c/li\u003e\n\u003cli\u003eæŒæ¡ Hadoop çš„ä½¿ç”¨å’Œå¼€å‘èƒ½åŠ›ï¼ˆå®è·µèƒ½åŠ›ï¼‰\u003c/li\u003e\n\u003cli\u003eç»“åˆä¹¦æœ¬ï¼Œå¦‚ã€ŠHadoop æƒå¨æŒ‡å—ã€‹\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"hadoop-çš„å‰ä¸–ä»Šç”Ÿ\"\u003eHadoop çš„å‰ä¸–ä»Šç”Ÿ\u003c/h1\u003e\n\u003cp\u003eä¸ºäº†è§£å†³ç³»ç»Ÿå­˜åœ¨çš„ç“¶é¢ˆï¼šå­˜å‚¨å®¹é‡ã€è¯»å†™é€Ÿç‡ã€è®¡ç®—æ•ˆç‡\u0026hellip; Google æå‡ºäº†å¤§æ•°æ®æŠ€æœ¯ï¼šMapReduceã€BigTableã€GFSï¼Œè¿™ä¸‰æ ·æŠ€æœ¯å–å¾—äº†é©å‘½æ€§çš„å˜åŒ–ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eæˆæœ¬é™ä½ï¼Œèƒ½ç”¨ PC æœºï¼Œå°±ä¸ç”¨å¤§å‹æœºå’Œé«˜ç«¯å­˜å‚¨\u003c/li\u003e\n\u003cli\u003eè½¯ä»¶å®¹é”™ç¡¬ä»¶æ•…éšœè§†ä¸ºå¸¸æ€ï¼Œé€šè¿‡è½¯ä»¶ä¿è¯å¯é æ€§\u003c/li\u003e\n\u003cli\u003eç®€åŒ–å¹¶è¡Œåˆ†å¸ƒå¼è®¡ç®—ï¼Œæ— é¡»æ§åˆ¶èŠ‚ç‚¹åŒæ­¥å’Œæ•°æ®äº¤æ¢\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eä½†æ˜¯ï¼ŒGoogle åªå‘è¡¨äº†ç›¸å…³çš„æŠ€æœ¯è®ºæ–‡ï¼Œæ²¡æœ‰å¼€æ”¾æºä»£ç ã€‚äºæ˜¯ï¼Œä¸€ä¸ªæ¨¡ä»¿ Google å¤§æ•°æ®æŠ€æœ¯çš„å¼€æºå®ç°å‡ºç°äº†ï¼šHadoopã€‚\u003c/p\u003e\n\u003ch1 id=\"hadoop-çš„åŠŸèƒ½å’Œä¼˜åŠ¿\"\u003eHadoop çš„åŠŸèƒ½å’Œä¼˜åŠ¿\u003c/h1\u003e\n\u003cp\u003eHadoop æ˜¯å¼€æºçš„åˆ†å¸ƒå¼å­˜å‚¨å’Œåˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ã€‚\u003c/p\u003e\n\u003ch2 id=\"hadoop-çš„ç»„æˆ\"\u003eHadoop çš„ç»„æˆ\u003c/h2\u003e\n\u003cp\u003eåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eHDFSï¼šåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨æµ·é‡çš„æ•°æ®\u003c/li\u003e\n\u003cli\u003eMapReduceï¼šå¹¶è¡Œå¤„ç†æ¡†æ¶ï¼Œå®ç°ä»»åŠ¡åˆ†è§£å’Œè°ƒåº¦\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eHadoop å¯ä»¥ç”¨æ¥æ­å»ºå¤§å‹æ•°æ®ä»“åº“ï¼ŒPB çº§æ•°æ®çš„å­˜å‚¨ã€å¤„ç†ã€åˆ†æã€ç»Ÿè®¡ç­‰ä¸šåŠ¡ã€‚å¦‚ï¼šæœç´¢å¼•æ“ã€æ—¥å¿—åˆ†æã€å•†ä¸šæ™ºèƒ½ã€æ•°æ®æŒ–æ˜ã€‚\u003c/p\u003e\n\u003ch2 id=\"hadoop-çš„ä¼˜åŠ¿\"\u003eHadoop çš„ä¼˜åŠ¿\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eé«˜æ‰©å±•\u003c/li\u003e\n\u003cli\u003eä½æˆæœ¬\u003c/li\u003e\n\u003cli\u003eæˆç†Ÿçš„ç”Ÿæ€åœˆï¼ˆHiveã€HBase ç­‰ï¼‰\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch1 id=\"hadoop-ç”Ÿæ€ç³»ç»ŸåŠç‰ˆæœ¬\"\u003eHadoop ç”Ÿæ€ç³»ç»ŸåŠç‰ˆæœ¬\u003c/h1\u003e\n\u003ch2 id=\"hadoop-ç”Ÿæ€ç³»ç»Ÿ\"\u003eHadoop ç”Ÿæ€ç³»ç»Ÿ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eHiveï¼šåªéœ€è¦ç¼–å†™ SQL è¯­å¥ï¼ŒHive å°±èƒ½å¤Ÿå°†å…¶è½¬åŒ–ä¸ºä¸€ä¸ª Hadoop ä»»åŠ¡å»æ‰§è¡Œï¼Œé™ä½äº†ä½¿ç”¨ Hadoop çš„é—¨æ§›ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eHBaseï¼šå’Œä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ä¸åŒï¼ŒHBase æ”¾å¼ƒäº‹åŠ¡ç‰¹æ€§ï¼Œè¿½æ±‚æ›´é«˜çš„æ‰©å±•ï¼›å’Œ HDFS ä¸åŒï¼ŒHBase æä¾›æ•°æ®çš„éšæœºè¯»å†™å’Œå®æ—¶è®¿é—®ï¼Œå®ç°å¯¹è¡¨æ•°æ®çš„è¯»å†™åŠŸèƒ½ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eZooKeeperï¼šç”¨äºç›‘æ§ Hadoop é›†ç¾¤çš„çŠ¶æ€ï¼Œç®¡ç†ä¸€äº›é…ç½®ï¼Œç»´æŠ¤æ•°æ®é—´èŠ‚ç‚¹çš„ä¸€è‡´æ€§ç­‰ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"hadoop-ç‰ˆæœ¬\"\u003eHadoop ç‰ˆæœ¬\u003c/h2\u003e\n\u003cp\u003ever1.xè¾ƒä¸ºç¨³å®šä¸”å®¹æ˜“ä¸Šæ‰‹ï¼Œæœ¬äººå°†é€‰æ‹© ver1.xã€‚\u003c/p\u003e","title":"Hadoop åŸºç¡€ç¯‡"},{"content":"è¿è¡Œç¯å¢ƒ CentOS 6 äº‘æœåŠ¡å™¨ åˆ›å»ºç”¨æˆ· åˆ›å»ºä¸€ä¸ª cinema ç”¨æˆ·ï¼š\n[root@huawei ~]# useradd cinema [root@huawei ~]# passwd cinema Changing password for user cinema. New password: BAD PASSWORD: it does not contain enough DIFFERENT characters Retype new password: passwd: all authentication tokens updated successfully. ç»™äºˆå…¶æƒé™ï¼Œé¦–å…ˆéœ€è¦èµ‹äºˆå½“å‰ç”¨æˆ·å¯¹ /etc/sudoers çš„å†™æƒé™ï¼Œç„¶ååœ¨ sudoers æ–‡ä»¶ä¸­çš„ root ALL = (ALL) ALL ä¸‹å¢åŠ ä¸€è¡Œï¼Œèµ‹äºˆå…¶åœ¨ä»»ä½•åœ°æ–¹æ‰§è¡Œä»»ä½•å‘½ä»¤çš„æƒé™ï¼š\nchmod u+w /etc/sudoers vim sudoers ## Allow root to run any commands anywhere root ALL=(ALL) ALL cinema ALL=(ALL) ALL æœ€åï¼Œå–æ¶ˆå½“å‰ç”¨æˆ·çš„å†™æƒé™ï¼š\nchmod u-w /etc/sudoers å…³é—­ iptables é˜²ç«å¢™ æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨äº‘æœåŠ¡å™¨æä¾›çš„é˜²ç«å¢™å°±å¤Ÿäº†\nservice iptables stop å¹¶ä¸”å…³é—­å¼€æœºå¯åŠ¨\nchkconfig iptables off å®‰è£…æ•°æ®åº“ ä¸‹è½½å¹¶å®‰è£… MySQL Yum Repositoryï¼ˆMySQL é•œåƒæºï¼‰ï¼š\nwget https://dev.mysql.com/get/mysql80-community-release-el6-3.noarch.rpm sudo yum install mysql80-community-release-el6-3.noarch.rpm éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸï¼š\nls /etc/yum.repos.d/ è‹¥å­˜åœ¨ mysql-community.repo å’Œ mysql-community-source.repoï¼Œåˆ™è¡¨ç¤º MySQL Yum Repository å®‰è£…æˆåŠŸã€‚\næŸ¥çœ‹æ‰€æœ‰ MySQL ç‰ˆæœ¬ï¼š\nyum repolist all | grep mysql ç¦ç”¨æœ€æ–°ç‰ˆï¼Œä½¿ç”¨ 5.7 ç‰ˆæœ¬ï¼š\nsudo yum-config-manager --disable mysql80-community sudo yum-config-manager --enable mysql57-community å®‰è£… MySQLï¼š\nsudo yum install mysql-community-server å¼€å¯ MySQL æœåŠ¡ï¼š\nsudo service mysqld start æŸ¥çœ‹ MySQL åˆå§‹å¯†ç ï¼š\nsudo grep \u0026#34;password\u0026#34; /var/log/mysqld.log åˆ©ç”¨åˆå§‹å¯†ç ç™»å½•æ•°æ®åº“ï¼š\nmysql -uroot -p ä¿®æ”¹åˆå§‹å¯†ç ï¼š\nset password for \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39; = password(\u0026#39;Zjxjwxk19981018_\u0026#39;); æŸ¥çœ‹å½“å‰æœ‰å“ªäº›ç”¨æˆ·ï¼š\nmysql\u0026gt; select host, user from mysql.user; +---------+---------------+ | host | user | +-------- +---------------+ | localhost | mysql.session | | localhost | mysql.sys | | localhost | root | +-----------+-------------+ ä¿®æ”¹ root ç”¨æˆ·è®¿é—®æƒé™ï¼Œä½¿å¾—å…¶å¯ä»¥è¢«è¿œç¨‹è®¿é—®ï¼š\nUPDATE mysql.user SET host = \u0026#39;%\u0026#39; WHERE user = \u0026#39;root\u0026#39; and host = \u0026#39;localhost\u0026#39;; ä¿®æ”¹åé‡å¯ MySQLï¼š\nsudo service mysqld restart å®‰è£… vsftpd é˜¿é‡Œäº‘æ–‡æ¡£ï¼šhttps://help.aliyun.com/knowledge_detail/60152.html\nå®‰è£… JDK å’Œ Zookeeper å®‰è£… JDK åœ¨æœ¬åœ°ä¸Šï¼Œä» Oracle å®˜ç½‘ä¸‹è½½ jdk çš„ tar.gz åŒ… https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html ï¼Œå¹¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼š\nsudo scp jdk-8u251-linux-x64.tar.gz cinema@34.80.107.207:~/install/ å¦‚æœ scp å‡ºç° Permission denied (publickey,gssapi-keyex,gssapi-with-mic). ï¼Œåˆ™å¯èƒ½éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šè®¾ç½®å¯†ç ç™»å½•ä¸º yesï¼š\nsudo vim /etc/ssh/sshd_config å°† PasswordAuthentication no ä¸­çš„ â€œnoâ€ æ”¹ä¸º \u0026ldquo;yes\u0026rdquo;ã€‚\nåœ¨æœåŠ¡å™¨è§£å‹ï¼š\ntar -zxvf jdk-8u251-linux-x64.tar.gz æ·»åŠ  JAVA_HOME ç¯å¢ƒå˜é‡ï¼š\nvim /etc/profile æ·»åŠ ä»¥ä¸‹å‡ è¡Œï¼š\n## JAVA_HOME export JAVA_HOME=/developer/jdk1.8.0_251 export PATH=$PATH:$JAVA_HOME/bin ç”Ÿæ•ˆç¯å¢ƒå˜é‡ï¼š\nsource /etc/profile å®‰è£… Zookeeper ä» Apache Zookeeper å®˜ç½‘è·å– tar.gz åŒ…ï¼š\nwget https://mirror.bit.edu.cn/apache/zookeeper/zookeeper-3.4.14/zookeeper-3.4.14.tar.gz åŒæ ·ï¼Œè§£å‹ä¹‹ï¼š\ntar -zxvf zookeeper-3.4.14.tar.gz é‡å‘½å zoo_sample.cfg ä¸º zoo.cfgï¼š\nmv zookeeper-3.4.14/conf/zoo_sample.cfg zoo.cfg å¯åŠ¨ Zookeeperï¼š\nsh zookeeper-3.4.14/bin/zkServer.sh start æŸ¥çœ‹æœåŠ¡è¿›ç¨‹ï¼š\nps -ef | grep zookeeper æ•°æ®åˆå§‹åŒ–ã€å·¥ç¨‹æ‰“åŒ…å’Œéƒ¨ç½² å°†å„ä¸ªæ¨¡å—çš„ application.yml é…ç½®ä¸ºçº¿ä¸Šç¯å¢ƒï¼ŒåŒ…æ‹¬æ•°æ®åº“å’Œ FTP æœåŠ¡å™¨çš„åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ç­‰ã€‚ç„¶åç›´æ¥å¯¹çˆ¶æ¨¡å—ä½¿ç”¨ maven clean å’Œ package æ‰“åŒ…å„ä¸ªæ¨¡å—ä¸º jar åŒ…ï¼Œå‘é€åˆ°æœåŠ¡å™¨ä¸Šéƒ¨ç½²è¿è¡Œå³å¯ï¼ˆjar åŒ…åå°è¿è¡Œå’Œæ—¥å¿—è¾“å‡ºé‡å®šå‘è§ [CentOS jaråŒ…åå°è¿è¡Œ](https://zjxjwxk.com/2019/01/30/Linux/CentOS/CentOS jaråŒ…åå°è¿è¡Œ/)ï¼‰ã€‚å½“ç„¶ï¼Œè¿™é‡Œæ˜¯ä¸€ç§æ¯”è¾ƒ low çš„éƒ¨ç½²æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡ Jenkinsï¼Œk8s ç­‰è¿›è¡ŒæŒç»­é›†æˆã€‚\nå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸï¼š\nps -ef | grep xxx æˆ–è€… jobs å®‰è£… OpenResty å®‰è£…å‰çš„å‡†å¤‡ æ‚¨å¿…é¡»å°†è¿™äº›åº“ perl 5.6.1+, libpcre, libsslå®‰è£…åœ¨æ‚¨çš„ç”µè„‘ä¹‹ä¸­ã€‚ å¯¹äº Linuxæ¥è¯´, æ‚¨éœ€è¦ç¡®è®¤ä½¿ç”¨ ldconfig å‘½ä»¤ï¼Œè®©å…¶åœ¨æ‚¨çš„ç³»ç»Ÿç¯å¢ƒè·¯å¾„ä¸­èƒ½æ‰¾åˆ°å®ƒä»¬ã€‚\nFedora å’Œ RedHat ç”¨æˆ· æ¨èæ‚¨ä½¿ç”¨yumå®‰è£…ä»¥ä¸‹çš„å¼€å‘åº“:\nyum install pcre-devel openssl-devel gcc curl æ„å»º OpenResty ä¸‹è½½ ä»ä¸‹è½½é¡µ Downloadä¸‹è½½æœ€æ–°çš„ OpenRestyÂ® æºç åŒ…ï¼Œå¹¶ä¸”åƒä¸‹é¢çš„ç¤ºä¾‹ä¸€æ ·å°†å…¶è§£å‹:\ntar -xzvf openresty-VERSION.tar.gz VERSION çš„åœ°æ–¹æ›¿æ¢æˆæ‚¨ä¸‹è½½çš„æºç åŒ…çš„ç‰ˆæœ¬å·ï¼Œæ¯”å¦‚è¯´ 0.8.54.6ã€‚\n./configure ç„¶ååœ¨è¿›å…¥ openresty-VERSION/ ç›®å½•, ç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤é…ç½®:\n./configure é»˜è®¤, --prefix=/usr/local/openresty ç¨‹åºä¼šè¢«å®‰è£…åˆ°/usr/local/openrestyç›®å½•ã€‚\næ‚¨å¯ä»¥æŒ‡å®šå„ç§é€‰é¡¹ï¼Œæ¯”å¦‚\n./configure --prefix=/developer/openresty \\ --with-luajit \\ --without-http_redis2_module \\ --with-http_iconv_module è¯•ç€ä½¿ç”¨ ./configure --help æŸ¥çœ‹æ›´å¤šçš„é€‰é¡¹ã€‚\né…ç½®æ–‡ä»¶ï¼ˆ./configure scriptï¼‰è¿è¡Œå‡ºé”™å¯ä»¥åˆ° build/nginx-VERSION/objs/autoconf.err æ‰¾åˆ°ã€‚ VERSION çš„åœ°æ–¹å¿…é¡»ä¸OpenRestyç‰ˆæœ¬å·ç›¸å¯¹åº”, æ¯”å¦‚ 0.8.54.6ã€‚\néœ€è¦é¢å¤–å®‰è£… postersql-devel\nsudo yum install -y postgresql-devel make æ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥ç¼–è¯‘ï¼š\nmake å¦‚æœæ‚¨çš„ç”µè„‘æ”¯æŒå¤šæ ¸ make å·¥ä½œçš„ç‰¹æ€§, æ‚¨å¯ä»¥è¿™æ ·ç¼–è¯‘:\nmake -j2 å‡è®¾æ‚¨æ˜¯çš„æœºå™¨æ˜¯åŒæ ¸ã€‚\nmake install å¦‚æœå‰é¢çš„æ­¥éª¤éƒ½æ²¡æœ‰é—®é¢˜çš„è¯,æ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å®‰è£… OpenResty åˆ°æ‚¨çš„ç³»ç»Ÿä¸­ï¼š\nmake install åœ¨ Linux ä¸Šï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨ sudo æ¥è·å– root æƒé™æ¥å®Œæˆå®‰è£…ã€‚\nå¦‚æœåœ¨ prefix ç›®å½•æœ‰äº† openresty ç›®å½•ï¼Œè¿™ä»£è¡¨å®‰è£…å®Œæˆã€‚\né…ç½® Nginx ç¼–è¾‘ Nginx çš„ nginx.conf\nvim openresty/nginx/conf/nginx.conf åœ¨å…¶ä¸­å¯ç”¨ï¼ˆå»æ‰æ³¨é‡Šï¼‰ error_log, pid, http ä¸­çš„ log_format å’Œ access_logã€‚\nåœ¨ http çš„ server ä¸­ï¼Œå»æ‰ access_log çš„æ³¨é‡Šï¼ˆå…¨å±€ä¹Ÿæœ‰ä¸€ä¸ª access_logï¼Œå±€éƒ¨ä¼˜å…ˆï¼‰ï¼Œå¹¶ç»™ server_name æ·»åŠ åŸŸåï¼Œå°† location / ä¸­ä¿®æ”¹ä¸º proxy_pass http://127.0.0.1:8081 ï¼ˆæ­¤å¤„ä¸ºæˆ‘çš„ gateway ç½‘å…³æ¨¡å—è¿è¡Œç«¯å£ï¼‰ï¼Œå³ä»£ç†è®¿é—® gateway æœåŠ¡ã€‚FTP æœåŠ¡å™¨ä»£ç†åˆ™ä¸º root /ftpfile/ ã€‚\n#user nobody; worker_processes 1; error_log logs/error.log; #error_log logs/error.log notice; #error_log logs/error.log info; pid logs/nginx.pid; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; log_format main \u0026#39;$remote_addr - $remote_user [$time_local] \u0026#34;$request\u0026#34; \u0026#39; \u0026#39;$status $body_bytes_sent \u0026#34;$http_referer\u0026#34; \u0026#39; \u0026#39;\u0026#34;$http_user_agent\u0026#34; \u0026#34;$http_x_forwarded_for\u0026#34;\u0026#39;; access_log logs/access.log main; sendfile on; #tcp_nopush on; #keepalive_timeout 0; keepalive_timeout 65; #gzip on; server { listen 80; server_name localhost www.cinema.zjxjwxk.com cinema.zjxjwxk.com #charset koi8-r; access_log logs/host.access.log main; location / { proxy_pass http://127.0.0.1:8081 } #error_page 404 /404.html; # redirect server error pages to the static page /50x.html # error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } # proxy the PHP scripts to Apache listening on 127.0.0.1:80 # #location ~ \\.php$ { # proxy_pass http://127.0.0.1; #} # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # #location ~ \\.php$ { # root html; # fastcgi_pass 127.0.0.1:9000; # fastcgi_index index.php; # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name; # include fastcgi_params; #} # deny access to .htaccess files, if Apache\u0026#39;s document root # concurs with nginx\u0026#39;s one # #location ~ /\\.ht { # deny all; #} } # another virtual host using mix of IP-, name-, and port-based configuration # # vsftpd FTP server #server { # listen 80; # server_name localhost img-cinema.zjxjwxk.com; # location / { # root /ftpfile/; # } #} # HTTPS server # #server { # listen 443 ssl; # server_name localhost; # ssl_certificate cert.pem; # ssl_certificate_key cert.key; # ssl_session_cache shared:SSL:1m; # ssl_session_timeout 5m; # ssl_ciphers HIGH:!aNULL:!MD5; # ssl_prefer_server_ciphers on; # location / { # root html; # index index.html index.htm; # } #} } åœ¨ sbin ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é…ç½®æ˜¯å¦åˆæ³•\nsudo ./nginx -t è¿è¡Œ nginx\n./nginx éªŒè¯æ˜¯å¦è¿è¡ŒæˆåŠŸ\nnetstat -nlp | grep \u0026#34;nginx\u0026#34; ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/12.%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2/","summary":"\u003ch1 id=\"è¿è¡Œç¯å¢ƒ\"\u003eè¿è¡Œç¯å¢ƒ\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eCentOS 6\u003c/li\u003e\n\u003cli\u003eäº‘æœåŠ¡å™¨\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"åˆ›å»ºç”¨æˆ·\"\u003eåˆ›å»ºç”¨æˆ·\u003c/h1\u003e\n\u003cp\u003eåˆ›å»ºä¸€ä¸ª cinema ç”¨æˆ·ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eroot@huawei ~\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# useradd cinema\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eroot@huawei ~\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e# passwd cinema\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eChanging password \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e user cinema.\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eNew password: \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eBAD PASSWORD: it does not contain enough DIFFERENT characters\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRetype new password: \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epasswd: all authentication tokens updated successfully.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eç»™äºˆå…¶æƒé™ï¼Œé¦–å…ˆéœ€è¦èµ‹äºˆå½“å‰ç”¨æˆ·å¯¹ /etc/sudoers çš„å†™æƒé™ï¼Œç„¶ååœ¨ sudoers æ–‡ä»¶ä¸­çš„ root ALL = (ALL) ALL ä¸‹å¢åŠ ä¸€è¡Œï¼Œèµ‹äºˆå…¶åœ¨ä»»ä½•åœ°æ–¹æ‰§è¡Œä»»ä½•å‘½ä»¤çš„æƒé™ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003echmod u+w /etc/sudoers\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evim sudoers\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e## Allow root to run any commands anywhere \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eroot    ALL\u003cspan style=\"color:#f92672\"\u003e=(\u003c/span\u003eALL\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e       ALL\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecinema  ALL\u003cspan style=\"color:#f92672\"\u003e=(\u003c/span\u003eALL\u003cspan style=\"color:#f92672\"\u003e)\u003c/span\u003e       ALL\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæœ€åï¼Œå–æ¶ˆå½“å‰ç”¨æˆ·çš„å†™æƒé™ï¼š\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ12ï¼‰ï¼šç³»ç»Ÿéƒ¨ç½²"},{"content":"æ–¹æ³•1ï¼ˆæš‚æ—¶ï¼‰: åœ¨ç»ˆç«¯ä¸­ç›´æ¥è¿è¡Œå‘½ä»¤\nexport http_proxy=http://proxyAddres.s:port è¿™ä¸ªåŠæ³•çš„å¥½å¤„æ˜¯ç®€å•ç›´æ¥ï¼Œå¹¶ä¸”å½±å“é¢å¾ˆå°ï¼ˆåªå¯¹å½“å‰ç»ˆç«¯æœ‰æ•ˆï¼Œé€€å‡ºå°±ä¸è¡Œäº†ï¼‰ã€‚\nå¦‚æœä½ ç”¨çš„æ˜¯ s.s ä»£ç†ï¼Œåœ¨å½“å‰ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé‚£ä¹ˆwget curl è¿™ç±»ç½‘ç»œå‘½ä»¤éƒ½ä¼šç»è¿‡ s.s ä»£ç†ï¼Œport ç«¯å£å·å¯ä»¥ä» s.s é«˜çº§è®¾ç½®ä¸­æŸ¥çœ‹ï¼Œæˆ‘çš„æ˜¯1086ã€‚\nexport ALL_PROXY=socks5://127.0.0.1:1086 å®‰è£…å®Œè½¯ä»¶ä»¥åï¼Œæˆ‘ä»¬å†æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å–æ¶ˆç»ˆç«¯ä»£ç†\nunset ALL_PROXY æ–¹æ³•2ï¼ˆæ°¸ä¹…ï¼‰: æŠŠä»£ç†æœåŠ¡å™¨åœ°å€å†™å…¥ shell é…ç½®æ–‡ä»¶.bashrcæˆ–è€….zshrc\nç›´æ¥åœ¨.bashrcæˆ–è€….zshrcæ·»åŠ ä¸‹é¢å†…å®¹\nexport http_proxy=\u0026#34;http://localhost:port\u0026#34; export https_proxy=\u0026#34;http://localhost:port\u0026#34; ä»¥ä½¿ç”¨ s.s ä»£ç†ä¸ºä¾‹ï¼Œs.s çš„ä»£ç†ç«¯å£ä¸º1086,é‚£ä¹ˆåº”è¯¥è®¾ç½®ä¸º\nexport http_proxy=\u0026#34;socks5://127.0.0.1:1086\u0026#34; export https_proxy=\u0026#34;socks5://127.0.0.1:1086\u0026#34; æˆ–è€…ç›´æ¥è®¾ç½® ALL_PROXY\nexport ALL_PROXY=socks5://127.0.0.1:1086 localhostå°±æ˜¯ä¸€ä¸ªåŸŸåï¼ŒåŸŸåé»˜è®¤æŒ‡å‘ 127.0.0.1ï¼Œä¸¤è€…æ˜¯ä¸€æ ·çš„ã€‚\nç„¶åESCå:wqä¿å­˜æ–‡ä»¶ï¼Œæ¥ç€åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œsource ~/.bashrc\nè¿™ä¸ªåŠæ³•çš„å¥½å¤„æ˜¯æŠŠä»£ç†æœåŠ¡å™¨æ°¸ä¹…ä¿å­˜äº†ï¼Œä¸‹æ¬¡å°±å¯ä»¥ç›´æ¥ç”¨äº†ã€‚\næˆ–è€…é€šè¿‡è®¾ç½® alias ç®€å†™æ¥ç®€åŒ–æ“ä½œï¼Œæ¯æ¬¡è¦ç”¨çš„æ—¶å€™è¾“å…¥setproxyï¼Œä¸ç”¨äº†å°±unsetproxyã€‚\nalias setproxy=\u0026#34;export ALL_PROXY=socks5://127.0.0.1:1086\u0026#34; alias unsetproxy=\u0026#34;unset ALL_PROXY\u0026#34; Git ä»£ç† git è®¾ç½®å…¨å±€ä»£ç†ï¼š\ngit config --global http.proxy \u0026#39;socks5://127.0.0.1:1086\u0026#39; git config --global https.proxy \u0026#39;socks5://127.0.0.1:1086\u0026#39; git ä»…é’ˆå¯¹ GitHub çš„å•ç‹¬é…ç½®ï¼š\ngit config --global http.https://github.com.proxy \u0026#39;socks5://127.0.0.1:1086\u0026#39; git å–æ¶ˆå…¨å±€ä»£ç†ï¼Œåªéœ€åŠ ä¸ª \u0026ndash;unsetï¼Œå•ç‹¬é…ç½®åŒç†ï¼š\ngit config --global --unset http.proxy \u0026#39;socks5://127.0.0.1:1086\u0026#39; git config --global --unset https.proxy \u0026#39;socks5://127.0.0.1:1086\u0026#39; ","permalink":"https://zjxjwxk.github.io/posts/linux/macos/","summary":"\u003ch1 id=\"æ–¹æ³•1æš‚æ—¶\"\u003eæ–¹æ³•1ï¼ˆæš‚æ—¶ï¼‰:\u003c/h1\u003e\n\u003cp\u003eåœ¨ç»ˆç«¯ä¸­ç›´æ¥è¿è¡Œå‘½ä»¤\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport http_proxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ehttp://proxyAddres.s:port\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè¿™ä¸ªåŠæ³•çš„å¥½å¤„æ˜¯ç®€å•ç›´æ¥ï¼Œå¹¶ä¸”å½±å“é¢å¾ˆå°ï¼ˆåªå¯¹å½“å‰ç»ˆç«¯æœ‰æ•ˆï¼Œé€€å‡ºå°±ä¸è¡Œäº†ï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003eå¦‚æœä½ ç”¨çš„æ˜¯ s.s ä»£ç†ï¼Œåœ¨å½“å‰ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé‚£ä¹ˆ\u003ccode\u003ewget\u003c/code\u003e \u003ccode\u003ecurl\u003c/code\u003e è¿™ç±»ç½‘ç»œå‘½ä»¤éƒ½ä¼šç»è¿‡ s.s ä»£ç†ï¼Œport ç«¯å£å·å¯ä»¥ä» s.s é«˜çº§è®¾ç½®ä¸­æŸ¥çœ‹ï¼Œæˆ‘çš„æ˜¯1086ã€‚\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport ALL_PROXY\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esocks5://127.0.0.1:1086\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg alt=\"s.sç«¯å£\" loading=\"lazy\" src=\"/posts/linux/macos/images/image-20200426235228770.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå®‰è£…å®Œè½¯ä»¶ä»¥åï¼Œæˆ‘ä»¬å†æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å–æ¶ˆç»ˆç«¯ä»£ç†\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eunset ALL_PROXY\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch1 id=\"æ–¹æ³•2æ°¸ä¹…\"\u003eæ–¹æ³•2ï¼ˆæ°¸ä¹…ï¼‰:\u003c/h1\u003e\n\u003cp\u003eæŠŠä»£ç†æœåŠ¡å™¨åœ°å€å†™å…¥ shell é…ç½®æ–‡ä»¶\u003ccode\u003e.bashrc\u003c/code\u003eæˆ–è€…\u003ccode\u003e.zshrc\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eç›´æ¥åœ¨\u003ccode\u003e.bashrc\u003c/code\u003eæˆ–è€…\u003ccode\u003e.zshrc\u003c/code\u003eæ·»åŠ ä¸‹é¢å†…å®¹\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport http_proxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;http://localhost:port\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport https_proxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;http://localhost:port\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eä»¥ä½¿ç”¨ s.s ä»£ç†ä¸ºä¾‹ï¼Œs.s çš„ä»£ç†ç«¯å£ä¸º\u003ccode\u003e1086\u003c/code\u003e,é‚£ä¹ˆåº”è¯¥è®¾ç½®ä¸º\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport http_proxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;socks5://127.0.0.1:1086\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport https_proxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;socks5://127.0.0.1:1086\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæˆ–è€…ç›´æ¥è®¾ç½® ALL_PROXY\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport ALL_PROXY\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esocks5://127.0.0.1:1086\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003elocalhost\u003c/code\u003eå°±æ˜¯ä¸€ä¸ªåŸŸåï¼ŒåŸŸåé»˜è®¤æŒ‡å‘ \u003ccode\u003e127.0.0.1\u003c/code\u003eï¼Œä¸¤è€…æ˜¯ä¸€æ ·çš„ã€‚\u003c/p\u003e\n\u003cp\u003eç„¶å\u003ccode\u003eESC\u003c/code\u003eå\u003ccode\u003e:wq\u003c/code\u003eä¿å­˜æ–‡ä»¶ï¼Œæ¥ç€åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ\u003ccode\u003esource ~/.bashrc\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eè¿™ä¸ªåŠæ³•çš„å¥½å¤„æ˜¯æŠŠä»£ç†æœåŠ¡å™¨æ°¸ä¹…ä¿å­˜äº†ï¼Œä¸‹æ¬¡å°±å¯ä»¥ç›´æ¥ç”¨äº†ã€‚\u003c/p\u003e\n\u003cp\u003eæˆ–è€…é€šè¿‡è®¾ç½® alias ç®€å†™æ¥ç®€åŒ–æ“ä½œï¼Œæ¯æ¬¡è¦ç”¨çš„æ—¶å€™è¾“å…¥\u003ccode\u003esetproxy\u003c/code\u003eï¼Œä¸ç”¨äº†å°±\u003ccode\u003eunsetproxy\u003c/code\u003eã€‚\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ealias setproxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;export ALL_PROXY=socks5://127.0.0.1:1086\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ealias unsetproxy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;unset ALL_PROXY\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch1 id=\"git-ä»£ç†\"\u003eGit ä»£ç†\u003c/h1\u003e\n\u003cp\u003egit è®¾ç½®å…¨å±€ä»£ç†ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit config --global http.proxy \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;socks5://127.0.0.1:1086\u0026#39;\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit config --global https.proxy \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;socks5://127.0.0.1:1086\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003egit ä»…é’ˆå¯¹ GitHub çš„å•ç‹¬é…ç½®ï¼š\u003c/p\u003e","title":"Terminal ç»ˆç«¯ä»£ç†åŠ é€Ÿ"},{"content":"ç« èŠ‚æ¦‚è¦ äº†è§£ Dubbo ç›‘æ§ç›¸å…³å†…å®¹ ç†Ÿç»ƒæŒæ¡ Dubbo-admin ä½¿ç”¨ ç†Ÿç»ƒæŒæ¡é“¾è·¯ç›‘æ§ å®Œæˆä¸šåŠ¡ç³»ç»Ÿéƒ¨ç½² Dubbo-monitor æºç ä¸‹è½½å’Œæ‰“åŒ… ç›®å‰ï¼Œè¿˜å¯ä»¥ä»å½“å½“ç½‘çš„é¡¹ç›® Dubbox ä¸­è·å–ï¼ˆå¾ˆä¹…æ²¡æœ‰ç»´æŠ¤äº†ï¼‰ï¼šhttps://github.com/dangdangdotcom/dubbox ï¼Œåœ¨é¡¹ç›®ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ‰“åŒ…å¹¶æ‹·è´åˆ°æœ¬åœ°ä»“åº“ï¼ˆè·³è¿‡å•å…ƒæµ‹è¯•ï¼‰ï¼š\nmvn package -Dmaven.test.skip=true å…¶ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ° Missing artifact com.alibaba:dubbo:jar:2.8.4 çš„å‘ï¼Œéœ€è¦åœ¨æ ¹é¡¹ç›®çš„ pom.xml æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ maven æ’ä»¶ï¼š\nè¿™æ ·åœ¨æœ¬åœ°ä»“åº“å°±æœ‰äº† ~/.m2/repository/com/alibaba/dubbo-monitor-simple/2.8.4/dubbo-monitor-simple-2.8.4-assembly.tar.gz è¿™ä¸ª tar.gz åŒ…ï¼Œè§£å‹å®ƒå¯ä»¥å¾—åˆ°ä»¥ä¸‹æ–‡ä»¶ï¼š\nå¯åŠ¨æœåŠ¡ç›‘æ§ åœ¨ conf æ–‡ä»¶å¤¹ä¸‹ï¼Œç¼–è¾‘ dubbo.propertiesï¼Œå°†ç›¸å…³å‚æ•°é…ç½®å¦‚ä¸‹ï¼š\ndubbo.container=log4j,spring,registry,jetty dubbo.application.name=simple-monitor dubbo.application.owner= #dubbo.registry.address=multicast://224.5.6.7:1234 dubbo.registry.address=zookeeper://127.0.0.1:2181 #dubbo.registry.address=redis://127.0.0.1:6379 #dubbo.registry.address=dubbo://127.0.0.1:9090 dubbo.protocol.port=7070 dubbo.jetty.port=8090 dubbo.jetty.directory=monitor dubbo.charts.directory=monitor/charts dubbo.statistics.directory=monitor/statistics dubbo.log4j.file=monitor/dubbo-monitor-simple.log dubbo.log4j.level=WARN ç„¶åï¼Œè¿›å…¥ bin ç›®å½•ï¼Œè¿è¡Œ start.sh å°±å¯ä»¥å¯åŠ¨ Dubbo-Monitor äº†ï¼Œè¿è¡Œåœ¨é…ç½®å¥½çš„ 8090 ç«¯å£ï¼ˆéœ€è¦å…ˆæ‰“å¼€ Zookeeperï¼‰ã€‚\nå¯åŠ¨æœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…åï¼Œå¯ä»¥åœ¨ Applications ä¸­çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š\nåŒæ—¶ï¼Œå¯ä»¥ç‚¹å‡» Providers æŸ¥çœ‹æœåŠ¡æŸä¸€æœåŠ¡æä¾›è€…çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥å°†å…¶å–æ¶ˆæ³¨å†Œï¼š\nå–æ¶ˆæ³¨å†Œåï¼ŒæœåŠ¡æ¶ˆè´¹è€…å°†ä¸èƒ½å¤Ÿè°ƒç”¨è¯¥æä¾›è€…çš„æœåŠ¡ï¼š\nDubbo-admin ç°åœ¨æœ‰ä¸¤ç§ç‰ˆæœ¬ï¼š\nDubbo åŸç”Ÿçš„ admin å·¥ç¨‹ Apache ä¿®æ­£ç‰ˆ Apache ä¿®æ­£ç‰ˆ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/admin/introduction.html\nMavenæ–¹å¼éƒ¨ç½² å®‰è£… git clone https://github.com/apache/dubbo-admin.git cd dubbo-admin mvn clean package cd dubbo-admin-distribution/target java -jar dubbo-admin-0.1.jar è®¿é—® http://localhost:8080 Dubbo åŸç”Ÿ ç°åœ¨å¾ˆå°‘èƒ½æ‰¾åˆ°ï¼Œä½†ç›®å‰è¿˜èƒ½åœ¨å½“å½“ç½‘çš„ dubbox é¡¹ç›®ä¸­æ‰¾åˆ°ï¼Œæ‰“åŒ…å½“å½“ç½‘çš„ dubbox é¡¹ç›®åï¼Œå¯ä»¥åœ¨ dubbo-admin æ¨¡å—ä¸‹æ‰¾åˆ°å…¶ war åŒ…ã€‚\nå°†å…¶æ”¾åˆ° tomcat ç›®å½•çš„ webapps ä¸‹ï¼Œå¯åŠ¨ tomcat å³å¯åœ¨é»˜è®¤çš„ 8080 ç«¯å£è®¿é—®åˆ° Dubbo-admin çš„ç•Œé¢ï¼Œhttp://localhost:8080/dubbo-admin ï¼Œdubbo-admin ä¸º war åŒ…åç§°ã€‚é»˜è®¤ root çš„ç™»å½•å¯†ç ä¸º rootï¼Œå¯ä»¥åœ¨ WEB-INF ä¸­çš„ dubbo.properties ä¸­é…ç½®ã€‚\nå¯ä»¥åœ¨æœåŠ¡æ²»ç†çš„æœåŠ¡ä¸­æŸ¥çœ‹æ‰€æœ‰æœåŠ¡ï¼Œç‚¹å‡»æœåŠ¡åå¯ä»¥æŸ¥çœ‹è¯¥æœåŠ¡çš„æä¾›è€…ã€æ¶ˆè´¹è€…ç­‰è¯¦ç»†ä¿¡æ¯ã€‚\næœåŠ¡æä¾›è€… å¯ä»¥å¯¹å…¶æä¾›è€…è¿›è¡Œæƒé‡ä¿®æ”¹ï¼ˆç”¨äº Dubbo çš„è´Ÿè½½å‡è¡¡ç‰¹æ€§ï¼‰ï¼Œæƒé‡è¶Šé«˜è¶Šå®¹æ˜“è¢«è°ƒç”¨ã€‚ä¹Ÿå¯ä»¥ç¦ç”¨æŸä¸€å°æœºå™¨çš„æœåŠ¡ï¼Œæ¶ˆè´¹è€…å°†ä¸ä¼šå¯¹å…¶è¿›è¡Œè°ƒç”¨ã€‚\næœåŠ¡æ¶ˆè´¹è€… å¯ä»¥å¯¹æœåŠ¡æ¶ˆè´¹è€…è¿›è¡Œé™æ­¢ã€å±è”½å’Œå®¹é”™ã€‚\nè‹¥ç¦æ­¢æŸä¸€å°æ¶ˆè´¹è€…ï¼Œåˆ™è¯¥æ¶ˆè´¹è€…è°ƒç”¨æ—¶å°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ è‹¥å±è”½æŸä¸€å°æ¶ˆè´¹è€…ï¼Œåˆ™è¯¥æ¶ˆè´¹è€…å°†ä¸ä¼šè¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œå¹¶ä¸”ç›´æ¥è¿”å›ç©ºå¯¹è±¡ã€‚ è‹¥å¯¹æŸä¸€å°æ¶ˆè´¹è€…å¼€å¯å®¹é”™ï¼Œåˆ™æŠ¥ä»»ä½•é”™è¯¯æ—¶éƒ½ä¼šè¿”å›ä¸€ä¸ªç©ºå¯¹è±¡ã€‚ åº”ç”¨ å¯ä»¥æŸ¥çœ‹æ‰€æœ‰åº”ç”¨ï¼ŒåŒ…æ‹¬æä¾›è€…å’Œæ¶ˆè´¹è€…ã€‚\nè·¯ç”±è§„åˆ™ è·¯ç”±è§„åˆ™åœ¨å‘èµ·ä¸€æ¬¡RPCè°ƒç”¨å‰èµ·åˆ°è¿‡æ»¤ç›®æ ‡æœåŠ¡å™¨åœ°å€çš„ä½œç”¨ï¼Œè¿‡æ»¤åçš„åœ°å€åˆ—è¡¨ï¼Œå°†ä½œä¸ºæ¶ˆè´¹ç«¯æœ€ç»ˆå‘èµ·RPCè°ƒç”¨çš„å¤‡é€‰åœ°å€ã€‚\nå®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/routing-rule.html\næ ¹æ®å®˜æ–¹æ–‡æ¡£çš„é…ç½®è¯´æ˜ï¼Œå¯ä»¥åœ¨ Dubbo Admin çš„æœåŠ¡æ²»ç†çš„è·¯ç”±è§„åˆ™ä¸­æ–°å¢é…ç½®ï¼š\nåŠ¨æ€é…ç½® è¦†ç›–è§„åˆ™æ˜¯Dubboè®¾è®¡çš„åœ¨æ— éœ€é‡å¯åº”ç”¨çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€è°ƒæ•´RPCè°ƒç”¨è¡Œä¸ºçš„ä¸€ç§èƒ½åŠ›ã€‚2.7.0ç‰ˆæœ¬å¼€å§‹ï¼Œæ”¯æŒä»æœåŠ¡å’Œåº”ç”¨ä¸¤ä¸ªç²’åº¦æ¥è°ƒæ•´åŠ¨æ€é…ç½®ã€‚\nå®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/config-rule.html\né“¾è·¯ç›‘æ§ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆç†Ÿæ‚‰ä¸€ä¸‹ Dubbo-Filter æ‹¦æˆªå™¨ï¼š\nDubbo-Filter å®˜æ–¹æ–‡æ¡£ï¼šhttp://dubbo.apache.org/zh-cn/docs/dev/impls/filter.html\nDubbo æ”¯æŒ Filter æœºåˆ¶ Dubbo è¯¸å¤šå·¥ä½œéƒ½æ˜¯é€šè¿‡ Filter å®ç° å¸¸è§è‡ªå®šä¹‰ Filterï¼šä¾‹å­è®°å½•ã€trace åŠŸèƒ½ç­‰ æ‹¦æˆªå™¨ç®€ä»‹ Dubbo-Filter ä½¿ç”¨ Spring XML é…ç½®ï¼š\n\u0026lt;!-- æ¶ˆè´¹æ–¹è°ƒç”¨è¿‡ç¨‹æ‹¦æˆª --\u0026gt; \u0026lt;dubbo:reference filter=\u0026#34;xxx,yyy\u0026#34; /\u0026gt; \u0026lt;!-- æ¶ˆè´¹æ–¹è°ƒç”¨è¿‡ç¨‹ç¼ºçœæ‹¦æˆªå™¨ï¼Œå°†æ‹¦æˆªæ‰€æœ‰reference --\u0026gt; \u0026lt;dubbo:consumer filter=\u0026#34;xxx,yyy\u0026#34;/\u0026gt; \u0026lt;!-- æä¾›æ–¹è°ƒç”¨è¿‡ç¨‹æ‹¦æˆª --\u0026gt; \u0026lt;dubbo:service filter=\u0026#34;xxx,yyy\u0026#34; /\u0026gt; \u0026lt;!-- æä¾›æ–¹è°ƒç”¨è¿‡ç¨‹ç¼ºçœæ‹¦æˆªå™¨ï¼Œå°†æ‹¦æˆªæ‰€æœ‰service --\u0026gt; \u0026lt;dubbo:provider filter=\u0026#34;xxx,yyy\u0026#34;/\u0026gt; åˆ›å»ºä¸€ä¸ª Filter ç±»ï¼Œå®ç° com.alibaba.dubbo.rpc.Filter æ¥å£ï¼Œå¯ä»¥åœ¨æœåŠ¡è°ƒç”¨å‰ååšä¸€äº›äº‹æƒ…ï¼Œè¿™é‡Œç”¨æ§åˆ¶å°è¾“å‡ºè¡¨ç¤ºï¼š\npublic class MyFilter implements Filter { @Override public Result invoke(Invoker\u0026lt;?\u0026gt; invoker, Invocation invocation) throws RpcException { // do something... System.out.println(\u0026#34;æœåŠ¡è°ƒç”¨ä¹‹å‰\u0026#34;); Result result = invoker.invoke(invocation); System.out.println(\u0026#34;æœåŠ¡è°ƒç”¨ä¹‹å\u0026#34;); // do something... return result; } } åœ¨æ¨¡å—çš„ resources ä¸‹åˆ›å»º META-INF æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨ META-INF ä¸‹åˆ›å»º dubbo æ–‡ä»¶å¤¹ï¼Œåœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸º com.alibaba.dubbo.rpc.Filter çš„çº¯æ–‡ä»¶ï¼ˆFileï¼‰ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ ä¹‹å‰åˆ›å»ºçš„ Filter ç±»ï¼š\nMyFilter=com.zjut.zjxjwxk.springboot.provider.filter.MyFilter è¿™æ ·ï¼Œåœ¨è°ƒç”¨æœåŠ¡æ—¶ï¼Œå°±ä¼šè¢« MyFilter æ‹¦æˆªå™¨æ‹¦æˆªï¼Œå¹¶åœ¨è°ƒç”¨å‰åå¯ä»¥åšä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚é“¾è·¯ç›‘æ§ã€‚\næœåŠ¡è°ƒç”¨ä¹‹å‰ quickstart-provider-message=Hello World! æœåŠ¡è°ƒç”¨ä¹‹å ç„¶åï¼Œä»‹ç»ä¸€ä¸‹ Zipkinï¼š\nZipkin å®˜ç½‘ï¼šhttps://zipkin.io\nZipkin æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è·Ÿè¸ªç³»ç»Ÿã€‚å®ƒæœ‰åŠ©äºæ”¶é›†è§£å†³æœåŠ¡ä½“ç³»ç»“æ„ä¸­çš„å»¶è¿Ÿé—®é¢˜æ‰€éœ€çš„æ—¶åºæ•°æ®ã€‚åŠŸèƒ½åŒ…æ‹¬è¯¥æ•°æ®çš„æ”¶é›†å’ŒæŸ¥æ‰¾ã€‚\nZipkin æ¶æ„ Zipkin ç®€ä»‹ æ„æˆ ä½œç”¨ TraceID å…¨å±€å”¯ä¸€è¡¨ç¤ºï¼Œå•æ¬¡è¯·æ±‚å”¯ä¸€ SpanID è°ƒç”¨ç¼–å·ï¼Œæ¯æ¬¡è¿œç¨‹è°ƒç”¨å”¯ä¸€ ParentID çˆ¶è¯·æ±‚ç¼–å·ï¼Œä¸Šä¸€çº§ SpanID Client Start csï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ Server Receive srï¼Œè¡¨ç¤ºæœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ Server Send ssï¼Œè¡¨ç¤ºæœåŠ¡ç«¯å®Œæˆå¤„ç† Client Receive crï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯æ”¶åˆ°ç›¸åº” Zipkin è¿è¡Œ The quickest way to get started is to fetch the latest released server as a self-contained executable jar. Note that the Zipkin server requires minimum JRE 8. For example:\ncurl -sSL https://zipkin.io/quickstart.sh | bash -s java -jar zipkin.jar å¯ä»¥åœ¨é»˜è®¤çš„ 9411 ç«¯å£ä¸Šçœ‹åˆ° Zipkin çš„ç•Œé¢ï¼š\nDubbo Spring é¡¹ç›®é…ç½® ä¸»æ¨¡å— pom.xmlï¼š\n\u0026lt;dependencyManagement\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.brave\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;brave-bom\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.5.0\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.reporter2\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zipkin-reporter-bom\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.7.9\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; \u0026lt;/dependencyManagement\u0026gt; provider æ¨¡å— pom.xmlï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.brave\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;brave-instrumentation-dubbo-rpc\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.brave\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;brave-spring-beans\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.brave\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;brave-context-slf4j\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.reporter2\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zipkin-sender-okhttp3\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; provider spring é…ç½®æ–‡ä»¶ï¼š\n\u0026lt;bean id=\u0026#34;sender\u0026#34; class=\u0026#34;zipkin2.reporter.beans.OkHttpSenderFactoryBean\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;endpoint\u0026#34; value=\u0026#34;http://localhost:9411/api/v2/spans\u0026#34;/\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;bean id=\u0026#34;tracing\u0026#34; class=\u0026#34;brave.spring.beans.TracingFactoryBean\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;localServiceName\u0026#34; value=\u0026#34;hello-service\u0026#34;/\u0026gt; \u0026lt;property name=\u0026#34;spanReporter\u0026#34;\u0026gt; \u0026lt;bean class=\u0026#34;zipkin2.reporter.beans.AsyncReporterFactoryBean\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;sender\u0026#34; ref=\u0026#34;sender\u0026#34;/\u0026gt; \u0026lt;!-- wait up to half a second for any in-flight spans on close --\u0026gt; \u0026lt;property name=\u0026#34;closeTimeout\u0026#34; value=\u0026#34;500\u0026#34;/\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;property name=\u0026#34;currentTraceContext\u0026#34;\u0026gt; \u0026lt;bean class=\u0026#34;brave.spring.beans.CurrentTraceContextFactoryBean\u0026#34;\u0026gt; \u0026lt;property name=\u0026#34;scopeDecorators\u0026#34;\u0026gt; \u0026lt;bean class=\u0026#34;brave.context.slf4j.MDCScopeDecorator\u0026#34; factory-method=\u0026#34;create\u0026#34;/\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; \u0026lt;/property\u0026gt; \u0026lt;/bean\u0026gt; æ ¹æ® openzipkin/brave GitHub ä»“åº“ä¸­ï¼Œbrave/instrumentation/dubbo-rpc ä¸­çš„æ–‡æ¡£è¯´æ˜ï¼šhttps://github.com/openzipkin/brave/tree/master/instrumentation/dubbo-rpc ï¼Œè¦åœ¨éœ€è¦ç›‘æ§çš„æœåŠ¡ä¸Šæ·»åŠ  filter=\u0026ldquo;tracing\u0026rdquo; ï¼Œå¦‚ï¼š\n\u0026lt;dubbo:service interface=\u0026#34;com.zjut.zjxjwxk.dubbo.ServiceAPI\u0026#34; ref=\u0026#34;quickStartService\u0026#34; filter=\u0026#34;tracing\u0026#34; /\u0026gt; æˆ–è€…ç›‘æ§æ‰€æœ‰æœåŠ¡ï¼Œåˆ™åŠ åœ¨ consumer å’Œ provider ä¸Šï¼š\n\u0026lt;dubbo:consumer filter=\u0026#34;tracing\u0026#34; /\u0026gt; \u0026lt;dubbo:provider filter=\u0026#34;tracing\u0026#34; /\u0026gt; è¿™æ ·ï¼Œåœ¨è°ƒç”¨æœåŠ¡åï¼Œå°±èƒ½åœ¨ Zipkin ä¸­æ‰¾åˆ°å¯¹åº”çš„æœåŠ¡è¯·æ±‚çŠ¶æ€äº†ï¼š\nDubbo SpringBoot é¡¹ç›®é…ç½® ä¸»æ¨¡å— pom.xmlï¼š\n\u0026lt;dependencyManagement\u0026gt; \u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.brave\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;brave-bom\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;5.5.0\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.reporter2\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zipkin-reporter-bom\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.7.9\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;scope\u0026gt;import\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; \u0026lt;/dependencyManagement\u0026gt; provider æ¨¡å— pom.xmlï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.brave\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;brave-instrumentation-dubbo-rpc\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.brave\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;brave-spring-beans\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.brave\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;brave-context-slf4j\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.zipkin.reporter2\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zipkin-sender-okhttp3\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- SpringBoot éœ€è¦çš„é¢å¤–ä¾èµ– --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.curator\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;curator-framework\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.0.1\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; SpringBoot ä¸éœ€è¦ Spring XML æ–‡ä»¶ï¼Œåªéœ€è¦åˆ›å»ºä¸€ä¸ª TraceConfig é…ç½®ç±»ï¼Œè¯¥ç±»æ¯ä¸ªéœ€è¦ç›‘æ§çš„æ¨¡å—éƒ½éœ€è¦ä¸€ä¸ªï¼Œå…¶ LocalServiceName å¯ä»¥è®¾ç½®ä¸ºæœåŠ¡åï¼Œå¦‚ order æ¨¡å—ä¸­çš„è¯¥é…ç½®ç±»ï¼ˆåˆ«å¿˜äº†åœ¨ @Bean ä¸­åŠ ä¸Š \u0026ldquo;tracing\u0026rdquo; åç§°ï¼‰ï¼š\n@Configuration public class TraceConfig { @Bean(\u0026#34;tracing\u0026#34;) public TracingFactoryBean getTracingBean() { TracingFactoryBean tracingFactoryBean = new TracingFactoryBean(); tracingFactoryBean.setLocalServiceName(\u0026#34;order\u0026#34;); tracingFactoryBean.setSpanReporter(AsyncReporter.create(OkHttpSender.create(\u0026#34;http://localhost:9411/api/v2/spans\u0026#34;))); return tracingFactoryBean; } } æ–¹æ³•çº§åˆ« åœ¨éœ€è¦ç›‘æ§çš„æ¶ˆè´¹è€…çš„ @Reference å’Œæä¾›è€…çš„ @Service ä¸­æ·»åŠ  filter å±æ€§ä¸º \u0026ldquo;tracing\u0026rdquo; å³å¯ï¼š\næ¶ˆè´¹è€…ï¼š\n@Reference(interfaceClass = AlipayServiceApi.class, filter = \u0026#34;tracing\u0026#34;) private AlipayServiceApi alipayServiceApi; æä¾›è€…ï¼š\n@Service(interfaceClass = OrderServiceApi.class, filter = \u0026#34;tracing\u0026#34;) æœåŠ¡çº§åˆ« åœ¨éœ€è¦ç›‘æ§çš„æœåŠ¡çš„ application.yml ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼Œåˆ™å¯¹è¯¥æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹å’Œæä¾›å‡è¿›è¡Œç›‘æ§ï¼š\nspring: dubbo: provider: filter: tracing consumer: filter: tracing Zipkin ç›‘æ§é¢æ¿ ä¹‹åæ¯æ¬¡è°ƒç”¨è¢«ç›‘æ§çš„æœåŠ¡ï¼Œå°±èƒ½åœ¨ Zipkin é¢æ¿ä¸­æ‰¾åˆ°å¯¹åº”çš„è°ƒç”¨é“¾è·¯ï¼š\nå¯ä»¥åœ¨ Discover é¢æ¿ä¸­ï¼Œæ‰¾åˆ°ä¸€å®šæ—¶é—´å†…è¢«ç›‘æ§çš„æœåŠ¡è°ƒç”¨ã€‚\næ¥å£è°ƒç”¨è¯¦æƒ…ä¸­ï¼Œæ¥å£çš„è°ƒç”¨é“¾è·¯å’Œæ—¶é—´ä¸€ç›®äº†ç„¶ï¼Œå¯ä»¥æ‰¾å‡ºå“ªä¸ªæ¥å£è°ƒç”¨çš„æ—¶é—´è¾ƒé•¿ï¼Œæˆ–è€…é”™è¯¯å‘ç”Ÿåœ¨å“ªä¸ªæ¥å£çš„è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œè¿˜å¯ä»¥ä»å³ä¾§çš„ Annotaions ä¸­çœ‹åˆ°å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„ Start å’Œ Finish æ—¶é—´ï¼Œä»¥åˆ¤æ–­å“ªä¸€å°æœåŠ¡å™¨çš„è®¿é—®é€Ÿåº¦è¾ƒæ…¢ç­‰ã€‚\nDependencies é¢æ¿ä¸­ï¼ŒæœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ä»¥åŠè®¿é—®æµé‡ä»¥å¯è§†åŒ–çš„æ–¹å¼å‘ˆç°å‡ºæ¥ã€‚\nï¼ˆZipkin é»˜è®¤ä½¿ç”¨å†…å­˜çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œå®ƒä¹Ÿæ”¯æŒ MySQL ç­‰æŒä¹…åŒ–å­˜å‚¨æ–¹å¼ï¼Œä»¥ä¾¿äºä»¥åçš„æ•°æ®åˆ†æï¼‰\n","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/11.%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7/","summary":"\u003ch1 id=\"ç« èŠ‚æ¦‚è¦\"\u003eç« èŠ‚æ¦‚è¦\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eäº†è§£ Dubbo ç›‘æ§ç›¸å…³å†…å®¹\u003c/li\u003e\n\u003cli\u003eç†Ÿç»ƒæŒæ¡ Dubbo-admin ä½¿ç”¨\u003c/li\u003e\n\u003cli\u003eç†Ÿç»ƒæŒæ¡é“¾è·¯ç›‘æ§\u003c/li\u003e\n\u003cli\u003eå®Œæˆä¸šåŠ¡ç³»ç»Ÿéƒ¨ç½²\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"dubbo-monitor\"\u003eDubbo-monitor\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"Dubboæ¶æ„\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/11.%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7/images/image-20200424231550404.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"æºç ä¸‹è½½å’Œæ‰“åŒ…\"\u003eæºç ä¸‹è½½å’Œæ‰“åŒ…\u003c/h2\u003e\n\u003cp\u003eç›®å‰ï¼Œè¿˜å¯ä»¥ä»å½“å½“ç½‘çš„é¡¹ç›® Dubbox ä¸­è·å–ï¼ˆå¾ˆä¹…æ²¡æœ‰ç»´æŠ¤äº†ï¼‰ï¼šhttps://github.com/dangdangdotcom/dubbox ï¼Œåœ¨é¡¹ç›®ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ‰“åŒ…å¹¶æ‹·è´åˆ°æœ¬åœ°ä»“åº“ï¼ˆè·³è¿‡å•å…ƒæµ‹è¯•ï¼‰ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emvn package -Dmaven.test.skip\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue  \n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå…¶ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ° Missing artifact com.alibaba:dubbo:jar:2.8.4 çš„å‘ï¼Œéœ€è¦åœ¨æ ¹é¡¹ç›®çš„ pom.xml æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ maven æ’ä»¶ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"æ·»åŠ æ’ä»¶ä¾èµ–\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/11.%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7/images/image-20200425004851922.png\"\u003e\u003c/p\u003e\n\u003cp\u003eè¿™æ ·åœ¨æœ¬åœ°ä»“åº“å°±æœ‰äº† ~/.m2/repository/com/alibaba/dubbo-monitor-simple/2.8.4/dubbo-monitor-simple-2.8.4-assembly.tar.gz è¿™ä¸ª tar.gz åŒ…ï¼Œè§£å‹å®ƒå¯ä»¥å¾—åˆ°ä»¥ä¸‹æ–‡ä»¶ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Dubbo-Monitoræ–‡ä»¶ç›®å½•\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/11.%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7/images/image-20200425004950736.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"å¯åŠ¨æœåŠ¡ç›‘æ§\"\u003eå¯åŠ¨æœåŠ¡ç›‘æ§\u003c/h2\u003e\n\u003cp\u003eåœ¨ conf æ–‡ä»¶å¤¹ä¸‹ï¼Œç¼–è¾‘ dubbo.propertiesï¼Œå°†ç›¸å…³å‚æ•°é…ç½®å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-properties\" data-lang=\"properties\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.container\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003elog4j,spring,registry,jetty\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.application.name\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003esimple-monitor\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.application.owner\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#dubbo.registry.address=multicast://224.5.6.7:1234\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.registry.address\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003ezookeeper://127.0.0.1:2181\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#dubbo.registry.address=redis://127.0.0.1:6379\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#dubbo.registry.address=dubbo://127.0.0.1:9090\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.protocol.port\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e7070\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.jetty.port\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e8090\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.jetty.directory\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003emonitor\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.charts.directory\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003emonitor/charts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.statistics.directory\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003emonitor/statistics\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.log4j.file\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003emonitor/dubbo-monitor-simple.log\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edubbo.log4j.level\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003eWARN\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eç„¶åï¼Œè¿›å…¥ bin ç›®å½•ï¼Œè¿è¡Œ start.sh å°±å¯ä»¥å¯åŠ¨ Dubbo-Monitor äº†ï¼Œè¿è¡Œåœ¨é…ç½®å¥½çš„ 8090 ç«¯å£ï¼ˆéœ€è¦å…ˆæ‰“å¼€ Zookeeperï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Dubbo-Monitorç•Œé¢\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/11.%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7/images/image-20200425005304792.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå¯åŠ¨æœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…åï¼Œå¯ä»¥åœ¨ Applications ä¸­çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"æœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/11.%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7/images/image-20200425010612712.png\"\u003e\u003c/p\u003e\n\u003cp\u003eåŒæ—¶ï¼Œå¯ä»¥ç‚¹å‡» Providers æŸ¥çœ‹æœåŠ¡æŸä¸€æœåŠ¡æä¾›è€…çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥å°†å…¶å–æ¶ˆæ³¨å†Œï¼š\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ11ï¼‰ï¼šæœåŠ¡ç›‘æ§"},{"content":"ç« èŠ‚æ¦‚è¦ äº‹åŠ¡ç®€ä»‹ åˆ†å¸ƒå¼äº‹åŠ¡çš„å‰ä¸–ä»Šç”Ÿ åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ ä¸»æµåˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ä»‹ç» äº‹åŠ¡ç®€ä»‹ äº‹åŠ¡æ˜¯ç”¨æ¥ä¿è¯ä¸€ç»„æ•°æ®æ“ä½œçš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§çš„ äº‹åŠ¡å¿…é¡»æ»¡è¶³ ACID çš„å››å¤§ç‰¹æ€§ äº‹åŠ¡å…·æœ‰å››ç§éš”ç¦»çº§åˆ« äº‹åŠ¡å…·æœ‰ä¸ƒç§ä¼ æ’­è¡Œä¸º äº‹åŠ¡å±æ€§ åŸå­æ€§ï¼ˆAtomicityï¼‰ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ éš”ç¦»å‹ï¼ˆIsolationï¼‰ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ åˆ†å¸ƒå¼äº‹åŠ¡ æ¦‚å¿µ åˆ†å¸ƒå¼äº‹åŠ¡å°±æ˜¯å°†å¤šä¸ªèŠ‚ç‚¹çš„äº‹åŠ¡çœ‹æˆä¸€ä¸ªæ•´ä½“å¤„ç† åˆ†å¸ƒå¼äº‹åŠ¡ç”±äº‹åŠ¡å‚ä¸è€…ã€èµ„æºæœåŠ¡å™¨ã€äº‹åŠ¡ç®¡ç†å™¨ç­‰ç»„æˆ å¸¸è§çš„åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¾‹å­ï¼šæ”¯ä»˜ã€ä¸‹è®¢å•ç­‰ å®ç°æ€è·¯ ä¸¤æ®µå¼äº‹åŠ¡å’Œä¸‰æ®µå¼äº‹åŠ¡ åŸºäº XA çš„åˆ†å¸ƒå¼äº‹åŠ¡ åŸºäºæ¶ˆæ¯çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ TCC ç¼–ç¨‹å¼è¡¥å¿æ€§äº‹åŠ¡ åˆ†å¸ƒå¼äº‹åŠ¡ç±»å‹ ä¸¤æ®µå¼å’Œä¸‰æ®µå¼äº‹åŠ¡ ä¸¤æ®µå¼äº‹åŠ¡ ä¸‰æ®µå¼äº‹åŠ¡ åŸºäº XA çš„åˆ†å¸ƒå¼äº‹åŠ¡ åŸºäºæ¶ˆæ¯çš„ä¸€è‡´æ€§æ–¹æ¡ˆ TCC è¡¥å¿æ€§äº‹åŠ¡ åŸºäºæ¶ˆæ¯çš„ä¸€è‡´æ€§æ–¹æ¡ˆå’Œ TCC è¡¥å¿æ€§äº‹åŠ¡çš„åŒºåˆ« åŸºäºæ¶ˆæ¯çš„äº‹åŠ¡æ˜¯å¼ºä¸€è‡´æ€§äº‹åŠ¡ï¼Œä¼šå­˜åœ¨æµªè´¹ TCC äº‹åŠ¡æ˜¯æŸ”æ€§äº‹åŠ¡ï¼Œåœ¨ try é˜¶æ®µè¦å¯¹èµ„æºåšé¢„ç•™ TCC äº‹åŠ¡åœ¨ç¡®è®¤æˆ–å–æ¶ˆé˜¶æ®µé‡Šæ”¾èµ„æº ä¸åŸºäºæ¶ˆæ¯çš„äº‹åŠ¡å¯¹æ¯”ï¼ŒTCC çš„æ—¶æ•ˆæ€§æ›´å¥½ åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ å…¨å±€äº‹åŠ¡æœåŠ¡ï¼ˆGlobal Transaction Serviceï¼Œç®€ç§° GTSï¼‰ èš‚èšé‡‘æœåˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆDistributed Transaction-eXtendedï¼Œç®€ç§° DTXï¼‰ å¼€æº TCC æ¡†æ¶ï¼ˆTCC-Transactionï¼‰ï¼ˆhttps://github.com/changmingxie/tcc-transactionï¼‰ å¼€æº TCC æ¡†æ¶ï¼ˆByteTCCï¼‰ï¼ˆhttps://github.com/liuyangming/ByteTCCï¼‰ TCC-Transaction åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ Github ä»“åº“ï¼šhttps://github.com/changmingxie/tcc-transaction\nåœ¨éœ€è¦æä¾›åˆ†å¸ƒå¼äº‹åŠ¡æ”¯æŒçš„æ¥å£æ–¹æ³•ä¸Šæ·»åŠ  @Compensable åœ¨å¯¹åº”çš„æ¥å£å®ç°æ–¹æ³•ä¸Šä¹Ÿæ·»åŠ  @Compensableï¼Œå¹¶æ·»åŠ æ³¨è§£å‚æ•° confirmMethod, cancelMethod å’Œ transactionContextEditor å®ç°å¯¹åº”çš„ confirmMethod å’Œ cancelMethodï¼ˆå¿…é¡»å’Œ try æ–¹æ³•åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼‰ æ³¨æ„ï¼š\nåœ¨åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ä¸­ï¼Œä¸è¦è½»æ˜“åœ¨ä¸šåŠ¡å±‚æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œåªæœ‰åœ¨æŠ›å‡ºå¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶æ‰çŸ¥é“è¯¥ä¸šåŠ¡æ˜¯æ‰§è¡Œå¤±è´¥çš„ã€‚ ä½¿ç”¨ TCC-Transaction æ—¶ï¼Œconfirm å’Œ cancel çš„å¹‚ç­‰æ€§é—®é¢˜éœ€è¦è‡ªå·±è§£å†³ã€‚ TCC çš„æ•°æ®åº“åº”è¯¥å’Œä¸šåŠ¡æ•°æ®åº“åˆ†å¼€ï¼Œä»¥ä¿è¯åˆ†å¸ƒå¼äº‹åŠ¡çš„æ­£å¸¸è¿›è¡Œã€‚ å»ºç«‹ç”¨äºåˆ†å¸ƒå¼äº‹åŠ¡çš„æ•°æ®åº“ TCC çš„æ•°æ®åº“åº”è¯¥å’Œä¸šåŠ¡æ•°æ®åº“åˆ†å¼€ï¼Œä»¥ä¿è¯åˆ†å¸ƒå¼äº‹åŠ¡çš„æ­£å¸¸è¿›è¡Œã€‚\nå…¶ä¸­ï¼ŒTCC åº“ç”¨äºå®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå…¶åŒ…å«çš„è¡¨å’Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š\nDubbo Demo å­äº‹åŠ¡ï¼šçº¢åŒ…æ¨¡å— æ¥å£\npublic interface RedPacketTradeOrderService { @Compensable public String record(RedPacketTradeOrderDto tradeOrderDto); } å®ç°ç±»\n@Service(\u0026#34;redPacketTradeOrderService\u0026#34;) public class RedPacketTradeOrderServiceImpl implements RedPacketTradeOrderService { @Autowired RedPacketAccountRepository redPacketAccountRepository; @Autowired TradeOrderRepository tradeOrderRepository; @Override @Compensable(confirmMethod = \u0026#34;confirmRecord\u0026#34;, cancelMethod = \u0026#34;cancelRecord\u0026#34;, transactionContextEditor = DubboTransactionContextEditor.class) @Transactional public String record(RedPacketTradeOrderDto tradeOrderDto) { TradeOrder foundTradeOrder = tradeOrderRepository.findByMerchantOrderNo(tradeOrderDto.getMerchantOrderNo()); // check if trade order has been recorded, if yes, return success directly. if (foundTradeOrder == null) { TradeOrder tradeOrder = new TradeOrder( tradeOrderDto.getSelfUserId(), tradeOrderDto.getOppositeUserId(), tradeOrderDto.getMerchantOrderNo(), tradeOrderDto.getAmount() ); try { tradeOrderRepository.insert(tradeOrder); RedPacketAccount transferFromAccount = redPacketAccountRepository.findByUserId(tradeOrderDto.getSelfUserId()); transferFromAccount.transferFrom(tradeOrderDto.getAmount()); redPacketAccountRepository.save(transferFromAccount); } catch (DataIntegrityViolationException e) { // this exception may happen when insert trade order concurrently, if happened, ignore this insert operation. } } return \u0026#34;success\u0026#34;; } @Transactional public void confirmRecord(RedPacketTradeOrderDto tradeOrderDto) { TradeOrder tradeOrder = tradeOrderRepository.findByMerchantOrderNo(tradeOrderDto.getMerchantOrderNo()); // check if the trade order status is DRAFT, if yes, return directly, ensure idempotency. if (tradeOrder != null \u0026amp;\u0026amp; tradeOrder.getStatus().equals(\u0026#34;DRAFT\u0026#34;)) { tradeOrder.confirm(); tradeOrderRepository.update(tradeOrder); RedPacketAccount transferToAccount = redPacketAccountRepository.findByUserId(tradeOrderDto.getOppositeUserId()); transferToAccount.transferTo(tradeOrderDto.getAmount()); redPacketAccountRepository.save(transferToAccount); } } @Transactional public void cancelRecord(RedPacketTradeOrderDto tradeOrderDto) { TradeOrder tradeOrder = tradeOrderRepository.findByMerchantOrderNo(tradeOrderDto.getMerchantOrderNo()); // check if the trade order status is DRAFT, if yes, return directly, ensure idempotency. if (null != tradeOrder \u0026amp;\u0026amp; \u0026#34;DRAFT\u0026#34;.equals(tradeOrder.getStatus())) { tradeOrder.cancel(); tradeOrderRepository.update(tradeOrder); RedPacketAccount capitalAccount = redPacketAccountRepository.findByUserId(tradeOrderDto.getSelfUserId()); capitalAccount.cancelTransfer(tradeOrderDto.getAmount()); redPacketAccountRepository.save(capitalAccount); } } } æ€è€ƒï¼šä¸ºä»€ä¹ˆè¦åœ¨ confirm å’Œ cancel æ–¹æ³•é‡Œå…ˆæ£€æŸ¥è®¢å•çŠ¶æ€æ˜¯å¦ä¸º DRAFTï¼ˆåœ¨ try æ–¹æ³•ä¸­æ–°å¢çš„ä¸€ä¸ªè®¢å•ï¼‰ï¼Œè€Œä¸ç›´æ¥ä¿®æ”¹ä¸ºç»“æŸçŠ¶æ€ï¼Ÿ\nç­”ï¼šä¸ºäº†ä¿è¯æœåŠ¡çš„å¹‚ç­‰æ€§ï¼Œå³ä½¿ç”¨ç›¸åŒå‚æ•°å¯¹åŒä¸€èµ„æºé‡å¤è°ƒç”¨æŸä¸ªæ¥å£çš„ç»“æœä¸è°ƒç”¨ä¸€æ¬¡çš„ç»“æœç›¸åŒã€‚\nä¸»äº‹åŠ¡ï¼šè®¢å•æ¨¡å— æ³¨æ„ï¼šè¦åœ¨ä¸»äº‹åŠ¡çš„ä¸šåŠ¡å·²ç»å®ç°çš„å·®ä¸å¤šçš„æ—¶å€™æ‰è°ƒç”¨å­äº‹åŠ¡ã€‚\n@Service public class PaymentServiceImpl { @Autowired CapitalTradeOrderService capitalTradeOrderService; @Autowired RedPacketTradeOrderService redPacketTradeOrderService; @Autowired OrderRepository orderRepository; @Compensable(confirmMethod = \u0026#34;confirmMakePayment\u0026#34;, cancelMethod = \u0026#34;cancelMakePayment\u0026#34;, asyncConfirm = false, delayCancelExceptions = {SocketTimeoutException.class, org.apache.dubbo.remoting.TimeoutException.class}) public void makePayment(@UniqueIdentity String orderNo, BigDecimal redPacketPayAmount, BigDecimal capitalPayAmount) { Order order = orderRepository.findByMerchantOrderNo(orderNo); // check if the order status is DRAFT, if no, means that another call makePayment for the same order happened, ignore this call makePayment. if (order.getStatus().equals(\u0026#34;DRAFT\u0026#34;)) { order.pay(redPacketPayAmount, capitalPayAmount); try { orderRepository.updateOrder(order); } catch (OptimisticLockingFailureException e) { // ignore the concurrently update order exception, ensure idempotency. } } // è°ƒç”¨å­äº‹åŠ¡ String result = capitalTradeOrderService.record(buildCapitalTradeOrderDto(order)); String result2 = redPacketTradeOrderService.record(buildRedPacketTradeOrderDto(order)); } public void confirmMakePayment(String orderNo, BigDecimal redPacketPayAmount, BigDecimal capitalPayAmount) { Order foundOrder = orderRepository.findByMerchantOrderNo(orderNo); // check if the trade order status is PAYING, if no, means another call confirmMakePayment happened, return directly, ensure idempotency. if (foundOrder != null \u0026amp;\u0026amp; foundOrder.getStatus().equals(\u0026#34;PAYING\u0026#34;)) { foundOrder.confirm(); orderRepository.updateOrder(foundOrder); } } public void cancelMakePayment(String orderNo, BigDecimal redPacketPayAmount, BigDecimal capitalPayAmount) { Order foundOrder = orderRepository.findByMerchantOrderNo(orderNo); // check if the trade order status is PAYING, if no, means another call cancelMakePayment happened, return directly, ensure idempotency. if (foundOrder != null \u0026amp;\u0026amp; foundOrder.getStatus().equals(\u0026#34;PAYING\u0026#34;)) { foundOrder.cancelPayment(); orderRepository.updateOrder(foundOrder); } } } æµç¨‹å›¾ éšå¼å‚æ•° æ ¹æ®å®˜æ–¹æ–‡æ¡£å¯ä»¥å¾—çŸ¥ï¼Œ1.2.x ç‰ˆæœ¬æ”¯æŒ rpc æ¡†æ¶æ”¯æŒéšå¼ä¼ å‚æƒ…å†µä¸‹å°†äº‹åŠ¡ä¸Šä¸‹æ–‡å‚æ•° TransactionContext ä»¥éšå¼ä¼ å‚æ–¹å¼è¿›è¡Œä¼ é€’ã€‚\né‚£ä¹ˆï¼Œåœ¨å­äº‹åŠ¡çš„ Service å®ç°ä»£ç ä¸­è·å– Dubbo éšå¼å‚æ•°ï¼š\nMap\u0026lt;String, String\u0026gt; attachments = RpcContext.getContext().getAttachments(); æ‰“ä¸€ä¸ªæ–­ç‚¹ï¼Œå¯ä»¥ä»éšå¼å‚æ•°ä¸­å¾—åˆ° key ä¸º TRANSACTION_CONTEXTï¼Œvalue ä¸ºä»¥ä¸‹ä¿¡æ¯çš„é”®å€¼å¯¹ï¼š\n{ \u0026#34;attachments\u0026#34;:{}, \u0026#34;status\u0026#34;:1, \u0026#34;xid\u0026#34;:{ \u0026#34;branchQualifier\u0026#34;:\u0026#34;hMBMmir6Q56M0hskfmPebw==\u0026#34;, \u0026#34;formatId\u0026#34;:1, \u0026#34;globalTransactionId\u0026#34;:\u0026#34;trSosXg0Soi8Q9xlauTToQ==\u0026#34; } } å…¶ä¸­ï¼ŒåŒ…å«äº† globalTransactionId è¿™ä¸€å…¨å±€äº‹åŠ¡ idï¼Œå’Œ branchQualifier åˆ†æ”¯äº‹åŠ¡ idã€‚\n##æå‡ºç–‘é—®\nä»€ä¹ˆæ—¶å€™ç”Ÿæˆçš„ TRANSACTION_CONTEXT éšå¼å‚æ•°ï¼Ÿ å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¤§çš„äº‹åŠ¡ä¸‹ï¼Œéƒ½æœ‰å“ªäº›å°çš„äº‹åŠ¡ï¼Ÿ ä¸ºä»€ä¹ˆè¦æœ‰ @Compensable æ³¨è§£ï¼Ÿ ä¸¤ä¸ªæ‹¦æˆªå™¨éƒ½æ²¡æœ‰å¤„ç† confirm å’Œ cancelï¼Œè°æ¥å¤„ç†ï¼Ÿ æºç åˆ†æ äº‹åŠ¡æ‹¦æˆªå™¨ é‡ç‚¹ä»‹ç» tcc-transaction-core æ ¸å¿ƒåŒ…çš„ interceptor åŒ…ï¼Œä¹Ÿå°±æ˜¯æ‹¦æˆªå™¨åŒ…ã€‚\nCompensableMethodContext\nè¿™æ˜¯åŠ äº† @Compensable æ³¨é‡Šçš„ç›®æ ‡æ–¹æ³•å¯¹è±¡çš„ä¸Šä¸‹æ–‡ç±»ã€‚é€šè¿‡æ„é€ å‡½æ•°ï¼Œåˆ©ç”¨æ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ä¸Šä¸‹æ–‡ï¼Œè·å–è¢«æ‹¦æˆªç›®æ ‡å¯¹è±¡æ–¹æ³•çš„å„ç§ä¿¡æ¯ã€‚\npublic CompensableMethodContext(ProceedingJoinPoint pjp) { this.pjp = pjp; // è·å–å¾…è®¿é—®å¯¹è±¡çš„æ–¹æ³•åç§° this.method = getCompensableMethod(); // è·å–ç›®æ ‡å¯¹è±¡çš„ Compensable æ³¨è§£ this.compensable = method.getAnnotation(Compensable.class); // è·å–ç›®æ ‡å¯¹è±¡çš„äº‹åŠ¡ä¼ æ’­å±æ€§ï¼ˆé»˜è®¤ä¸º REQUIREDï¼‰ this.propagation = compensable.propagation(); // è·å–äº‹åŠ¡ä¸Šä¸‹æ–‡ this.transactionContext = FactoryBuilder.factoryOf(compensable.transactionContextEditor()).getInstance().get(pjp.getTarget(), method, pjp.getArgs()); } å…¶ä¸­ï¼ŒtransactionContext æ˜¯ä¸€ä¸ª TransactionContext ç±»ï¼Œå®šä¹‰åœ¨ tcc-transaction-api æ¨¡å—ä¸­ï¼š\npublic class TransactionContext implements Serializable { private static final long serialVersionUID = -8199390103169700387L; private TransactionXid xid; private int status; /** * ä¿å­˜å½“å‰äº‹åŠ¡æœ‰å‡ ä¸ªå­äº‹åŠ¡ */ private Map\u0026lt;String, String\u0026gt; attachments = new ConcurrentHashMap\u0026lt;String, String\u0026gt;(); public TransactionContext() { } public TransactionContext(TransactionXid xid, int status) { this.xid = xid; this.status = status; } public void setXid(TransactionXid xid) { this.xid = xid; } public TransactionXid getXid() { return xid.clone(); } public void setAttachments(Map\u0026lt;String, String\u0026gt; attachments) { if (attachments != null \u0026amp;\u0026amp; !attachments.isEmpty()) { this.attachments.putAll(attachments); } } public Map\u0026lt;String, String\u0026gt; getAttachments() { return attachments; } public void setStatus(int status) { this.status = status; } public int getStatus() { return status; } } CompensableTransactionAspect\nè¿™æ˜¯ä¸€ä¸ª AOP åˆ‡é¢ç±»ã€‚@Pointcut å°† @Compensable æ³¨è§£æ ‡è®°ä¸ºåˆ‡å…¥ç‚¹ï¼Œå…¶ç­¾åä¸º compensableService()ã€‚@Around è¡¨ç¤ºåœ¨ compensableService() ä¹‹å‰å’Œä¹‹åè°ƒç”¨ interceptCompensableMethod()ï¼Œå…¶ä¸­è°ƒç”¨äº† CompensableTransactionInterceptor çš„ interceptCompensableMethod()ã€‚\n@Pointcut(\u0026#34;@annotation(org.mengyun.tcctransaction.api.Compensable)\u0026#34;) public void compensableService() { } @Around(\u0026#34;compensableService()\u0026#34;) public Object interceptCompensableMethod(ProceedingJoinPoint pjp) throws Throwable { return compensableTransactionInterceptor.interceptCompensableMethod(pjp); } CompensableTransactionInterceptor\nè¿™æ˜¯äº‹åŠ¡æ‹¦æˆªå™¨ï¼Œå…·æœ‰ä»¥ä¸‹ä½œç”¨ï¼š\nå°†äº‹åŠ¡åŒºåˆ†ä¸º ROOT äº‹åŠ¡å’Œ PROVIDER åˆ†æ”¯äº‹åŠ¡ ä¸æ–­åœ°ä¿®æ”¹æ•°æ®åº“å†…çš„çŠ¶æ€ï¼ˆåˆå§‹åŒ–äº‹åŠ¡ã€ä¿®æ”¹äº‹åŠ¡çŠ¶æ€ï¼‰ ä¿®æ”¹å’Œæ¸…é™¤äº‹åŠ¡ç®¡ç†åŒºä¸­çš„äº‹åŠ¡é˜Ÿåˆ— ï¼ˆå¹¶æ²¡æœ‰æ‰§è¡Œç›®æ ‡å¯¹è±¡æ–¹æ³•ï¼Œpjp.proceed() å…¶å®æ˜¯äº¤ç»™äº†ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨ ResourceCoordinatorInterceptorï¼‰ interceptCompensableMethod\nå…¶ä¸­interceptCompensableMethod() æ–¹æ³•ä¸­ï¼Œå‚æ•° pjp è¡¨ç¤ºè¢«ä»£ç†çš„ç›®æ ‡å¯¹è±¡ï¼Œæ¯”å¦‚è¢«åŠ äº† @Compensable æ³¨è§£çš„ makePayment æ–¹æ³•å¯¹è±¡ï¼Œå°±ä¼šä½œä¸ºè¯¥å‚æ•°ï¼Œé€šè¿‡å…¶è·å–è¯¥æ–¹æ³•çš„å„ç§ä¿¡æ¯ã€‚\npublic Object interceptCompensableMethod(ProceedingJoinPoint pjp) throws Throwable { // é€šè¿‡ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œè·å–å¾…è®¿é—®å¯¹è±¡çš„å„ç§ä¿¡æ¯ï¼Œè§ä¸‹æ–¹ CompensableMethodContext() æ„é€ å‡½æ•° CompensableMethodContext compensableMethodContext = new CompensableMethodContext(pjp); // é€šè¿‡äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ¥åˆ¤æ–­æ˜¯å¦æœ‰å­˜åœ¨çš„äº‹åŠ¡é˜Ÿåˆ—ï¼ˆä» ThreadLocal è·å– transactions æ¥åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦å·²ç»æœ‰äº‹åŠ¡ï¼‰ boolean isTransactionActive = transactionManager.isTransactionActive(); if (!TransactionUtils.isLegalTransactionContext(isTransactionActive, compensableMethodContext)) { throw new SystemException(\u0026#34;no active compensable transaction while propagation is mandatory for method \u0026#34; + compensableMethodContext.getMethod().getName()); } // è·å–å¹¶åˆ¤æ–­å½“å‰äº‹åŠ¡çš„è§’è‰²ï¼ˆROOT è¡¨ç¤ºä¸»äº‹åŠ¡ï¼ŒPROVIDER è¡¨ç¤ºåˆ†æ”¯äº‹åŠ¡æˆ–äº‹åŠ¡å‚ä¸è€…ï¼‰ï¼Œå¹¶æ ¹æ®å…¶è§’è‰²è°ƒç”¨ä¸åŒçš„æ–¹æ³•æ¥å¤„ç† switch (compensableMethodContext.getMethodRole(isTransactionActive)) { case ROOT: return rootMethodProceed(compensableMethodContext); case PROVIDER: return providerMethodProceed(compensableMethodContext); default: return pjp.proceed(); } } rootMethodProceed\nå¤„ç†ä¸»äº‹åŠ¡çš„ rootMethodProceed() æ–¹æ³•ï¼Œå®ƒä¼šå®Œæˆï¼š\nå¼€å¯å…¨å±€äº‹åŠ¡ æŒä¹…åŒ–å…¨å±€äº‹åŠ¡ æ³¨å†Œå…¨å±€äº‹åŠ¡ åˆ¤æ–­åº”è¯¥ confirm è¿˜æ˜¯ cancel æ¸…é™¤äº‹åŠ¡é˜Ÿåˆ— private Object rootMethodProceed(CompensableMethodContext compensableMethodContext) throws Throwable { Object returnValue = null; Transaction transaction = null; boolean asyncConfirm = compensableMethodContext.getAnnotation().asyncConfirm(); boolean asyncCancel = compensableMethodContext.getAnnotation().asyncCancel(); Set\u0026lt;Class\u0026lt;? extends Exception\u0026gt;\u0026gt; allDelayCancelExceptions = new HashSet\u0026lt;Class\u0026lt;? extends Exception\u0026gt;\u0026gt;(); allDelayCancelExceptions.addAll(this.delayCancelExceptions); allDelayCancelExceptions.addAll(Arrays.asList(compensableMethodContext.getAnnotation().delayCancelExceptions())); try { // è®©äº‹åŠ¡ç®¡ç†å™¨å¼€å¯ä¸€ä¸ªå…¨æ–°çš„äº‹åŠ¡ï¼ŒæŒä¹…åŒ–äº‹åŠ¡ï¼Œå¹¶äº‹åŠ¡ç®¡ç†å™¨æ³¨å†Œè¯¥äº‹åŠ¡ï¼ˆåŠ å…¥äº‹åŠ¡é˜Ÿåˆ—ï¼‰ transaction = transactionManager.begin(compensableMethodContext.getUniqueIdentity()); try { // æ‰§è¡Œç›®æ ‡æ–¹æ³•ï¼ˆå®é™…ä¸Šä¼šå…ˆè°ƒç”¨ ResourceCoordinatorIntercepter æ‹¦æˆªå™¨ï¼‰ returnValue = compensableMethodContext.proceed(); // å¦‚æœæ‰§è¡Œå¼‚å¸¸ï¼Œå°±å›æ»šï¼Œå¦åˆ™æäº¤ } catch (Throwable tryingException) { if (!isDelayCancelException(tryingException, allDelayCancelExceptions)) { logger.warn(String.format(\u0026#34;compensable transaction trying failed. transaction content:%s\u0026#34;, JSON.toJSONString(transaction)), tryingException); /* 1. ä¿®æ”¹æ•°æ®åº“çŠ¶æ€ 2. æ‰§è¡Œ rollback æ–¹æ³• 3. å¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œåˆ™åˆ é™¤äº‹åŠ¡èµ„æºæ•°æ® */ transactionManager.rollback(asyncCancel); } throw tryingException; } /* 1. ä¿®æ”¹æ•°æ®åº“çŠ¶æ€ 2. æ‰§è¡Œ confirm æ–¹æ³• 3. å¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œåˆ™åˆ é™¤äº‹åŠ¡èµ„æºæ•°æ® */ transactionManager.commit(asyncConfirm); } finally { // åˆ°è¿™é‡Œï¼Œåˆ†æ”¯äº‹åŠ¡å°±éƒ½æ‰§è¡Œå®Œäº†ï¼Œå°±æ¸…é™¤é˜Ÿåˆ—ä¸­çš„äº‹åŠ¡ transactionManager.cleanAfterCompletion(transaction); } return returnValue; } å…¶ä¸­äº‹åŠ¡ç®¡ç†å™¨ TransactionManager çš„ begin() æ–¹æ³•ï¼š\npublic Transaction begin(Object uniqueIdentify) { Transaction transaction = new Transaction(uniqueIdentify,TransactionType.ROOT); // æŒä¹…åŒ–äº‹åŠ¡ transactionRepository.create(transaction); // æ³¨å†Œäº‹åŠ¡ï¼Œå‘äº‹åŠ¡é˜Ÿåˆ—ä¸­åŠ å…¥è¯¥äº‹åŠ¡ registerTransaction(transaction); return transaction; } providerMethodProceed\nå¤„ç†åˆ†æ”¯äº‹åŠ¡çš„ providerMethodProceed() æ–¹æ³•ï¼š\nprivate Object providerMethodProceed(CompensableMethodContext compensableMethodContext) throws Throwable { Transaction transaction = null; boolean asyncConfirm = compensableMethodContext.getAnnotation().asyncConfirm(); boolean asyncCancel = compensableMethodContext.getAnnotation().asyncCancel(); try { // æ ¹æ®äº‹åŠ¡çš„ä¸åŒçŠ¶æ€ï¼Œæ‰§è¡Œä¸åŒçš„åŠ¨ä½œ switch (TransactionStatus.valueOf(compensableMethodContext.getTransactionContext().getStatus())) { case TRYING: // propagationNewBegin() æŒä¹…åŒ–äº‹åŠ¡å‚ä¸è€…çš„æ•°æ®åˆ°å½“å‰æœåŠ¡ä¸­ï¼ˆé»˜è®¤çŠ¶æ€ä¸º TRYINGï¼‰ï¼Œå¹¶å‘äº‹åŠ¡ç®¡ç†å™¨æ³¨å†Œäº‹åŠ¡ transaction = transactionManager.propagationNewBegin(compensableMethodContext.getTransactionContext()); return compensableMethodContext.proceed(); case CONFIRMING: try { // propagationExistBegin() ä¿®æ”¹äº‹åŠ¡çŠ¶æ€ï¼Œå¹¶æ³¨å†Œäº‹åŠ¡ transaction = transactionManager.propagationExistBegin(compensableMethodContext.getTransactionContext()); // commit() ä¿®æ”¹äº‹åŠ¡çŠ¶æ€ä¸º CONFIRMINGï¼Œå¹¶æŒä¹…åŒ–æ›´æ–°ï¼Œæäº¤äº‹åŠ¡ transactionManager.commit(asyncConfirm); } catch (NoExistedTransactionException excepton) { //the transaction has been commit,ignore it. } break; case CANCELLING: try { // propagationExistBegin() ä¿®æ”¹äº‹åŠ¡çŠ¶æ€ï¼Œå¹¶æ³¨å†Œäº‹åŠ¡ transaction = transactionManager.propagationExistBegin(compensableMethodContext.getTransactionContext()); // rollback() ä¿®æ”¹äº‹åŠ¡çŠ¶æ€ä¸º CANCELLINGï¼Œå¹¶æŒä¹…åŒ–æ›´æ–°ï¼Œå›æ»šäº‹åŠ¡ transactionManager.rollback(asyncCancel); } catch (NoExistedTransactionException exception) { //the transaction has been rollback,ignore it. } break; } } finally { // æ¸…é™¤äº‹åŠ¡é˜Ÿåˆ— transactionManager.cleanAfterCompletion(transaction); } Method method = compensableMethodContext.getMethod(); return ReflectionUtils.getNullValue(method.getReturnType()); } ResourceCoordinatorAspect\nèµ„æºåè°ƒåˆ‡é¢ç±»å’Œ CompensableTransactionAspect ç±»ä¼¼ï¼Œå‡ ä¹ä¸€æ ·ï¼Œä¸å†èµ˜è¿°ã€‚\n@Pointcut(\u0026#34;@annotation(org.mengyun.tcctransaction.api.Compensable)\u0026#34;) public void transactionContextCall() { } @Around(\u0026#34;transactionContextCall()\u0026#34;) public Object interceptTransactionContextMethod(ProceedingJoinPoint pjp) throws Throwable { return resourceCoordinatorInterceptor.interceptTransactionContextMethod(pjp); } ResourceCoordinatorInterceptor\nä¸»è¦å¤„ç† try é˜¶æ®µçš„äº‹æƒ…ï¼Œåœ¨ try é˜¶æ®µï¼Œå°±å°†æ‰€æœ‰çš„â€œèµ„æºâ€å°è£…å®Œæˆå¹¶äº¤ç»™äº‹åŠ¡ç®¡ç†å™¨ã€‚\nå…¶ä¸­â€œèµ„æºâ€æŒ‡çš„æ˜¯â€œäº‹åŠ¡èµ„æºâ€ï¼š\nå³äº‹åŠ¡çš„å‚ä¸è€…ï¼š\nconfirm ä¸Šä¸‹æ–‡ cancel ä¸Šä¸‹æ–‡ åˆ†æ”¯äº‹åŠ¡ä¿¡æ¯ ç„¶åäº‹åŠ¡ç®¡ç†å™¨ä¿®æ”¹æ•°æ®åº“çŠ¶æ€ã€‚\ninterceptTransactionContextMethod\npublic Object interceptTransactionContextMethod(ProceedingJoinPoint pjp) throws Throwable { // ä½¿ç”¨äº‹åŠ¡ç®¡ç†å™¨ï¼Œä¼ é€’ä¸€äº›äº‹åŠ¡ç›¸å…³çš„ä¿¡æ¯ï¼ˆçº¿ç¨‹å…±äº«ï¼‰ Transaction transaction = transactionManager.getCurrentTransaction(); if (transaction != null) { switch (transaction.getStatus()) { case TRYING: enlistParticipant(pjp); break; case CONFIRMING: break; case CANCELLING: break; } } return pjp.proceed(pjp.getArgs()); } enlistParticipant\nprivate void enlistParticipant(ProceedingJoinPoint pjp) throws IllegalAccessException, InstantiationException { // è·å–å¯¹è±¡çš„æ–¹æ³• Method method = CompensableMethodUtils.getCompensableMethod(pjp); if (method == null) { throw new RuntimeException(String.format(\u0026#34;join point not found method, point is : %s\u0026#34;, pjp.getSignature().getName())); } // è·å–å¯¹åº”çš„ @Compensable å¯¹è±¡ Compensable compensable = method.getAnnotation(Compensable.class); // è·å–é…ç½®çš„ confirm å’Œ cancel æ–¹æ³• String confirmMethodName = compensable.confirmMethod(); String cancelMethodName = compensable.cancelMethod(); Transaction transaction = transactionManager.getCurrentTransaction(); TransactionXid xid = new TransactionXid(transaction.getXid().getGlobalTransactionId()); if (FactoryBuilder.factoryOf(compensable.transactionContextEditor()).getInstance().get(pjp.getTarget(), method, pjp.getArgs()) == null) { FactoryBuilder.factoryOf(compensable.transactionContextEditor()).getInstance().set(new TransactionContext(xid, TransactionStatus.TRYING.getId()), pjp.getTarget(), ((MethodSignature) pjp.getSignature()).getMethod(), pjp.getArgs()); } Class targetClass = ReflectionUtils.getDeclaringType(pjp.getTarget().getClass(), method.getName(), method.getParameterTypes()); InvocationContext confirmInvocation = new InvocationContext(targetClass, confirmMethodName, method.getParameterTypes(), pjp.getArgs()); InvocationContext cancelInvocation = new InvocationContext(targetClass, cancelMethodName, method.getParameterTypes(), pjp.getArgs()); Participant participant = new Participant( xid, confirmInvocation, cancelInvocation, compensable.transactionContextEditor()); transactionManager.enlistParticipant(participant); } è¿™æ ·ï¼Œç»è¿‡ä¸¤ä¸ªæ‹¦æˆªå™¨åï¼Œæ‰è°ƒç”¨ç›®æ ‡å¯¹è±¡æ–¹æ³•ã€‚\nå¹‚ç­‰æ€§é—®é¢˜ TCC-Transaction ä¸èƒ½ä¿è¯å¹‚ç­‰æ€§ï¼Œéœ€è¦è‡ªå·±å®ç°å¹‚ç­‰æ€§ã€‚å¦‚ä»¥ä¸‹ confirm å’Œ cancel æ–¹æ³•å°±å®ç°äº†å¹‚ç­‰æ€§ï¼š\nconfirm çš„å¹‚ç­‰æ€§\n@Transactional public void confirmRecord(RedPacketTradeOrderDto tradeOrderDto) { try { Thread.sleep(1000l); } catch (InterruptedException e) { throw new RuntimeException(e); } System.out.println(\u0026#34;red packet confirm record called. time seq:\u0026#34; + DateFormatUtils.format(Calendar.getInstance(), \u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;)); TradeOrder tradeOrder = tradeOrderRepository.findByMerchantOrderNo(tradeOrderDto.getMerchantOrderNo()); // ä¿è¯å¹‚ç­‰æ€§ check if the trade order status is DRAFT, if yes, return directly, ensure idempotency. if (tradeOrder != null \u0026amp;\u0026amp; tradeOrder.getStatus().equals(\u0026#34;DRAFT\u0026#34;)) { tradeOrder.confirm(); tradeOrderRepository.update(tradeOrder); RedPacketAccount transferToAccount = redPacketAccountRepository.findByUserId(tradeOrderDto.getOppositeUserId()); transferToAccount.transferTo(tradeOrderDto.getAmount()); redPacketAccountRepository.save(transferToAccount); } } cancel çš„å¹‚ç­‰æ€§\n@Transactional public void cancelRecord(RedPacketTradeOrderDto tradeOrderDto) { try { Thread.sleep(1000l); } catch (InterruptedException e) { throw new RuntimeException(e); } System.out.println(\u0026#34;red packet cancel record called. time seq:\u0026#34; + DateFormatUtils.format(Calendar.getInstance(), \u0026#34;yyyy-MM-dd HH:mm:ss\u0026#34;)); TradeOrder tradeOrder = tradeOrderRepository.findByMerchantOrderNo(tradeOrderDto.getMerchantOrderNo()); // ä¿è¯å¹‚ç­‰æ€§ check if the trade order status is DRAFT, if yes, return directly, ensure idempotency. if (null != tradeOrder \u0026amp;\u0026amp; \u0026#34;DRAFT\u0026#34;.equals(tradeOrder.getStatus())) { tradeOrder.cancel(); tradeOrderRepository.update(tradeOrder); RedPacketAccount capitalAccount = redPacketAccountRepository.findByUserId(tradeOrderDto.getSelfUserId()); capitalAccount.cancelTransfer(tradeOrderDto.getAmount()); redPacketAccountRepository.save(capitalAccount); } } å°ç»“ äº‹åŠ¡çš„ç›¸å…³ä¿¡æ¯ï¼ˆå…¨å±€äº‹åŠ¡ç¼–å·ï¼Œä¹è§‚é”ç‰ˆæœ¬ç­‰è¦æŒä¹…åŒ–å­˜å‚¨ï¼‰\nèµ„æº try æ ¸å¿ƒç‚¹ï¼šé¢„ç•™èµ„æºï¼ˆä¸šåŠ¡èµ„æºã€äº‹åŠ¡æ•°æ®èµ„æºï¼‰\næµç¨‹ æ³¨å†Œå’Œåˆå§‹åŒ–äº‹åŠ¡ -\u0026gt; ç»„ç»‡äº‹åŠ¡å‚ä¸è€… -\u0026gt; æ‰§è¡Œç›®æ ‡æ–¹æ³•ï¼ˆtryï¼‰ -\u0026gt; æ‰§è¡Œ confirm å’Œ cancel æ–¹æ³•\næ€»ç»“ ç†Ÿæ‚‰ TCC-Transaction çš„åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†æµç¨‹ TCC-Transaction ä¸èƒ½ä¿è¯å¹‚ç­‰æ€§ TCC åˆ†å¸ƒå¼äº‹åŠ¡çš„æ ¸å¿ƒæ˜¯èµ„æºï¼ˆä¸šåŠ¡èµ„æºå’Œäº‹åŠ¡èµ„æºï¼‰ ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/10.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/","summary":"\u003ch1 id=\"ç« èŠ‚æ¦‚è¦\"\u003eç« èŠ‚æ¦‚è¦\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eäº‹åŠ¡ç®€ä»‹\u003c/li\u003e\n\u003cli\u003eåˆ†å¸ƒå¼äº‹åŠ¡çš„å‰ä¸–ä»Šç”Ÿ\u003c/li\u003e\n\u003cli\u003eåˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ\u003c/li\u003e\n\u003cli\u003eä¸»æµåˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ä»‹ç»\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"äº‹åŠ¡ç®€ä»‹\"\u003eäº‹åŠ¡ç®€ä»‹\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eäº‹åŠ¡æ˜¯ç”¨æ¥ä¿è¯ä¸€ç»„\u003cstrong\u003eæ•°æ®æ“ä½œ\u003c/strong\u003eçš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§çš„\u003c/li\u003e\n\u003cli\u003eäº‹åŠ¡å¿…é¡»æ»¡è¶³ ACID çš„å››å¤§ç‰¹æ€§\u003c/li\u003e\n\u003cli\u003eäº‹åŠ¡å…·æœ‰å››ç§éš”ç¦»çº§åˆ«\u003c/li\u003e\n\u003cli\u003eäº‹åŠ¡å…·æœ‰ä¸ƒç§ä¼ æ’­è¡Œä¸º\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"äº‹åŠ¡å±æ€§\"\u003eäº‹åŠ¡å±æ€§\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eåŸå­æ€§ï¼ˆAtomicityï¼‰\u003c/li\u003e\n\u003cli\u003eä¸€è‡´æ€§ï¼ˆConsistencyï¼‰\u003c/li\u003e\n\u003cli\u003eéš”ç¦»å‹ï¼ˆIsolationï¼‰\u003c/li\u003e\n\u003cli\u003eæŒä¹…æ€§ï¼ˆDurabilityï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"åˆ†å¸ƒå¼äº‹åŠ¡\"\u003eåˆ†å¸ƒå¼äº‹åŠ¡\u003c/h1\u003e\n\u003ch2 id=\"æ¦‚å¿µ\"\u003eæ¦‚å¿µ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eåˆ†å¸ƒå¼äº‹åŠ¡å°±æ˜¯å°†å¤šä¸ªèŠ‚ç‚¹çš„äº‹åŠ¡çœ‹æˆä¸€ä¸ªæ•´ä½“å¤„ç†\u003c/li\u003e\n\u003cli\u003eåˆ†å¸ƒå¼äº‹åŠ¡ç”±äº‹åŠ¡å‚ä¸è€…ã€èµ„æºæœåŠ¡å™¨ã€äº‹åŠ¡ç®¡ç†å™¨ç­‰ç»„æˆ\u003c/li\u003e\n\u003cli\u003eå¸¸è§çš„åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¾‹å­ï¼šæ”¯ä»˜ã€ä¸‹è®¢å•ç­‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"å®ç°æ€è·¯\"\u003eå®ç°æ€è·¯\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eä¸¤æ®µå¼äº‹åŠ¡å’Œä¸‰æ®µå¼äº‹åŠ¡\u003c/li\u003e\n\u003cli\u003eåŸºäº XA çš„åˆ†å¸ƒå¼äº‹åŠ¡\u003c/li\u003e\n\u003cli\u003eåŸºäºæ¶ˆæ¯çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTCC ç¼–ç¨‹å¼è¡¥å¿æ€§äº‹åŠ¡\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"åˆ†å¸ƒå¼äº‹åŠ¡ç±»å‹\"\u003eåˆ†å¸ƒå¼äº‹åŠ¡ç±»å‹\u003c/h1\u003e\n\u003ch2 id=\"ä¸¤æ®µå¼å’Œä¸‰æ®µå¼äº‹åŠ¡\"\u003eä¸¤æ®µå¼å’Œä¸‰æ®µå¼äº‹åŠ¡\u003c/h2\u003e\n\u003ch3 id=\"ä¸¤æ®µå¼äº‹åŠ¡\"\u003eä¸¤æ®µå¼äº‹åŠ¡\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"ä¸¤æ®µå¼äº‹åŠ¡\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/10.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/images/63d3220513cf709f84fdcd06457c3b65.png\"\u003e\u003c/p\u003e\n\u003ch3 id=\"ä¸‰æ®µå¼äº‹åŠ¡\"\u003eä¸‰æ®µå¼äº‹åŠ¡\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"ä¸‰æ®µå¼äº‹åŠ¡\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/10.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/images/image-20200416213159506.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"åŸºäº-xa-çš„åˆ†å¸ƒå¼äº‹åŠ¡\"\u003eåŸºäº XA çš„åˆ†å¸ƒå¼äº‹åŠ¡\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"åŸºäºXAçš„åˆ†å¸ƒå¼äº‹åŠ¡\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/10.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/images/image-20200416213551917.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"åŸºäºæ¶ˆæ¯çš„ä¸€è‡´æ€§æ–¹æ¡ˆ\"\u003eåŸºäºæ¶ˆæ¯çš„ä¸€è‡´æ€§æ–¹æ¡ˆ\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"åŸºäºæ¶ˆæ¯çš„ä¸€è‡´æ€§æ–¹æ¡ˆ\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/10.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/images/image-20200416215409588.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"tcc-è¡¥å¿æ€§äº‹åŠ¡\"\u003eTCC è¡¥å¿æ€§äº‹åŠ¡\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"TCCè¡¥å¿æ€§äº‹åŠ¡\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/10.%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/images/image-20200416220735799.png\"\u003e\u003c/p\u003e\n\u003ch3 id=\"åŸºäºæ¶ˆæ¯çš„ä¸€è‡´æ€§æ–¹æ¡ˆå’Œ-tcc-è¡¥å¿æ€§äº‹åŠ¡çš„åŒºåˆ«\"\u003eåŸºäºæ¶ˆæ¯çš„ä¸€è‡´æ€§æ–¹æ¡ˆå’Œ TCC è¡¥å¿æ€§äº‹åŠ¡çš„åŒºåˆ«\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eåŸºäºæ¶ˆæ¯çš„äº‹åŠ¡æ˜¯å¼ºä¸€è‡´æ€§äº‹åŠ¡ï¼Œä¼šå­˜åœ¨æµªè´¹\u003c/li\u003e\n\u003cli\u003eTCC äº‹åŠ¡æ˜¯æŸ”æ€§äº‹åŠ¡ï¼Œåœ¨ try é˜¶æ®µè¦å¯¹èµ„æºåšé¢„ç•™\u003c/li\u003e\n\u003cli\u003eTCC äº‹åŠ¡åœ¨ç¡®è®¤æˆ–å–æ¶ˆé˜¶æ®µé‡Šæ”¾èµ„æº\u003c/li\u003e\n\u003cli\u003eä¸åŸºäºæ¶ˆæ¯çš„äº‹åŠ¡å¯¹æ¯”ï¼ŒTCC çš„æ—¶æ•ˆæ€§æ›´å¥½\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶\"\u003eåˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eå…¨å±€äº‹åŠ¡æœåŠ¡ï¼ˆGlobal Transaction Serviceï¼Œç®€ç§° GTSï¼‰\u003c/li\u003e\n\u003cli\u003eèš‚èšé‡‘æœåˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆDistributed Transaction-eXtendedï¼Œç®€ç§° DTXï¼‰\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå¼€æº TCC æ¡†æ¶ï¼ˆTCC-Transactionï¼‰\u003c/strong\u003eï¼ˆhttps://github.com/changmingxie/tcc-transactionï¼‰\u003c/li\u003e\n\u003cli\u003eå¼€æº TCC æ¡†æ¶ï¼ˆByteTCCï¼‰ï¼ˆhttps://github.com/liuyangming/ByteTCCï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"tcc-transaction-åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶\"\u003eTCC-Transaction åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003eGithub ä»“åº“ï¼šhttps://github.com/changmingxie/tcc-transaction\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ10ï¼‰ï¼šåˆ†å¸ƒå¼äº‹åŠ¡"},{"content":"The basic task is simple: given N real numbers, you are supposed to calculate their average. But what makes it complicated is that some of the input numbers might not be legal. A legal input is a real number in [âˆ’1000,1000] and is accurate up to no more than 2 decimal places. When you calculate the average, those illegal numbers must not be counted in.\nInput Specification: Each input file contains one test case. For each case, the first line gives a positive integer N (â‰¤100). Then N numbers are given in the next line, separated by one space.\nOutput Specification: For each illegal input number, print in a line ERROR: X is not a legal number where X is the input. Then finally print in a line the result: The average of K numbers is Y where K is the number of legal inputs and Y is their average, accurate to 2 decimal places. In case the average cannot be calculated, output Undefined instead of Y. In case K is only 1, output The average of 1 number is Y instead.\nSample Input 1: 7 5 -3.2 aaa 9999 2.3.4 7.123 2.35 Sample Output 1: ERROR: aaa is not a legal number ERROR: 9999 is not a legal number ERROR: 2.3.4 is not a legal number ERROR: 7.123 is not a legal number The average of 3 numbers is 1.38 Sample Input 2: 2 aaa -9999 Sample Output 2: ERROR: aaa is not a legal number ERROR: -9999 is not a legal number The average of 0 numbers is Undefined æ³¨æ„ç‚¹ å­—ç¬¦ä¸²æ•°ç»„ä¸èƒ½å¼€å¤ªå°ï¼Œå¦åˆ™ä¼šé€ æˆ â€œè¿è¡Œæ—¶é”™è¯¯â€ï¼Œå³æ•°ç»„è¶Šç•Œã€‚å®æµ‹å¤§å°è‡³å°‘ä¸º50. æ–¹æ³•ä¸€ æ¥è‡ªæŸ³ç¥ï¼Œä¸å®¹æ˜“æƒ³åˆ°ã€‚è¿ç”¨ sscanf å’Œ sprintf åå¯ä»¥æ–¹ä¾¿åˆ¤æ–­æ˜¯å¦ä¸ºåˆæ³•æ•°å­—ã€‚åˆ©ç”¨ sscanf(a, \u0026ldquo;%lf\u0026rdquo;, \u0026amp;temp) å°†åŸå­—ç¬¦ä¸²è¾“å…¥ä¸º double å‹ï¼Œå†åˆ©ç”¨ sprintf(b, \u0026ldquo;%.2f\u0026rdquo;,temp) å°†è¯¥ double å‹æ•°å­—è¾“å‡ºä¸ºä¿ç•™ä¸¤ä½å°æ•°çš„å­—ç¬¦ä¸²ã€‚ä¹‹ååˆ¤æ–­ä¿ç•™ä¸¤ä½å°æ•°åçš„å­—ç¬¦ä¸²å’ŒåŸå­—ç¬¦ä¸²æ˜¯å¦ç›¸åŒï¼Œå³å¯åˆ¤æ–­æ˜¯å¦åˆæ³•ã€‚\n#include \u0026lt;iostream\u0026gt; #include \u0026lt;cstdio\u0026gt; #include \u0026lt;string.h\u0026gt; using namespace std; int main() { int n, cnt = 0; char a[50], b[50]; double temp, sum = 0.0; cin \u0026gt;\u0026gt; n; for(int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%s\u0026#34;, a); sscanf(a, \u0026#34;%lf\u0026#34;, \u0026amp;temp); sprintf(b, \u0026#34;%.2f\u0026#34;,temp); int flag = 0; for(int j = 0; j \u0026lt; strlen(a); j++) if(a[j] != b[j]) flag = 1; if(flag || temp \u0026lt; -1000 || temp \u0026gt; 1000) { printf(\u0026#34;ERROR: %s is not a legal number\\n\u0026#34;, a); continue; } else { sum += temp; cnt++; } } if(cnt == 1) printf(\u0026#34;The average of 1 number is %.2f\u0026#34;, sum); else if(cnt \u0026gt; 1) printf(\u0026#34;The average of %d numbers is %.2f\u0026#34;, cnt, sum / cnt); else printf(\u0026#34;The average of 0 numbers is Undefined\u0026#34;); return 0; } æ–¹æ³•äºŒ æˆ‘çš„æ–¹æ³•æ¯”è¾ƒç¬¨ï¼Œä½†æœ€ç›´æ¥ï¼Œæ€è·¯ç®€å•ï¼Œå°±æ˜¯ç›´æ¥éå†åŸå­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦åˆæ³•ã€‚\n#include \u0026lt;cstdio\u0026gt; #include \u0026lt;cstring\u0026gt; #include \u0026lt;string\u0026gt; using namespace std; int main() { int n, cnt = 0; scanf(\u0026#34;%d\u0026#34;, \u0026amp;n); char str[50]; double total = 0; for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%s\u0026#34;, str); int len = strlen(str), index = -1; bool flag = true; for (int i = 0; i \u0026lt; len; i++) { if (str[i] == \u0026#39;.\u0026#39;) { if (i \u0026lt; len - 3 || index != -1) { flag = false; break; } index = i; } else if ((str[i] \u0026lt; \u0026#39;0\u0026#39; || str[i] \u0026gt; \u0026#39;9\u0026#39;) \u0026amp;\u0026amp; !(i == 0 \u0026amp;\u0026amp; str[i] == \u0026#39;-\u0026#39;)) { flag = false; } } if (!flag) { printf(\u0026#34;ERROR: %s is not a legal number\\n\u0026#34;, str); } else { double num = stod(str); if (num \u0026lt; -1000 || num \u0026gt; 1000) { printf(\u0026#34;ERROR: %s is not a legal number\\n\u0026#34;, str); } else { cnt++; total += num; } } } if (cnt == 0) { printf(\u0026#34;The average of 0 numbers is Undefined\u0026#34;); } else if (cnt == 1) { printf(\u0026#34;The average of 1 number is %.2f\u0026#34;, total / cnt); } else { printf(\u0026#34;The average of %d numbers is %.2f\u0026#34;, cnt, total / cnt); } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1108/","summary":"\u003cp\u003eThe basic task is simple: given \u003cem\u003eN\u003c/em\u003e real numbers, you are supposed to calculate their average. But what makes it complicated is that some of the input numbers might not be legal. A \u003cstrong\u003elegal\u003c/strong\u003e input is a real number in [âˆ’1000,1000] and is accurate up to no more than 2 decimal places. When you calculate the average, those illegal numbers must not be counted in.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case. For each case, the first line gives a positive integer \u003cem\u003eN\u003c/em\u003e (â‰¤100). Then \u003cem\u003eN\u003c/em\u003e numbers are given in the next line, separated by one space.\u003c/p\u003e","title":"PATç”²çº§ 1108 Finding Average (20åˆ†)"},{"content":"A gas station has to be built at such a location that the minimum distance between the station and any of the residential housing is as far away as possible. However it must guarantee that all the houses are in its service range.\nNow given the map of the city and several candidate locations for the gas station, you are supposed to give the best recommendation. If there are more than one solution, output the one with the smallest average distance to all the houses. If such a solution is still not unique, output the one with the smallest index number.\nInput Specification: Each input file contains one test case. For each case, the first line contains 4 positive integers: N (â‰¤10^3), the total number of houses; M (â‰¤10), the total number of the candidate locations for the gas stations; K (â‰¤ 10^4 ), the number of roads connecting the houses and the gas stations; and D S, the maximum service range of the gas station. It is hence assumed that all the houses are numbered from 1 to N, and all the candidate locations are numbered from G1 to GM.\nThen K lines follow, each describes a road in the format\nP1 P2 Dist where P1 and P2 are the two ends of a road which can be either house numbers or gas station numbers, and Dist is the integer length of the road.\nOutput Specification: For each test case, print in the first line the index number of the best location. In the next line, print the minimum and the average distances between the solution and all the houses. The numbers in a line must be separated by a space and be accurate up to 1 decimal place. If the solution does not exist, simply output No Solution.\nSample Input 1: 4 3 11 5 1 2 2 1 4 2 1 G1 4 1 G2 3 2 3 2 2 G2 1 3 4 2 3 G3 2 4 G1 3 G2 G1 1 G3 G2 2 Sample Output 1: G1 2.0 3.3 Sample Input 2: 2 1 2 10 1 G1 9 2 G1 20 Sample Output 2: No Solution æ³¨æ„ç‚¹ åŠ æ²¹ç«™å’Œå±…æ°‘æˆ¿çš„ç¼–å·éƒ½æœ‰å¯èƒ½ä¸ºä¸¤ä½æ•°ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²æ•°ç»„èµ·ç è¦å¼€ 4 ä¸ªå¤§å°ã€‚ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int maxn = 1011, INF = 1000000000; int n, m, k, ds, G[maxn][maxn], d[maxn], minD = 0, minG = -1; double minAvgD = INF; bool vis[maxn] = {false}; int getIndex(char str[]) { int i = 0, index = 0; if (str[0] == \u0026#39;G\u0026#39;) { i++; } while (str[i] != \u0026#39;\\0\u0026#39;) { index = index * 10 + str[i] - \u0026#39;0\u0026#39;; i++; } if (str[0] == \u0026#39;G\u0026#39;) { return n + index; } else { return index; } } void Dijkstra(int root) { fill(d, d + maxn, INF); fill(vis, vis + maxn, false); d[root] = 0; for (int i = 1; i \u0026lt;= n + m; i++) { int u = -1, min = INF; for (int j = 1; j \u0026lt;= n + m; j++) { if (vis[j] == false \u0026amp;\u0026amp; d[j] \u0026lt; min) { min = d[j]; u = j; } } if (u == -1) { return; } vis[u] = true; for (int v = 1; v \u0026lt;= n + m; v++) { if (vis[v] == false \u0026amp;\u0026amp; G[u][v] != INF \u0026amp;\u0026amp; d[u] + G[u][v] \u0026lt; d[v]) { d[v] = d[u] + G[u][v]; } } } } int main() { scanf(\u0026#34;%d %d %d %d\u0026#34;, \u0026amp;n, \u0026amp;m, \u0026amp;k, \u0026amp;ds); fill(G[0], G[0] + maxn * maxn, INF); char str1[4], str2[4]; int v1, v2, dist; for (int i = 0; i \u0026lt; k; i++) { scanf(\u0026#34;%s %s %d\u0026#34;, str1, str2, \u0026amp;dist); v1 = getIndex(str1); v2 = getIndex(str2); G[v1][v2] = G[v2][v1] = dist; } for (int i = n + 1; i \u0026lt;= n + m; i++) { Dijkstra(i); double tempAvgD = 0; int tempMinD = INF; for (int j = 1; j \u0026lt;= n; j++) { if (d[j] \u0026gt; ds) { tempMinD = -1; break; } if (d[j] \u0026lt; tempMinD) { tempMinD = d[j]; } tempAvgD += 1.0 * d[j] / n; } if (tempMinD != -1) { if (tempMinD \u0026gt; minD) { minD = tempMinD; minG = i - n; minAvgD = tempAvgD; } else if (tempMinD == minD \u0026amp;\u0026amp; tempAvgD \u0026lt; minAvgD) { minG = i - n; minAvgD = tempAvgD; } } } if (minG == -1) { printf(\u0026#34;No Solution\u0026#34;); } else { printf(\u0026#34;G%d\\n\u0026#34;, minG); printf(\u0026#34;%.1f %.1f\u0026#34;, 1.0 * minD, minAvgD); } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1072/","summary":"\u003cp\u003eA gas station has to be built at such a location that the minimum distance between the station and any of the residential housing is as far away as possible. However it must guarantee that all the houses are in its service range.\u003c/p\u003e\n\u003cp\u003eNow given the map of the city and several candidate locations for the gas station, you are supposed to give the best recommendation. If there are more than one solution, output the one with the smallest average distance to all the houses. If such a solution is still not unique, output the one with the smallest index number.\u003c/p\u003e","title":"PATç”²çº§ 1072 Gas Station (30åˆ†)"},{"content":"There is a public bike service in Hangzhou City which provides great convenience to the tourists from all over the world. One may rent a bike at any station and return it to any other stations in the city.\nThe Public Bike Management Center (PBMC) keeps monitoring the real-time capacity of all the stations. A station is said to be in perfect condition if it is exactly half-full. If a station is full or empty, PBMC will collect or send bikes to adjust the condition of that station to perfect. And more, all the stations on the way will be adjusted as well.\nWhen a problem station is reported, PBMC will always choose the shortest path to reach that station. If there are more than one shortest path, the one that requires the least number of bikes sent from PBMC will be chosen.\nThe above figure illustrates an example. The stations are represented by vertices and the roads correspond to the edges. The number on an edge is the time taken to reach one end station from another. The number written inside a vertex S is the current number of bikes stored at S. Given that the maximum capacity of each station is 10. To solve the problem at S3, we have 2 different shortest paths:\nPBMC -\u0026gt; S1 -\u0026gt; S3. In this case, 4 bikes must be sent from PBMC, because we can collect 1 bike from S1 and then take 5 bikes to S3, so that both stations will be in perfect conditions. PBMC -\u0026gt; S2 -\u0026gt; S3. This path requires the same time as path 1, but only 3 bikes sent from PBMC and hence is the one that will be chosen. Input Specification: Each input file contains one test case. For each case, the first line contains 4 numbers: Cmax (â‰¤100), always an even number, is the maximum capacity of each station; N (â‰¤500), the total number of stations; Sp, the index of the problem station (the stations are numbered from 1 to N, and PBMC is represented by the vertex 0); and M, the number of roads. The second line contains N non-negative numbers Ci (i=1,â‹¯,N) where each Ci is the current number of bikes at Si respectively. Then M lines follow, each contains 3 numbers: Si, Sj, and Tij which describe the time Tij taken to move betwen stations Si and Sj. All the numbers in a line are separated by a space.\nOutput Specification: For each test case, print your results in one line. First output the number of bikes that PBMC must send. Then after one space, output the path in the format: 0âˆ’\u0026gt;S1âˆ’\u0026gt;â‹¯âˆ’\u0026gt;Sp. Finally after another space, output the number of bikes that we must take back to PBMC after the condition of Sp is adjusted to perfect.\nNote that if such a path is not unique, output the one that requires minimum number of bikes that we must take back to PBMC. The judge\u0026rsquo;s data guarantee that such a path is unique.\nSample Input: 10 3 3 5 6 7 0 0 1 1 0 2 1 0 3 3 1 3 1 2 3 1 Sample Output: 3 0-\u0026gt;2-\u0026gt;3 0 æ³¨æ„ç‚¹ åœ¨æ›´æ–° minNeed çš„æ—¶å€™ï¼Œåˆ«å¿˜äº†æ›´æ–°ç›¸åº”çš„ minBack #include \u0026lt;cstdio\u0026gt; #include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; using namespace std; const int maxn = 501, INF = 1000000000; int cmax, n, sp, m, c[maxn], G[maxn][maxn], t[maxn], minNeed = INF, minBack = INF; vector\u0026lt;int\u0026gt; path[maxn], temp, ans; bool vis[maxn] = {false}; void Dijkstra() { fill(t, t + maxn, INF); t[0] = 0; for (int i = 0; i \u0026lt;= n; i++) { int u = -1, min = INF; for (int j = 0; j \u0026lt; n; j++) { if (vis[j] == false \u0026amp;\u0026amp; t[j] \u0026lt; min) { min = t[j]; u = j; } } if (u == -1) { return; } vis[u] = true; for (int v = 0; v \u0026lt;= n; v++) { if (vis[v] == false \u0026amp;\u0026amp; G[u][v] != INF) { if (t[u] + G[u][v] \u0026lt; t[v]) { t[v] = t[u] + G[u][v]; path[v].clear(); path[v].push_back(u); } else if (t[u] + G[u][v] == t[v]) { path[v].push_back(u); } } } } } void DFS(int root) { temp.push_back(root); if (root == 0) { int now = 0, need = 0; for (int i = temp.size() - 2; i \u0026gt;= 0; i--) { if (c[temp[i]] \u0026lt; cmax / 2) { if (now \u0026gt;= (cmax / 2 - c[temp[i]])) { now -= cmax / 2 - c[temp[i]]; } else { need += cmax / 2 - c[temp[i]] - now; now = 0; } } else { now += c[temp[i]] - cmax / 2; } } if (need \u0026lt; minNeed) { minNeed = need; minBack = now; ans = temp; } else if (need == minNeed) { if (now \u0026lt; minBack) { minBack = now; ans = temp; } } temp.pop_back(); return; } for (int i = 0; i \u0026lt; path[root].size(); i++) { DFS(path[root][i]); } temp.pop_back(); } int main() { scanf(\u0026#34;%d %d %d %d\u0026#34;, \u0026amp;cmax, \u0026amp;n, \u0026amp;sp, \u0026amp;m); fill(G[0], G[0] + maxn * maxn, INF); for (int i = 1; i \u0026lt;= n; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;c[i]); } int s1, s2, t; for (int i = 0; i \u0026lt; m; i++) { scanf(\u0026#34;%d %d %d\u0026#34;, \u0026amp;s1, \u0026amp;s2, \u0026amp;t); G[s1][s2] = G[s2][s1] = t; } Dijkstra(); DFS(sp); printf(\u0026#34;%d \u0026#34;, minNeed); for (int i = ans.size() - 1; i \u0026gt;= 0; i--) { printf(\u0026#34;%d\u0026#34;, ans[i]); if (i != 0) { printf(\u0026#34;-\u0026gt;\u0026#34;); } } printf(\u0026#34; %d\u0026#34;, minBack); return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1018/","summary":"\u003cp\u003eThere is a public bike service in Hangzhou City which provides great convenience to the tourists from all over the world. One may rent a bike at any station and return it to any other stations in the city.\u003c/p\u003e\n\u003cp\u003eThe Public Bike Management Center (PBMC) keeps monitoring the real-time capacity of all the stations. A station is said to be in \u003cstrong\u003eperfect\u003c/strong\u003e condition if it is exactly half-full. If a station is full or empty, PBMC will collect or send bikes to adjust the condition of that station to perfect. And more, all the stations on the way will be adjusted as well.\u003c/p\u003e","title":"PATç”²çº§ 1018 Public Bike Management (30åˆ†)"},{"content":"ç« èŠ‚æ¦‚è¦ å®Œæˆæ”¯ä»˜æ¨¡å—ä¸šåŠ¡å¼€å‘ Dubbo ç‰¹æ€§å­¦ä¹ ï¼šéšå¼å‚æ•°ã€å‚æ•°éªŒè¯ç­‰ Dubbo æœ¬åœ°å­˜æ ¹ æœ¬åœ°å­˜æ ¹ç±»ä¼¼äº Dubbo çš„é™æ€ä»£ç† Dubbo ä¼šåœ¨å®¢æˆ·ç«¯ç”Ÿæˆä¸€ä¸ªä»£ç†ï¼Œå¤„ç†éƒ¨åˆ†ä¸šåŠ¡ Stub å¿…é¡»æœ‰å¯ä¼ å…¥ Proxy çš„æ„é€ å‡½æ•° å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/local-stub.html\nè¿œç¨‹æœåŠ¡åï¼Œå®¢æˆ·ç«¯é€šå¸¸åªå‰©ä¸‹æ¥å£ï¼Œè€Œå®ç°å…¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œä½†æä¾›æ–¹æœ‰äº›æ—¶å€™æƒ³åœ¨å®¢æˆ·ç«¯ä¹Ÿæ‰§è¡Œéƒ¨åˆ†é€»è¾‘ï¼Œæ¯”å¦‚ï¼šåš ThreadLocal ç¼“å­˜ï¼Œæå‰éªŒè¯å‚æ•°ï¼Œè°ƒç”¨å¤±è´¥åä¼ªé€ å®¹é”™æ•°æ®ç­‰ç­‰ï¼Œæ­¤æ—¶å°±éœ€è¦åœ¨ API ä¸­å¸¦ä¸Š Stubï¼Œå®¢æˆ·ç«¯ç”Ÿæˆ Proxy å®ä¾‹ï¼Œä¼šæŠŠ Proxy é€šè¿‡æ„é€ å‡½æ•°ä¼ ç»™ Stubï¼Œç„¶åæŠŠ Stub æš´éœ²ç»™ç”¨æˆ·ï¼ŒStub å¯ä»¥å†³å®šè¦ä¸è¦å»è°ƒ Proxyã€‚\nåœ¨ spring é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34; stub=\u0026#34;true\u0026#34; /\u0026gt; æˆ–\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34; stub=\u0026#34;com.foo.BarServiceStub\u0026#34; /\u0026gt; æä¾› Stub çš„å®ç°ï¼š\npackage com.foo; public class BarServiceStub implements BarService { private final BarService barService; // æ„é€ å‡½æ•°ä¼ å…¥çœŸæ­£çš„è¿œç¨‹ä»£ç†å¯¹è±¡ public BarServiceStub(BarService barService){ this.barService = barService; } public String sayHello(String name) { // æ­¤ä»£ç åœ¨å®¢æˆ·ç«¯æ‰§è¡Œ, ä½ å¯ä»¥åœ¨å®¢æˆ·ç«¯åšThreadLocalæœ¬åœ°ç¼“å­˜ï¼Œæˆ–é¢„å…ˆéªŒè¯å‚æ•°æ˜¯å¦åˆæ³•ï¼Œç­‰ç­‰ try { return barService.sayHello(name); } catch (Exception e) { // ä½ å¯ä»¥å®¹é”™ï¼Œå¯ä»¥åšä»»ä½•AOPæ‹¦æˆªäº‹é¡¹ return \u0026#34;å®¹é”™æ•°æ®\u0026#34;; } } } Stub å¿…é¡»æœ‰å¯ä¼ å…¥ Proxy çš„æ„é€ å‡½æ•°ã€‚ åœ¨ interface æ—è¾¹æ”¾ä¸€ä¸ª Stub å®ç°ï¼Œå®ƒå®ç° BarService æ¥å£ï¼Œå¹¶æœ‰ä¸€ä¸ªä¼ å…¥è¿œç¨‹ BarService å®ä¾‹çš„æ„é€ å‡½æ•° Dubbo æœ¬åœ°ä¼ªè£… æœ¬åœ°ä¼ªè£…æ˜¯æœ¬åœ°å­˜æ ¹çš„ä¸€ä¸ªå­é›† é€šå¸¸ä¼šä½¿ç”¨æœ¬åœ°ä¼ªè£…å¤„ç†æœåŠ¡é™çº§ å»ºè®®æœ¬åœ°ä¼ªè£…åœ¨å®¢æˆ·ç«¯å®ç° å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/local-mock.html\næœ¬åœ°ä¼ªè£…é€šå¸¸ç”¨äºæœåŠ¡é™çº§ï¼Œæ¯”å¦‚æŸéªŒæƒæœåŠ¡ï¼Œå½“æœåŠ¡æä¾›æ–¹å…¨éƒ¨æŒ‚æ‰åï¼Œå®¢æˆ·ç«¯ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯é€šè¿‡ Mock æ•°æ®è¿”å›æˆæƒå¤±è´¥ã€‚\nåœ¨ spring é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; mock=\u0026#34;true\u0026#34; /\u0026gt; æˆ–\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; mock=\u0026#34;com.foo.BarServiceMock\u0026#34; /\u0026gt; åœ¨å·¥ç¨‹ä¸­æä¾› Mock å®ç°ï¼š\npackage com.foo; public class BarServiceMock implements BarService { public String sayHello(String name) { // ä½ å¯ä»¥ä¼ªé€ å®¹é”™æ•°æ®ï¼Œæ­¤æ–¹æ³•åªåœ¨å‡ºç°RpcExceptionæ—¶è¢«æ‰§è¡Œ return \u0026#34;å®¹é”™æ•°æ®\u0026#34;; } } å¦‚æœæœåŠ¡çš„æ¶ˆè´¹æ–¹ç»å¸¸éœ€è¦ try-catch æ•è·å¼‚å¸¸ï¼Œå¦‚ï¼š\nOffer offer = null; try { offer = offerService.findOffer(offerId); } catch (RpcException e) { logger.error(e); } è¯·è€ƒè™‘æ”¹ä¸º Mock å®ç°ï¼Œå¹¶åœ¨ Mock å®ç°ä¸­ return nullã€‚å¦‚æœåªæ˜¯æƒ³ç®€å•çš„å¿½ç•¥å¼‚å¸¸ï¼Œåœ¨ 2.0.11 ä»¥ä¸Šç‰ˆæœ¬å¯ç”¨ï¼š\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; mock=\u0026#34;return null\u0026#34; /\u0026gt; è¿›é˜¶ç”¨æ³• return ä½¿ç”¨ return æ¥è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºçš„å¯¹è±¡ï¼Œä½œä¸º Mock çš„è¿”å›å€¼ã€‚åˆæ³•çš„å­—ç¬¦ä¸²å¯ä»¥æ˜¯ï¼š\nempty: ä»£è¡¨ç©ºï¼ŒåŸºæœ¬ç±»å‹çš„é»˜è®¤å€¼ï¼Œæˆ–è€…é›†åˆç±»çš„ç©ºå€¼ null: null true: true false: false JSON æ ¼å¼: ååºåˆ—åŒ– JSON æ‰€å¾—åˆ°çš„å¯¹è±¡ throw ä½¿ç”¨ throw æ¥è¿”å›ä¸€ä¸ª Exception å¯¹è±¡ï¼Œä½œä¸º Mock çš„è¿”å›å€¼ã€‚\nå½“è°ƒç”¨å‡ºé”™æ—¶ï¼ŒæŠ›å‡ºä¸€ä¸ªé»˜è®¤çš„ RPCException:\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; mock=\u0026#34;throw\u0026#34; /\u0026gt; å½“è°ƒç”¨å‡ºé”™æ—¶ï¼ŒæŠ›å‡ºæŒ‡å®šçš„ Exceptionï¼š\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; mock=\u0026#34;throw com.foo.MockException\u0026#34; /\u0026gt; force å’Œ fail åœ¨ 2.6.6 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå¯ä»¥å¼€å§‹åœ¨ Spring XML é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ fail: å’Œ force:ã€‚force: ä»£è¡¨å¼ºåˆ¶ä½¿ç”¨ Mock è¡Œä¸ºï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¸ä¼šèµ°è¿œç¨‹è°ƒç”¨ã€‚fail: ä¸é»˜è®¤è¡Œä¸ºä¸€è‡´ï¼Œåªæœ‰å½“è¿œç¨‹è°ƒç”¨å‘ç”Ÿé”™è¯¯æ—¶æ‰ä½¿ç”¨ Mock è¡Œä¸ºã€‚force: å’Œ fail: éƒ½æ”¯æŒä¸ throw æˆ–è€… return ç»„åˆä½¿ç”¨ã€‚\nå¼ºåˆ¶è¿”å›æŒ‡å®šå€¼ï¼š\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; mock=\u0026#34;force:return fake\u0026#34; /\u0026gt; å¼ºåˆ¶æŠ›å‡ºæŒ‡å®šå¼‚å¸¸ï¼š\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; mock=\u0026#34;force:throw com.foo.MockException\u0026#34; /\u0026gt; åœ¨æ–¹æ³•çº§åˆ«é…ç½® Mock Mock å¯ä»¥åœ¨æ–¹æ³•çº§åˆ«ä¸ŠæŒ‡å®šï¼Œå‡å®š com.foo.BarService ä¸Šæœ‰å¥½å‡ ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å•ç‹¬ä¸º sayHello() æ–¹æ³•æŒ‡å®š Mock è¡Œä¸ºã€‚å…·ä½“é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œåªè¦ sayHello() è¢«è°ƒç”¨åˆ°æ—¶ï¼Œå¼ºåˆ¶è¿”å› \u0026ldquo;fake\u0026rdquo;:\n\u0026lt;dubbo:reference id=\u0026#34;demoService\u0026#34; check=\u0026#34;false\u0026#34; interface=\u0026#34;com.foo.BarService\u0026#34;\u0026gt; \u0026lt;dubbo:parameter key=\u0026#34;sayHello.mock\u0026#34; value=\u0026#34;force:return fake\u0026#34;/\u0026gt; \u0026lt;/dubbo:reference\u0026gt; Mock æ˜¯ Stub çš„ä¸€ä¸ªå­é›†ï¼Œä¾¿äºæœåŠ¡æä¾›æ–¹åœ¨å®¢æˆ·ç«¯æ‰§è¡Œå®¹é”™é€»è¾‘ï¼Œå› ç»å¸¸éœ€è¦åœ¨å‡ºç° RpcException (æ¯”å¦‚ç½‘ç»œå¤±è´¥ï¼Œè¶…æ—¶ç­‰)æ—¶è¿›è¡Œå®¹é”™ï¼Œè€Œåœ¨å‡ºç°ä¸šåŠ¡å¼‚å¸¸(æ¯”å¦‚ç™»å½•ç”¨æˆ·åå¯†ç é”™è¯¯)æ—¶ä¸éœ€è¦å®¹é”™ï¼Œå¦‚æœç”¨ Stubï¼Œå¯èƒ½å°±éœ€è¦æ•è·å¹¶ä¾èµ– RpcException ç±»ï¼Œè€Œç”¨ Mock å°±å¯ä»¥ä¸ä¾èµ– RpcExceptionï¼Œå› ä¸ºå®ƒçš„çº¦å®šå°±æ˜¯åªæœ‰å‡ºç° RpcException æ—¶æ‰æ‰§è¡Œã€‚ åœ¨ interface æ—æ”¾ä¸€ä¸ª Mock å®ç°ï¼Œå®ƒå®ç° BarService æ¥å£ï¼Œå¹¶æœ‰ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ã€‚ åœ¨ä½¿ç”¨ SpringBoot + Dubbo çš„é¡¹ç›®ä¸­ï¼Œä¼˜å…ˆä½¿ç”¨ Hystrix æä¾›çš„ç†”æ–­é™çº§ï¼Œå› ä¸º Mock åªèƒ½æ•è· RpcException (æ¯”å¦‚ç½‘ç»œå¤±è´¥ï¼Œè¶…æ—¶ç­‰)ï¼Œè€Œä¸èƒ½æ•è· Java å¼‚å¸¸ã€‚\nDubbo éšå¼å‚æ•° Dubbo æä¾›äº†å‚æ•°çš„éšå¼ä¼ é€’ Dubbo çš„éšå¼å‚æ•°ä»…å•æ¬¡è°ƒç”¨å¯ç”¨ æ³¨æ„éšå¼å‚æ•°çš„ä¿ç•™å­—æ®µ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/attachment.html\nå¯ä»¥é€šè¿‡ RpcContext ä¸Šçš„ setAttachment å’Œ getAttachment åœ¨æœåŠ¡æ¶ˆè´¹æ–¹å’Œæä¾›æ–¹ä¹‹é—´è¿›è¡Œå‚æ•°çš„éšå¼ä¼ é€’ã€‚\nåœ¨æœåŠ¡æ¶ˆè´¹æ–¹ç«¯è®¾ç½®éšå¼å‚æ•° setAttachment è®¾ç½®çš„ KV å¯¹ï¼Œåœ¨å®Œæˆä¸‹é¢ä¸€æ¬¡è¿œç¨‹è°ƒç”¨ä¼šè¢«æ¸…ç©ºï¼Œå³å¤šæ¬¡è¿œç¨‹è°ƒç”¨è¦å¤šæ¬¡è®¾ç½®ã€‚\nRpcContext.getContext().setAttachment(\u0026#34;index\u0026#34;, \u0026#34;1\u0026#34;); // éšå¼ä¼ å‚ï¼Œåé¢çš„è¿œç¨‹è°ƒç”¨éƒ½ä¼šéšå¼å°†è¿™äº›å‚æ•°å‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œç±»ä¼¼cookieï¼Œç”¨äºæ¡†æ¶é›†æˆï¼Œä¸å»ºè®®å¸¸è§„ä¸šåŠ¡ä½¿ç”¨ xxxService.xxx(); // è¿œç¨‹è°ƒç”¨ // ... åœ¨æœåŠ¡æä¾›æ–¹ç«¯è·å–éšå¼å‚æ•° public class XxxServiceImpl implements XxxService { public void xxx() { // è·å–å®¢æˆ·ç«¯éšå¼ä¼ å…¥çš„å‚æ•°ï¼Œç”¨äºæ¡†æ¶é›†æˆï¼Œä¸å»ºè®®å¸¸è§„ä¸šåŠ¡ä½¿ç”¨ String index = RpcContext.getContext().getAttachment(\u0026#34;index\u0026#34;); } } æ³¨æ„ï¼špath, group, version, dubbo, token, timeout å‡ ä¸ª key æ˜¯ä¿ç•™å­—æ®µï¼Œè¯·ä½¿ç”¨å…¶å®ƒå€¼ã€‚ æ€»ç»“ Dubbo ç‰¹æ€§ä¹‹éšå¼å‚æ•° Dubbo ç‰¹æ€§ä¹‹æœ¬åœ°å­˜æ ¹å’Œæœ¬åœ°ä¼ªè£…ï¼ˆæ›´å¸¸ç”¨ï¼‰ æ”¯ä»˜å®å½“é¢ä»˜åŠŸèƒ½å¯¹æ¥ ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/9.dubbo%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91%E6%94%AF%E4%BB%98%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91/","summary":"\u003ch1 id=\"ç« èŠ‚æ¦‚è¦\"\u003eç« èŠ‚æ¦‚è¦\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eå®Œæˆæ”¯ä»˜æ¨¡å—ä¸šåŠ¡å¼€å‘\u003c/li\u003e\n\u003cli\u003eDubbo ç‰¹æ€§å­¦ä¹ ï¼šéšå¼å‚æ•°ã€å‚æ•°éªŒè¯ç­‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"dubbo-æœ¬åœ°å­˜æ ¹\"\u003eDubbo æœ¬åœ°å­˜æ ¹\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eæœ¬åœ°å­˜æ ¹ç±»ä¼¼äº Dubbo çš„é™æ€ä»£ç†\u003c/li\u003e\n\u003cli\u003eDubbo ä¼šåœ¨å®¢æˆ·ç«¯ç”Ÿæˆä¸€ä¸ªä»£ç†ï¼Œå¤„ç†éƒ¨åˆ†ä¸šåŠ¡\u003c/li\u003e\n\u003cli\u003eStub å¿…é¡»æœ‰å¯ä¼ å…¥ Proxy çš„æ„é€ å‡½æ•°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eå®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/local-stub.html\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eè¿œç¨‹æœåŠ¡åï¼Œå®¢æˆ·ç«¯é€šå¸¸åªå‰©ä¸‹æ¥å£ï¼Œè€Œå®ç°å…¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œä½†æä¾›æ–¹æœ‰äº›æ—¶å€™æƒ³åœ¨å®¢æˆ·ç«¯ä¹Ÿæ‰§è¡Œéƒ¨åˆ†é€»è¾‘ï¼Œæ¯”å¦‚ï¼šåš ThreadLocal ç¼“å­˜ï¼Œæå‰éªŒè¯å‚æ•°ï¼Œè°ƒç”¨å¤±è´¥åä¼ªé€ å®¹é”™æ•°æ®ç­‰ç­‰ï¼Œæ­¤æ—¶å°±éœ€è¦åœ¨ API ä¸­å¸¦ä¸Š Stubï¼Œå®¢æˆ·ç«¯ç”Ÿæˆ Proxy å®ä¾‹ï¼Œä¼šæŠŠ Proxy é€šè¿‡æ„é€ å‡½æ•°ä¼ ç»™ Stubï¼Œç„¶åæŠŠ Stub æš´éœ²ç»™ç”¨æˆ·ï¼ŒStub å¯ä»¥å†³å®šè¦ä¸è¦å»è°ƒ Proxyã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Dubboæœ¬åœ°å­˜æ ¹\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/9.dubbo%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91%E6%94%AF%E4%BB%98%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91/images/stub.jpg\"\u003e\u003c/p\u003e\n\u003cp\u003eåœ¨ spring é…ç½®æ–‡ä»¶ä¸­æŒ‰ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:service\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estub=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæˆ–\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:service\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003estub=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarServiceStub\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæä¾› Stub çš„å®ç°ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003epackage\u003c/span\u003e com.foo;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003epublic\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eBarServiceStub\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eimplements\u003c/span\u003e BarService {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eprivate\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003efinal\u003c/span\u003e BarService barService;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e// æ„é€ å‡½æ•°ä¼ å…¥çœŸæ­£çš„è¿œç¨‹ä»£ç†å¯¹è±¡\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003epublic\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eBarServiceStub\u003c/span\u003e(BarService barService){\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ethis\u003c/span\u003e.\u003cspan style=\"color:#a6e22e\"\u003ebarService\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e barService;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003epublic\u003c/span\u003e String \u003cspan style=\"color:#a6e22e\"\u003esayHello\u003c/span\u003e(String name) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// æ­¤ä»£ç åœ¨å®¢æˆ·ç«¯æ‰§è¡Œ, ä½ å¯ä»¥åœ¨å®¢æˆ·ç«¯åšThreadLocalæœ¬åœ°ç¼“å­˜ï¼Œæˆ–é¢„å…ˆéªŒè¯å‚æ•°æ˜¯å¦åˆæ³•ï¼Œç­‰ç­‰\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003etry\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e barService.\u003cspan style=\"color:#a6e22e\"\u003esayHello\u003c/span\u003e(name);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        } \u003cspan style=\"color:#66d9ef\"\u003ecatch\u003c/span\u003e (Exception e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e// ä½ å¯ä»¥å®¹é”™ï¼Œå¯ä»¥åšä»»ä½•AOPæ‹¦æˆªäº‹é¡¹\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;å®¹é”™æ•°æ®\u0026#34;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003eStub å¿…é¡»æœ‰å¯ä¼ å…¥ Proxy çš„æ„é€ å‡½æ•°ã€‚\u003c/li\u003e\n\u003cli\u003eåœ¨ interface æ—è¾¹æ”¾ä¸€ä¸ª Stub å®ç°ï¼Œå®ƒå®ç° BarService æ¥å£ï¼Œå¹¶æœ‰ä¸€ä¸ªä¼ å…¥è¿œç¨‹ BarService å®ä¾‹çš„æ„é€ å‡½æ•°\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch1 id=\"dubbo-æœ¬åœ°ä¼ªè£…\"\u003eDubbo æœ¬åœ°ä¼ªè£…\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eæœ¬åœ°ä¼ªè£…æ˜¯æœ¬åœ°å­˜æ ¹çš„ä¸€ä¸ªå­é›†\u003c/li\u003e\n\u003cli\u003eé€šå¸¸ä¼šä½¿ç”¨æœ¬åœ°ä¼ªè£…å¤„ç†æœåŠ¡é™çº§\u003c/li\u003e\n\u003cli\u003eå»ºè®®æœ¬åœ°ä¼ªè£…åœ¨å®¢æˆ·ç«¯å®ç°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eå®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/local-mock.html\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ9ï¼‰ï¼šDubboæœåŠ¡å¼€å‘ï¼ˆæ”¯ä»˜æ¨¡å—å¼€å‘ï¼‰"},{"content":"æ ¹æ®å¾€å¹´ (2019) å¹´æµ™å¤§è½¯ä»¶å­¦é™¢çš„è€ƒç ”å¤è¯•å…¬å‘Šï¼Œå¦‚æœä»Šå¹´ (2020) æ˜¯çº¿ä¸‹å¤è¯•ï¼Œä¸”è€ƒåœºæ²¡æœ‰å˜åŒ–çš„è¯ï¼Œæœºè¯•åº”è¯¥è¿˜æ˜¯åœ¨ æµ™å¤§ç´«é‡‘æ¸¯æ ¡åŒºï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚\næµ™å¤§è½¯é™¢æ‹›ç”Ÿé€šçŸ¥ï¼šhttp://www.cst.zju.edu.cn/2019/0307/c36207a1478348/page.htm\nä» PAT å®˜ç½‘å¯ä»¥æ‰¾åˆ°ç´«é‡‘æ¸¯çš„æœºæˆ¿é…ç½®ï¼š\nPAT è€ƒç‚¹è”ç›Ÿï¼šhttps://www.patest.cn/location\næˆ‘æœ¬äººé€‰æ‹©ä½¿ç”¨ Dev C++ 5.10 ç‰ˆæœ¬ï¼Œè€ƒè¯•é‚£å¤©åœ¨è€ƒåœºéœ€è¦å…ˆå¯¹å…¶ä½œä»¥ä¸‹é…ç½®ï¼ˆå½“ç„¶ä¹Ÿè®¸å·²ç»é…ç½®å¥½äº†ï¼‰ï¼š\næ‰“å¼€äº§ç”Ÿè°ƒè¯•ä¿¡æ¯ åœ¨ â€œå·¥å…·(Tools)â€ -\u0026gt; â€œç¼–è¯‘é€‰é¡¹(Compiler Options)\u0026quot; ä¸­ï¼š\nç‚¹å‡» â€œä»£ç ç”Ÿæˆ/ä¼˜åŒ–(Settings)â€ é€‰é¡¹å¡ä¸­çš„ \u0026quot;è¿æ¥å™¨(Linker)\u0026quot; é€‰é¡¹å¡ï¼Œå°† \u0026quot;äº§ç”Ÿè°ƒè¯•ä¿¡æ¯(Generate debugging information)\u0026quot; é€‰é¡¹æ”¹ä¸º â€œYesâ€ã€‚\nè¿™æ ·ï¼Œå°±å¯ä»¥æ„‰å¿«çš„ Debug äº†ï½\næ·»åŠ  C++ 11 æ”¯æŒ ç”±äº PAT çš„ OJ æ˜¯æ”¯æŒ C++ 11 çš„ï¼Œæ•…æœ€å¥½æ‰“å¼€ C++ 11 æ”¯æŒã€‚\næ–¹æ³•ä¸€ï¼ˆæ¨èï¼‰ åœ¨ â€œå·¥å…·(Tools)â€ -\u0026gt; â€œç¼–è¯‘é€‰é¡¹(Compiler Options)\u0026quot; ä¸­ï¼Œâ€œä»£ç ç”Ÿæˆ/ä¼˜åŒ–(Settings)â€ é€‰é¡¹å¡ä¸‹çš„ â€œä»£ç ç”Ÿæˆ(Code Generation)â€ é€‰é¡¹å¡ä¸­ï¼Œå°† â€œè¯­è¨€æ ‡å‡†(Language Standard)(-std)â€ è®¾ç½®ä¸º ISO C++11 å³å¯ã€‚\næ–¹æ³•äºŒ åŒæ ·ï¼Œä¹Ÿå¯ä»¥åœ¨â€œå·¥å…·(Tools)â€ -\u0026gt; â€œç¼–è¯‘é€‰é¡¹(Compiler Options)\u0026quot;ä¸­ï¼Œåœ¨\u0026quot;ç¼–è¯‘å™¨(General)\u0026quot;é€‰é¡¹å¡ä¸­ï¼Œå‹¾é€‰\u0026quot;ç¼–è¯‘æ—¶åŠ å…¥ä»¥ä¸‹å‘½ä»¤ï¼š(Add the following commands when calling the compiler:)\u0026quot;ï¼Œå¹¶åœ¨ä¸‹æ–¹åŠ å…¥ -std=c++11ã€‚\nå­—ä½“å¤§å° ç”±äºé»˜è®¤å­—ä½“æ˜¯ 10ï¼Œå®åœ¨å¤ªå°äº†ä¸èƒ½æ¥å—ï¼Œå¯ä»¥åœ¨ â€œå·¥å…·(Tools)â€ -\u0026gt; â€œç¼–è¯‘å™¨é€‰é¡¹(Editor Options)\u0026quot; ä¸­çš„\u0026quot;æ˜¾ç¤º(Fonts)\u0026quot;é€‰é¡¹å¡ï¼Œä¿®æ”¹å­—ä½“å¤§å°(Size)ã€‚æˆ–è€…é€šè¿‡ Ctrl + æ»šè½® ä¿®æ”¹å­—ä½“å¤§å°ï¼ˆæ›´æ–¹ä¾¿ï¼‰ã€‚\nä»£ç è¡¥å…¨ æ‰“å¼€ä»£ç è¡¥å…¨ Dev C++ æ˜¯æœ‰ä¸€å®šçš„ä»£ç è¡¥å…¨åŠŸèƒ½çš„ï¼Œåœ¨â€œå·¥å…·(Tools)â€ -\u0026gt; â€œç¼–è¯‘å™¨é€‰é¡¹(Editor Options)\u0026quot;ä¸­ï¼Œåœ¨ â€œä»£ç è¡¥å…¨(Completion)â€ é€‰é¡¹å¡ä¸‹çš„ Code Completion é€‰é¡¹å¡ä¸­ï¼Œå°†æ‰€æœ‰å‹¾å‹¾ä¸Šå³å¯ã€‚\nå¿«æ·é”® åŒæ—¶ï¼Œå¯ä»¥é€šè¿‡â€œå·¥å…·(Tools)â€ -\u0026gt; â€œå¿«æ·é”®é€‰é¡¹(Configure Shortcuts)â€ æ¥é…ç½® Show Code Completion çš„å¿«æ·é”®ä»¥å”¤å‡ºä»£ç è¡¥å…¨ï¼ˆé»˜è®¤ä¸º Ctrl + Spaceï¼‰ï¼š\nç„¶åï¼Œå°±å¯ä»¥æ„‰å¿«åœ°è€ƒè¯•äº†ï½\n","permalink":"https://zjxjwxk.github.io/posts/pat/%E8%80%83%E8%AF%95%E6%94%BB%E7%95%A5/","summary":"\u003cp\u003eæ ¹æ®å¾€å¹´ (2019) å¹´æµ™å¤§è½¯ä»¶å­¦é™¢çš„è€ƒç ”å¤è¯•å…¬å‘Šï¼Œå¦‚æœä»Šå¹´ (2020) æ˜¯çº¿ä¸‹å¤è¯•ï¼Œä¸”è€ƒåœºæ²¡æœ‰å˜åŒ–çš„è¯ï¼Œæœºè¯•åº”è¯¥è¿˜æ˜¯åœ¨ \u003ccode\u003eæµ™å¤§ç´«é‡‘æ¸¯æ ¡åŒº\u003c/code\u003eï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eæµ™å¤§è½¯é™¢æ‹›ç”Ÿé€šçŸ¥ï¼šhttp://www.cst.zju.edu.cn/2019/0307/c36207a1478348/page.htm\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg alt=\"è½¯ä»¶å­¦é™¢2019å¹´ç»Ÿè€ƒç ”ç©¶ç”Ÿæ‹›ç”Ÿå¤è¯•å®‰æ’\" loading=\"lazy\" src=\"/posts/pat/%E8%80%83%E8%AF%95%E6%94%BB%E7%95%A5/images/image-20200411162644696.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä» PAT å®˜ç½‘å¯ä»¥æ‰¾åˆ°ç´«é‡‘æ¸¯çš„æœºæˆ¿é…ç½®ï¼š\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePAT è€ƒç‚¹è”ç›Ÿï¼šhttps://www.patest.cn/location\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg alt=\"PATç´«é‡‘æ¸¯é…ç½®.png\" loading=\"lazy\" src=\"/posts/pat/%E8%80%83%E8%AF%95%E6%94%BB%E7%95%A5/images/PAT%E7%B4%AB%E9%87%91%E6%B8%AF%E9%85%8D%E7%BD%AE.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæˆ‘æœ¬äººé€‰æ‹©ä½¿ç”¨ \u003ccode\u003eDev C++ 5.10\u003c/code\u003e ç‰ˆæœ¬ï¼Œè€ƒè¯•é‚£å¤©åœ¨è€ƒåœºéœ€è¦å…ˆå¯¹å…¶ä½œä»¥ä¸‹é…ç½®ï¼ˆå½“ç„¶ä¹Ÿè®¸å·²ç»é…ç½®å¥½äº†ï¼‰ï¼š\u003c/p\u003e\n\u003ch1 id=\"æ‰“å¼€äº§ç”Ÿè°ƒè¯•ä¿¡æ¯\"\u003eæ‰“å¼€äº§ç”Ÿè°ƒè¯•ä¿¡æ¯\u003c/h1\u003e\n\u003cp\u003eåœ¨ \u003ccode\u003eâ€œå·¥å…·(Tools)â€\u003c/code\u003e -\u0026gt; \u003ccode\u003eâ€œç¼–è¯‘é€‰é¡¹(Compiler Options)\u0026quot;\u003c/code\u003e ä¸­ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"ç¼–è¯‘é€‰é¡¹\" loading=\"lazy\" src=\"/posts/pat/%E8%80%83%E8%AF%95%E6%94%BB%E7%95%A5/images/image-20200411163457056.png\"\u003e\u003c/p\u003e\n\u003cp\u003eç‚¹å‡» \u003ccode\u003eâ€œä»£ç ç”Ÿæˆ/ä¼˜åŒ–(Settings)â€\u003c/code\u003e é€‰é¡¹å¡ä¸­çš„ \u003ccode\u003e\u0026quot;è¿æ¥å™¨(Linker)\u0026quot;\u003c/code\u003e é€‰é¡¹å¡ï¼Œå°† \u003ccode\u003e\u0026quot;äº§ç”Ÿè°ƒè¯•ä¿¡æ¯(Generate debugging information)\u0026quot;\u003c/code\u003e é€‰é¡¹æ”¹ä¸º \u003ccode\u003eâ€œYesâ€\u003c/code\u003eã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"äº§ç”Ÿè°ƒè¯•ä¿¡æ¯\" loading=\"lazy\" src=\"/posts/pat/%E8%80%83%E8%AF%95%E6%94%BB%E7%95%A5/images/image-20200411163800036.png\"\u003e\u003c/p\u003e\n\u003cp\u003eè¿™æ ·ï¼Œå°±å¯ä»¥æ„‰å¿«çš„ Debug äº†ï½\u003c/p\u003e\n\u003ch1 id=\"æ·»åŠ -c-11-æ”¯æŒ\"\u003eæ·»åŠ  C++ 11 æ”¯æŒ\u003c/h1\u003e\n\u003cp\u003eç”±äº PAT çš„ OJ æ˜¯æ”¯æŒ C++ 11 çš„ï¼Œæ•…æœ€å¥½æ‰“å¼€ C++ 11 æ”¯æŒã€‚\u003c/p\u003e\n\u003ch2 id=\"æ–¹æ³•ä¸€æ¨è\"\u003eæ–¹æ³•ä¸€ï¼ˆæ¨èï¼‰\u003c/h2\u003e\n\u003cp\u003eåœ¨ \u003ccode\u003eâ€œå·¥å…·(Tools)â€\u003c/code\u003e -\u0026gt; \u003ccode\u003eâ€œç¼–è¯‘é€‰é¡¹(Compiler Options)\u0026quot;\u003c/code\u003e ä¸­ï¼Œ\u003ccode\u003eâ€œä»£ç ç”Ÿæˆ/ä¼˜åŒ–(Settings)â€\u003c/code\u003e é€‰é¡¹å¡ä¸‹çš„ \u003ccode\u003eâ€œä»£ç ç”Ÿæˆ(Code Generation)â€\u003c/code\u003e é€‰é¡¹å¡ä¸­ï¼Œå°† \u003ccode\u003eâ€œè¯­è¨€æ ‡å‡†(Language Standard)(-std)â€\u003c/code\u003e è®¾ç½®ä¸º \u003ccode\u003eISO C++11\u003c/code\u003e å³å¯ã€‚\u003c/p\u003e","title":"PATè€ƒåœº Dev C++ 5.10 é…ç½®"},{"content":"A graph which is connected and acyclic can be considered a tree. The height of the tree depends on the selected root. Now you are supposed to find the root that results in a highest tree. Such a root is called the deepest root.\nInput Specification: Each input file contains one test case. For each case, the first line contains a positive integer N (â‰¤10^4) which is the number of nodes, and hence the nodes are numbered from 1 to N. Then Nâˆ’1 lines follow, each describes an edge by given the two adjacent nodes\u0026rsquo; numbers.\nOutput Specification: For each test case, print each of the deepest roots in a line. If such a root is not unique, print them in increasing order of their numbers. In case that the given graph is not a tree, print Error: K components where K is the number of connected components in the graph.\nSample Input 1: 5 1 2 1 3 1 4 2 5 Sample Output 1: 3 4 5 Sample Input 2: 5 1 3 1 4 2 5 3 4 Sample Output 2: Error: 2 components æ€è·¯ ä»¥æ¯ä¸ªæœªè®¿é—®çš„ç»“ç‚¹ä¸ºæ ¹ç»“ç‚¹è¿›è¡Œ DFSï¼Œå¯ä»¥æ±‚å‡ºè¯¥å›¾çš„è¿é€šåˆ†é‡ï¼Œè‹¥ä¸ä¸º 1ï¼Œåˆ™è¡¨ç¤ºä¸ä¸ºæ ‘ã€‚åŒæ—¶ï¼Œå°†ä»¥ç¬¬ä¸€ä¸ªç»“ç‚¹ä½œä¸ºæ ‘çš„æ ¹ç»“ç‚¹è¿›è¡Œ DFS æ—¶æ‰€å¾—åˆ°çš„æœ€é«˜é«˜åº¦çš„ç›¸åº”å¶å­ç»“ç‚¹æ’å…¥ set é›†åˆ ans ä¸­ï¼Œæ­¤ä¸ºç¬¬ä¸€ä¸ªç»“ç‚¹é›†åˆã€‚åœ¨ç¬¬ä¸€ä¸ªé›†åˆä¸­éšæœºé€‰å–ä¸€ä¸ªç»“ç‚¹ä½œä¸ºæ ¹ç»“ç‚¹ï¼ˆè¿™é‡Œé€‰å–äº† ans é›†åˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå†æ¬¡è¿›è¡Œä¸€é DFSï¼Œå¾—åˆ°ç¬¬äºŒä¸ªç»“ç‚¹é›†åˆã€‚è¿™ä¸¤ä¸ªç»“ç‚¹é›†åˆçš„å¹¶é›†ï¼Œå³ä¸ºé¢˜ç›®æ‰€æ±‚æœ€æ·±æ ¹ç»“ç‚¹ã€‚ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;set\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;cstring\u0026gt; using namespace std; const int maxn = 10001; vector\u0026lt;int\u0026gt; G[maxn], temp; set\u0026lt;int\u0026gt; ans; int n, maxLevel = 0, cnt = 0; bool vis[maxn] = {false}; void DFS(int root, int level) { vis[root] = true; if (level \u0026gt; maxLevel) { maxLevel = level; temp.clear(); temp.push_back(root); } else if (level == maxLevel) { temp.push_back(root); } for (int i = 0; i \u0026lt; G[root].size(); i++) { if (vis[G[root][i]] == false) { DFS(G[root][i], level + 1); } } } int main() { scanf(\u0026#34;%d\u0026#34;, \u0026amp;n); int v1, v2; for (int i = 0; i \u0026lt; n - 1; i++) { scanf(\u0026#34;%d %d\u0026#34;, \u0026amp;v1, \u0026amp;v2); G[v1].push_back(v2); G[v2].push_back(v1); } for (int i = 1; i \u0026lt;= n; i++) { if (vis[i] == false) { cnt++; DFS(i, 1); if (i == 1) { for (int i = 0; i \u0026lt; temp.size(); i++) { ans.insert(temp[i]); } } } } if (cnt != 1) { printf(\u0026#34;Error: %d components\u0026#34;, cnt); } else { temp.clear(); memset(vis + 1, false, n); DFS(*(ans.begin()), 1); for (int i = 0; i \u0026lt; temp.size(); i++) { ans.insert(temp[i]); } for (auto it = ans.begin(); it != ans.end(); it++) { printf(\u0026#34;%d\\n\u0026#34;, *it); } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1021/","summary":"\u003cp\u003eA graph which is connected and acyclic can be considered a tree. The height of the tree depends on the selected root. Now you are supposed to find the root that results in a highest tree. Such a root is called \u003cstrong\u003ethe deepest root\u003c/strong\u003e.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case. For each case, the first line contains a positive integer \u003cem\u003eN\u003c/em\u003e (â‰¤10^4) which is the number of nodes, and hence the nodes are numbered from 1 to \u003cem\u003eN\u003c/em\u003e. Then \u003cem\u003eN\u003c/em\u003eâˆ’1 lines follow, each describes an edge by given the two adjacent nodes\u0026rsquo; numbers.\u003c/p\u003e","title":"PATç”²çº§ 1021 Deepest Root (25åˆ†)"},{"content":"It is vitally important to have all the cities connected by highways in a war. If a city is occupied by the enemy, all the highways from/toward that city are closed. We must know immediately if we need to repair any other highways to keep the rest of the cities connected. Given the map of cities which have all the remaining highways marked, you are supposed to tell the number of highways need to be repaired, quickly.\nFor example, if we have 3 cities and 2 highways connecting city1-city2 and city1-city3. Then if city1 is occupied by the enemy, we must have 1 highway repaired, that is the highway city2-city3.\nInput Specification: Each input file contains one test case. Each case starts with a line containing 3 numbers N (\u0026lt;1000), M and K, which are the total number of cities, the number of remaining highways, and the number of cities to be checked, respectively. Then M lines follow, each describes a highway by 2 integers, which are the numbers of the cities the highway connects. The cities are numbered from 1 to N. Finally there is a line containing K numbers, which represent the cities we concern.\nOutput Specification: For each of the K cities, output in a line the number of highways need to be repaired if that city is lost.\nSample Input: 3 2 3 1 2 1 3 1 2 3 Sample Output: 1 0 0 æ³¨æ„ç‚¹ å¯èƒ½åŸå›¾å°±æ˜¯ä¸è¿é€šçš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ¯ä¸ªé¡¶ç‚¹è¿›è¡Œ DFS #include \u0026lt;cstdio\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;cstring\u0026gt; using namespace std; const int maxn = 1000; int n, m, k, q; vector\u0026lt;int\u0026gt; G[maxn]; bool vis[maxn] = {false}; void DFS(int root) { vis[root] = true; for (int i = 0; i \u0026lt; G[root].size(); i++) { if (G[root][i] != q \u0026amp;\u0026amp; vis[G[root][i]] == false) { DFS(G[root][i]); } } } int main() { scanf(\u0026#34;%d %d %d\u0026#34;, \u0026amp;n, \u0026amp;m, \u0026amp;k); int c1, c2; for (int i = 0; i \u0026lt; m; i++) { scanf(\u0026#34;%d %d\u0026#34;, \u0026amp;c1, \u0026amp;c2); G[c1].push_back(c2); G[c2].push_back(c1); } for (int i = 0; i \u0026lt; k; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;q); int cnt = -1; memset(vis + 1, false, n); for (int j = 1; j \u0026lt;= n; j++) { if (j != q \u0026amp;\u0026amp; vis[j] == false) { DFS(j); cnt++; } } printf(\u0026#34;%d\\n\u0026#34;, cnt); } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1013/","summary":"\u003cp\u003eIt is vitally important to have all the cities connected by highways in a war. If a city is occupied by the enemy, all the highways from/toward that city are closed. We must know immediately if we need to repair any other highways to keep the rest of the cities connected. Given the map of cities which have all the remaining highways marked, you are supposed to tell the number of highways need to be repaired, quickly.\u003c/p\u003e","title":"PATç”²çº§ 1013 Battle Over Cities (25åˆ†)"},{"content":"To store English words, one method is to use linked lists and store a word letter by letter. To save some space, we may let the words share the same sublist if they share the same suffix. For example, loading and being are stored as showed in Figure 1.\nYou are supposed to find the starting position of the common suffix (e.g. the position of i in Figure 1).\nInput Specification: Each input file contains one test case. For each case, the first line contains two addresses of nodes and a positive N (â‰¤ 10^5), where the two addresses are the addresses of the first nodes of the two words, and N is the total number of nodes. The address of a node is a 5-digit positive integer, and NULL is represented by âˆ’1.\nThen N lines follow, each describes a node in the format:\nAddress Data Next whereAddress is the position of the node, Data is the letter contained by this node which is an English letter chosen from { a-z, A-Z }, and Next is the position of the next node.\nOutput Specification: For each case, simply output the 5-digit starting position of the common suffix. If the two words have no common suffix, output -1 instead.\nSample Input 1: 11111 22222 9 67890 i 00002 00010 a 12345 00003 g -1 12345 D 67890 00002 n 00003 22222 B 23456 11111 L 00001 23456 e 67890 00001 o 00010 Sample Output 1: 67890 Sample Input 2: 00001 00002 4 00001 a 10001 10001 s -1 00002 a 10002 10002 t -1 Sample Output 2: -1 æ€è·¯ ç”±äºåœ°å€çš„èŒƒå›´è¾ƒå°ï¼Œå¯ä»¥ä½¿ç”¨é™æ€é“¾è¡¨ã€‚å¹¶æ ¹æ®é¢˜æ„ï¼Œä¸ºé“¾è¡¨èŠ‚ç‚¹ç»“æ„ä½“å¢åŠ ä¸€ä¸ª flag å˜é‡ï¼Œç”¨äºè¡¨ç¤ºè¯¥èŠ‚ç‚¹æ˜¯å¦åœ¨ç¬¬ä¸€æ¡é“¾è¡¨ä¸­ï¼Œé»˜è®¤ä¸º falseã€‚å…ˆç”±ç¬¬ä¸€æ¡é“¾è¡¨çš„é¦–åœ°å€å‡ºå‘ï¼Œéå†ç¬¬ä¸€æ¡é“¾è¡¨ï¼Œå¹¶å°†å…¶èŠ‚ç‚¹çš„ flag éƒ½è®¾ä¸º trueã€‚å½“éå†ç¬¬äºŒæ¡é“¾è¡¨æ—¶ï¼Œåªéœ€è¾“å‡ºç¬¬ä¸€ä¸ª flag ä¸ºtrue çš„èŠ‚ç‚¹çš„åœ°å€å³å¯ã€‚ æ³¨æ„ç‚¹ ä½¿ç”¨ %05d æ ¼å¼è¾“å‡ºåœ°å€ï¼Œä½¿å…¶é«˜ä½è¡¥ 0ã€‚ #include \u0026lt;cstdio\u0026gt; const int maxn = 100000; struct Node { char data; int next; bool flag = false; } nodes[maxn]; int main() { int root1, root2, n, address, next; char data; scanf(\u0026#34;%d %d %d\u0026#34;, \u0026amp;root1, \u0026amp;root2, \u0026amp;n); for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;address); scanf(\u0026#34; %c %d\u0026#34;, \u0026amp;nodes[address].data, \u0026amp;nodes[address].next); } int cur = root1; while (cur != -1) { nodes[cur].flag = true; cur = nodes[cur].next; } cur = root2; while (cur != -1) { if (nodes[cur].flag == true) { printf(\u0026#34;%05d\u0026#34;, cur); return 0; } cur = nodes[cur].next; } printf(\u0026#34;-1\u0026#34;); return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1032/","summary":"\u003cp\u003eTo store English words, one method is to use linked lists and store a word letter by letter. To save some space, we may let the words share the same sublist if they share the same suffix. For example, \u003ccode\u003eloading\u003c/code\u003e and \u003ccode\u003ebeing\u003c/code\u003e are stored as showed in Figure 1.\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Figure 1\" loading=\"lazy\" src=\"../images/image-A1032.jpg\"\u003e\u003c/p\u003e\n\u003cp\u003eYou are supposed to find the starting position of the common suffix (e.g. the position of \u003ccode\u003ei\u003c/code\u003e in Figure 1).\u003c/p\u003e","title":"PATç”²çº§ 1032 Sharing (25åˆ†)"},{"content":"Mice and Rice is the name of a programming contest in which each programmer must write a piece of code to control the movements of a mouse in a given map. The goal of each mouse is to eat as much rice as possible in order to become a FatMouse.\nFirst the playing order is randomly decided for N P programmers. Then every N G programmers are grouped in a match. The fattest mouse in a group wins and enters the next turn. All the losers in this turn are ranked the same. Every N G winners are then grouped in the next match until a final winner is determined.\nFor the sake of simplicity, assume that the weight of each mouse is fixed once the programmer submits his/her code. Given the weights of all the mice and the initial playing order, you are supposed to output the ranks for the programmers.\nInput Specification: Each input file contains one test case. For each case, the first line contains 2 positive integers: N P and N G (â‰¤1000), the number of programmers and the maximum number of mice in a group, respectively. If there are less than N G mice at the end of the player\u0026rsquo;s list, then all the mice left will be put into the last group. The second line contains N P distinct non-negative numbers W i (i=0,â‹¯,N P âˆ’ 1) where each W i is the weight of the i-th mouse respectively. The third line gives the initial playing order which is a permutation of 0,â‹¯,N P âˆ’ 1 (assume that the programmers are numbered from 0 to N P - 1). All the numbers in a line are separated by a space.\nOutput Specification: For each test case, print the final ranks in a line. The i-th number is the rank of the i-th programmer, and all the numbers must be separated by a space, with no extra space at the end of the line.\nSample Input: 11 3 25 18 0 46 37 3 19 22 57 56 10 6 0 8 7 10 5 9 1 4 2 3 Sample Output: 5 5 5 2 5 5 5 3 1 3 5 æ³¨æ„ç‚¹ åœ¨è®¡ç®—å½“å‰å¾ªç¯æ‰€è¦ç¡®å®šçš„æ’åæ—¶ï¼Œéœ€è¦åˆ†ä¸ºæ˜¯å¦èƒ½æ•´é™¤ä¸¤ç§æƒ…å†µï¼š\nå¦‚æœå‰©ä¸‹è¿˜æœªç¡®å®šæ’åçš„æ•°é‡ï¼ˆlenï¼‰ä¸èƒ½æ•´é™¤æ¯ç»„çš„äººæ•°ï¼ˆngï¼‰ï¼Œåˆ™è¯¥è½®å¾ªç¯å¯ä»¥ç¡®å®šçš„æ’åæ˜¯ len / ng + 2 å¦åˆ™ï¼Œè¯¥è½®å¾ªç¯å¯ä»¥ç¡®å®šçš„æ’åæ˜¯ len / ng + 1 #include \u0026lt;cstdio\u0026gt; #include \u0026lt;queue\u0026gt; using namespace std; const int maxn = 1000; int main() { int np, ng, index, w[maxn], rank[maxn]; scanf(\u0026#34;%d %d\u0026#34;, \u0026amp;np, \u0026amp;ng); queue\u0026lt;int\u0026gt; que; for (int i = 0; i \u0026lt; np; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;w[i]); } for (int i = 0; i \u0026lt; np; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;index); que.push(index); } int len = que.size(), nowRank; while (len \u0026gt; 1) { if (len % ng == 0) { nowRank = len / ng + 1; } else { nowRank = len / ng + 2; } for (int i = 0; i \u0026lt; len; i += ng) { int maxW = -1, maxI = -1; for (int j = i; j \u0026lt; i + ng \u0026amp;\u0026amp; j \u0026lt; len; j++) { int tempI = que.front(); if (w[tempI] \u0026gt; maxW) { maxW = w[tempI]; maxI = tempI; } rank[tempI] = nowRank; que.pop(); } que.push(maxI); } len = que.size(); } rank[que.front()] = 1; for (int i = 0; i \u0026lt; np; i++) { printf(\u0026#34;%d\u0026#34;, rank[i]); if (i != np - 1) { printf(\u0026#34; \u0026#34;); } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1056/","summary":"\u003cp\u003e\u003cstrong\u003eMice and Rice\u003c/strong\u003e is the name of a programming contest in which each programmer must write a piece of code to control the movements of a mouse in a given map. The goal of each mouse is to eat as much rice as possible in order to become a FatMouse.\u003c/p\u003e\n\u003cp\u003eFirst the playing order is randomly decided for N \u003c!-- raw HTML omitted --\u003eP\u003c!-- raw HTML omitted --\u003e programmers. Then every N \u003c!-- raw HTML omitted --\u003eG\u003c!-- raw HTML omitted --\u003e programmers are grouped in a match. The fattest mouse in a group wins and enters the next turn. All the losers in this turn are ranked the same. Every N \u003c!-- raw HTML omitted --\u003eG\u003c!-- raw HTML omitted --\u003e winners are then grouped in the next match until a final winner is determined.\u003c/p\u003e","title":"PATç”²çº§ 1056 Mice and Rice (25åˆ†)"},{"content":"People on Mars count their numbers with base 13:\nZero on Earth is called \u0026ldquo;tret\u0026rdquo; on Mars. The numbers 1 to 12 on Earth is called \u0026ldquo;jan, feb, mar, apr, may, jun, jly, aug, sep, oct, nov, dec\u0026rdquo; on Mars, respectively. For the next higher digit, Mars people name the 12 numbers as \u0026ldquo;tam, hel, maa, huh, tou, kes, hei, elo, syy, lok, mer, jou\u0026rdquo;, respectively. For examples, the number 29 on Earth is called \u0026ldquo;hel mar\u0026rdquo; on Mars; and \u0026ldquo;elo nov\u0026rdquo; on Mars corresponds to 115 on Earth. In order to help communication between people from these two planets, you are supposed to write a program for mutual translation between Earth and Mars number systems.\nInput Specification: Each input file contains one test case. For each case, the first line contains a positive integer N (\u0026lt;100). Then N lines follow, each contains a number in [0, 169), given either in the form of an Earth number, or that of Mars.\nOutput Specification: For each number, print in a line the corresponding number in the other language.\nSample Input: 4 29 5 elo nov tam Sample Output: hel mar may 115 13 æ€è·¯ ç›´æ¥é’ˆå¯¹ç»™å‡ºçš„è¾“å…¥è¿›è¡Œæ¨¡æ‹Ÿä¼šç›¸å¯¹å¤æ‚ï¼Œè€ƒè™‘åˆ°æ•°æ®èŒƒå›´æœ€å¤šä¸è¶…è¿‡168ï¼Œå› æ­¤ä¸å¦¨å°† [0, 168] çš„æ‰€æœ‰æ•°éƒ½é¢„å¤„ç†å‡ºæ¥ï¼ˆå³æ‰“è¡¨ï¼‰ï¼Œç„¶åæŸ¥è¯¢ä¸€ä¸ªè¾“å‡ºä¸€ä¸ªå³å¯ã€‚\næ³¨æ„ç‚¹ ç”±äºä¸ªä½æˆ–åä½ä¸º 0 æ—¶ï¼Œä¸åº”è¯¥å°†å…¶è¾“å‡ºä¸º \u0026ldquo;tret\u0026rdquo;ï¼Œæ‰€ä»¥åœ¨å¤§è¡¨æ—¶ï¼Œåº”è¯¥å°†ä¸ªä½æˆ–åä½ä¸º 0 çš„æ•°ä¸å…¶ä»–æ•°åˆ†å¼€è€ƒè™‘ã€‚ #include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;map\u0026gt; using namespace std; int n; string num[4]; string unitDigit[13] = {\u0026#34;tret\u0026#34;, \u0026#34;jan\u0026#34;, \u0026#34;feb\u0026#34;, \u0026#34;mar\u0026#34;, \u0026#34;apr\u0026#34;, \u0026#34;may\u0026#34;, \u0026#34;jun\u0026#34;, \u0026#34;jly\u0026#34;, \u0026#34;aug\u0026#34;, \u0026#34;sep\u0026#34;, \u0026#34;oct\u0026#34;, \u0026#34;nov\u0026#34;, \u0026#34;dec\u0026#34;}; string tenDigit[13] = {\u0026#34;tret\u0026#34;, \u0026#34;tam\u0026#34;, \u0026#34;hel\u0026#34;, \u0026#34;maa\u0026#34;, \u0026#34;huh\u0026#34;, \u0026#34;tou\u0026#34;, \u0026#34;kes\u0026#34;, \u0026#34;hei\u0026#34;, \u0026#34;elo\u0026#34;, \u0026#34;syy\u0026#34;, \u0026#34;lok\u0026#34;, \u0026#34;mer\u0026#34;, \u0026#34;jou\u0026#34;}; map\u0026lt;string, int\u0026gt; marsToNum; string numToMars[170]; void init() { for (int i = 0; i \u0026lt; 13; i++) { numToMars[i] = unitDigit[i]; marsToNum[unitDigit[i]] = i; numToMars[i * 13] = tenDigit[i]; marsToNum[tenDigit[i]] = i * 13; } for (int i = 1; i \u0026lt; 13; i++) { for (int j = 1; j \u0026lt; 13; j++) { string mars = tenDigit[i] + \u0026#34; \u0026#34; + unitDigit[j]; numToMars[i * 13 + j] = mars; marsToNum[mars] = i * 13 + j; } } } int main() { scanf(\u0026#34;%d\u0026#34;, \u0026amp;n); getchar(); string str; init(); for (int i = 0; i \u0026lt; n; i++) { getline(cin, str); if (str[0] \u0026gt;= \u0026#39;0\u0026#39; \u0026amp;\u0026amp; str[0] \u0026lt;= \u0026#39;9\u0026#39;) { printf(\u0026#34;%s\\n\u0026#34;, numToMars[stoi(str)].c_str()); } else { printf(\u0026#34;%d\\n\u0026#34;, marsToNum[str]); } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1100/","summary":"\u003cp\u003ePeople on Mars count their numbers with base 13:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eZero on Earth is called \u0026ldquo;tret\u0026rdquo; on Mars.\u003c/li\u003e\n\u003cli\u003eThe numbers 1 to 12 on Earth is called \u0026ldquo;jan, feb, mar, apr, may, jun, jly, aug, sep, oct, nov, dec\u0026rdquo; on Mars, respectively.\u003c/li\u003e\n\u003cli\u003eFor the next higher digit, Mars people name the 12 numbers as \u0026ldquo;tam, hel, maa, huh, tou, kes, hei, elo, syy, lok, mer, jou\u0026rdquo;, respectively.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFor examples, the number 29 on Earth is called \u0026ldquo;hel mar\u0026rdquo; on Mars; and \u0026ldquo;elo nov\u0026rdquo; on Mars corresponds to 115 on Earth. In order to help communication between people from these two planets, you are supposed to write a program for mutual translation between Earth and Mars number systems.\u003c/p\u003e","title":"PATç”²çº§ 1100 Mars Numbers (20åˆ†)"},{"content":"ç« èŠ‚æ¦‚è¦ å®Œæˆè®¢å•æ¨¡å—ä¸šåŠ¡å¼€å‘ å®Œæˆé™æµå’Œç†”æ–­ã€é™çº§ç›¸å…³å†…å®¹ Dubbo ç‰¹æ€§ä¹‹åˆ†ç»„ã€èšåˆå’Œç‰ˆæœ¬æ§åˆ¶ è®¢å•æ¨¡å—é—®é¢˜ è®¢å•æ¨¡å—çš„æ¨ªå‘å’Œçºµå‘åˆ†è¡¨å¦‚ä½•è§£å†³ï¼Ÿ æœåŠ¡é™æµå¦‚ä½•å¤„ç†ï¼Ÿ æœåŠ¡ç†”æ–­å’Œé™çº§ï¼Ÿ å¦‚ä½•ä¿è¯å¤šç‰ˆæœ¬çš„è“ç»¿ä¸Šçº¿ï¼Ÿ æ¨ªå‘æ‹†åˆ†å’Œçºµå‘æ‹†åˆ† Dubbo æœåŠ¡åˆ†ç»„ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/service-group.html\nå½“ä¸€ä¸ªæ¥å£æœ‰å¤šç§å®ç°æ—¶ï¼Œå¯ä»¥ç”¨ group åŒºåˆ†ã€‚\næœåŠ¡ \u0026lt;dubbo:service group=\u0026#34;feedback\u0026#34; interface=\u0026#34;com.xxx.IndexService\u0026#34; /\u0026gt; \u0026lt;dubbo:service group=\u0026#34;member\u0026#34; interface=\u0026#34;com.xxx.IndexService\u0026#34; /\u0026gt; å¼•ç”¨ \u0026lt;dubbo:reference id=\u0026#34;feedbackIndexService\u0026#34; group=\u0026#34;feedback\u0026#34; interface=\u0026#34;com.xxx.IndexService\u0026#34; /\u0026gt; \u0026lt;dubbo:reference id=\u0026#34;memberIndexService\u0026#34; group=\u0026#34;member\u0026#34; interface=\u0026#34;com.xxx.IndexService\u0026#34; /\u0026gt; ä»»æ„ç»„ï¼š\n\u0026lt;dubbo:reference id=\u0026#34;barService\u0026#34; interface=\u0026#34;com.foo.BarService\u0026#34; group=\u0026#34;*\u0026#34; /\u0026gt; Dubbo åˆ†ç»„èšåˆ https://dubbo.apache.org/zh-cn/docs/user/demos/group-merger.html\næŒ‰ç»„åˆå¹¶è¿”å›ç»“æœï¼Œæ¯”å¦‚èœå•æœåŠ¡ï¼Œæ¥å£ä¸€æ ·ï¼Œä½†æœ‰å¤šç§å®ç°ï¼Œç”¨ group åŒºåˆ†ï¼Œç°åœ¨æ¶ˆè´¹æ–¹éœ€ä»æ¯ç§ group ä¸­è°ƒç”¨ä¸€æ¬¡è¿”å›ç»“æœï¼Œåˆå¹¶ç»“æœè¿”å›ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°èšåˆèœå•é¡¹ã€‚\né…ç½® æœç´¢æ‰€æœ‰åˆ†ç»„\n\u0026lt;dubbo:reference interface=\u0026#34;com.xxx.MenuService\u0026#34; group=\u0026#34;*\u0026#34; merger=\u0026#34;true\u0026#34; /\u0026gt; åˆå¹¶æŒ‡å®šåˆ†ç»„\n\u0026lt;dubbo:reference interface=\u0026#34;com.xxx.MenuService\u0026#34; group=\u0026#34;aaa,bbb\u0026#34; merger=\u0026#34;true\u0026#34; /\u0026gt; æŒ‡å®šæ–¹æ³•åˆå¹¶ç»“æœï¼Œå…¶å®ƒæœªæŒ‡å®šçš„æ–¹æ³•ï¼Œå°†åªè°ƒç”¨ä¸€ä¸ª Group\n\u0026lt;dubbo:reference interface=\u0026#34;com.xxx.MenuService\u0026#34; group=\u0026#34;*\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;getMenuItems\u0026#34; merger=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;/dubbo:reference\u0026gt; æŸä¸ªæ–¹æ³•ä¸åˆå¹¶ç»“æœï¼Œå…¶å®ƒéƒ½åˆå¹¶ç»“æœ\n\u0026lt;dubbo:reference interface=\u0026#34;com.xxx.MenuService\u0026#34; group=\u0026#34;*\u0026#34; merger=\u0026#34;true\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;getMenuItems\u0026#34; merger=\u0026#34;false\u0026#34; /\u0026gt; \u0026lt;/dubbo:reference\u0026gt; æŒ‡å®šåˆå¹¶ç­–ç•¥ï¼Œç¼ºçœæ ¹æ®è¿”å›å€¼ç±»å‹è‡ªåŠ¨åŒ¹é…ï¼Œå¦‚æœåŒä¸€ç±»å‹æœ‰ä¸¤ä¸ªåˆå¹¶å™¨æ—¶ï¼Œéœ€æŒ‡å®šåˆå¹¶å™¨çš„åç§°\n\u0026lt;dubbo:reference interface=\u0026#34;com.xxx.MenuService\u0026#34; group=\u0026#34;*\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;getMenuItems\u0026#34; merger=\u0026#34;mymerge\u0026#34; /\u0026gt; \u0026lt;/dubbo:reference\u0026gt; æŒ‡å®šåˆå¹¶æ–¹æ³•ï¼Œå°†è°ƒç”¨è¿”å›ç»“æœçš„æŒ‡å®šæ–¹æ³•è¿›è¡Œåˆå¹¶ï¼Œåˆå¹¶æ–¹æ³•çš„å‚æ•°ç±»å‹å¿…é¡»æ˜¯è¿”å›ç»“æœç±»å‹æœ¬èº«\n\u0026lt;dubbo:reference interface=\u0026#34;com.xxx.MenuService\u0026#34; group=\u0026#34;*\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;getMenuItems\u0026#34; merger=\u0026#34;.addAll\u0026#34; /\u0026gt; \u0026lt;/dubbo:reference\u0026gt; Dubbo å¤šç‰ˆæœ¬ å½“ä¸€ä¸ªæ¥å£å®ç°ï¼Œå‡ºç°ä¸å…¼å®¹å‡çº§æ—¶ï¼Œå¯ä»¥ç”¨ç‰ˆæœ¬å·è¿‡æ¸¡ï¼Œç‰ˆæœ¬å·ä¸åŒçš„æœåŠ¡ç›¸äº’é—´ä¸å¼•ç”¨ã€‚\nå¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ­¥éª¤è¿›è¡Œç‰ˆæœ¬è¿ç§»ï¼š\nåœ¨ä½å‹åŠ›æ—¶é—´æ®µï¼Œå…ˆå‡çº§ä¸€åŠæä¾›è€…ä¸ºæ–°ç‰ˆæœ¬ å†å°†æ‰€æœ‰æ¶ˆè´¹è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬ ç„¶åå°†å‰©ä¸‹çš„ä¸€åŠæä¾›è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬ é…ç½® è€ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34; version=\u0026#34;1.0.0\u0026#34; /\u0026gt; æ–°ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34; version=\u0026#34;2.0.0\u0026#34; /\u0026gt; è€ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š\n\u0026lt;dubbo:reference id=\u0026#34;barService\u0026#34; interface=\u0026#34;com.foo.BarService\u0026#34; version=\u0026#34;1.0.0\u0026#34; /\u0026gt; æ–°ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š\n\u0026lt;dubbo:reference id=\u0026#34;barService\u0026#34; interface=\u0026#34;com.foo.BarService\u0026#34; version=\u0026#34;2.0.0\u0026#34; /\u0026gt; å¦‚æœä¸éœ€è¦åŒºåˆ†ç‰ˆæœ¬ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ–¹å¼é…ç½®ï¼š\n\u0026lt;dubbo:reference id=\u0026#34;barService\u0026#34; interface=\u0026#34;com.foo.BarService\u0026#34; version=\u0026#34;*\u0026#34; /\u0026gt; é™æµæ€è·¯ é™æµæªæ–½æ˜¯ç³»ç»Ÿé«˜å¯ç”¨çš„ä¸€ç§æ‰‹æ®µ ä½¿ç”¨å¹¶å‘ä¸è¿æ¥æ§åˆ¶è¿›è¡Œé™æµ ä½¿ç”¨**æ¼æ¡¶ç®—æ³•ï¼ˆLeaky Bucketï¼‰å’Œä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆToken Bucketï¼‰**ç®—æ³•è¿›è¡Œé™æµ æ¼æ¡¶ç®—æ³•ï¼ˆLeaky Bucketï¼‰ ä»¤ç‰Œæ¡¶ç®—æ³•ï¼ˆToken Bucketï¼‰ åŒºåˆ« æ¼æ¡¶ç®—æ³•ä»¥å‡åŒ€çš„é€Ÿåº¦å¤„ç†è¯·æ±‚ï¼Œä¸éœ€è¦æ‰¿è½½è¾ƒé«˜çš„è®¿é—®å³°å€¼ ä»¤ç‰Œæ¡¶ç®—æ³•åˆ™å¯èƒ½åœ¨çŸ­æ—¶é—´å†…å¤„ç†å¤§é‡è¯·æ±‚ï¼Œæ‰€ä»¥éœ€è¦å¯ä»¥æ‰¿è½½è¾ƒé«˜çš„è®¿é—®å³°å€¼ ä»¤ç‰Œæ¡¶ç®—æ³•å®ç° public class TokenBucket { /** * æ¡¶çš„å®¹é‡ */ private int bucketNums = 100; /** * æµå…¥é€Ÿåº¦ */ private int rate = 1; /** * å½“å‰ä»¤ç‰Œæ•° */ private int nowTokens; /** * ä¸Šæ¬¡åˆ·æ–°å½“å‰ä»¤ç‰Œæ•°çš„æ—¶é—´ */ private long lastTime = getNowTime(); private long getNowTime() { return System.currentTimeMillis(); } public boolean getToken() { // è®°å½•å½“å‰æ—¶é—´ long nowTime = getNowTime(); // åˆ·æ–°ä»¤ç‰Œ nowTokens += (nowTime - lastTime) * rate; // è‹¥ä»¤ç‰Œæ•°æ¯”æ¡¶å®¹é‡å¤§ï¼Œåˆ™æ”¹ä¸ºæ¡¶å®¹é‡ nowTokens = Math.min(bucketNums, nowTokens); System.out.println(\u0026#34;å½“å‰ä»¤ç‰Œæ•°ï¼š\u0026#34; + nowTokens); // ä¿®æ”¹ä¸Šæ¬¡åˆ·æ–°ä»¤ç‰Œæ•°çš„æ—¶é—´ä¸ºå½“å‰æ—¶é—´ lastTime = nowTime; // åˆ¤æ–­ä»¤ç‰Œæ˜¯å¦è¶³å¤Ÿ if (nowTokens \u0026gt; 0) { nowTokens--; return true; } else { return false; } } } Hystrix ç†”æ–­é™çº§ ç½‘å…³æ¨¡å—æ·»åŠ ä¾èµ–ï¼š\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-netflix-hystrix\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.0.0.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-boot-starter-actuator\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework.cloud\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-cloud-starter-netflix-hystrix-dashboard\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.0.0.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; GatewayApplication æ·»åŠ æ³¨è§£ï¼š\n@EnableHystrixDashboard @EnableCircuitBreaker @EnableHystrix ç»™éœ€è¦ç†”æ–­å™¨çš„æ§åˆ¶å™¨æ–¹æ³•æ·»åŠ æ³¨è§£ï¼š\n@HystrixCommand(fallbackMethod = \u0026#34;error\u0026#34;, commandProperties = { @HystrixProperty(name = \u0026#34;execution.isolation.strategy\u0026#34;, value = \u0026#34;THREAD\u0026#34;), @HystrixProperty(name = \u0026#34;execution.isolation.thread.timeoutInMilliseconds\u0026#34;, value = \u0026#34;4000\u0026#34;), @HystrixProperty(name = \u0026#34;circuitBreaker.requestVolumeThreshold\u0026#34;, value = \u0026#34;10\u0026#34;), @HystrixProperty(name = \u0026#34;circuitBreaker.errorThresholdPercentage\u0026#34;, value = \u0026#34;50\u0026#34;) }, threadPoolProperties = { @HystrixProperty(name = \u0026#34;coreSize\u0026#34;, value = \u0026#34;1\u0026#34;), @HystrixProperty(name = \u0026#34;maxQueueSize\u0026#34;, value = \u0026#34;10\u0026#34;), @HystrixProperty(name = \u0026#34;keepAliveTimeMinutes\u0026#34;, value = \u0026#34;1000\u0026#34;), @HystrixProperty(name = \u0026#34;queueSizeRejectionThreshold\u0026#34;, value = \u0026#34;8\u0026#34;), @HystrixProperty(name = \u0026#34;metrics.rollingStats.numBuckets\u0026#34;, value = \u0026#34;12\u0026#34;), @HystrixProperty(name = \u0026#34;metrics.rollingStats.timeInMilliseconds\u0026#34;, value = \u0026#34;1500\u0026#34;) }) å®šä¹‰ fallbackMethod æ–¹æ³•ï¼Œç”¨äºæœåŠ¡é™çº§ï¼š\npublic ResponseVO error(Integer fieldId, String soldSeats, String seatsName) { return ResponseVO.serviceFail(\u0026#34;æŠ±æ­‰ï¼Œä¸‹å•çš„äººå¤ªå¤šäº†ï¼Œè¯·ç¨åé‡è¯•\u0026#34;); } æ€»ç»“ å­¦ä¹ äº†é™æµæªæ–½ä»¥åŠå®ç°æ–¹æ³•ï¼ˆåœ¨çœŸå®ä¸šåŠ¡ç¯å¢ƒä¸­ï¼Œå¯èƒ½ä¼šæ ¹æ®è¯·æ±‚çš„å­—èŠ‚æ•°å¤§å°åˆ†é… TokenBucketï¼‰ æŒæ¡äº† Dubbo çš„åˆ†ç»„èšåˆã€ç‰ˆæœ¬æ§åˆ¶ ç•™ä¸‹ä¸€ä¸ªæ€è€ƒï¼Œå¦‚ä½•å¤„ç†äº‹åŠ¡ï¼Ÿå‡å¦‚ï¼Œä¸‹è®¢å•æ—¶ï¼Œå°† 1. éªŒè¯æ‰€è´­ä¹°çš„ç¥¨æ˜¯å¦ä¸ºçœŸå’Œ 2. æ£€æŸ¥æ‰€è´­ä¹°çš„ç¥¨æ˜¯å¦å·²å”®å‡ºï¼Œè¿™ä¸¤ä¸ª service æ¥å£æ”¹ä¸ºå¼‚æ­¥è°ƒç”¨ï¼ˆå› ä¸ºè¦è¿æ¥ FTP å’Œè¯»å–æ–‡ä»¶ï¼Œé€Ÿåº¦è¾ƒæ…¢ï¼‰ï¼Œé‚£ä¹ˆå¯èƒ½è¿˜æ²¡æœ‰è°ƒç”¨ç»“æŸï¼Œå°±å·²ç»ç”Ÿæˆäº†è®¢å•\u0026hellip;\u0026hellip;ä½†æ˜¯å¦‚æœå¼‚æ­¥è°ƒç”¨çš„éªŒè¯ç»“æœä¸ä¸ºçœŸï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿè¿™æ—¶å€™å°±éœ€è¦äº‹åŠ¡æ¥ä¿è¯ ACID äº†ã€‚é‚£ä¹ˆåº”è¯¥å¦‚ä½•å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡å‘¢ï¼Ÿä¸”çœ‹ä¸‹å›åˆ†è§£ã€‚ ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/8.dubbo%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91/","summary":"\u003ch1 id=\"ç« èŠ‚æ¦‚è¦\"\u003eç« èŠ‚æ¦‚è¦\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eå®Œæˆè®¢å•æ¨¡å—ä¸šåŠ¡å¼€å‘\u003c/li\u003e\n\u003cli\u003eå®Œæˆé™æµå’Œç†”æ–­ã€é™çº§ç›¸å…³å†…å®¹\u003c/li\u003e\n\u003cli\u003eDubbo ç‰¹æ€§ä¹‹åˆ†ç»„ã€èšåˆå’Œç‰ˆæœ¬æ§åˆ¶\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"è®¢å•æ¨¡å—é—®é¢˜\"\u003eè®¢å•æ¨¡å—é—®é¢˜\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eè®¢å•æ¨¡å—çš„æ¨ªå‘å’Œçºµå‘åˆ†è¡¨å¦‚ä½•è§£å†³ï¼Ÿ\u003c/li\u003e\n\u003cli\u003eæœåŠ¡é™æµå¦‚ä½•å¤„ç†ï¼Ÿ\u003c/li\u003e\n\u003cli\u003eæœåŠ¡ç†”æ–­å’Œé™çº§ï¼Ÿ\u003c/li\u003e\n\u003cli\u003eå¦‚ä½•ä¿è¯å¤šç‰ˆæœ¬çš„è“ç»¿ä¸Šçº¿ï¼Ÿ\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"æ¨ªå‘æ‹†åˆ†å’Œçºµå‘æ‹†åˆ†\"\u003eæ¨ªå‘æ‹†åˆ†å’Œçºµå‘æ‹†åˆ†\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"æ¨ªå‘æ‹†åˆ†å’Œçºµå‘æ‹†åˆ†\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/8.dubbo%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91/images/image-20200408000355380.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"dubbo-æœåŠ¡åˆ†ç»„\"\u003eDubbo æœåŠ¡åˆ†ç»„\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003eå®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/service-group.html\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eå½“ä¸€ä¸ªæ¥å£æœ‰å¤šç§å®ç°æ—¶ï¼Œå¯ä»¥ç”¨ group åŒºåˆ†ã€‚\u003c/p\u003e\n\u003ch2 id=\"æœåŠ¡\"\u003eæœåŠ¡\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:service\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;feedback\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.IndexService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:service\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;member\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.IndexService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"å¼•ç”¨\"\u003eå¼•ç”¨\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eid=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;feedbackIndexService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;feedback\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.IndexService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eid=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;memberIndexService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;member\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.IndexService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eä»»æ„ç»„ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eid=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;barService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch1 id=\"dubbo-åˆ†ç»„èšåˆ\"\u003eDubbo åˆ†ç»„èšåˆ\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://dubbo.apache.org/zh-cn/docs/user/demos/group-merger.html\"\u003ehttps://dubbo.apache.org/zh-cn/docs/user/demos/group-merger.html\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eæŒ‰ç»„åˆå¹¶è¿”å›ç»“æœï¼Œæ¯”å¦‚èœå•æœåŠ¡ï¼Œæ¥å£ä¸€æ ·ï¼Œä½†æœ‰å¤šç§å®ç°ï¼Œç”¨ group åŒºåˆ†ï¼Œç°åœ¨æ¶ˆè´¹æ–¹éœ€ä»æ¯ç§ group ä¸­è°ƒç”¨ä¸€æ¬¡è¿”å›ç»“æœï¼Œåˆå¹¶ç»“æœè¿”å›ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°èšåˆèœå•é¡¹ã€‚\u003c/p\u003e\n\u003ch2 id=\"é…ç½®\"\u003eé…ç½®\u003c/h2\u003e\n\u003cp\u003eæœç´¢æ‰€æœ‰åˆ†ç»„\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.MenuService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emerger=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eåˆå¹¶æŒ‡å®šåˆ†ç»„\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.MenuService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;aaa,bbb\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emerger=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæŒ‡å®šæ–¹æ³•åˆå¹¶ç»“æœï¼Œå…¶å®ƒæœªæŒ‡å®šçš„æ–¹æ³•ï¼Œå°†åªè°ƒç”¨ä¸€ä¸ª Group\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.MenuService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:method\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;getMenuItems\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emerger=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dubbo:reference\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæŸä¸ªæ–¹æ³•ä¸åˆå¹¶ç»“æœï¼Œå…¶å®ƒéƒ½åˆå¹¶ç»“æœ\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.MenuService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emerger=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:method\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;getMenuItems\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emerger=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dubbo:reference\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæŒ‡å®šåˆå¹¶ç­–ç•¥ï¼Œç¼ºçœæ ¹æ®è¿”å›å€¼ç±»å‹è‡ªåŠ¨åŒ¹é…ï¼Œå¦‚æœåŒä¸€ç±»å‹æœ‰ä¸¤ä¸ªåˆå¹¶å™¨æ—¶ï¼Œéœ€æŒ‡å®šåˆå¹¶å™¨çš„åç§°\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.MenuService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:method\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;getMenuItems\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emerger=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;mymerge\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dubbo:reference\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæŒ‡å®šåˆå¹¶æ–¹æ³•ï¼Œå°†è°ƒç”¨è¿”å›ç»“æœçš„æŒ‡å®šæ–¹æ³•è¿›è¡Œåˆå¹¶ï¼Œåˆå¹¶æ–¹æ³•çš„å‚æ•°ç±»å‹å¿…é¡»æ˜¯è¿”å›ç»“æœç±»å‹æœ¬èº«\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.xxx.MenuService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:method\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;getMenuItems\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emerger=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;.addAll\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dubbo:reference\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch1 id=\"dubbo-å¤šç‰ˆæœ¬\"\u003eDubbo å¤šç‰ˆæœ¬\u003c/h1\u003e\n\u003cp\u003eå½“ä¸€ä¸ªæ¥å£å®ç°ï¼Œå‡ºç°ä¸å…¼å®¹å‡çº§æ—¶ï¼Œå¯ä»¥ç”¨ç‰ˆæœ¬å·è¿‡æ¸¡ï¼Œç‰ˆæœ¬å·ä¸åŒçš„æœåŠ¡ç›¸äº’é—´ä¸å¼•ç”¨ã€‚\u003c/p\u003e\n\u003cp\u003eå¯ä»¥æŒ‰ç…§ä»¥ä¸‹çš„æ­¥éª¤è¿›è¡Œç‰ˆæœ¬è¿ç§»ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eåœ¨ä½å‹åŠ›æ—¶é—´æ®µï¼Œå…ˆå‡çº§ä¸€åŠæä¾›è€…ä¸ºæ–°ç‰ˆæœ¬\u003c/li\u003e\n\u003cli\u003eå†å°†æ‰€æœ‰æ¶ˆè´¹è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬\u003c/li\u003e\n\u003cli\u003eç„¶åå°†å‰©ä¸‹çš„ä¸€åŠæä¾›è€…å‡çº§ä¸ºæ–°ç‰ˆæœ¬\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"é…ç½®-1\"\u003eé…ç½®\u003c/h2\u003e\n\u003cp\u003eè€ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:service\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eversion=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1.0.0\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæ–°ç‰ˆæœ¬æœåŠ¡æä¾›è€…é…ç½®ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:service\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eversion=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2.0.0\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè€ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eid=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;barService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eversion=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;1.0.0\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæ–°ç‰ˆæœ¬æœåŠ¡æ¶ˆè´¹è€…é…ç½®ï¼š\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ8ï¼‰ï¼šDubboæœåŠ¡å¼€å‘ï¼ˆè®¢å•æ¨¡å—å¼€å‘ï¼‰"},{"content":"If a machine can save only 3 significant digits, the float numbers 12300 and 12358.9 are considered equal since they are both saved as 0.123Ã—105 with simple chopping. Now given the number of significant digits on a machine and two float numbers, you are supposed to tell if they are treated equal in that machine.\nInput Specification: Each input file contains one test case which gives three numbers N, A and B, where N (\u0026lt;100) is the number of significant digits, and A and B are the two float numbers to be compared. Each float number is non-negative, no greater than 10100, and that its total digit number is less than 100.\nOutput Specification: For each test case, print in a line YES if the two numbers are treated equal, and then the number in the standard form 0.d[1]...d[N]*10^k (d[1]\u0026gt;0 unless the number is 0); or NO if they are not treated equal, and then the two numbers in their standard form. All the terms must be separated by a space, with no extra space at the end of a line.\nNote: Simple chopping is assumed without rounding.\nSample Input 1: 3 12300 12358.9 Sample Output 1: YES 0.123*10^5 Sample Input 2: 3 120 128 Sample Output 2: NO 0.120*10^3 0.128*10^3 æ€è·¯ æŒ‰æ•´æ•°éƒ¨åˆ†æ˜¯å¦ä¸º 0 æ¥åˆ†æƒ…å†µè®¨è®ºï¼Œæ±‚å‡ºæœ¬ä½“å’ŒæŒ‡æ•°ï¼Œç„¶ååˆ¤æ–­ä¸¤è€…æ˜¯å¦éƒ½ç›¸ç­‰ï¼š\næ•´æ•°éƒ¨åˆ†ä¸º 0ï¼šç”±äºåœ¨å°æ•°ç‚¹åé¢è¿˜å¯èƒ½è·Ÿç€è‹¥å¹²ä¸ª 0ï¼Œå› æ­¤æœ¬ä½“éƒ¨åˆ†æ˜¯ä»å°æ•°ç‚¹åç¬¬ä¸€ä¸ªéé›¶ä½å¼€å§‹çš„éƒ¨åˆ†ï¼ˆä¸è¶³ n ä½åˆ™è¡¥ 0ï¼‰ï¼ŒæŒ‡æ•°åˆ™æ˜¯å°æ•°ç‚¹ä¸è¯¥éé›¶ä½ä¹‹é—´çš„ 0 çš„ä¸ªæ•°çš„ç›¸åæ•°ã€‚ æ•´æ•°éƒ¨åˆ†ä¸ä¸º 0ï¼šæœ¬ä½“éƒ¨åˆ†æ˜¯å»æ‰å°æ•°ç‚¹åçš„ç¬¬ä¸€ä¸ªéé›¶ä½å¼€å§‹çš„ n ä¸ªå­—ç¬¦ï¼ˆä¸è¶³ n ä½åˆ™è¡¥ 0ï¼‰ï¼ŒæŒ‡æ•°åˆ™æ˜¯å°æ•°ç‚¹æˆ–æœ€åä¸€ä½ï¼ˆå¦‚æ²¡æœ‰å°æ•°ç‚¹ï¼‰ä¹‹å‰çš„éé›¶ä½æ•°ã€‚ ä¸ç®¡æ˜¯å“ªç§æƒ…å†µï¼Œå¦‚æœæœ‰å°æ•°ç‚¹ï¼Œéƒ½éœ€è¦æŠŠå°æ•°ç‚¹å»æ‰ï¼Œè¿™æ ·æ‰èƒ½è¾“å‡ºæ­£ç¡®çš„æœ¬ä½“ã€‚\næ³¨æ„ç‚¹ æ­¤é¢˜æœ‰ä¸€ä¸ªé™·é˜±ï¼šæ•°æ®æœ‰å¯èƒ½å‡ºç°å‰å¯¼ 0ï¼Œåº”è¯¥å…ˆå»é™¤å‰å¯¼é›¶ï¼Œç„¶åå†æ ¹æ®é¦–ä½æ˜¯å¦ä¸ºå°æ•°ç‚¹æ¥åˆ¤æ–­æ˜¯æƒ…å†µ 1ï¼Œè¿˜æ˜¯æƒ…å†µ2ã€‚ å»é™¤å‰å¯¼é›¶åï¼Œè‹¥å­—ç¬¦ä¸²é•¿åº¦ä¸º 0ï¼Œåˆ™ä»£è¡¨è¯¥æ•°ä¸º 0ï¼Œåº”å°†æŒ‡æ•°å€¼ä¸º 0ï¼Œå¦åˆ™æœ‰å¯èƒ½å› å°æ•°ç‚¹åå…¨ä¸º 0 çš„æƒ…å†µï¼ŒæŒ‡æ•°å˜ä¸ºè´Ÿæ•°ã€‚ #include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; using namespace std; int n; string a, b; void chopping(string \u0026amp;str, int \u0026amp;e) { while (str[0] == \u0026#39;0\u0026#39; \u0026amp;\u0026amp; str.length() \u0026gt; 0) { str.erase(0, 1); } if (str[0] == \u0026#39;.\u0026#39;) { str.erase(0, 1); while (str[0] == \u0026#39;0\u0026#39; \u0026amp;\u0026amp; str.length() \u0026gt; 0) { str.erase(0, 1); e--; } } else { if (str.find(\u0026#39;.\u0026#39;) == string::npos) { e = str.length(); } else { e = str.find(\u0026#39;.\u0026#39;); str.erase(str.find(\u0026#39;.\u0026#39;), 1); } } int len = str.length(); if (len == 0) { e = 0; } if (str.length() \u0026lt; n) { for (int i = 0; i \u0026lt; n - len; i++) { str.append(\u0026#34;0\u0026#34;); } } else if (len \u0026gt; n) { str = str.substr(0, n); } } int main() { cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; a \u0026gt;\u0026gt; b; int e1 = 0, e2 = 0; chopping(a, e1); chopping(b, e2); if (a == b \u0026amp;\u0026amp; e1 == e2) { printf(\u0026#34;YES\u0026#34;); cout \u0026lt;\u0026lt; \u0026#34; 0.\u0026#34; \u0026lt;\u0026lt; a \u0026lt;\u0026lt; \u0026#34;*10^\u0026#34; \u0026lt;\u0026lt; e1; } else { printf(\u0026#34;NO\u0026#34;); cout \u0026lt;\u0026lt; \u0026#34; 0.\u0026#34; \u0026lt;\u0026lt; a \u0026lt;\u0026lt; \u0026#34;*10^\u0026#34; \u0026lt;\u0026lt; e1; cout \u0026lt;\u0026lt; \u0026#34; 0.\u0026#34; \u0026lt;\u0026lt; b \u0026lt;\u0026lt; \u0026#34;*10^\u0026#34; \u0026lt;\u0026lt; e2; } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1060/","summary":"\u003cp\u003eIf a machine can save only 3 significant digits, the float numbers 12300 and 12358.9 are considered equal since they are both saved as 0.123Ã—105 with simple chopping. Now given the number of significant digits on a machine and two float numbers, you are supposed to tell if they are treated equal in that machine.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case which gives three numbers \u003cem\u003eN\u003c/em\u003e, \u003cem\u003eA\u003c/em\u003e and \u003cem\u003eB\u003c/em\u003e, where \u003cem\u003eN\u003c/em\u003e (\u0026lt;100) is the number of significant digits, and \u003cem\u003eA\u003c/em\u003e and \u003cem\u003eB\u003c/em\u003e are the two float numbers to be compared. Each float number is non-negative, no greater than 10100, and that its total digit number is less than 100.\u003c/p\u003e","title":"PATç”²çº§ 1060 Are They Equal (25åˆ†)"},{"content":"Zhejiang University has 40000 students and provides 2500 courses. Now given the student name lists of all the courses, you are supposed to output the registered course list for each student who comes for a query.\nInput Specification: Each input file contains one test case. For each case, the first line contains 2 positive integers: N (â‰¤40,000), the number of students who look for their course lists, and K (â‰¤2,500), the total number of courses. Then the student name lists are given for the courses (numbered from 1 to K) in the following format: for each course i, first the course index i and the number of registered students N i (â‰¤200) are given in a line. Then in the next line, N i student names are given. A student name consists of 3 capital English letters plus a one-digit number. Finally the last line contains the N names of students who come for a query. All the names and numbers in a line are separated by a space.\nOutput Specification: For each test case, print your results in N lines. Each line corresponds to one student, in the following format: first print the student\u0026rsquo;s name, then the total number of registered courses of that student, and finally the indices of the courses in increasing order. The query results must be printed in the same order as input. All the data in a line must be separated by a space, with no extra space at the end of the line.\nSample Input: 11 5 4 7 BOB5 DON2 FRA8 JAY9 KAT3 LOR6 ZOE1 1 4 ANN0 BOB5 JAY9 LOR6 2 7 ANN0 BOB5 FRA8 JAY9 JOE4 KAT3 LOR6 3 1 BOB5 5 9 AMY7 ANN0 BOB5 DON2 FRA8 JAY9 KAT3 LOR6 ZOE1 ZOE1 ANN0 BOB5 JOE4 JAY9 FRA8 DON2 AMY7 KAT3 LOR6 NON9 Sample Output: ZOE1 2 4 5 ANN0 3 1 2 5 BOB5 5 1 2 3 4 5 JOE4 1 2 JAY9 4 1 2 4 5 FRA8 3 2 4 5 DON2 2 4 5 AMY7 1 5 KAT3 3 2 4 5 LOR6 4 1 2 4 5 NON9 0 æ³¨æ„ç‚¹ æœ¬é¢˜æœ€åä¸€ä¸ªæµ‹è¯•ç‚¹æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œä½¿ç”¨ map, string ä¼šå¯¼è‡´è¶…æ—¶ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨å­—ç¬¦ä¸² hash è¿›è¡Œæ±‚è§£ï¼Œä½¿ç”¨ vector æ•°ç»„æˆ– set æ•°ç»„ï¼ˆè‡ªåŠ¨æ’åºè¯¾ç¨‹å·ï¼‰ã€‚ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;set\u0026gt; using namespace std; const int maxn = 26 * 26 * 26 * 10; set\u0026lt;int\u0026gt; course[maxn]; int getID(char name[]) { int id = 0; for (int i = 0; i \u0026lt; 3; i++) { id = id * 26 + (name[i] - \u0026#39;A\u0026#39;); } id = id * 10 + (name[3] - \u0026#39;0\u0026#39;); return id; } int main() { int n, k, index, num; scanf(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;k); char name[5]; for (int i = 0; i \u0026lt; k; i++) { scanf(\u0026#34;%d %d\u0026#34;, \u0026amp;index, \u0026amp;num); for (int j = 0; j \u0026lt; num; j++) { scanf(\u0026#34;%s\u0026#34;, name); course[getID(name)].insert(index); } } for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%s\u0026#34;, name); int id = getID(name); printf(\u0026#34;%s %d\u0026#34;, name, course[id].size()); for (auto it = course[id].begin(); it != course[id].end(); it++) { printf(\u0026#34;% d\u0026#34;, *it); } printf(\u0026#34;\\n\u0026#34;); } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1039/","summary":"\u003cp\u003eZhejiang University has 40000 students and provides 2500 courses. Now given the student name lists of all the courses, you are supposed to output the registered course list for each student who comes for a query.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case. For each case, the first line contains 2 positive integers: \u003cem\u003eN\u003c/em\u003e (â‰¤40,000), the number of students who look for their course lists, and \u003cem\u003eK\u003c/em\u003e (â‰¤2,500), the total number of courses. Then the student name lists are given for the courses (numbered from 1 to \u003cem\u003eK\u003c/em\u003e) in the following format: for each course \u003cem\u003ei\u003c/em\u003e, first the course index \u003cem\u003ei\u003c/em\u003e and the number of registered students N \u003c!-- raw HTML omitted --\u003ei\u003c!-- raw HTML omitted --\u003e (â‰¤200) are given in a line. Then in the next line, N \u003c!-- raw HTML omitted --\u003ei\u003c!-- raw HTML omitted --\u003e student names are given. A student name consists of 3 capital English letters plus a one-digit number. Finally the last line contains the \u003cem\u003eN\u003c/em\u003e names of students who come for a query. All the names and numbers in a line are separated by a space.\u003c/p\u003e","title":"PATç”²çº§ 1039 Course List for Student (25åˆ†)"},{"content":"Among all the factors of a positive integer N, there may exist several consecutive numbers. For example, 630 can be factored as 3Ã—5Ã—6Ã—7, where 5, 6, and 7 are the three consecutive numbers. Now given any positive N, you are supposed to find the maximum number of consecutive factors, and list the smallest sequence of the consecutive factors.\nInput Specification: Each input file contains one test case, which gives the integer N (1\u0026lt;N\u0026lt;2^{31}).\nOutput Specification: For each test case, print in the first line the maximum number of consecutive factors. Then in the second line, print the smallest sequence of the consecutive factors in the format factor[1]*factor[2]*...*factor[k], where the factors are listed in increasing order, and 1 is NOT included.\nSample Input: 630 Sample Output: 3 5*6*7 æ³¨æ„ç‚¹ N ä¸ä¼šè¢«è‡ªå·±ä»¥ä¸ºçš„å¤§äº $\\sqrt{N}$ çš„å¤šä¸ªè¿ç»­æ•´æ•°æ•´é™¤ï¼Œå› æ­¤åªéœ€è¦ä» 2 ï½ $\\sqrt{N}$ éå†è¿ç»­æ•´æ•°çš„ç¬¬ä¸€ä¸ªã€‚ å¦‚æœéå†ç»“æŸå ansLen ä¾ç„¶ä¸º 0ï¼Œè¯´æ˜ä¸è¶…è¿‡ $\\sqrt{N}$ çš„æ•´æ•°ä¸­ä¸å­˜åœ¨èƒ½æ•´é™¤ N çš„è¿ç»­æ•´æ•°ï¼Œå› æ­¤ç­”æ¡ˆå°±æ˜¯ N æœ¬èº«ã€‚æ­¤æ—¶è¾“å‡ºç‰¹ä¾‹ï¼Œå³è¿ç»­ä¸ªæ•°ä¸º 1ï¼Œå› æ•°ä¸º N æœ¬èº«ã€‚ éœ€è¦ç”¨ long longï¼Œé˜²æ­¢ä¸­é—´ä¹˜ç§¯è¶…è¿‡ int å¯¼è‡´æº¢å‡ºã€‚ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;cmath\u0026gt; int main() { long long n; scanf(\u0026#34;%lld\u0026#34;, \u0026amp;n); long long ansI, ansLen = 0, sqr = sqrt(1.0 * n); for (long long i = 2; i \u0026lt;= sqr; i++) { long long temp = 1; for (long long j = i; j \u0026lt;= n ; j++) { temp *= j; if (n % temp == 0) { if (j - i + 1 \u0026gt; ansLen) { ansLen = j - i + 1; ansI = i; } } else { break; } } } if (ansLen == 0) { printf(\u0026#34;1\\n%lld\u0026#34;, n); } else { printf(\u0026#34;%lld\\n\u0026#34;, ansLen); for (long long i = 0; i \u0026lt; ansLen; i++) { printf(\u0026#34;%lld\u0026#34;, ansI + i); if (i != ansLen - 1) { printf(\u0026#34;*\u0026#34;); } } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1096/","summary":"\u003cp\u003eAmong all the factors of a positive integer N, there may exist several consecutive numbers. For example, 630 can be factored as 3Ã—5Ã—6Ã—7, where 5, 6, and 7 are the three consecutive numbers. Now given any positive N, you are supposed to find the maximum number of consecutive factors, and list the smallest sequence of the consecutive factors.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case, which gives the integer N (1\u0026lt;N\u0026lt;2^{31}).\u003c/p\u003e","title":"PATç”²çº§ 1096 Consecutive Factors (20åˆ†)"},{"content":"The task of this problem is simple: insert a sequence of distinct positive integers into a hash table, and output the positions of the input numbers. The hash function is defined to be H(key)=key%TSize where TSize is the maximum size of the hash table. Quadratic probing (with positive increments only) is used to solve the collisions.\nNote that the table size is better to be prime. If the maximum size given by the user is not prime, you must re-define the table size to be the smallest prime number which is larger than the size given by the user.\nInput Specification: Each input file contains one test case. For each case, the first line contains two positive numbers: MSize (â‰¤ 10^4 ) and N (â‰¤MSize) which are the user-defined table size and the number of input numbers, respectively. Then N distinct positive integers are given in the next line. All the numbers in a line are separated by a space.\nOutput Specification: For each test case, print the corresponding positions (index starts from 0) of the input numbers in one line. All the numbers in a line are separated by a space, and there must be no extra space at the end of the line. In case it is impossible to insert the number, print \u0026ldquo;-\u0026rdquo; instead.\nSample Input: 4 4 10 6 4 15 Sample Output: 0 1 4 - æ³¨æ„ç‚¹ è¿›è¡ŒäºŒæ¬¡æ¢æµ‹æ—¶ï¼Œå½“ step è‡ªå¢è¾¾åˆ° TSize æ—¶å¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°å¯ç”¨ä½ç½®ï¼Œåˆ™è¡¨æ˜è¿™ä¸ªå…ƒç´ æ— æ³•è¢«æ’å…¥ã€‚ åˆ›å»ºå“ˆå¸Œè¡¨æ—¶æ•°ç»„å¤§å°åº”è¯¥å°½é‡æ¯” 10^4 å¤§ä¸€äº›ï¼Œå› ä¸ºå½“å¯»æ‰¾å¤§äº MSize çš„æœ€å°è´¨æ•°æ—¶å¯èƒ½è¶…è¿‡ 10^4ã€‚ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;cmath\u0026gt; const int maxn = 10010; bool isPrime(int n) { if (n \u0026lt;= 1) { return false; } else if (n == 2) { return true; } else { int q = (int) sqrt(1.0 * n); for (int i = 2; i \u0026lt;= q; i++) { if (n % i == 0) { return false; } } return true; } } int main() { int tSize, n, nums[maxn] = {0}, num; scanf(\u0026#34;%d %d\u0026#34;, \u0026amp;tSize, \u0026amp;n); while (!isPrime(tSize)) { tSize++; } for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;num); int index = num % tSize; if (nums[index] == 0) { nums[index] = num; if (i != 0) { printf(\u0026#34; \u0026#34;); } printf(\u0026#34;%d\u0026#34;, index); } else { int j; for (j = 1; j \u0026lt;= tSize; j++) { index = (num + j * j) % tSize; if (nums[index] == 0) { nums[index] = num; printf(\u0026#34; %d\u0026#34;, index); break; } } if (j \u0026gt; tSize) { printf(\u0026#34; -\u0026#34;); } } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1078/","summary":"\u003cp\u003eThe task of this problem is simple: insert a sequence of distinct positive integers into a hash table, and output the positions of the input numbers. The hash function is defined to be H(key)=key%TSize where TSize is the maximum size of the hash table. Quadratic probing (with positive increments only) is used to solve the collisions.\u003c/p\u003e\n\u003cp\u003eNote that the table size is better to be prime. If the maximum size given by the user is not prime, you must re-define the table size to be the smallest prime number which is larger than the size given by the user.\u003c/p\u003e","title":"PATç”²çº§ 1078 Hashing (25åˆ†)"},{"content":"Given N rational numbers in the form numerator/denominator, you are supposed to calculate their sum.\nInput Specification: Each input file contains one test case. Each case starts with a positive integer N (â‰¤100), followed in the next line N rational numbers a1/b1 a2/b2 ... where all the numerators and denominators are in the range of long int. If there is a negative number, then the sign must appear in front of the numerator.\nOutput Specification: For each test case, output the sum in the simplest form integer numerator/denominator where integer is the integer part of the sum, numerator \u0026lt; denominator, and the numerator and the denominator have no common factor. You must output only the fractional part if the integer part is 0.\nSample Input 1: 5 2/5 4/15 1/30 -2/60 8/3 Sample Output 1: 3 1/3 Sample Input 2: 2 4/3 2/3 Sample Output 2: 2 Sample Input 3: 3 1/3 -1/6 1/8 Sample Output 3: 7/24 æ³¨æ„ç‚¹ æ•°æ®èŒƒå›´ä¸º intï¼Œä½†æ˜¯ä¸¤ä¸ªåˆ†æ¯ç›¸ä¹˜æ—¶ï¼Œå¯èƒ½è¶…å‡º intï¼Œæœ€å¤§å¯ä»¥è¾¾åˆ° long longï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨ intï¼Œå°±ä¼šæº¢å‡ºï¼Œå¾—åˆ°â€œç­”æ¡ˆé”™è¯¯â€ å¿…é¡»åœ¨æ¯ä¸€æ­¥åŠ æ³•åéƒ½è¿›è¡Œçº¦åˆ†ï¼Œå¦‚æœç­‰å…¨éƒ¨åŠ å®Œåæ‰çº¦åˆ†ï¼Œåˆ™ä¼šæº¢å‡º #include \u0026lt;cstdio\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; struct Num { long long a, b; } temp, ans; long long gcd(long long a, long long b) { if (b == 0) { return a; } else { return gcd(b, a % b); } } void simplify(Num \u0026amp;n) { if (n.b \u0026lt; 0) { n.a = -n.a; n.b = -n.b; } if (n.a == 0) { n.b = 1; } else { int d = gcd(abs(n.a), abs(n.b)); n.a /= d; n.b /= d; } } Num add(Num \u0026amp;n1, Num \u0026amp;n2) { Num ret; ret.a = n1.a * n2.b + n2.a * n1.b; ret.b = n1.b * n2.b; simplify(ret); return ret; } int main() { int n; scanf(\u0026#34;%d %lld/%lld\u0026#34;, \u0026amp;n, \u0026amp;ans.a, \u0026amp;ans.b); simplify(ans); for (int i = 1; i \u0026lt; n; i++) { scanf(\u0026#34;%lld/%lld\u0026#34;, \u0026amp;temp.a, \u0026amp;temp.b); ans = add(ans, temp); } if (ans.b == 1) { printf(\u0026#34;%lld\u0026#34;, ans.a); } else if (ans.a \u0026gt; ans.b) { printf(\u0026#34;%lld %lld/%lld\u0026#34;, ans.a / ans.b, ans.a % ans.b, ans.b); } else { printf(\u0026#34;%lld/%lld\u0026#34;, ans.a, ans.b); } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1081/","summary":"\u003cp\u003eGiven \u003cem\u003eN\u003c/em\u003e rational numbers in the form \u003ccode\u003enumerator/denominator\u003c/code\u003e, you are supposed to calculate their sum.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case. Each case starts with a positive integer \u003cem\u003eN\u003c/em\u003e (â‰¤100), followed in the next line \u003cem\u003eN\u003c/em\u003e rational numbers \u003ccode\u003ea1/b1 a2/b2 ...\u003c/code\u003e where all the numerators and denominators are in the range of \u003cstrong\u003elong int\u003c/strong\u003e. If there is a negative number, then the sign must appear in front of the numerator.\u003c/p\u003e","title":"PATç”²çº§ 1081 Rational Sum (20åˆ†)"},{"content":"ä¸€ä¸ªæ•°ç»„Aä¸­å­˜æœ‰Nï¼ˆ\u0026gt;0ï¼‰ä¸ªæ•´æ•°ï¼Œåœ¨ä¸å…è®¸ä½¿ç”¨å¦å¤–æ•°ç»„çš„å‰æä¸‹ï¼Œå°†æ¯ä¸ªæ•´æ•°å¾ªç¯å‘å³ç§»Mï¼ˆâ‰¥0ï¼‰ä¸ªä½ç½®ï¼Œå³å°†Aä¸­çš„æ•°æ®ç”±ï¼ˆA0 A1 â‹¯A Nâˆ’1 ï¼‰å˜æ¢ä¸ºï¼ˆA Nâˆ’M â‹¯A Nâˆ’1 A 0 A 1â‹¯A Nâˆ’Mâˆ’1 ï¼‰ï¼ˆæœ€åMä¸ªæ•°å¾ªç¯ç§»è‡³æœ€å‰é¢çš„Mä¸ªä½ç½®ï¼‰ã€‚å¦‚æœéœ€è¦è€ƒè™‘ç¨‹åºç§»åŠ¨æ•°æ®çš„æ¬¡æ•°å°½é‡å°‘ï¼Œè¦å¦‚ä½•è®¾è®¡ç§»åŠ¨çš„æ–¹æ³•ï¼Ÿ\nè¾“å…¥æ ¼å¼: æ¯ä¸ªè¾“å…¥åŒ…å«ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œç¬¬1è¡Œè¾“å…¥Nï¼ˆ1â‰¤Nâ‰¤100ï¼‰å’ŒMï¼ˆâ‰¥0ï¼‰ï¼›ç¬¬2è¡Œè¾“å…¥Nä¸ªæ•´æ•°ï¼Œä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ã€‚\nè¾“å‡ºæ ¼å¼: åœ¨ä¸€è¡Œä¸­è¾“å‡ºå¾ªç¯å³ç§»Mä½ä»¥åçš„æ•´æ•°åºåˆ—ï¼Œä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”ï¼Œåºåˆ—ç»“å°¾ä¸èƒ½æœ‰å¤šä½™ç©ºæ ¼ã€‚\nè¾“å…¥æ ·ä¾‹: 6 2 1 2 3 4 5 6 è¾“å‡ºæ ·ä¾‹: 5 6 1 2 3 4 æ€è·¯ å¦‚ä½•è®©ç§»åŠ¨çš„æ¬¡æ•°æœ€å°‘ï¼šå°†åºåˆ—ä¸­ä¸€ä¸ªå…ƒç´ å…ˆæ‹¿å‡ºè‡³ä¸´æ—¶å˜é‡ï¼Œç„¶åå°†ç©ºå‡ºçš„ä½ç½®ç”¨å°†è¦ç§»åŠ¨åˆ°è¿™ä¸ªä½ç½®çš„å…ƒç´ ä»£æ›¿ï¼Œå†æŠŠæ–°ç©ºå‡ºçš„ä½ç½®ç”¨å°†è¦ç§»åŠ¨åˆ°è¿™ä¸ªæ–°ç©ºå‡ºçš„ä½ç½®çš„å…ƒç´ ä»£æ›¿ï¼Œä»¥æ­¤ç±»æ¨ï¼ŒçŸ¥é“æ‰€æœ‰å…ƒç´ ç§»åŠ¨å®Œæ¯•ã€‚ æ³¨æ„ç‚¹ æœ‰å¯èƒ½ç»è¿‡ä¸€è½®å¾ªç¯ä¹‹å N-M å·ä½ä¹‹åæœ‰å¤šä¸ªä½ç½®å·²ç»å¾—åˆ°äº†æœ€ç»ˆç»“æœï¼Œè¿™æ ·å½“ç»§ç»­æšä¸¾èµ·å§‹ä½æ—¶å°±ä¼šäº§ç”Ÿé‡å¤ï¼Œæœ€åå¯¼è‡´é”™è¯¯ã€‚ä¾‹å¦‚ N = 8ï¼ŒM = 3ï¼Œè¿™ç§æƒ…å†µä¸‹åªéœ€è¦æšä¸¾ä¸€æ¬¡èµ·å§‹ä½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¦è®¡ç®—å¾—åˆ° N å’Œ M çš„æœ€å¤§å…¬çº¦æ•°ï¼Œè®¡ä¸º dï¼Œé‚£ä¹ˆ d å°±è¡¨ç¤ºéœ€è¦å¾ªç¯è½®æ•°ã€‚é‚£ä¹ˆä» N - M å·ä½å¼€å§‹æšä¸¾èµ·å§‹ä½ï¼Œç›´åˆ° N - M + d - 1 ä½ç»“æŸå³å¯ã€‚ å½“ M ç»è¿‡ M % N ä¿®æ­£åï¼Œè‹¥ M == 0ï¼Œåˆ™ç›´æ¥è¾“å‡ºæ•°ç»„å³å¯ï¼Œå¦åˆ™ä¼šäº§ç”Ÿé”™è¯¯ï¼Œè¶…æ—¶ã€‚ #include \u0026lt;cstdio\u0026gt; const int maxn = 100; int gcd(int a, int b) { if (b == 0) { return a; } else { return gcd(b, a % b); } } int main() { int n, m, nums[maxn]; scanf(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m); m %= n; for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;nums[i]); } if (m != 0) { int d = gcd(n, m); for (int i = n - m; i \u0026lt;= n - m + d - 1; i++) { int temp = nums[i], curIndex = i; while ((curIndex - m + n) % n != i) { int preIndex = (curIndex - m + n) % n; nums[curIndex] = nums[preIndex]; curIndex = preIndex; } nums[curIndex] = temp; } } for (int i = 0; i \u0026lt; n; i++) { printf(\u0026#34;%d\u0026#34;, nums[i]); if (i != n - 1) { printf(\u0026#34; \u0026#34;); } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/basic_level/b1008/","summary":"\u003cp\u003eä¸€ä¸ªæ•°ç»„\u003cem\u003eA\u003c/em\u003eä¸­å­˜æœ‰\u003cem\u003eN\u003c/em\u003eï¼ˆ\u0026gt;0ï¼‰ä¸ªæ•´æ•°ï¼Œåœ¨ä¸å…è®¸ä½¿ç”¨å¦å¤–æ•°ç»„çš„å‰æä¸‹ï¼Œå°†æ¯ä¸ªæ•´æ•°å¾ªç¯å‘å³ç§»\u003cem\u003eM\u003c/em\u003eï¼ˆâ‰¥0ï¼‰ä¸ªä½ç½®ï¼Œå³å°†\u003cem\u003eA\u003c/em\u003eä¸­çš„æ•°æ®ç”±ï¼ˆA\u003c!-- raw HTML omitted --\u003e0\u003c!-- raw HTML omitted --\u003e A\u003c!-- raw HTML omitted --\u003e1\u003c!-- raw HTML omitted --\u003e â‹¯A \u003c!-- raw HTML omitted --\u003eNâˆ’1\u003c!-- raw HTML omitted --\u003e ï¼‰å˜æ¢ä¸ºï¼ˆA \u003c!-- raw HTML omitted --\u003eNâˆ’M\u003c!-- raw HTML omitted --\u003e â‹¯A \u003c!-- raw HTML omitted --\u003eNâˆ’1\u003c!-- raw HTML omitted --\u003e A \u003c!-- raw HTML omitted --\u003e0\u003c!-- raw HTML omitted --\u003e A \u003c!-- raw HTML omitted --\u003e1\u003c!-- raw HTML omitted --\u003eâ‹¯A  \u003c!-- raw HTML omitted --\u003eNâˆ’Mâˆ’1\u003c!-- raw HTML omitted --\u003e ï¼‰ï¼ˆæœ€å\u003cem\u003eM\u003c/em\u003eä¸ªæ•°å¾ªç¯ç§»è‡³æœ€å‰é¢çš„\u003cem\u003eM\u003c/em\u003eä¸ªä½ç½®ï¼‰ã€‚å¦‚æœéœ€è¦è€ƒè™‘ç¨‹åºç§»åŠ¨æ•°æ®çš„æ¬¡æ•°å°½é‡å°‘ï¼Œè¦å¦‚ä½•è®¾è®¡ç§»åŠ¨çš„æ–¹æ³•ï¼Ÿ\u003c/p\u003e","title":"PATä¹™çº§ 1008 æ•°ç»„å…ƒç´ å¾ªç¯å³ç§»é—®é¢˜ (20åˆ†)"},{"content":"ç« èŠ‚æ¦‚è¦ å®Œæˆå½±é™¢æ¨¡å—ä¸šåŠ¡å¼€å‘ ä¿®æ”¹å…¨å±€å¼‚å¸¸è¿”å› å­¦ä¹  Dubbo ç‰¹æ€§ï¼šç»“æœç¼“å­˜ï¼Œè¿æ¥å’Œå¹¶å‘æ§åˆ¶ Dubbo ç»“æœç¼“å­˜ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/result-cache.html\nç”¨äºåŠ é€Ÿçƒ­é—¨æ•°æ®çš„è®¿é—®é€Ÿåº¦ï¼ŒDubbo æä¾›å£°æ˜å¼ç¼“å­˜ï¼Œä»¥å‡å°‘ç”¨æˆ·åŠ ç¼“å­˜çš„å·¥ä½œé‡ã€‚\nç¼“å­˜ç±»å‹ lru åŸºäºæœ€è¿‘æœ€å°‘ä½¿ç”¨åŸåˆ™åˆ é™¤å¤šä½™ç¼“å­˜ï¼Œä¿æŒæœ€çƒ­çš„æ•°æ®è¢«ç¼“å­˜ã€‚ threadlocal å½“å‰çº¿ç¨‹ç¼“å­˜ï¼Œæ¯”å¦‚ä¸€ä¸ªé¡µé¢æ¸²æŸ“ï¼Œç”¨åˆ°å¾ˆå¤š portalï¼Œæ¯ä¸ª portal éƒ½è¦å»æŸ¥ç”¨æˆ·ä¿¡æ¯ï¼Œé€šè¿‡çº¿ç¨‹ç¼“å­˜ï¼Œå¯ä»¥å‡å°‘è¿™ç§å¤šä½™è®¿é—®ã€‚ é…ç½® \u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; cache=\u0026#34;lru\u0026#34; /\u0026gt; æˆ–ï¼š\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;findBar\u0026#34; cache=\u0026#34;lru\u0026#34; /\u0026gt; \u0026lt;/dubbo:reference\u0026gt; äº†è§£ Dubbo ç»“æœç¼“å­˜ä¸ Redis ç¼“å­˜ç­‰çš„åŒºåˆ«ï¼š\nDubbo ç»“æœç¼“å­˜æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œä¿å­˜åœ¨å½“å‰ JVM ä¸­ï¼Œå¤šå°æœºå™¨å­˜å‚¨å¤šä»½ç¼“å­˜ã€‚é€‚åˆæ•°æ®é‡å°çš„æ•°æ®ï¼Œå­˜å‚¨åœ¨æœ¬åœ°å ç”¨èµ„æºå°‘ï¼Œè€Œä¸”é€Ÿåº¦è¾ƒå¿«ã€‚ Redis ç¼“å­˜åˆ™æ˜¯åˆ†å¸ƒå¼ç¼“å­˜ï¼Œå¤šå°æœºå™¨å…±äº«ç¼“å­˜ã€‚ å°æ•°æ®é‡çš„å¯ä»¥æ”¾åœ¨ Dubbo ç»“æœç¼“å­˜ä¸­ï¼Œéœ€è¦è®¡ç®—å’Œå…±äº«çš„ç¼“å­˜æ•°æ®å¯ä»¥æ”¾åœ¨ Redis ä¸­ã€‚ Dubbo è¿æ¥ã€å¹¶å‘æ§åˆ¶ Dubbo å¯ä»¥å¯¹è¿æ¥ã€å¹¶å‘æ•°é‡è¿›è¡Œæ§åˆ¶ è¶…å‡ºéƒ¨åˆ†ä»¥é”™è¯¯å½¢å¼è¿”å› Dubbo è¿æ¥æ§åˆ¶ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/config-connections.html\næœåŠ¡ç«¯è¿æ¥æ§åˆ¶ é™åˆ¶æœåŠ¡å™¨ç«¯æ¥å—çš„è¿æ¥ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š\n\u0026lt;dubbo:provider protocol=\u0026#34;dubbo\u0026#34; accepts=\u0026#34;10\u0026#34; /\u0026gt; æˆ–\n\u0026lt;dubbo:protocol name=\u0026#34;dubbo\u0026#34; accepts=\u0026#34;10\u0026#34; /\u0026gt; å®¢æˆ·ç«¯è¿æ¥æ§åˆ¶ é™åˆ¶å®¢æˆ·ç«¯æœåŠ¡ä½¿ç”¨è¿æ¥ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼ˆå¦‚æœæ˜¯é•¿è¿æ¥ï¼Œæ¯”å¦‚ Dubbo åè®®ï¼Œconnections è¡¨ç¤ºè¯¥æœåŠ¡å¯¹æ¯ä¸ªæä¾›è€…å»ºç«‹çš„é•¿è¿æ¥æ•°ï¼‰ï¼š\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; connections=\u0026#34;10\u0026#34; /\u0026gt; æˆ–\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34; connections=\u0026#34;10\u0026#34; /\u0026gt; å¦‚æœ dubbo:service å’Œ dubbo:reference éƒ½é…äº† connectionsï¼Œdubbo:reference ä¼˜å…ˆã€‚\nåŒºåˆ« æœåŠ¡ç«¯è¿æ¥æ§åˆ¶ æœåŠ¡ç«¯åªèƒ½æ¥å—æ¥è‡ªå®¢æˆ·ç«¯çš„ 10 ä¸ªè¯·æ±‚ï¼š\nå®¢æˆ·ç«¯è¿æ¥æ§åˆ¶ æœåŠ¡ç«¯å¯ä»¥æ¥å—ä»»æ„ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯å®¢æˆ·ç«¯åªèƒ½æ¥å— 10 ä¸ªè¯·æ±‚ã€‚\nå¦‚æœè¶…å‡ºäº†é™åˆ¶ï¼Œåˆ™ä¼šæŠ¥å’Œæ²¡æœ‰å¯åŠ¨æœåŠ¡ç±»ä¼¼çš„å¼‚å¸¸ï¼š\nCaused by: java.lang.IllegalStateException: Failed to check the status of the service com.zjut.zjxjwxk.dubbo.ServiceAPI. No provider available for the service com.zjut.zjxjwxk.dubbo.ServiceAPI ... Dubbo å¹¶å‘æ§åˆ¶ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/concurrency-control.html\næœåŠ¡ç«¯æœåŠ¡çº§åˆ« é™åˆ¶ com.foo.BarService çš„æ¯ä¸ªæ–¹æ³•ï¼ŒæœåŠ¡å™¨ç«¯å¹¶å‘æ‰§è¡Œï¼ˆæˆ–å ç”¨çº¿ç¨‹æ± çº¿ç¨‹æ•°ï¼‰ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34; executes=\u0026#34;10\u0026#34; /\u0026gt; æœåŠ¡ç«¯æ–¹æ³•çº§åˆ« é™åˆ¶ com.foo.BarService çš„ sayHello æ–¹æ³•ï¼ŒæœåŠ¡å™¨ç«¯å¹¶å‘æ‰§è¡Œï¼ˆæˆ–å ç”¨çº¿ç¨‹æ± çº¿ç¨‹æ•°ï¼‰ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;sayHello\u0026#34; executes=\u0026#34;10\u0026#34; /\u0026gt; \u0026lt;/dubbo:service\u0026gt; å®¢æˆ·ç«¯æœåŠ¡ç•Œåˆ« é™åˆ¶ com.foo.BarService çš„æ¯ä¸ªæ–¹æ³•ï¼Œæ¯å®¢æˆ·ç«¯å¹¶å‘æ‰§è¡Œï¼ˆæˆ–å ç”¨è¿æ¥çš„è¯·æ±‚æ•°ï¼‰ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34; actives=\u0026#34;10\u0026#34; /\u0026gt; æˆ–\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; actives=\u0026#34;10\u0026#34; /\u0026gt; å®¢æˆ·ç«¯æ–¹æ³•çº§åˆ« é™åˆ¶ com.foo.BarService çš„ sayHello æ–¹æ³•ï¼Œæ¯å®¢æˆ·ç«¯å¹¶å‘æ‰§è¡Œï¼ˆæˆ–å ç”¨è¿æ¥çš„è¯·æ±‚æ•°ï¼‰ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;sayHello\u0026#34; actives=\u0026#34;10\u0026#34; /\u0026gt; \u0026lt;/dubbo:service\u0026gt; æˆ–\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;sayHello\u0026#34; actives=\u0026#34;10\u0026#34; /\u0026gt; \u0026lt;/dubbo:service\u0026gt; å¦‚æœ dubbo:service å’Œ dubbo:reference éƒ½é…äº†activesï¼Œdubbo:reference ä¼˜å…ˆ\nLoad Balance å‡è¡¡ é…ç½®æœåŠ¡çš„å®¢æˆ·ç«¯çš„ loadbalance å±æ€§ä¸º leastactiveï¼Œæ­¤ Loadbalance ä¼šè°ƒç”¨å¹¶å‘æ•°æœ€å°çš„ Providerï¼ˆConsumerç«¯å¹¶å‘æ•°ï¼‰ã€‚\n\u0026lt;dubbo:reference interface=\u0026#34;com.foo.BarService\u0026#34; loadbalance=\u0026#34;leastactive\u0026#34; /\u0026gt; æˆ–\n\u0026lt;dubbo:service interface=\u0026#34;com.foo.BarService\u0026#34; loadbalance=\u0026#34;leastactive\u0026#34; /\u0026gt; ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/7.dubbo%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91%E5%BD%B1%E9%99%A2%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91/","summary":"\u003ch1 id=\"ç« èŠ‚æ¦‚è¦\"\u003eç« èŠ‚æ¦‚è¦\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eå®Œæˆå½±é™¢æ¨¡å—ä¸šåŠ¡å¼€å‘\u003c/li\u003e\n\u003cli\u003eä¿®æ”¹å…¨å±€å¼‚å¸¸è¿”å›\u003c/li\u003e\n\u003cli\u003eå­¦ä¹  Dubbo ç‰¹æ€§ï¼šç»“æœç¼“å­˜ï¼Œè¿æ¥å’Œå¹¶å‘æ§åˆ¶\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"dubbo-ç»“æœç¼“å­˜\"\u003eDubbo ç»“æœç¼“å­˜\u003c/h1\u003e\n\u003cblockquote\u003e\n\u003cp\u003eå®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/result-cache.html\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eç”¨äºåŠ é€Ÿçƒ­é—¨æ•°æ®çš„è®¿é—®é€Ÿåº¦ï¼ŒDubbo æä¾›å£°æ˜å¼ç¼“å­˜ï¼Œä»¥å‡å°‘ç”¨æˆ·åŠ ç¼“å­˜çš„å·¥ä½œé‡ã€‚\u003c/p\u003e\n\u003ch2 id=\"ç¼“å­˜ç±»å‹\"\u003eç¼“å­˜ç±»å‹\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003elru\u003c/code\u003e åŸºäºæœ€è¿‘æœ€å°‘ä½¿ç”¨åŸåˆ™åˆ é™¤å¤šä½™ç¼“å­˜ï¼Œä¿æŒæœ€çƒ­çš„æ•°æ®è¢«ç¼“å­˜ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ethreadlocal\u003c/code\u003e å½“å‰çº¿ç¨‹ç¼“å­˜ï¼Œæ¯”å¦‚ä¸€ä¸ªé¡µé¢æ¸²æŸ“ï¼Œç”¨åˆ°å¾ˆå¤š portalï¼Œæ¯ä¸ª portal éƒ½è¦å»æŸ¥ç”¨æˆ·ä¿¡æ¯ï¼Œé€šè¿‡çº¿ç¨‹ç¼“å­˜ï¼Œå¯ä»¥å‡å°‘è¿™ç§å¤šä½™è®¿é—®ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"é…ç½®\"\u003eé…ç½®\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecache=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lru\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæˆ–ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:method\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;findBar\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ecache=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;lru\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dubbo:reference\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eäº†è§£ Dubbo ç»“æœç¼“å­˜ä¸ Redis ç¼“å­˜ç­‰çš„åŒºåˆ«ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDubbo ç»“æœç¼“å­˜æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œä¿å­˜åœ¨å½“å‰ JVM ä¸­ï¼Œå¤šå°æœºå™¨å­˜å‚¨å¤šä»½ç¼“å­˜ã€‚é€‚åˆæ•°æ®é‡å°çš„æ•°æ®ï¼Œå­˜å‚¨åœ¨æœ¬åœ°å ç”¨èµ„æºå°‘ï¼Œè€Œä¸”é€Ÿåº¦è¾ƒå¿«ã€‚\u003c/li\u003e\n\u003cli\u003eRedis ç¼“å­˜åˆ™æ˜¯åˆ†å¸ƒå¼ç¼“å­˜ï¼Œå¤šå°æœºå™¨å…±äº«ç¼“å­˜ã€‚\u003c/li\u003e\n\u003cli\u003eå°æ•°æ®é‡çš„å¯ä»¥æ”¾åœ¨ Dubbo ç»“æœç¼“å­˜ä¸­ï¼Œéœ€è¦è®¡ç®—å’Œå…±äº«çš„ç¼“å­˜æ•°æ®å¯ä»¥æ”¾åœ¨ Redis ä¸­ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"dubbo-è¿æ¥å¹¶å‘æ§åˆ¶\"\u003eDubbo è¿æ¥ã€å¹¶å‘æ§åˆ¶\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eDubbo å¯ä»¥å¯¹è¿æ¥ã€å¹¶å‘æ•°é‡è¿›è¡Œæ§åˆ¶\u003c/li\u003e\n\u003cli\u003eè¶…å‡ºéƒ¨åˆ†ä»¥é”™è¯¯å½¢å¼è¿”å›\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"dubbo-è¿æ¥æ§åˆ¶\"\u003eDubbo è¿æ¥æ§åˆ¶\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eå®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/config-connections.html\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"æœåŠ¡ç«¯è¿æ¥æ§åˆ¶\"\u003eæœåŠ¡ç«¯è¿æ¥æ§åˆ¶\u003c/h3\u003e\n\u003cp\u003eé™åˆ¶æœåŠ¡å™¨ç«¯æ¥å—çš„è¿æ¥ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:provider\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eprotocol=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dubbo\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eaccepts=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;10\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæˆ–\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:protocol\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ename=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;dubbo\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eaccepts=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;10\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"å®¢æˆ·ç«¯è¿æ¥æ§åˆ¶\"\u003eå®¢æˆ·ç«¯è¿æ¥æ§åˆ¶\u003c/h3\u003e\n\u003cp\u003eé™åˆ¶å®¢æˆ·ç«¯æœåŠ¡ä½¿ç”¨è¿æ¥ä¸èƒ½è¶…è¿‡ 10 ä¸ªï¼ˆå¦‚æœæ˜¯é•¿è¿æ¥ï¼Œæ¯”å¦‚ Dubbo åè®®ï¼Œconnections è¡¨ç¤ºè¯¥æœåŠ¡å¯¹æ¯ä¸ªæä¾›è€…å»ºç«‹çš„é•¿è¿æ¥æ•°ï¼‰ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:reference\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003econnections=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;10\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæˆ–\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dubbo:service\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003einterface=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;com.foo.BarService\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003econnections=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;10\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå¦‚æœ dubbo:service å’Œ dubbo:reference éƒ½é…äº† connectionsï¼Œdubbo:reference ä¼˜å…ˆã€‚\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ7ï¼‰ï¼šDubboæœåŠ¡å¼€å‘ï¼ˆå½±é™¢æ¨¡å—å¼€å‘ï¼‰"},{"content":"The task is simple: given any positive integer N, you are supposed to count the total number of 1\u0026rsquo;s in the decimal form of the integers from 1 to N. For example, given N being 12, there are five 1\u0026rsquo;s in 1, 10, 11, and 12.\nInput Specification: Each input file contains one test case which gives the positive N (â‰¤230).\nOutput Specification: For each test case, print the number of 1\u0026rsquo;s in one line.\nSample Input: 12 Sample Output: 5 æ€è·¯ ä»ä½ä½åˆ°é«˜ä½è€ƒè™‘æ¯ä¸€ä½ä¸º 1 çš„ä¸ªæ•°ï¼Œè®¾å½“å‰ä½çš„æ•°ä¸º iï¼Œè¯¥ä½å·¦è¾¹çš„æ•°ä¸º leftNumï¼Œå³è¾¹çš„æ•°ä¸º rightNumï¼Œe ä» 1 å¼€å§‹æ¯æ¬¡éå†ä¹˜ 10ã€‚é€šè¿‡æ•°å­—ä¸¾ä¾‹ï¼Œå¯ä»¥æ€»ç»“å‡ºè¿™æ ·çš„å…¬å¼ï¼š\ni \u0026gt; 1 æ—¶ï¼Œä¸ªæ•°ä¸º (leftNum + 1) * e i == 1 æ—¶ï¼Œä¸ªæ•°ä¸º leftNum * e + rightNum + 1 i == 0 æ—¶ï¼Œä¸ªæ•°ä¸º leftNum * e #include \u0026lt;cstdio\u0026gt; int main() { int n; scanf(\u0026#34;%d\u0026#34;, \u0026amp;n); int i, leftNum = n, rightNum, e = 1, ans = 0; while (leftNum != 0) { i = n / e % 10; leftNum /= 10; rightNum = n % e; if (i \u0026gt; 1) { ans += (leftNum + 1) * e; } else if (i == 1) { ans += leftNum * e + rightNum + 1; } else { ans += leftNum * e; } e *= 10; } printf(\u0026#34;%d\u0026#34;, ans); return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1049/","summary":"\u003cp\u003eThe task is simple: given any positive integer \u003cem\u003eN\u003c/em\u003e, you are supposed to count the total number of 1\u0026rsquo;s in the decimal form of the integers from 1 to \u003cem\u003eN\u003c/em\u003e. For example, given \u003cem\u003eN\u003c/em\u003e being 12, there are five 1\u0026rsquo;s in 1, 10, 11, and 12.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case which gives the positive \u003cem\u003eN\u003c/em\u003e (â‰¤230).\u003c/p\u003e\n\u003ch1 id=\"output-specification\"\u003eOutput Specification:\u003c/h1\u003e\n\u003cp\u003eFor each test case, print the number of 1\u0026rsquo;s in one line.\u003c/p\u003e","title":"PATç”²çº§ 1049 Counting Ones (30åˆ†)"},{"content":"â€œç­”æ¡ˆæ­£ç¡®â€æ˜¯è‡ªåŠ¨åˆ¤é¢˜ç³»ç»Ÿç»™å‡ºçš„æœ€ä»¤äººæ¬¢å–œçš„å›å¤ã€‚æœ¬é¢˜å±äº PAT çš„â€œç­”æ¡ˆæ­£ç¡®â€å¤§æ´¾é€ â€”â€” åªè¦è¯»å…¥çš„å­—ç¬¦ä¸²æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼Œç³»ç»Ÿå°±è¾“å‡ºâ€œç­”æ¡ˆæ­£ç¡®â€ï¼Œå¦åˆ™è¾“å‡ºâ€œç­”æ¡ˆé”™è¯¯â€ã€‚\nå¾—åˆ°â€œç­”æ¡ˆæ­£ç¡®â€çš„æ¡ä»¶æ˜¯ï¼š\nå­—ç¬¦ä¸²ä¸­å¿…é¡»ä»…æœ‰ Pã€ Aã€ Tè¿™ä¸‰ç§å­—ç¬¦ï¼Œä¸å¯ä»¥åŒ…å«å…¶å®ƒå­—ç¬¦ï¼› ä»»æ„å½¢å¦‚ xPATx çš„å­—ç¬¦ä¸²éƒ½å¯ä»¥è·å¾—â€œç­”æ¡ˆæ­£ç¡®â€ï¼Œå…¶ä¸­ x æˆ–è€…æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯ä»…ç”±å­—æ¯ A ç»„æˆçš„å­—ç¬¦ä¸²ï¼› å¦‚æœ aPbTc æ˜¯æ­£ç¡®çš„ï¼Œé‚£ä¹ˆ aPbATca ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œå…¶ä¸­ aã€ bã€ c å‡æˆ–è€…æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯ä»…ç”±å­—æ¯ A ç»„æˆçš„å­—ç¬¦ä¸²ã€‚ ç°åœ¨å°±è¯·ä½ ä¸º PAT å†™ä¸€ä¸ªè‡ªåŠ¨è£åˆ¤ç¨‹åºï¼Œåˆ¤å®šå“ªäº›å­—ç¬¦ä¸²æ˜¯å¯ä»¥è·å¾—â€œç­”æ¡ˆæ­£ç¡®â€çš„ã€‚\nè¾“å…¥æ ¼å¼ï¼š æ¯ä¸ªæµ‹è¯•è¾“å…¥åŒ…å« 1 ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚ç¬¬ 1 è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•° n (\u0026lt;10)ï¼Œæ˜¯éœ€è¦æ£€æµ‹çš„å­—ç¬¦ä¸²ä¸ªæ•°ã€‚æ¥ä¸‹æ¥æ¯ä¸ªå­—ç¬¦ä¸²å ä¸€è¡Œï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¸è¶…è¿‡ 100ï¼Œä¸”ä¸åŒ…å«ç©ºæ ¼ã€‚\nè¾“å‡ºæ ¼å¼ï¼š æ¯ä¸ªå­—ç¬¦ä¸²çš„æ£€æµ‹ç»“æœå ä¸€è¡Œï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²å¯ä»¥è·å¾—â€œç­”æ¡ˆæ­£ç¡®â€ï¼Œåˆ™è¾“å‡º YESï¼Œå¦åˆ™è¾“å‡º NOã€‚\nè¾“å…¥æ ·ä¾‹ï¼š 8 PAT PAAT AAPATAA AAPAATAAAA xPATx PT Whatever APAAATAA è¾“å‡ºæ ·ä¾‹ï¼š YES YES YES YES NO NO NO NO æ€è·¯ å¯ä»¥æ‰¾åˆ°è¿™æ ·çš„è§„å¾‹ï¼šæ­£ç¡®çš„å­—ç¬¦ä¸²åº”è¯¥éµå¾ª P å·¦ä¾§çš„ A ä¸ªæ•°ä¹˜ P ä¸ T ä¸­é—´çš„ A ä¸ªæ•°ç­‰äº T å³ä¾§çš„ A ä¸ªæ•°ã€‚ä¸” P å’Œ T çš„ä¸ªæ•°å¿…é¡»ä¸º1ï¼Œä¸­é—´ A çš„ä¸ªæ•°ä¸èƒ½ä¸º 0ï¼Œé™¤äº† Pï¼ŒAï¼ŒT çš„å…¶ä»–çš„å­—ç¬¦ä¸ªæ•°å¿…é¡»ä¸º 0ã€‚ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;cstring\u0026gt; const int maxn = 101; int main() { int n, len; scanf(\u0026#34;%d\u0026#34;, \u0026amp;n); char str[maxn]; for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%s\u0026#34;, str); len = strlen(str); int PNum = 0, TNum = 0, otherNum = 0, PIndex, TIndex; for (int j = 0; j \u0026lt; len; j++) { if (str[j] == \u0026#39;P\u0026#39;) { PNum++; PIndex = j; } else if (str[j] == \u0026#39;T\u0026#39;) { TNum++; TIndex = j; } else if (str[j] != \u0026#39;A\u0026#39;) { otherNum++; } } if (PNum != 1 || TNum != 1 || otherNum != 0 || (TIndex - PIndex) \u0026lt;= 1) { printf(\u0026#34;NO\\n\u0026#34;); continue; } int leftA = PIndex, midA = TIndex - PIndex - 1, rightA = len - TIndex - 1; if (leftA * midA == rightA) { printf(\u0026#34;YES\\n\u0026#34;); } else { printf(\u0026#34;NO\\n\u0026#34;); } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/basic_level/b1003/","summary":"\u003cp\u003eâ€œ\u003cstrong\u003eç­”æ¡ˆæ­£ç¡®\u003c/strong\u003eâ€æ˜¯è‡ªåŠ¨åˆ¤é¢˜ç³»ç»Ÿç»™å‡ºçš„æœ€ä»¤äººæ¬¢å–œçš„å›å¤ã€‚æœ¬é¢˜å±äº PAT çš„â€œ\u003cstrong\u003eç­”æ¡ˆæ­£ç¡®\u003c/strong\u003eâ€å¤§æ´¾é€ â€”â€” åªè¦è¯»å…¥çš„å­—ç¬¦ä¸²æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼Œç³»ç»Ÿå°±è¾“å‡ºâ€œ\u003cstrong\u003eç­”æ¡ˆæ­£ç¡®\u003c/strong\u003eâ€ï¼Œå¦åˆ™è¾“å‡ºâ€œ\u003cstrong\u003eç­”æ¡ˆé”™è¯¯\u003c/strong\u003eâ€ã€‚\u003c/p\u003e\n\u003cp\u003eå¾—åˆ°â€œ\u003cstrong\u003eç­”æ¡ˆæ­£ç¡®\u003c/strong\u003eâ€çš„æ¡ä»¶æ˜¯ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eå­—ç¬¦ä¸²ä¸­å¿…é¡»ä»…æœ‰ \u003ccode\u003eP\u003c/code\u003eã€ \u003ccode\u003eA\u003c/code\u003eã€ \u003ccode\u003eT\u003c/code\u003eè¿™ä¸‰ç§å­—ç¬¦ï¼Œä¸å¯ä»¥åŒ…å«å…¶å®ƒå­—ç¬¦ï¼›\u003c/li\u003e\n\u003cli\u003eä»»æ„å½¢å¦‚ \u003ccode\u003exPATx\u003c/code\u003e çš„å­—ç¬¦ä¸²éƒ½å¯ä»¥è·å¾—â€œ\u003cstrong\u003eç­”æ¡ˆæ­£ç¡®\u003c/strong\u003eâ€ï¼Œå…¶ä¸­ \u003ccode\u003ex\u003c/code\u003e æˆ–è€…æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯ä»…ç”±å­—æ¯ \u003ccode\u003eA\u003c/code\u003e ç»„æˆçš„å­—ç¬¦ä¸²ï¼›\u003c/li\u003e\n\u003cli\u003eå¦‚æœ \u003ccode\u003eaPbTc\u003c/code\u003e æ˜¯æ­£ç¡®çš„ï¼Œé‚£ä¹ˆ \u003ccode\u003eaPbATca\u003c/code\u003e ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œå…¶ä¸­ \u003ccode\u003ea\u003c/code\u003eã€ \u003ccode\u003eb\u003c/code\u003eã€ \u003ccode\u003ec\u003c/code\u003e å‡æˆ–è€…æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…æ˜¯ä»…ç”±å­—æ¯ \u003ccode\u003eA\u003c/code\u003e ç»„æˆçš„å­—ç¬¦ä¸²ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eç°åœ¨å°±è¯·ä½ ä¸º PAT å†™ä¸€ä¸ªè‡ªåŠ¨è£åˆ¤ç¨‹åºï¼Œåˆ¤å®šå“ªäº›å­—ç¬¦ä¸²æ˜¯å¯ä»¥è·å¾—â€œ\u003cstrong\u003eç­”æ¡ˆæ­£ç¡®\u003c/strong\u003eâ€çš„ã€‚\u003c/p\u003e\n\u003ch1 id=\"è¾“å…¥æ ¼å¼\"\u003eè¾“å…¥æ ¼å¼ï¼š\u003c/h1\u003e\n\u003cp\u003eæ¯ä¸ªæµ‹è¯•è¾“å…¥åŒ…å« 1 ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚ç¬¬ 1 è¡Œç»™å‡ºä¸€ä¸ªæ­£æ•´æ•° \u003cem\u003en\u003c/em\u003e (\u0026lt;10)ï¼Œæ˜¯éœ€è¦æ£€æµ‹çš„å­—ç¬¦ä¸²ä¸ªæ•°ã€‚æ¥ä¸‹æ¥æ¯ä¸ªå­—ç¬¦ä¸²å ä¸€è¡Œï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¸è¶…è¿‡ 100ï¼Œä¸”ä¸åŒ…å«ç©ºæ ¼ã€‚\u003c/p\u003e\n\u003ch1 id=\"è¾“å‡ºæ ¼å¼\"\u003eè¾“å‡ºæ ¼å¼ï¼š\u003c/h1\u003e\n\u003cp\u003eæ¯ä¸ªå­—ç¬¦ä¸²çš„æ£€æµ‹ç»“æœå ä¸€è¡Œï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²å¯ä»¥è·å¾—â€œ\u003cstrong\u003eç­”æ¡ˆæ­£ç¡®\u003c/strong\u003eâ€ï¼Œåˆ™è¾“å‡º \u003ccode\u003eYES\u003c/code\u003eï¼Œå¦åˆ™è¾“å‡º \u003ccode\u003eNO\u003c/code\u003eã€‚\u003c/p\u003e\n\u003ch1 id=\"è¾“å…¥æ ·ä¾‹\"\u003eè¾“å…¥æ ·ä¾‹ï¼š\u003c/h1\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-in\" data-lang=\"in\"\u003e8\nPAT\nPAAT\nAAPATAA\nAAPAATAAAA\nxPATx\nPT\nWhatever\nAPAAATAA\n\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"è¾“å‡ºæ ·ä¾‹\"\u003eè¾“å‡ºæ ·ä¾‹ï¼š\u003c/h1\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-out\" data-lang=\"out\"\u003eYES\nYES\nYES\nYES\nNO\nNO\nNO\nNO\n\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"æ€è·¯\"\u003eæ€è·¯\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eå¯ä»¥æ‰¾åˆ°è¿™æ ·çš„è§„å¾‹ï¼šæ­£ç¡®çš„å­—ç¬¦ä¸²åº”è¯¥éµå¾ª P å·¦ä¾§çš„ A ä¸ªæ•°ä¹˜ P ä¸ T ä¸­é—´çš„ A ä¸ªæ•°ç­‰äº T å³ä¾§çš„ A ä¸ªæ•°ã€‚ä¸” P å’Œ T çš„ä¸ªæ•°å¿…é¡»ä¸º1ï¼Œä¸­é—´ A çš„ä¸ªæ•°ä¸èƒ½ä¸º 0ï¼Œé™¤äº† Pï¼ŒAï¼ŒT çš„å…¶ä»–çš„å­—ç¬¦ä¸ªæ•°å¿…é¡»ä¸º 0ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;cstdio\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;cstring\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e maxn \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e101\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e n, len;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    scanf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%d\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003en);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003echar\u003c/span\u003e str[maxn];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e (\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e i \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; i \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e n; i\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        scanf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%s\u0026#34;\u003c/span\u003e, str);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        len \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e strlen(str);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e PNum \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, TNum \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, otherNum \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, PIndex, TIndex;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e (\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e j \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; j \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e len; j\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (str[j] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;P\u0026#39;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                PNum\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                PIndex \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e j;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (str[j] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;T\u0026#39;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                TNum\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                TIndex \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e j;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (str[j] \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;A\u0026#39;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                otherNum\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (PNum \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e TNum \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e otherNum \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e||\u003c/span\u003e (TIndex \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e PIndex) \u003cspan style=\"color:#f92672\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            printf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;NO\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003econtinue\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e leftA \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e PIndex, midA \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e TIndex \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e PIndex \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, rightA \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e len \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e TIndex \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (leftA \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e midA \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e rightA) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            printf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;YES\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            printf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;NO\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","title":"PATä¹™çº§ 1003 æˆ‘è¦é€šè¿‡ï¼ (20åˆ†)"},{"content":"Given a sequence of positive numbers, a segment is defined to be a consecutive subsequence. For example, given the sequence { 0.1, 0.2, 0.3, 0.4 }, we have 10 segments: (0.1) (0.1, 0.2) (0.1, 0.2, 0.3) (0.1, 0.2, 0.3, 0.4) (0.2) (0.2, 0.3) (0.2, 0.3, 0.4) (0.3) (0.3, 0.4) and (0.4).\nNow given a sequence, you are supposed to find the sum of all the numbers in all the segments. For the previous example, the sum of all the 10 segments is 0.1 + 0.3 + 0.6 + 1.0 + 0.2 + 0.5 + 0.9 + 0.3 + 0.7 + 0.4 = 5.0.\nInput Specification: Each input file contains one test case. For each case, the first line gives a positive integer N, the size of the sequence which is no more than 10^5. The next line contains N positive numbers in the sequence, each no more than 1.0, separated by a space.\nOutput Specification: For each test case, print in one line the sum of all the numbers in all the segments, accurate up to 2 decimal places.\nSample Input: 4 0.1 0.2 0.3 0.4 Sample Output: 5.00 æ€è·¯ åŒ…å«ç¬¬ i ä¸ªæ•°çš„ç‰‡æ®µï¼Œå…¶é¦–æŒ‡é’ˆæœ‰ i ä¸­é€‰æ‹©ï¼š1, 2, 3, \u0026hellip; iï¼Œå…¶å°¾æŒ‡é’ˆæœ‰ n - i + 1 ä¸­é€‰æ‹©ï¼ši, i + 1, \u0026hellip; nã€‚æ‰€ä»¥åŒ…å«ç¬¬ i ä¸ªæ•°çš„ç‰‡æ®µæœ‰ i * (n - i + 1) ç§ã€‚å°† i ä» 1 åˆ° n éå†ï¼Œå°†åŒ…å«æ¯ä¸ªæ•°çš„ç‰‡æ®µæ•°ç›¸åŠ å³å¯ã€‚ #include \u0026lt;cstdio\u0026gt; const int maxn = 100000; int main() { int n; scanf(\u0026#34;%d\u0026#34;, \u0026amp;n); double temp, ans = 0; for (int i = 1; i \u0026lt;= n; i++) { scanf(\u0026#34;%lf\u0026#34;, \u0026amp;temp); ans += temp * i * (n - i + 1); } printf(\u0026#34;%.2f\u0026#34;, ans); return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1104/","summary":"\u003cp\u003eGiven a sequence of positive numbers, a segment is defined to be a consecutive subsequence. For example, given the sequence { 0.1, 0.2, 0.3, 0.4 }, we have 10 segments: (0.1) (0.1, 0.2) (0.1, 0.2, 0.3) (0.1, 0.2, 0.3, 0.4) (0.2) (0.2, 0.3) (0.2, 0.3, 0.4) (0.3) (0.3, 0.4) and (0.4).\u003c/p\u003e\n\u003cp\u003eNow given a sequence, you are supposed to find the sum of all the numbers in all the segments. For the previous example, the sum of all the 10 segments is 0.1 + 0.3 + 0.6 + 1.0 + 0.2 + 0.5 + 0.9 + 0.3 + 0.7 + 0.4 = 5.0.\u003c/p\u003e","title":"PATç”²çº§ 1104 Sum of Number Segments (20åˆ†)"},{"content":"There is a classical process named partition in the famous quick sort algorithm. In this process we typically choose one element as the pivot. Then the elements less than the pivot are moved to its left and those larger than the pivot to its right. Given N distinct positive integers after a run of partition, could you tell how many elements could be the selected pivot for this partition?\nFor example, given N=5 and the numbers 1, 3, 2, 4, and 5. We have:\n1 could be the pivot since there is no element to its left and all the elements to its right are larger than it; 3 must not be the pivot since although all the elements to its left are smaller, the number 2 to its right is less than it as well; 2 must not be the pivot since although all the elements to its right are larger, the number 3 to its left is larger than it as well; and for the similar reason, 4 and 5 could also be the pivot. Hence in total there are 3 pivot candidates.\nInput Specification: Each input file contains one test case. For each case, the first line gives a positive integer N (â‰¤10^5). Then the next line contains N distinct positive integers no larger than 10^9. The numbers in a line are separated by spaces.\nOutput Specification: For each test case, output in the first line the number of pivot candidates. Then in the next line print these candidates in increasing order. There must be exactly 1 space between two adjacent numbers, and no extra space at the end of each line.\nSample Input: 5 1 3 2 4 5 Sample Output: 3 1 4 5 æ€è·¯ å®šä¹‰ä¸¤ä¸ªæ•°ç»„ leftMax[maxn] å’Œ leftMax[maxn]ï¼ŒleftMax[maxn] ç”¨äºè®°å½•åºåˆ—ä¸­æ¯ä¸€ä½å·¦è¾¹çš„æœ€å¤§å€¼ï¼ŒleftMax[maxn] ç”¨äºè®°å½•åºåˆ—ä¸­æ¯ä¸€ä½å³è¾¹çš„æœ€å°å€¼ã€‚å¦‚æœ nums[i] å¤§äºå·¦è¾¹çš„æœ€å¤§å€¼ leftMax[i] ä¸”å°äºå³è¾¹çš„æœ€å°å€¼ rightMin[i]ï¼Œé‚£ä¹ˆ nums[i] ä¸€å®šå¯ä»¥ä½œä¸ºä¸»å…ƒã€‚ å…¶ä¸­ï¼ŒleftMax[0] åº”è®¾ä¸º0ï¼Œè¿™æ ·å°±å‡è®¾äº† nums[0] å·¦è¾¹æ²¡æœ‰æ¯”å®ƒå¤§çš„å…ƒç´ ï¼›rightMin[n - 1] åº”è®¾ä¸ºæœ€å¤§å€¼ 1 \u0026laquo; 31 - 1ï¼Œè¿™æ ·å°±å‡è®¾äº† nums[n - 1] å³è¾¹æ²¡æœ‰æ¯”å®ƒå°çš„å…ƒç´ ã€‚è¿™æ ·åœ¨ç»™è¿™ä¸¤ä¸ªæ•°ç»„èµ‹å€¼çš„è¿‡ç¨‹ä¸­ï¼Œç›¸å½“äºæŠŠåˆå§‹æœ€å¤§å€¼è®¾ä¸ºäº† nums[0] å³ 0ï¼ŒæŠŠåˆå§‹æœ€å°å€¼è®¾ä¸ºäº† nums[n - 1] å³ 1 \u0026laquo; 31 - 1ã€‚åŒæ—¶åœ¨åˆ¤æ–­ä¸»å…ƒæ—¶æ–¹ä¾¿äº†è¾¹ç•Œå…ƒç´ çš„åˆ¤æ–­ï¼Œ æ³¨æ„ç‚¹ ç›´æ¥æš´åŠ›åˆ¤æ–­çš„åšæ³•ä¼šè¶…æ—¶ å½“ä¸»å…ƒä¸ªæ•°ä¸º0æ—¶ï¼Œç¬¬äºŒè¡Œè™½ç„¶æ²¡æœ‰è¾“å‡ºä¸»å…ƒï¼Œä½†å¿…é¡»è¾“å‡ºä¸€ä¸ªæ¢è¡Œï¼ˆå¦åˆ™ä¼šæœ‰ä¸€ä¸ªç‚¹æ ¼å¼é”™è¯¯\u0026hellip;ï¼‰ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;vector\u0026gt; using namespace std; const int maxn = 100000; int main() { int n, nums[maxn], leftMax[maxn], rightMin[maxn]; scanf(\u0026#34;%d\u0026#34;, \u0026amp;n); leftMax[0] = 0; rightMin[n - 1] = 1 \u0026lt;\u0026lt; 31 - 1; for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;nums[i]); if (i != n - 1) { if (nums[i] \u0026gt; leftMax[i]) { leftMax[i + 1] = nums[i]; } else { leftMax[i + 1] = leftMax[i]; } } } for (int i = n - 1; i \u0026gt;= 1; i--) { if (nums[i] \u0026lt; rightMin[i]) { rightMin[i - 1] = nums[i]; } else { rightMin[i - 1] = rightMin[i]; } } vector\u0026lt;int\u0026gt; ans; for (int i = 0; i \u0026lt; n; i++) { if (nums[i] \u0026gt; leftMax[i] \u0026amp;\u0026amp; nums[i] \u0026lt; rightMin[i]) { ans.push_back(nums[i]); } } printf(\u0026#34;%d\\n\u0026#34;, ans.size()); for (int i = 0; i \u0026lt; ans.size(); i++) { printf(\u0026#34;%d\u0026#34;, ans[i]); if (i != ans.size() - 1) { printf(\u0026#34; \u0026#34;); } } printf(\u0026#34;\\n\u0026#34;); return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1101/","summary":"\u003cp\u003eThere is a classical process named \u003cstrong\u003epartition\u003c/strong\u003e in the famous quick sort algorithm. In this process we typically choose one element as the pivot. Then the elements less than the pivot are moved to its left and those larger than the pivot to its right. Given \u003cem\u003eN\u003c/em\u003e distinct positive integers after a run of partition, could you tell how many elements could be the selected pivot for this partition?\u003c/p\u003e\n\u003cp\u003eFor example, given \u003cem\u003eN\u003c/em\u003e=5 and the numbers 1, 3, 2, 4, and 5. We have:\u003c/p\u003e","title":"PATç”²çº§ 1101 Quick Sort (25åˆ†)"},{"content":"Given a pair of positive integers, for example, 6 and 110, can this equation 6 = 110 be true? The answer is yes, if 6 is a decimal number and 110 is a binary number.\nNow for any pair of positive integers N1 and N2, your task is to find the radix of one number while that of the other is given.\nInput Specification: Each input file contains one test case. Each case occupies a line which contains 4 positive integers:\nN1 N2 tag radix Here N1 and N2 each has no more than 10 digits. A digit is less than its radix and is chosen from the set { 0-9, a-z } where 0-9 represent the decimal numbers 0-9, and a-z represent the decimal numbers 10-35. The last number radix is the radix of N1 if tag is 1, or of N2 if tag is 2.\nOutput Specification: For each test case, print in one line the radix of the other number so that the equation N1 = N2 is true. If the equation is impossible, print Impossible. If the solution is not unique, output the smallest possible radix.\nSample Input 1: 6 110 1 10 Sample Output 1: 2 Sample Input 2: 1 ab 1 2 Sample Output 2: Impossible æ€è·¯ äºŒåˆ†ï¼šå¯¹ä¸€ä¸ªç¡®å®šçš„æ•°å­—ä¸²æ¥è¯´ï¼Œå®ƒçš„è¿›åˆ¶è¶Šå¤§ï¼Œè¯¥æ•°å­—ä¸²è½¬æ¢ä¸ºåè¿›åˆ¶çš„ç»“æœä¹Ÿå°±è¶Šå¤§ã€‚ æ³¨æ„ç‚¹ ä½¿ç”¨éå†è¿›åˆ¶çš„æš´åŠ›æ³•ä¼šè¶…æ—¶ï¼Œå› ä½¿ç”¨äºŒåˆ†æ³•ã€‚ æœ¬é¢˜çš„å˜é‡å°½é‡ä½¿ç”¨ long long ç±»å‹ã€‚å¦å¤–ï¼Œç»æµ‹è¯•å¾—åˆ°ï¼Œæœ¬é¢˜ä¸­ radix çš„èŒƒå›´æœ€å¤§ä¸º INT_MAX ï¼Œå³2^{31}-1ï¼Œå› æ­¤å¿…é¡»åœ¨åœ¨è®¡ç®—è¿‡ç¨‹ä¸­åˆ¤æ–­æ˜¯å¦æº¢å‡ºã€‚ N2 è¿›åˆ¶çš„ä¸‹ç•Œä¸ºæ‰€æœ‰æ•°ä½ä¸­æœ€å¤§çš„é‚£ä¸ª+1ï¼Œä¸Šç•Œä¸º N1 çš„åè¿›åˆ¶ï¼ˆnum1ï¼‰ä¸ä¸‹ç•Œï¼ˆlowerï¼‰çš„è¾ƒå¤§å€¼+1ï¼ˆå³ max(num1, lower) + 1ï¼‰ã€‚ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;cstring\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; char n1[11], n2[11], temp[11]; int tag; long long radix, num1, inf = (1LL \u0026lt;\u0026lt; 63) - 1; long long strToNum(char str[], long long radix, long long upper) { int len = strlen(str); long long num = 0; for (int i = 0; i \u0026lt; len; i++) { long long digit; if (str[i] \u0026gt;= \u0026#39;a\u0026#39; \u0026amp;\u0026amp; str[i] \u0026lt;= \u0026#39;z\u0026#39;) { digit = str[i] - \u0026#39;a\u0026#39; + 10; } else { digit = str[i] - \u0026#39;0\u0026#39;; } num = num * radix + digit; if (num \u0026lt; 0 || num \u0026gt; upper) { return -1; } } return num; } long long findLower(char str[]) { long long maxDigit = -1; int len = strlen(str); for (int i = 0; i \u0026lt; len; i++) { long long digit; if (str[i] \u0026gt;= \u0026#39;a\u0026#39; \u0026amp;\u0026amp; str[i] \u0026lt;= \u0026#39;z\u0026#39;) { digit = str[i] - \u0026#39;a\u0026#39; + 10; } else { digit = str[i] - \u0026#39;0\u0026#39;; } if (digit \u0026gt; maxDigit) { maxDigit = digit; } } return maxDigit + 1; } int binarySearch(long long left, long long right, char str[], long long upper) { long long mid, num2; while (left \u0026lt;= right) { mid = left + (right - left) / 2; long long num2 = strToNum(n2, mid, upper); if (num2 == num1) { return mid; } else if (num2 \u0026gt; num1 || num2 == -1) { right = mid - 1; } else { left = mid + 1; } } return -1; } int main() { scanf(\u0026#34;%s %s %d %d\u0026#34;, n1, n2, \u0026amp;tag, \u0026amp;radix); if (tag == 2) { strcpy(temp, n1); strcpy(n1, n2); strcpy(n2, temp); } long long lower = findLower(n2); num1 = strToNum(n1, radix, inf); long long radix2 = binarySearch(lower, max(num1, lower) + 1, n2, num1); if (radix2 == -1) { printf(\u0026#34;Impossible\u0026#34;); } else { printf(\u0026#34;%d\u0026#34;, radix2); } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1010/","summary":"\u003cp\u003eGiven a pair of positive integers, for example, 6 and 110, can this equation 6 = 110 be true? The answer is \u003ccode\u003eyes\u003c/code\u003e, if 6 is a decimal number and 110 is a binary number.\u003c/p\u003e\n\u003cp\u003eNow for any pair of positive integers \u003cem\u003eN\u003c/em\u003e1 and \u003cem\u003eN\u003c/em\u003e2, your task is to find the radix of one number while that of the other is given.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case. Each case occupies a line which contains 4 positive integers:\u003c/p\u003e","title":"PATç”²çº§ 1010 Radix (25åˆ†)"},{"content":"Given a sequence of positive integers and another positive integer p. The sequence is said to be a perfect sequence if Mâ‰¤mÃ—p where M and m are the maximum and minimum numbers in the sequence, respectively.\nNow given a sequence and a parameter p, you are supposed to find from the sequence as many numbers as possible to form a perfect subsequence.\nInput Specification: Each input file contains one test case. For each case, the first line contains two positive integers N and p, where N (â‰¤10^5) is the number of integers in the sequence, and p (â‰¤ 10^9 ) is the parameter. In the second line there are N positive integers, each is no greater than 10^9.\nOutput Specification: For each test case, print in one line the maximum number of integers that can be chosen to form a perfect subsequence.\nSample Input: 10 8 2 3 20 4 5 1 6 7 8 9 Sample Output: 8 æ€è·¯ èƒ½ä½¿é€‰å‡ºçš„æ•°ä¸ªæ•°æœ€å¤§çš„æ–¹æ¡ˆï¼Œä¸€å®šæ˜¯åœ¨è¯¥é€’å¢åºåˆ—ä¸­é€‰æ‹©è¿ç»­çš„è‹¥å¹²ä¸ªæ•°çš„æ–¹æ¡ˆ å¦‚æœå¼ºè¡Œè¿›è¡ŒO(n^2)çš„äºŒé‡å¾ªç¯éå†ï¼Œé‚£ä¹ˆæ ¹æ®é¢˜ç›®çš„æ•°æ®èŒƒå›´ï¼Œè‚¯å®šæ˜¯ä¼šè¶…æ—¶çš„ã€‚è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼šäºŒåˆ†æŸ¥æ‰¾å’Œ two pointersã€‚ æœ¬äººåˆ©ç”¨ upper_bound() å‡½æ•°æ¥äºŒåˆ†å¯»æ‰¾ç¬¬ä¸€ä¸ªå¤§äº m * p çš„æ•°çš„ä½ç½®ï¼Œé‚£ä¹ˆ M çš„æœ€å¤§æ•°çš„ä½ç½®å³ä¸ºè¯¥ä½ç½® -1ã€‚ æ³¨æ„ç‚¹ nums[i] * p å¯èƒ½è¾¾åˆ° 10^{18}ï¼Œå¯ä»¥ä½¿ç”¨ long long æ¥å®šä¹‰æ•°ç»„ã€‚ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int maxn = 100000; int main() { int n; long long p, nums[maxn]; scanf(\u0026#34;%d %lld\u0026#34;, \u0026amp;n, \u0026amp;p); for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%lld\u0026#34;, \u0026amp;nums[i]); } sort(nums, nums + n); int ans = 0; long long m = nums[0]; for (int i = 0; i \u0026lt; n; i++) { int j = upper_bound(nums + i + 1, nums + n, nums[i] * p) - nums - 1; if (j - i + 1 \u0026gt; ans) { ans = j - i + 1; } } printf(\u0026#34;%d\u0026#34;, ans); return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1085/","summary":"\u003cp\u003eGiven a sequence of positive integers and another positive integer \u003cem\u003ep\u003c/em\u003e. The sequence is said to be a \u003cstrong\u003eperfect sequence\u003c/strong\u003e if \u003cem\u003eM\u003c/em\u003eâ‰¤\u003cem\u003em\u003c/em\u003eÃ—\u003cem\u003ep\u003c/em\u003e where \u003cem\u003eM\u003c/em\u003e and \u003cem\u003em\u003c/em\u003e are the maximum and minimum numbers in the sequence, respectively.\u003c/p\u003e\n\u003cp\u003eNow given a sequence and a parameter \u003cem\u003ep\u003c/em\u003e, you are supposed to find from the sequence as many numbers as possible to form a perfect subsequence.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case. For each case, the first line contains two positive integers \u003cem\u003eN\u003c/em\u003e and \u003cem\u003ep\u003c/em\u003e, where \u003cem\u003eN\u003c/em\u003e (â‰¤10^5) is the number of integers in the sequence, and \u003cem\u003ep\u003c/em\u003e (â‰¤ 10^9 ) is the parameter. In the second line there are \u003cem\u003eN\u003c/em\u003e positive integers, each is no greater than 10^9.\u003c/p\u003e","title":"PATç”²çº§ 1085 Perfect Sequence (25åˆ†)"},{"content":"Given a collection of number segments, you are supposed to recover the smallest number from them. For example, given { 32, 321, 3214, 0229, 87 }, we can recover many numbers such like 32-321-3214-0229-87 or 0229-32-87-321-3214 with respect to different orders of combinations of these segments, and the smallest number is 0229-321-3214-32-87.\nInput Specification: Each input file contains one test case. Each case gives a positive integer N (â‰¤10^4) followed by N number segments. Each segment contains a non-negative integer of no more than 8 digits. All the numbers in a line are separated by a space.\nOutput Specification: For each test case, print the smallest number in one line. Notice that the first digit must not be zero.\nSample Input: 5 32 321 3214 0229 87 Sample Output: 22932132143287 æ€è·¯ è´ªå¿ƒï¼šå¯¹å­—ç¬¦ä¸² s1 ä¸ s2ï¼Œå¦‚æœ s1 + s2 \u0026lt; s2 + s1ï¼Œé‚£ä¹ˆæŠŠ s1 æ”¾åœ¨ s2 çš„å‰é¢ã€‚ æ³¨æ„ç‚¹ ç»“æœä¸²çš„æ‰€æœ‰å‰å¯¼é›¶éœ€è¦å»æ‰ã€‚ç”±äºæ¯ä¸ªå­—ç¬¦ä¸²éƒ½æ˜¯éè´Ÿçš„æ•´æ•°ï¼ˆnon-negativeï¼‰ï¼Œæ˜¯æœ‰å¯èƒ½ä¸º 0 çš„ï¼Œæ‰€ä»¥å¦‚æœå»é™¤å‰å¯¼é›¶åä¸²çš„é•¿åº¦å˜ä¸º0ï¼Œåˆ™è¾“å‡º0ã€‚ #include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int maxn = 10000; int cmp(string s1, string s2) { return s1 + s2 \u0026lt; s2 + s1; } int main() { int n; string str[maxn]; cin \u0026gt;\u0026gt; n; for (int i = 0; i \u0026lt; n; i++) { cin \u0026gt;\u0026gt; str[i]; } sort(str, str + n, cmp); string ans; for (int i = 0; i \u0026lt; n; i++) { ans += str[i]; } while (ans.size() != 0 \u0026amp;\u0026amp; ans[0] == \u0026#39;0\u0026#39;) { ans.erase(ans.begin()); } if (ans.size() == 0) { cout \u0026lt;\u0026lt; 0; } else { cout \u0026lt;\u0026lt; ans; } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1038/","summary":"\u003cp\u003eGiven a collection of number segments, you are supposed to recover the smallest number from them. For example, given { 32, 321, 3214, 0229, 87 }, we can recover many numbers such like 32-321-3214-0229-87 or 0229-32-87-321-3214 with respect to different orders of combinations of these segments, and the smallest number is 0229-321-3214-32-87.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case. Each case gives a positive integer \u003cem\u003eN\u003c/em\u003e (â‰¤10^4) followed by \u003cem\u003eN\u003c/em\u003e number segments. Each segment contains a non-negative integer of no more than 8 digits. All the numbers in a line are separated by a space.\u003c/p\u003e","title":"PATç”²çº§ 1038 Recover the Smallest Number (30åˆ†)"},{"content":"Given any permutation of the numbers {0, 1, 2,\u0026hellip;, Nâˆ’1}, it is easy to sort them in increasing order. But what if Swap(0, *) is the ONLY operation that is allowed to use? For example, to sort {4, 0, 2, 1, 3} we may apply the swap operations in the following way:\nSwap(0, 1) =\u0026gt; {4, 1, 2, 0, 3} Swap(0, 3) =\u0026gt; {4, 1, 2, 3, 0} Swap(0, 4) =\u0026gt; {0, 1, 2, 3, 4} Now you are asked to find the minimum number of swaps need to sort the given permutation of the first N nonnegative integers.\nInput Specification: Each input file contains one test case, which gives a positive N (â‰¤10^5) followed by a permutation sequence of {0, 1, \u0026hellip;, Nâˆ’1}. All the numbers in a line are separated by a space.\nOutput Specification: For each case, simply print in a line the minimum number of swaps need to sort the given permutation.\nSample Input: 10 3 5 7 2 6 4 9 0 8 1 Sample Output: 9 æ€è·¯ å¦‚æœåœ¨äº¤æ¢è¿‡ç¨‹ä¸­å‡ºç°æ•°å­—0åœ¨0å·ä½çš„æƒ…å†µï¼Œå°±éšæ„é€‰æ‹©ä¸€ä¸ªè¿˜æ²¡æœ‰å›åˆ°â€œæœ¬ä½â€çš„æ•°å­—ï¼Œè®©å…¶ä¸æ•°å­—0äº¤æ¢ä½ç½® æ³¨æ„ç‚¹ åœ¨å¾ªç¯ä¸­å¯»æ‰¾ä¸€ä¸ªä¸åœ¨æœ¬ä½ä¸Šçš„æ•°æ—¶ï¼Œå¦‚æœæ¯æ¬¡éƒ½ä»å¤´å¼€å§‹éå†åºåˆ—ä¸­çš„æ•°ï¼Œåˆ™ä¼šæœ‰ä¸¤ç»„æ•°æ®è¶…æ—¶ï¼ˆå› ä¸ºå¤æ‚åº¦æ˜¯äºŒæ¬¡æ–¹çº§åˆ«çš„ï¼‰ã€‚åˆé€‚çš„åšæ³•æ˜¯ä»æ•´ä½“ä¸Šå®šä¹‰ä¸€ä¸ªå˜é‡ kï¼Œç”¨æ¥ä¿å­˜ç›®å‰åºåˆ—ä¸­ä¸åœ¨æœ¬ä½ä¸Šçš„æœ€å°æ•°ï¼ˆåˆè¯•ä¸º1ï¼‰ï¼Œå½“äº¤æ¢è¿‡ç¨‹ä¸­å‡ºç°0å›å½’æœ¬ä½çš„æƒ…å†µæ—¶ï¼Œæ€»æ˜¯ä»å½“å‰çš„ k å¼€å§‹ç»§ç»­å¢å¤§å¯»æ‰¾ä¸åœ¨æœ¬ä½ä¸Šçš„æ•°ï¼Œè¿™æ ·èƒ½ä¿è¯å¤æ‚åº¦ä»æ•´ä½“ä¸Šæ˜¯çº¿æ€§çº§åˆ«ï¼ˆk ä» 1 å¢é•¿åˆ° nï¼‰ è¯¥é¢˜ç”¨ä¸€ä¸ª index[] æ•°ç»„è¡¨ç¤ºä¸‹æ ‡å€¼æ‰€åœ¨çš„ä½ç½®å³å¯ï¼Œæ— éœ€åŸå§‹æ•°ç»„ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int maxn = 100000; int main() { int n, index[maxn], num, k = 1, ans = 0, cnt = 0; scanf(\u0026#34;%d\u0026#34;, \u0026amp;n); for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;num); index[num] = i; if (index[num] != num \u0026amp;\u0026amp; num != 0) { cnt++; } } while (cnt != 0) { if (index[0] == 0) { for (; k \u0026lt; n; k++) { if (index[k] != k) { break; } } swap(index[0], index[k]); } else { swap(index[0], index[index[0]]); cnt--; } ans++; } printf(\u0026#34;%d\u0026#34;, ans); return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1067/","summary":"\u003cp\u003eGiven any permutation of the numbers {0, 1, 2,\u0026hellip;, \u003cem\u003eN\u003c/em\u003eâˆ’1}, it is easy to sort them in increasing order. But what if \u003ccode\u003eSwap(0, *)\u003c/code\u003e is the ONLY operation that is allowed to use? For example, to sort {4, 0, 2, 1, 3} we may apply the swap operations in the following way:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eSwap(0, 1) =\u0026gt; {4, 1, 2, 0, 3}\nSwap(0, 3) =\u0026gt; {4, 1, 2, 3, 0}\nSwap(0, 4) =\u0026gt; {0, 1, 2, 3, 4}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow you are asked to find the minimum number of swaps need to sort the given permutation of the first \u003cem\u003eN\u003c/em\u003e nonnegative integers.\u003c/p\u003e","title":"PATç”²çº§ 1067 Sort with Swap(0, i) (25åˆ†)"},{"content":"æ—§é”®ç›˜ä¸Šåäº†å‡ ä¸ªé”®ï¼Œäºæ˜¯åœ¨æ•²ä¸€æ®µæ–‡å­—çš„æ—¶å€™ï¼Œå¯¹åº”çš„å­—ç¬¦å°±ä¸ä¼šå‡ºç°ã€‚ç°åœ¨ç»™å‡ºåº”è¯¥è¾“å…¥çš„ä¸€æ®µæ–‡å­—ã€ä»¥åŠåæ‰çš„é‚£äº›é”®ï¼Œæ‰“å‡ºçš„ç»“æœæ–‡å­—ä¼šæ˜¯æ€æ ·ï¼Ÿ\nè¾“å…¥æ ¼å¼ï¼š è¾“å…¥åœ¨ 2 è¡Œä¸­åˆ†åˆ«ç»™å‡ºåæ‰çš„é‚£äº›é”®ã€ä»¥åŠåº”è¯¥è¾“å…¥çš„æ–‡å­—ã€‚å…¶ä¸­å¯¹åº”è‹±æ–‡å­—æ¯çš„åé”®ä»¥å¤§å†™ç»™å‡ºï¼›æ¯æ®µæ–‡å­—æ˜¯ä¸è¶…è¿‡ 10^5 ä¸ªå­—ç¬¦çš„ä¸²ã€‚å¯ç”¨çš„å­—ç¬¦åŒ…æ‹¬å­—æ¯ [a-z, A-Z]ã€æ•°å­— 0-9ã€ä»¥åŠä¸‹åˆ’çº¿ _ï¼ˆä»£è¡¨ç©ºæ ¼ï¼‰ã€,ã€.ã€-ã€+ï¼ˆä»£è¡¨ä¸Šæ¡£é”®ï¼‰ã€‚é¢˜ç›®ä¿è¯ç¬¬ 2 è¡Œè¾“å…¥çš„æ–‡å­—ä¸²éç©ºã€‚\næ³¨æ„ï¼šå¦‚æœä¸Šæ¡£é”®åæ‰äº†ï¼Œé‚£ä¹ˆå¤§å†™çš„è‹±æ–‡å­—æ¯æ— æ³•è¢«æ‰“å‡ºã€‚\nè¾“å‡ºæ ¼å¼ï¼š åœ¨ä¸€è¡Œä¸­è¾“å‡ºèƒ½å¤Ÿè¢«æ‰“å‡ºçš„ç»“æœæ–‡å­—ã€‚å¦‚æœæ²¡æœ‰ä¸€ä¸ªå­—ç¬¦èƒ½è¢«æ‰“å‡ºï¼Œåˆ™è¾“å‡ºç©ºè¡Œã€‚\nè¾“å…¥æ ·ä¾‹ï¼š 7+IE. 7_This_is_a_test. è¾“å‡ºæ ·ä¾‹ï¼š _hs_s_a_tst æ³¨æ„ç‚¹ è¯»å…¥å¤±æ•ˆé”®ä½çš„æ—¶å€™è¦æ³¨æ„ï¼Œå¯èƒ½æ²¡æœ‰å¤±æ•ˆçš„é”®ä½ï¼Œå³ç¬¬ä¸€è¡Œä¸ºç©ºè¡Œçš„æƒ…å†µã€‚è¿™æ—¶å€™ä¸èƒ½ç”¨ scanf è¾“å…¥ï¼Œè€Œè¦ç”¨ cin.getline(str, maxn) è¾“å…¥å­—ç¬¦ä¸²ã€‚ #include \u0026lt;iostream\u0026gt; #include \u0026lt;cstring\u0026gt; using namespace std; const int maxn = 100001; int main() { int hash_table[256] = {0}; char wrong[257], input[maxn]; cin.getline(wrong, 257); int len = strlen(wrong); for (int i = 0; i \u0026lt; len; i++) { if (wrong[i] \u0026gt;= \u0026#39;A\u0026#39; \u0026amp;\u0026amp; wrong[i] \u0026lt;= \u0026#39;Z\u0026#39;) { wrong[i] = wrong[i] - \u0026#39;A\u0026#39; + \u0026#39;a\u0026#39;; } hash_table[wrong[i]] = 1; } scanf(\u0026#34;%s\u0026#34;, input); len = strlen(input); for (int i = 0; i \u0026lt; len; i++) { if (input[i] \u0026gt;= \u0026#39;A\u0026#39; \u0026amp;\u0026amp; input[i] \u0026lt;= \u0026#39;Z\u0026#39;) { int low = input[i] - \u0026#39;A\u0026#39; + \u0026#39;a\u0026#39;; if (hash_table[low] == 0 \u0026amp;\u0026amp; hash_table[\u0026#39;+\u0026#39;] == 0) { printf(\u0026#34;%c\u0026#34;, input[i]); } } else if (hash_table[input[i]] == 0) { printf(\u0026#34;%c\u0026#34;, input[i]); } } printf(\u0026#34;\\n\u0026#34;); return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/basic_level/b1033/","summary":"\u003cp\u003eæ—§é”®ç›˜ä¸Šåäº†å‡ ä¸ªé”®ï¼Œäºæ˜¯åœ¨æ•²ä¸€æ®µæ–‡å­—çš„æ—¶å€™ï¼Œå¯¹åº”çš„å­—ç¬¦å°±ä¸ä¼šå‡ºç°ã€‚ç°åœ¨ç»™å‡ºåº”è¯¥è¾“å…¥çš„ä¸€æ®µæ–‡å­—ã€ä»¥åŠåæ‰çš„é‚£äº›é”®ï¼Œæ‰“å‡ºçš„ç»“æœæ–‡å­—ä¼šæ˜¯æ€æ ·ï¼Ÿ\u003c/p\u003e\n\u003ch1 id=\"è¾“å…¥æ ¼å¼\"\u003eè¾“å…¥æ ¼å¼ï¼š\u003c/h1\u003e\n\u003cp\u003eè¾“å…¥åœ¨ 2 è¡Œä¸­åˆ†åˆ«ç»™å‡ºåæ‰çš„é‚£äº›é”®ã€ä»¥åŠåº”è¯¥è¾“å…¥çš„æ–‡å­—ã€‚å…¶ä¸­å¯¹åº”è‹±æ–‡å­—æ¯çš„åé”®ä»¥å¤§å†™ç»™å‡ºï¼›æ¯æ®µæ–‡å­—æ˜¯ä¸è¶…è¿‡ 10^5 ä¸ªå­—ç¬¦çš„ä¸²ã€‚å¯ç”¨çš„å­—ç¬¦åŒ…æ‹¬å­—æ¯ [\u003ccode\u003ea\u003c/code\u003e-\u003ccode\u003ez\u003c/code\u003e, \u003ccode\u003eA\u003c/code\u003e-\u003ccode\u003eZ\u003c/code\u003e]ã€æ•°å­— \u003ccode\u003e0\u003c/code\u003e-\u003ccode\u003e9\u003c/code\u003eã€ä»¥åŠä¸‹åˆ’çº¿ \u003ccode\u003e_\u003c/code\u003eï¼ˆä»£è¡¨ç©ºæ ¼ï¼‰ã€\u003ccode\u003e,\u003c/code\u003eã€\u003ccode\u003e.\u003c/code\u003eã€\u003ccode\u003e-\u003c/code\u003eã€\u003ccode\u003e+\u003c/code\u003eï¼ˆä»£è¡¨ä¸Šæ¡£é”®ï¼‰ã€‚é¢˜ç›®ä¿è¯ç¬¬ 2 è¡Œè¾“å…¥çš„æ–‡å­—ä¸²éç©ºã€‚\u003c/p\u003e\n\u003cp\u003eæ³¨æ„ï¼šå¦‚æœä¸Šæ¡£é”®åæ‰äº†ï¼Œé‚£ä¹ˆå¤§å†™çš„è‹±æ–‡å­—æ¯æ— æ³•è¢«æ‰“å‡ºã€‚\u003c/p\u003e\n\u003ch1 id=\"è¾“å‡ºæ ¼å¼\"\u003eè¾“å‡ºæ ¼å¼ï¼š\u003c/h1\u003e\n\u003cp\u003eåœ¨ä¸€è¡Œä¸­è¾“å‡ºèƒ½å¤Ÿè¢«æ‰“å‡ºçš„ç»“æœæ–‡å­—ã€‚å¦‚æœæ²¡æœ‰ä¸€ä¸ªå­—ç¬¦èƒ½è¢«æ‰“å‡ºï¼Œåˆ™è¾“å‡ºç©ºè¡Œã€‚\u003c/p\u003e\n\u003ch1 id=\"è¾“å…¥æ ·ä¾‹\"\u003eè¾“å…¥æ ·ä¾‹ï¼š\u003c/h1\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-in\" data-lang=\"in\"\u003e7+IE.\n7_This_is_a_test.\n\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"è¾“å‡ºæ ·ä¾‹\"\u003eè¾“å‡ºæ ·ä¾‹ï¼š\u003c/h1\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-out\" data-lang=\"out\"\u003e_hs_s_a_tst\n\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"æ³¨æ„ç‚¹\"\u003eæ³¨æ„ç‚¹\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eè¯»å…¥å¤±æ•ˆé”®ä½çš„æ—¶å€™è¦æ³¨æ„ï¼Œå¯èƒ½æ²¡æœ‰å¤±æ•ˆçš„é”®ä½ï¼Œå³ç¬¬ä¸€è¡Œä¸ºç©ºè¡Œçš„æƒ…å†µã€‚è¿™æ—¶å€™ä¸èƒ½ç”¨ scanf è¾“å…¥ï¼Œè€Œè¦ç”¨ cin.getline(str, maxn) è¾“å…¥å­—ç¬¦ä¸²ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;iostream\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;cstring\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eusing\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enamespace\u003c/span\u003e std;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e maxn \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e100001\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e hash_table[\u003cspan style=\"color:#ae81ff\"\u003e256\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e};\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003echar\u003c/span\u003e wrong[\u003cspan style=\"color:#ae81ff\"\u003e257\u003c/span\u003e], input[maxn];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    cin.getline(wrong, \u003cspan style=\"color:#ae81ff\"\u003e257\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e len \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e strlen(wrong);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e (\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e i \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; i \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e len; i\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (wrong[i] \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;A\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e wrong[i] \u003cspan style=\"color:#f92672\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Z\u0026#39;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            wrong[i] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e wrong[i] \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;A\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;a\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        hash_table[wrong[i]] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    scanf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%s\u0026#34;\u003c/span\u003e, input);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    len \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e strlen(input);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e (\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e i \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; i \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e len; i\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (input[i] \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;A\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e input[i] \u003cspan style=\"color:#f92672\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Z\u0026#39;\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e low \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e input[i] \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;A\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;a\u0026#39;\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (hash_table[low] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e hash_table[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;+\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                printf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%c\u0026#34;\u003c/span\u003e, input[i]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (hash_table[input[i]] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            printf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%c\u0026#34;\u003c/span\u003e, input[i]);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    printf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\n\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","title":"PATä¹™çº§ 1033 æ—§é”®ç›˜æ‰“å­— (20åˆ†)"},{"content":"ç« èŠ‚æ¦‚è¦ æŒæ¡ API ç½‘å…³æœåŠ¡èšåˆåŠŸèƒ½çš„å®ç° æŒæ¡ Mybatis-plus è‡ªå®šä¹‰ SQL å®ç° æŒæ¡ Dubbo å¼‚æ­¥è°ƒç”¨ æœåŠ¡èšåˆ æœåŠ¡èšåˆå°±æ˜¯å°†å¤šä¸ªæœåŠ¡è°ƒç”¨å°è£… æœåŠ¡èšåˆå¯ä»¥ç®€åŒ–å‰ç«¯è°ƒç”¨æ–¹å¼ æœåŠ¡èšåˆæä¾›æ›´å¥½çš„å®‰å…¨æ€§ã€å¯æ‰©å±•æ€§ ä¸šåŠ¡åŠŸèƒ½å¼€å‘æµç¨‹ æ ¹æ®æ¥å£æ–‡æ¡£æ€è€ƒåŠŸèƒ½åˆ—è¡¨ å®ç° API æ¥å£å’Œå®ä½“ æœåŠ¡æä¾›è€…å®ç° å½±ç‰‡æ¨¡å—åˆ›å»º ä» guns-user æ‹·è´ä¸€ä»½é‡å‘½åä¸º guns-filmï¼Œä¿®æ”¹ç›¸å…³é…ç½®\nAPI ç½‘å…³åŠŸèƒ½èšåˆ ä¼˜ç‚¹ å…­ä¸ªæ¥å£ï¼Œä¸€æ¬¡è¯·æ±‚ï¼ŒåŒä¸€æ—¶åˆ»èŠ‚çœäº†5æ¬¡HTTPè¯·æ±‚ åŒä¸€ä¸ªæ¥å£å¯¹å¤–æš´éœ²ï¼Œé™ä½äº†å‰åç«¯åˆ†ç¦»å¼€å‘çš„éš¾åº¦å’Œå¤æ‚åº¦ ç¼ºç‚¹ï¼š ä¸€æ¬¡è·å–æ•°æ®è¿‡å¤šï¼Œå®¹æ˜“å‡ºç°é—®é¢˜ å¦‚ gateway ä¸­çš„å½±ç‰‡æ¨¡å—çš„è·å–é¦–é¡µä¿¡æ¯æ¥å£ï¼Œå°† filmServiceApi çš„å¤šä¸ªæ–¹æ³•æ‰€è·å¾—çš„å¯¹è±¡èšåˆä¸º FilmIndexVO å¯¹è±¡è¿”å›ç»™å‰ç«¯ï¼Œå°†åŸæœ¬éœ€è¦çš„å¤šä¸ªæ¥å£èšåˆä¸ºä¸€ä¸ª /film/getIndex æ¥å£ï¼Œé¿å…äº†å‰ç«¯å¯¹ä¸åŒæ¥å£çš„å¤šæ¬¡è°ƒç”¨ã€‚\n@RequestMapping(value = \u0026#34;getIndex\u0026#34;, method = RequestMethod.GET) public ResponseVO getIndex() { FilmIndexVO filmIndexVO = new FilmIndexVO(); // è·å–bannerä¿¡æ¯ filmIndexVO.setBanners(filmServiceApi.getBanners()); // è·å–çƒ­æ˜ çš„å½±ç‰‡ filmIndexVO.setHotFilms(filmServiceApi.getHotFilms(true, 99, 99, 99, 99, 1, 8)); // è·å–å³å°†ä¸Šæ˜ çš„å½±ç‰‡ filmIndexVO.setSoonFilms(filmServiceApi.getSoonFilms(true, 99, 99, 99, 99, 1, 8)); // è·å–ç¥¨æˆ¿æ’è¡Œæ¦œ filmIndexVO.setBoxRanking(filmServiceApi.getBoxRanking()); // è·å–äººæ°”æ¦œå• filmIndexVO.setExpectRanking(filmServiceApi.getExpectRanking()); // è·å–æ’è¡Œå‰100å½±ç‰‡ filmIndexVO.setTop100(filmServiceApi.getTop()); return ResponseVO.success(IMG_PRE, filmIndexVO); } Mybatis-plus è‡ªå®šä¹‰ SQL å®ç° åœ¨ç›¸åº”çš„ Mapper æ¥å£ä¸­æ·»åŠ æ–¹æ³•\npublic interface ActorTMapper extends BaseMapper\u0026lt;ActorT\u0026gt; { List\u0026lt;ActorVO\u0026gt; getActors(@Param(\u0026#34;filmId\u0026#34;) String filmId); } åœ¨ç›¸åº”çš„ Mapper xml é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  select è¯­å¥\n\u0026lt;mapper namespace=\u0026#34;com.stylefeng.guns.rest.common.persistence.dao.ActorTMapper\u0026#34;\u0026gt; \u0026lt;!-- é€šç”¨æŸ¥è¯¢æ˜ å°„ç»“æœ --\u0026gt; \u0026lt;resultMap id=\u0026#34;BaseResultMap\u0026#34; type=\u0026#34;com.stylefeng.guns.rest.common.persistence.model.ActorT\u0026#34;\u0026gt; \u0026lt;id column=\u0026#34;UUID\u0026#34; property=\u0026#34;uuid\u0026#34; /\u0026gt; \u0026lt;result column=\u0026#34;actor_name\u0026#34; property=\u0026#34;actorName\u0026#34; /\u0026gt; \u0026lt;result column=\u0026#34;actor_img\u0026#34; property=\u0026#34;actorImg\u0026#34; /\u0026gt; \u0026lt;/resultMap\u0026gt; \u0026lt;select id=\u0026#34;getActors\u0026#34; parameterType=\u0026#34;java.lang.String\u0026#34; resultType=\u0026#34;com.stylefeng.guns.api.film.vo.ActorVO\u0026#34;\u0026gt; SELECT actor_img AS imgAddress, actor_name AS directorName, role_name AS roleName FROM actor_t, film_actor_t WHERE actor_t.UUID = film_actor_t.actor_id AND film_actor_t.film_id = ${filmId} \u0026lt;/select\u0026gt; \u0026lt;/mapper\u0026gt; è¿™æ ·ï¼Œå°±èƒ½æ‰§è¡Œè‡ªå®šä¹‰ SQL è¯­å¥äº†ï¼Œå…¶å®å°±æ˜¯æ™®é€šç‰ˆ Mybatis çš„æ­£å¸¸ä½¿ç”¨è€Œå·²\u0026hellip;\nDubbo å¼‚æ­¥è°ƒç”¨ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/async-call.html\nå¼‚æ­¥è°ƒç”¨ å¼‚æ­¥è°ƒç”¨åˆ©ç”¨ NIO çš„éé˜»å¡ç‰¹æ€§å®ç°æœåŠ¡è°ƒç”¨å¹¶è¡Œã€‚\nä½¿ç”¨RpcContext é…ç½®ï¼ˆSpringï¼‰ æœåŠ¡ç«¯æœåŠ¡çº§åˆ« \u0026lt;dubbo:service interface=\u0026#34;...\u0026#34; async=\u0026#34;true\u0026#34; /\u0026gt; å®¢æˆ·ç«¯æœåŠ¡çº§åˆ« \u0026lt;dubbo:reference interface=\u0026#34;...\u0026#34; async=\u0026#34;true\u0026#34; /\u0026gt; æœåŠ¡ç«¯æ–¹æ³•çº§åˆ« \u0026lt;dubbo:service interface=\u0026#34;...\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;...\u0026#34; async=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;/dubbo:service\u0026gt; å®¢æˆ·ç«¯æ–¹æ³•çº§åˆ« \u0026lt;dubbo:reference interface=\u0026#34;...\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;...\u0026#34; async=\u0026#34;true\u0026#34;/\u0026gt; \u0026lt;/dubbo:reference\u0026gt; é…ç½®ï¼ˆSpringBootï¼‰ SpringBoot çš„é…ç½®æ”¾åœ¨æ³¨è§£ä¸­ï¼Œä½†åªæœ‰æœåŠ¡çº§åˆ«ï¼Œå¹¶æ²¡æœ‰æ–¹æ³•çº§åˆ«ã€‚\næœåŠ¡ç«¯æœåŠ¡çº§åˆ« @Service(interfaceClass = xxx.class, async = true) å®¢æˆ·ç«¯æœåŠ¡çº§åˆ« @Reference(interfaceClass = xxx.class, async = true) ä½¿ç”¨RpcContext åœ¨ consumer.xml ä¸­é…ç½®æ–¹æ³•çº§åˆ«çš„å¼‚æ­¥è°ƒç”¨ï¼š\n\u0026lt;dubbo:reference id=\u0026#34;asyncService\u0026#34; interface=\u0026#34;org.apache.dubbo.samples.governance.api.AsyncService\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;sayHello\u0026#34; async=\u0026#34;true\u0026#34; /\u0026gt; \u0026lt;/dubbo:reference\u0026gt; è°ƒç”¨ä»£ç :\n// æ­¤è°ƒç”¨ä¼šç«‹å³è¿”å›null asyncService.sayHello(\u0026#34;world\u0026#34;); // æ‹¿åˆ°è°ƒç”¨çš„Futureå¼•ç”¨ï¼Œå½“ç»“æœè¿”å›åï¼Œä¼šè¢«é€šçŸ¥å’Œè®¾ç½®åˆ°æ­¤Future CompletableFuture\u0026lt;String\u0026gt; helloFuture = RpcContext.getContext().getCompletableFuture(); // ä¸ºFutureæ·»åŠ å›è°ƒ helloFuture.whenComplete((retValue, exception) -\u0026gt; { if (exception == null) { System.out.println(retValue); } else { exception.printStackTrace(); } }); æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥è¿™æ ·åšå¼‚æ­¥è°ƒç”¨:\nCompletableFuture\u0026lt;String\u0026gt; future = RpcContext.getContext().asyncCall( () -\u0026gt; { asyncService.sayHello(\u0026#34;oneway call request1\u0026#34;); } ); future.get(); éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œ asyncService.sayHello(\u0026ldquo;world\u0026rdquo;) è¿”å›çš„æ˜¯ nullï¼Œä¸èƒ½é€šè¿‡è¯¥è¿”å›å€¼è·å–ç»“æœï¼Œæ‰€æœ‰ asyncService æ¥å£çš„ sayHello() æ–¹æ³•è°ƒç”¨éƒ½éœ€è¦é€šè¿‡ future æ¥è·å–ç»“æœã€‚\nSpringBootä¸­ ç”±äº SpringBoot æ²¡æœ‰æ–¹æ³•çº§åˆ«çš„æ³¨è§£å¯ä»¥é…ç½® async å‚æ•°ï¼Œä½†å¦‚æœåŠ åœ¨æœåŠ¡çº§åˆ«ï¼Œå³å®¢æˆ·ç«¯çš„ @Reference æˆ–è€…æœåŠ¡ç«¯çš„ @Service ä¸Šï¼Œåˆä¼šå½±å“ä¸éœ€è¦ä½¿ç”¨å¼‚æ­¥è°ƒç”¨çš„åœ°æ–¹ã€‚\næ‰€ä»¥ï¼Œå¯ä»¥é€šè¿‡åœ¨ api ä¸­å†åˆ›å»ºä¸€ä¸ªä¸“é—¨ç”¨äºå¼‚æ­¥è°ƒç”¨çš„æ¥å£æ¥å£°æ˜éœ€è¦å¼‚æ­¥è°ƒç”¨çš„æ–¹æ³•ã€‚\npublic interface FilmAsyncServiceApi { FilmDescVO getFilmDesc(String filmId); ActorVO getDirectorInfo(String filmId); List\u0026lt;ActorVO\u0026gt; getActors(String filmId); } åŒæ—¶ï¼Œåœ¨æœåŠ¡ç«¯ä¸­å†åˆ›å»ºä¸€ä¸ªç”¨äºå¼‚æ­¥è°ƒç”¨çš„å®ç°ç±»ã€‚\n@Component @Service(interfaceClass = FilmAsyncServiceApi.class) public class DefaultFilmAsyncServiceImpl implements FilmAsyncServiceApi { @Override public FilmDescVO getFilmDesc(String filmId) { ... } @Override public ActorVO getDirectorInfo(String filmId) { ... } @Override public List\u0026lt;ActorVO\u0026gt; getActors(String filmId) { ... } } æœ€åï¼Œåœ¨ API ç½‘å…³çš„ Controller ä¸­å£°æ˜å¼‚æ­¥è°ƒç”¨çš„æ¥å£ï¼Œå¹¶ä½¿ç”¨ RpcContext å®ç°å¼‚æ­¥è°ƒç”¨\n@RequestMapping(value = \u0026#34;films/{searchParam}\u0026#34;, method = RequestMethod.GET) public ResponseVO films(@PathVariable(\u0026#34;searchParam\u0026#34;) String searchParam, int searchType) throws ExecutionException, InterruptedException { filmAsyncServiceApi.getFilmDesc(filmId); Future\u0026lt;FilmDescVO\u0026gt; filmDescVOFuture = RpcContext.getContext().getFuture(); filmAsyncServiceApi.getDirectorInfo(filmId); Future\u0026lt;ActorVO\u0026gt; directorVOFuture = RpcContext.getContext().getFuture(); filmAsyncServiceApi.getActors(filmId); Future\u0026lt;List\u0026lt;ActorVO\u0026gt;\u0026gt; actorsFuture = RpcContext.getContext().getFuture(); /* çœç•¥æ— å…³ä»£ç ... */ actorRequestVO.setDirector(directorVOFuture.get()); actorRequestVO.setActors(actorsFuture.get()); infoRequestVO.setBiography(filmDescVOFuture.get().getBiography()); /* çœç•¥æ— å…³ä»£ç ... */ } éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSpringBoot è¿˜éœ€è¦åœ¨ Application ä¸Šæ·»åŠ  @EnableAsync æ³¨è§£\n@SpringBootApplication(scanBasePackages = {\u0026#34;com.stylefeng.guns\u0026#34;}) @EnableDubboConfiguration @EnableAsync public class GatewayApplication { public static void main(String[] args) { SpringApplication.run(GatewayApplication.class, args); } } æ€»ç»“ API ç½‘å…³çš„æœåŠ¡èšåˆ Dubbo ç‰¹æ€§ï¼šå¼‚æ­¥è°ƒç”¨ Mybatis-plus è‡ªå®šä¹‰ SQL å®ç° ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/6.dubbo%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91%E5%BD%B1%E7%89%87%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91/","summary":"\u003ch1 id=\"ç« èŠ‚æ¦‚è¦\"\u003eç« èŠ‚æ¦‚è¦\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eæŒæ¡ API ç½‘å…³æœåŠ¡èšåˆåŠŸèƒ½çš„å®ç°\u003c/li\u003e\n\u003cli\u003eæŒæ¡ Mybatis-plus è‡ªå®šä¹‰ SQL å®ç°\u003c/li\u003e\n\u003cli\u003eæŒæ¡ Dubbo å¼‚æ­¥è°ƒç”¨\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"æœåŠ¡èšåˆ\"\u003eæœåŠ¡èšåˆ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eæœåŠ¡èšåˆå°±æ˜¯å°†å¤šä¸ªæœåŠ¡è°ƒç”¨å°è£…\u003c/li\u003e\n\u003cli\u003eæœåŠ¡èšåˆå¯ä»¥ç®€åŒ–å‰ç«¯è°ƒç”¨æ–¹å¼\u003c/li\u003e\n\u003cli\u003eæœåŠ¡èšåˆæä¾›æ›´å¥½çš„å®‰å…¨æ€§ã€å¯æ‰©å±•æ€§\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ä¸šåŠ¡åŠŸèƒ½å¼€å‘æµç¨‹\"\u003eä¸šåŠ¡åŠŸèƒ½å¼€å‘æµç¨‹\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eæ ¹æ®æ¥å£æ–‡æ¡£æ€è€ƒåŠŸèƒ½åˆ—è¡¨\u003c/li\u003e\n\u003cli\u003eå®ç° API æ¥å£å’Œå®ä½“\u003c/li\u003e\n\u003cli\u003eæœåŠ¡æä¾›è€…å®ç°\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"å½±ç‰‡æ¨¡å—åˆ›å»º\"\u003eå½±ç‰‡æ¨¡å—åˆ›å»º\u003c/h1\u003e\n\u003cp\u003eä» guns-user æ‹·è´ä¸€ä»½é‡å‘½åä¸º guns-filmï¼Œä¿®æ”¹ç›¸å…³é…ç½®\u003c/p\u003e\n\u003ch1 id=\"api-ç½‘å…³åŠŸèƒ½èšåˆ\"\u003eAPI ç½‘å…³åŠŸèƒ½èšåˆ\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eä¼˜ç‚¹\n\u003col\u003e\n\u003cli\u003eå…­ä¸ªæ¥å£ï¼Œä¸€æ¬¡è¯·æ±‚ï¼ŒåŒä¸€æ—¶åˆ»èŠ‚çœäº†5æ¬¡HTTPè¯·æ±‚\u003c/li\u003e\n\u003cli\u003eåŒä¸€ä¸ªæ¥å£å¯¹å¤–æš´éœ²ï¼Œé™ä½äº†å‰åç«¯åˆ†ç¦»å¼€å‘çš„éš¾åº¦å’Œå¤æ‚åº¦\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003eç¼ºç‚¹ï¼š\n\u003col\u003e\n\u003cli\u003eä¸€æ¬¡è·å–æ•°æ®è¿‡å¤šï¼Œå®¹æ˜“å‡ºç°é—®é¢˜\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå¦‚ gateway ä¸­çš„å½±ç‰‡æ¨¡å—çš„è·å–é¦–é¡µä¿¡æ¯æ¥å£ï¼Œå°† filmServiceApi çš„å¤šä¸ªæ–¹æ³•æ‰€è·å¾—çš„å¯¹è±¡èšåˆä¸º FilmIndexVO å¯¹è±¡è¿”å›ç»™å‰ç«¯ï¼Œå°†åŸæœ¬éœ€è¦çš„å¤šä¸ªæ¥å£èšåˆä¸ºä¸€ä¸ª /film/getIndex æ¥å£ï¼Œé¿å…äº†å‰ç«¯å¯¹ä¸åŒæ¥å£çš„å¤šæ¬¡è°ƒç”¨ã€‚\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@RequestMapping\u003c/span\u003e(value \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;getIndex\u0026#34;\u003c/span\u003e, method \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e RequestMethod.\u003cspan style=\"color:#a6e22e\"\u003eGET\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003epublic\u003c/span\u003e ResponseVO \u003cspan style=\"color:#a6e22e\"\u003egetIndex\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        FilmIndexVO filmIndexVO \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003enew\u003c/span\u003e FilmIndexVO();\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// è·å–bannerä¿¡æ¯\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        filmIndexVO.\u003cspan style=\"color:#a6e22e\"\u003esetBanners\u003c/span\u003e(filmServiceApi.\u003cspan style=\"color:#a6e22e\"\u003egetBanners\u003c/span\u003e());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// è·å–çƒ­æ˜ çš„å½±ç‰‡\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        filmIndexVO.\u003cspan style=\"color:#a6e22e\"\u003esetHotFilms\u003c/span\u003e(filmServiceApi.\u003cspan style=\"color:#a6e22e\"\u003egetHotFilms\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e, 99, 99, 99, 99, 1, 8));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// è·å–å³å°†ä¸Šæ˜ çš„å½±ç‰‡\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        filmIndexVO.\u003cspan style=\"color:#a6e22e\"\u003esetSoonFilms\u003c/span\u003e(filmServiceApi.\u003cspan style=\"color:#a6e22e\"\u003egetSoonFilms\u003c/span\u003e(\u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e, 99, 99, 99, 99, 1, 8));\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// è·å–ç¥¨æˆ¿æ’è¡Œæ¦œ\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        filmIndexVO.\u003cspan style=\"color:#a6e22e\"\u003esetBoxRanking\u003c/span\u003e(filmServiceApi.\u003cspan style=\"color:#a6e22e\"\u003egetBoxRanking\u003c/span\u003e());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// è·å–äººæ°”æ¦œå•\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        filmIndexVO.\u003cspan style=\"color:#a6e22e\"\u003esetExpectRanking\u003c/span\u003e(filmServiceApi.\u003cspan style=\"color:#a6e22e\"\u003egetExpectRanking\u003c/span\u003e());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e// è·å–æ’è¡Œå‰100å½±ç‰‡\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        filmIndexVO.\u003cspan style=\"color:#a6e22e\"\u003esetTop100\u003c/span\u003e(filmServiceApi.\u003cspan style=\"color:#a6e22e\"\u003egetTop\u003c/span\u003e());\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e ResponseVO.\u003cspan style=\"color:#a6e22e\"\u003esuccess\u003c/span\u003e(IMG_PRE, filmIndexVO);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch1 id=\"mybatis-plus-è‡ªå®šä¹‰-sql-å®ç°\"\u003eMybatis-plus è‡ªå®šä¹‰ SQL å®ç°\u003c/h1\u003e\n\u003cp\u003eåœ¨ç›¸åº”çš„ Mapper æ¥å£ä¸­æ·»åŠ æ–¹æ³•\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ6ï¼‰ï¼šDubboæœåŠ¡å¼€å‘ï¼ˆå½±ç‰‡æ¨¡å—å¼€å‘ï¼‰"},{"content":"With highways available, driving a car from Hangzhou to any other city is easy. But since the tank capacity of a car is limited, we have to find gas stations on the way from time to time. Different gas station may give different price. You are asked to carefully design the cheapest route to go.\nInput Specification: Each input file contains one test case. For each case, the first line contains 4 positive numbers: Cmax (â‰¤ 100), the maximum capacity of the tank; D (â‰¤30000), the distance between Hangzhou and the destination city; Davg (â‰¤20), the average distance per unit gas that the car can run; and N (â‰¤ 500), the total number of gas stations. Then N lines follow, each contains a pair of non-negative numbers: Pi, the unit gas price, and Di (â‰¤D), the distance between this station and Hangzhou, for i=1,â‹¯,N. All the numbers in a line are separated by a space.\nOutput Specification: For each test case, print the cheapest price in a line, accurate up to 2 decimal places. It is assumed that the tank is empty at the beginning. If it is impossible to reach the destination, print The maximum travel distance = X where X is the maximum possible distance the car can run, accurate up to 2 decimal places.\nSample Input 1: 50 1300 12 8 6.00 1250 7.00 600 7.00 150 7.10 0 7.20 200 7.50 400 7.30 1000 6.85 300 Sample Output 1: 749.17 Sample Input 2: 50 1300 12 2 7.10 0 7.00 600 Sample Output 2: The maximum travel distance = 1200.00 æ€è·¯ æŠŠç»ˆç‚¹è§†ä¸ºå•ä½æ²¹ä»·ä¸º0ï¼Œç¦»èµ·ç‚¹è·ç¦»ä¸º destD çš„åŠ æ²¹ç«™ï¼ˆä»¥ä¾¿åœ¨æœ€åé€‰æ‹©ä¸‹ä¸€ç«™æ—¶ï¼Œèƒ½å¤Ÿç›´æ¥é€‰åˆ°ç»ˆç‚¹ï¼‰ è´ªå¿ƒï¼šå¯»æ‰¾è·ç¦»å½“å‰åŠ æ²¹ç«™æœ€è¿‘çš„æ²¹ä»·ä½äºå½“å‰æ²¹ä»·çš„åŠ æ²¹ç«™ï¼ŒåŠ æ°å¥½èƒ½å¤Ÿåˆ°è¾¾è¯¥åŠ æ²¹ç«™çš„æ²¹ï¼Œç„¶åå‰å¾€è¯¥åŠ æ²¹ç«™ï¼›å¦‚æœæ‰¾ä¸åˆ°æ²¹ä»·ä½äºå½“å‰æ²¹ä»·çš„åŠ æ²¹ç«™ï¼Œåˆ™å¯»æ‰¾æ²¹ä»·æœ€ä½çš„åŠ æ²¹ç«™ï¼Œåœ¨å½“å‰åŠ æ²¹ç«™åŠ æ»¡æ²¹ï¼Œç„¶åå‰å¾€è¯¥åŠ æ²¹ç«™ æ³¨æ„ç‚¹ åœ¨è·ç¦»ä¸º0å¤„å¿…é¡»æœ‰åŠ æ²¹ç«™ï¼Œå¦åˆ™æ— æ³•å‡ºå‘ï¼Œä¸€å®šæ— æ³•åˆ°è¾¾ç»ˆç‚¹ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int maxn = 501; struct Station { double P; double D; } stations[maxn]; int cmp(Station s1, Station s2) { return s1.D \u0026lt; s2.D; } int main() { double capacity, destD, avgD, nowC = 0, nowD = 0, cost = 0; int n, nowIndex = 0; scanf(\u0026#34;%lf %lf %lf %d\u0026#34;, \u0026amp;capacity, \u0026amp;destD, \u0026amp;avgD, \u0026amp;n); for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%lf %lf\u0026#34;, \u0026amp;stations[i].P, \u0026amp;stations[i].D); } stations[n].P = 0; stations[n].D = destD; sort(stations, stations + n, cmp); if (stations[0].D != 0) { printf(\u0026#34;The maximum travel distance = 0.00\u0026#34;); } else { while (nowD \u0026lt; destD) { if (nowIndex == n - 1 \u0026amp;\u0026amp; (capacity * avgD \u0026lt; (destD - nowD)) || (nowIndex \u0026lt; n - 1) \u0026amp;\u0026amp; (capacity * avgD \u0026lt; (stations[nowIndex + 1].D - nowD))) { nowD += capacity * avgD; break; } double minP = stations[nowIndex].P, secondP = stations[nowIndex + 1].P; int minIndex = -1, secondIndex = nowIndex + 1; for (int i = nowIndex + 1; i \u0026lt;= n; i++) { if (capacity * avgD \u0026gt;= (stations[i].D - nowD)) { if (stations[i].P \u0026lt; minP) { minP = stations[i].P; minIndex = i; break; } else if (stations[i].P \u0026lt; secondP) { secondP = stations[i].P; secondIndex = i; } } else { break; } } if (minIndex != -1) { if (nowC * avgD \u0026lt; (stations[minIndex].D - nowD)) { cost += ((stations[minIndex].D - nowD) / avgD - nowC) * stations[nowIndex].P; nowC = 0; } else { nowC -= (stations[minIndex].D - nowD) / avgD; } nowD = stations[minIndex].D; nowIndex = minIndex; } else { cost += (capacity - nowC) * stations[nowIndex].P; nowC = capacity - (stations[secondIndex].D - nowD) / avgD; nowD = stations[secondIndex].D; nowIndex = secondIndex; } } if (nowD \u0026lt; destD) { printf(\u0026#34;The maximum travel distance = %.2f\u0026#34;, nowD); } else { printf(\u0026#34;%.2f\u0026#34;, cost); } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1033/","summary":"\u003cp\u003eWith highways available, driving a car from Hangzhou to any other city is easy. But since the tank capacity of a car is limited, we have to find gas stations on the way from time to time. Different gas station may give different price. You are asked to carefully design the cheapest route to go.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eEach input file contains one test case. For each case, the first line contains 4 positive numbers: \u003cem\u003eCmax\u003c/em\u003e (â‰¤ 100), the maximum capacity of the tank; \u003cem\u003eD\u003c/em\u003e (â‰¤30000), the distance between Hangzhou and the destination city; \u003cem\u003eDavg\u003c/em\u003e (â‰¤20), the average distance per unit gas that the car can run; and \u003cem\u003eN\u003c/em\u003e (â‰¤ 500), the total number of gas stations. Then \u003cem\u003eN\u003c/em\u003e lines follow, each contains a pair of non-negative numbers: \u003cem\u003ePi\u003c/em\u003e, the unit gas price, and \u003cem\u003eDi\u003c/em\u003e (â‰¤\u003cem\u003eD\u003c/em\u003e), the distance between this station and Hangzhou, for \u003cem\u003ei\u003c/em\u003e=1,â‹¯,\u003cem\u003eN\u003c/em\u003e. All the numbers in a line are separated by a space.\u003c/p\u003e","title":"PATç”²çº§ 1033 To Fill or Not to Fill (25åˆ†)"},{"content":"Zhejiang University has 8 campuses and a lot of gates. From each gate we can collect the in/out times and the plate numbers of the cars crossing the gate. Now with all the information available, you are supposed to tell, at any specific time point, the number of cars parking on campus, and at the end of the day find the cars that have parked for the longest time period.\nInput Specification: Each input file contains one test case. Each case starts with two positive integers N (â‰¤ {10^4}), the number of records, and K (â‰¤ 8Ã—10^4) the number of queries. Then N lines follow, each gives a record in the format:\nplate_number hh:mm:ss status where plate_number is a string of 7 English capital letters or 1-digit numbers; hh:mm:ss represents the time point in a day by hour:minute:second, with the earliest time being 00:00:00 and the latest 23:59:59; and status is either in or out.\nNote that all times will be within a single day. Each in record is paired with the chronologically next record for the same car provided it is an out record. Any in records that are not paired with an out record are ignored, as are out records not paired with an in record. It is guaranteed that at least one car is well paired in the input, and no car is both in and out at the same moment. Times are recorded using a 24-hour clock.\nThen K lines of queries follow, each gives a time point in the format hh:mm:ss. Note: the queries are given in ascending order of the times.\nOutput Specification: For each query, output in a line the total number of cars parking on campus. The last line of output is supposed to give the plate number of the car that has parked for the longest time period, and the corresponding time length. If such a car is not unique, then output all of their plate numbers in a line in alphabetical order, separated by a space.\nSample Input: 16 7 JH007BD 18:00:01 in ZD00001 11:30:08 out DB8888A 13:00:00 out ZA3Q625 23:59:50 out ZA133CH 10:23:00 in ZD00001 04:09:59 in JH007BD 05:09:59 in ZA3Q625 11:42:01 out JH007BD 05:10:33 in ZA3Q625 06:30:50 in JH007BD 12:23:42 out ZA3Q625 23:55:00 in JH007BD 12:24:23 out ZA133CH 17:11:22 out JH007BD 18:07:01 out DB8888A 06:30:50 in 05:10:00 06:30:50 11:00:00 12:23:42 14:00:00 18:00:00 23:59:00 Sample Output: 1 4 5 2 1 0 1 JH007BD ZD00001 07:20:09 æ€è·¯ å°†æ—¶é—´ç»Ÿä¸€è½¬æ¢ä¸ºç§’ï¼Œæ–¹ä¾¿æ¯”è¾ƒï¼›å°† â€œinâ€ çŠ¶æ€è¡¨ç¤ºä¸º1ï¼Œâ€œoutâ€ çŠ¶æ€è¡¨ç¤ºä¸º-1ï¼Œæ–¹ä¾¿åœè½¦æ•° cnt çš„è®¡ç®—ï¼ˆå³ cnt += statusï¼‰ å°†è®°å½•çš„ç»“æ„ä½“æ•°ç»„ï¼Œæ ¹æ®å…ˆ idï¼Œå time çš„é¡ºåºè¿›è¡Œæ’åºã€‚ç„¶åä»ä¸­æ‰¾å‡ºåˆæ³•çš„è®°å½•ï¼ŒåŠ å…¥ vectorï¼Œé¡ºä¾¿ç”¨ map\u0026lt;string, int\u0026gt; å­˜å‚¨å„ä¸ªè½¦è¾†çš„æ€»åœè½¦æ—¶é•¿ï¼Œå¹¶è®°å½•æœ€å¤§ä¸­åœè½¦æ—¶é•¿ ç„¶åè¾“å…¥æŸ¥è¯¢æ—¶é—´ï¼Œæ¯è¾“å…¥ä¸€ä¸ªæŸ¥è¯¢ idï¼Œå°±æ¥ç€ä¸Šæ¬¡éå†è¿™ä¸ª vectorï¼Œä¸€è¾¹éå†ï¼Œä¸€è¾¹è®¡ç®—å½“å‰åœè½¦æ•° cntï¼Œç›´åˆ°å½“å‰æ—¶é—´å¤§äºæŸ¥è¯¢æ—¶é—´ï¼Œå³å¯è¾“å‡º cnt æœ€åï¼Œå†éå†ä¸€é mapï¼Œè¾“å‡ºæ‰€æœ‰ç­‰äº maxLen çš„è½¦è¾† idï¼ˆmap å·²æ ¹æ® id çš„å­—æ¯é¡ºåºè‡ªåŠ¨æ’åºï¼‰ æ³¨æ„ç‚¹ æœ€é•¿åœè½¦æ—¶é•¿ï¼ˆparked for the longest time periodï¼‰ï¼ŒæŒ‡çš„æ˜¯ä¸€è¾†è½¦åœ¨ä¸€å¤©ä¸­çš„æ€»åœè½¦æ—¶é•¿ï¼Œè€Œä¸æ˜¯æŒ‡æŸä¸€æ¬¡åœè½¦çš„æ—¶é•¿ å¦‚æœä¸€è¾†è½¦å¤šæ¬¡ inï¼Œåº”è¯¥å–æœ€åä¸€ä¸ª in è®°å½•ï¼›å¦‚æœä¸€è¾†è½¦å¤šæ¬¡ outï¼Œåº”è¯¥å–ç¬¬ä¸€ä¸ª out è®°å½• #include \u0026lt;cstdio\u0026gt; #include \u0026lt;cstring\u0026gt; #include \u0026lt;algorithm\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;map\u0026gt; using namespace std; const int maxn = 10000; struct Record { char id[8]; int time, status; } records[maxn]; vector\u0026lt;Record\u0026gt; vec; map\u0026lt;string, int\u0026gt; lenMap; int cmpByIdAndTime(Record r1, Record r2) { int strCmp = strcmp(r1.id, r2.id); if (strCmp != 0) { return strCmp \u0026lt; 0; } else { return r1.time \u0026lt; r2.time; } } int cmpByTime(Record r1, Record r2) { return r1.time \u0026lt; r2.time; } int main() { int n, k, hour, min, sec, time, cnt = 0, maxLen = -1, j = 0; scanf(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;k); char status[3]; for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%s %d:%d:%d %s\u0026#34;, records[i].id, \u0026amp;hour, \u0026amp;min, \u0026amp;sec, status); records[i].time = hour * 3600 + min * 60 + sec; if (strcmp(status, \u0026#34;in\u0026#34;) == 0) { records[i].status = 1; } else { records[i].status = -1; } } sort(records, records + n, cmpByIdAndTime); for (int i = 1; i \u0026lt; n; i++) { if (strcmp(records[i].id, records[i - 1].id) == 0 \u0026amp;\u0026amp; records[i - 1].status == 1 \u0026amp;\u0026amp; records[i].status == -1) { vec.push_back(records[i - 1]); vec.push_back(records[i]); lenMap[records[i].id] += records[i].time - records[i - 1].time; if (lenMap[records[i].id] \u0026gt; maxLen) { maxLen = lenMap[records[i].id]; } } } sort(vec.begin(), vec.end(), cmpByTime); for (int i = 0; i \u0026lt; k; i++) { scanf(\u0026#34;%d:%d:%d\u0026#34;, \u0026amp;hour, \u0026amp;min, \u0026amp;sec); time = hour * 60 * 60 + min * 60 + sec; while (j \u0026lt; vec.size() \u0026amp;\u0026amp; vec[j].time \u0026lt;= time) { cnt += vec[j].status; j++; } printf(\u0026#34;%d\\n\u0026#34;, cnt); } for (auto it : lenMap) { if (it.second == maxLen) { printf(\u0026#34;%s \u0026#34;, it.first.c_str()); } } printf(\u0026#34;%02d:%02d:%02d\u0026#34;, maxLen / 3600, maxLen % 3600 / 60, maxLen % 60); return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1095/","summary":"\u003cp\u003eZhejiang University has 8 campuses and a lot of gates. From each gate we can collect the in/out times and the plate numbers of the cars crossing the gate. Now with all the information available, you are supposed to tell, at any specific time point, the number of cars parking on campus, and at the end of the day find the cars that have parked for the longest time period.\u003c/p\u003e","title":"PATç”²çº§ 1095 Cars on Campus (30åˆ†)"},{"content":"A long-distance telephone company charges its customers by the following rules:\nMaking a long-distance call costs a certain amount per minute, depending on the time of day when the call is made. When a customer starts connecting a long-distance call, the time will be recorded, and so will be the time when the customer hangs up the phone. Every calendar month, a bill is sent to the customer for each minute called (at a rate determined by the time of day). Your job is to prepare the bills for each month, given a set of phone call records.\nInput Specification: Each input file contains one test case. Each case has two parts: the rate structure, and the phone call records.\nThe rate structure consists of a line with 24 non-negative integers denoting the toll (cents/minute) from 00:00 - 01:00, the toll from 01:00 - 02:00, and so on for each hour in the day.\nThe next line contains a positive number N (â‰¤1000), followed by N lines of records. Each phone call record consists of the name of the customer (string of up to 20 characters without space), the time and date (mm:dd:hh:mm), and the word on-line or off-line.\nFor each test case, all dates will be within a single month. Each on-line record is paired with the chronologically next record for the same customer provided it is an off-line record. Any on-line records that are not paired with an off-line record are ignored, as are off-line records not paired with an on-line record. It is guaranteed that at least one call is well paired in the input. You may assume that no two records for the same customer have the same time. Times are recorded using a 24-hour clock.\nOutput Specification: For each test case, you must print a phone bill for each customer.\nBills must be printed in alphabetical order of customers\u0026rsquo; names. For each customer, first print in a line the name of the customer and the month of the bill in the format shown by the sample. Then for each time period of a call, print in one line the beginning and ending time and date (dd:hh:mm), the lasting time (in minute) and the charge of the call. The calls must be listed in chronological order. Finally, print the total charge for the month in the format shown by the sample.\nSample Input: 10 10 10 10 10 10 20 20 20 15 15 15 15 15 15 15 20 30 20 15 15 10 10 10 10 CYLL 01:01:06:01 on-line CYLL 01:28:16:05 off-line CYJJ 01:01:07:00 off-line CYLL 01:01:08:03 off-line CYJJ 01:01:05:59 on-line aaa 01:01:01:03 on-line aaa 01:02:00:01 on-line CYLL 01:28:15:41 on-line aaa 01:05:02:24 on-line aaa 01:04:23:59 off-line Sample Output: CYJJ 01 01:05:59 01:07:00 61 $12.10 Total amount: $12.10 CYLL 01 01:06:01 01:08:03 122 $24.40 28:15:41 28:16:05 24 $3.85 Total amount: $28.25 aaa 01 02:00:01 04:23:59 4318 $638.80 Total amount: $638.80 æ€è·¯ å°†é€šè¯è®°å½•ï¼Œå…ˆæ ¹æ®å§“åï¼Œå†æ ¹æ®æ—¶é—´å…ˆåï¼Œè¿›è¡Œæ’åºã€‚è¿™æ ·ç›¸åŒåå­—çš„è®°å½•å°±ä¼šæ’åœ¨ä¸€èµ·ï¼Œä¸”å…¶ä¸­çš„æ•°æ®ä¹Ÿæ˜¯æŒ‰ç…§æ—¶é—´é¡ºåºçš„ã€‚ ä¸ºäº†æ–¹ä¾¿è®¡ç®—æŸä¸€ç»„é€šè¯çš„æ—¶é•¿ï¼Œå¯ä»¥æŠŠè®°å½•çš„æ—¶é—´éƒ½æ¢ç®—ä¸ºç›¸å¯¹äº 00:00:00 çš„åˆ†é’Ÿæ•°ï¼Œåˆ™æŒ‚ç”µè¯æ—¶é—´å‡å»æ¥ç”µè¯æ—¶é—´ï¼Œå³ä¸ºé€šè¯æ—¶é•¿ ä¸ºäº†æ–¹ä¾¿è®¡ç®—æŸä¸€ç»„é€šè¯çš„è´¹ç”¨ï¼Œå¯ä»¥æŠŠæŒ‚ç”µè¯ç›¸å¯¹äº 00:00:00 çš„è´¹ç”¨å‡å»æ¥ç”µè¯ç›¸å¯¹äº 00:00:00 çš„è´¹ç”¨ï¼Œå³ä¸ºè¯¥é€šè¯çš„è´¹ç”¨ #include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;map\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int maxn = 2000; int n, rate[25] = {0}; struct Record { string name; int month, day, hour, min, time, status; } records[maxn]; double getCostFromZero(Record \u0026amp;r) { double cost = 0; cost += (r.day - 1) * 60 * rate[24] + r.min * rate[r.hour]; for (int i = 0; i \u0026lt;= r.hour - 1; i++) { cost += rate[i] * 60; } return cost; } int cmp(Record r1, Record r2) { if (r1.name != r2.name) { return r1.name \u0026lt; r2.name; } else { return r1.time \u0026lt; r2.time; } } int main() { for (int i = 0; i \u0026lt; 24; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;rate[i]); rate[24] += rate[i]; } scanf(\u0026#34;%d\u0026#34;, \u0026amp;n); string status; for (int i = 0; i \u0026lt; n; i++) { cin \u0026gt;\u0026gt; records[i].name; scanf(\u0026#34;%d:%d:%d:%d\u0026#34;, \u0026amp;records[i].month, \u0026amp;records[i].day, \u0026amp;records[i].hour, \u0026amp;records[i].min); records[i].time = records[i].day * 24 * 60 + records[i].hour * 60 + records[i].min; cin \u0026gt;\u0026gt; status; if (status == \u0026#34;on-line\u0026#34;) { records[i].status = 1; } else { records[i].status = 0; } } sort(records, records + n, cmp); map\u0026lt;string, vector\u0026lt;Record\u0026gt; \u0026gt; nameRecords; for (int i = 1; i \u0026lt; n; i++) { if (records[i].name == records[i - 1].name \u0026amp;\u0026amp; records[i - 1].status == 1 \u0026amp;\u0026amp; records[i].status == 0) { nameRecords[records[i].name].push_back(records[i - 1]); nameRecords[records[i].name].push_back(records[i]); } } for (auto it : nameRecords) { vector\u0026lt;Record\u0026gt; temp = it.second; printf(\u0026#34;%s %02d\\n\u0026#34;, it.first.c_str(), temp[0].month); double totalCost = 0; for (int i = 0; i \u0026lt; temp.size(); i += 2) { double cost = getCostFromZero(temp[i + 1]) - getCostFromZero(temp[i]); printf(\u0026#34;%02d:%02d:%02d %02d:%02d:%02d %d $%.2f\\n\u0026#34;, temp[i].day, temp[i].hour, temp[i].min, temp[i + 1].day, temp[i + 1].hour, temp[i + 1].min, temp[i + 1].time - temp[i].time, cost / 100); totalCost += cost; } printf(\u0026#34;Total amount: $%.2f\\n\u0026#34;, totalCost / 100); } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1016/","summary":"\u003cp\u003eA long-distance telephone company charges its customers by the following rules:\u003c/p\u003e\n\u003cp\u003eMaking a long-distance call costs a certain amount per minute, depending on the time of day when the call is made. When a customer starts connecting a long-distance call, the time will be recorded, and so will be the time when the customer hangs up the phone. Every calendar month, a bill is sent to the customer for each minute called (at a rate determined by the time of day). Your job is to prepare the bills for each month, given a set of phone call records.\u003c/p\u003e","title":"PATç”²çº§ 1016 Phone Bills (25åˆ†)"},{"content":"To evaluate the performance of our first year CS majored students, we consider their grades of three courses only: C - C Programming Language, M - Mathematics (Calculus or Linear Algrbra), and E - English. At the mean time, we encourage students by emphasizing on their best ranks \u0026ndash; that is, among the four ranks with respect to the three courses and the average grade, we print the best rank for each student.\nFor example, The grades of C, M, E and A - Average of 4 students are given as the following:\nStudentID C M E A 310101 98 85 88 90 310102 70 95 88 84 310103 82 87 94 88 310104 91 91 91 91 Then the best ranks for all the students are No.1 since the 1st one has done the best in C Programming Language, while the 2nd one in Mathematics, the 3rd one in English, and the last one in average.\nInput Specification: Each input file contains one test case. Each case starts with a line containing 2 numbers N and M (â‰¤2000), which are the total number of students, and the number of students who would check their ranks, respectively. Then N lines follow, each contains a student ID which is a string of 6 digits, followed by the three integer grades (in the range of [0, 100]) of that student in the order of C, M and E. Then there are M lines, each containing a student ID.\nOutput Specification: For each of the M students, print in one line the best rank for him/her, and the symbol of the corresponding rank, separated by a space.\nThe priorities of the ranking methods are ordered as A \u0026gt; C \u0026gt; M \u0026gt; E. Hence if there are two or more ways for a student to obtain the same best rank, output the one with the highest priority.\nIf a student is not on the grading list, simply output N/A.\nSample Input: 5 6 310101 98 85 88 310102 70 95 88 310103 82 87 94 310104 91 91 91 310105 85 90 90 310101 310102 310103 310104 310105 999999 Sample Output: 1 C 1 M 1 E 1 A 3 A N/A æ€è·¯ æœ¬é¢˜ä¸»è¦åœ¨äºæ•°æ®çš„å­˜å–æ–¹å¼ï¼Œå…ˆç”¨ Stu ç»“æ„ä½“æ•°ç»„æ¥å­˜å‚¨æ¯ä¸ªè€ƒç”Ÿçš„ id å’Œç”¨æ¥å­˜å‚¨å…¶å„ç§‘åˆ†æ•°çš„æ•°ç»„ï¼Œå¹¶å¯¹è¯¥ç»“æ„ä½“æ•°ç»„æ ¹æ®å„ç§‘åˆ†æ•°è¿›è¡Œæ’åºï¼Œæ¯æ’åºä¸€æ¬¡å°±å°†å…¶æ’åºç»“æœå†™å…¥æ’åæ•°ç»„ ranksï¼Œæœ€åæ ¹æ®æŸ¥è¯¢ idï¼Œè¾“å‡ºæœ€é«˜æ’åä¿¡æ¯å³å¯ ä»¥ç»“æ„ä½“ Stu å­˜æ”¾ id å’Œ score[4] æ•°ç»„ï¼Œscore[0] ~ score[3] åˆ†åˆ«ä»£è¡¨ Aï¼ŒCï¼ŒMï¼ŒE ç”±äº id æ˜¯ 6 ä½çš„æ•´æ•°ï¼ˆ6 digitsï¼‰ï¼Œä¸å¦¨è®¾ç½® ranks [1000000] [4] æ•°ç»„ï¼Œå…¶ä¸­ ranks [id] [0] ~ ranks [id] [4] åˆ†åˆ«ä»£è¡¨ç¼–å·ä¸º id çš„è€ƒç”Ÿçš„ Aï¼ŒCï¼ŒMï¼ŒE åˆ†åˆ«çš„æ’å æ³¨æ„ç‚¹ ç”±äºä¼˜å…ˆçº§æ˜¯ A \u0026gt; C \u0026gt; M \u0026gt; Eï¼Œä¸ºäº†æ–¹ä¾¿æšä¸¾ï¼Œè®¾ç½®æ•°ç»„æ—¶ï¼Œå°½é‡æŠŠ A æ”¾åœ¨ Cã€Mã€E å‰é¢ æœ¬é¢˜ id æ˜¯æ•´æ•°ï¼ˆdigits å³æ•°å­—ï¼‰ï¼Œä¸ä¼šæ˜¯å­—ç¬¦å‹ æœ¬é¢˜æ²¡æœ‰è¯´æ˜å¹³å‡åˆ†æ˜¯å‘ä¸‹å–æ•´è¿˜æ˜¯å››èˆäº”å…¥ï¼ˆå‘ä¸‹å–æ•´ä¹Ÿèƒ½é€šè¿‡ï¼‰ï¼Œä½†ä¸ºäº†æ›´æ–¹ä¾¿ï¼Œå¹³å‡åˆ†ä¹Ÿå¯ä»¥ç”¨æ€»åˆ†æ¥ä»£æ›¿ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int maxn = 2000; struct Stu { int id; int score[4] = {0}; } stus[maxn]; int n, m, q, ranks[1000000][4] = {0}, index; char ch[4] = {\u0026#39;A\u0026#39;, \u0026#39;C\u0026#39;, \u0026#39;M\u0026#39;, \u0026#39;E\u0026#39;}; int cmp(Stu s1, Stu s2) { return s1.score[index] \u0026gt; s2.score[index]; } int main() { scanf(\u0026#34;%d %d\u0026#34;, \u0026amp;n, \u0026amp;m); for (int i = 0; i \u0026lt; n; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;stus[i].id); for (int j = 1; j \u0026lt;= 3; j++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;stus[i].score[j]); stus[i].score[0] += stus[i].score[j]; } } for (index = 0; index \u0026lt; 4; index++) { sort(stus, stus + n, cmp); ranks[stus[0].id][index] = 1; for (int i = 1; i \u0026lt; n; i++) { if (stus[i].score[index] == stus[i - 1].score[index]) { ranks[stus[i].id][index] = ranks[stus[i - 1].id][index]; } else { ranks[stus[i].id][index] = i + 1; } } } for (int i = 0; i \u0026lt; m; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;q); if (ranks[q][0] == 0) { printf(\u0026#34;N/A\\n\u0026#34;); } else { int minRank = 2000, minIndex; for (int j = 0; j \u0026lt; 4; j++) { if (ranks[q][j] \u0026lt; minRank) { minRank = ranks[q][j]; minIndex = j; } } printf(\u0026#34;%d %c\\n\u0026#34;, minRank, ch[minIndex]); } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1012/","summary":"\u003cp\u003eTo evaluate the performance of our first year CS majored students, we consider their grades of three courses only: \u003ccode\u003eC\u003c/code\u003e - C Programming Language, \u003ccode\u003eM\u003c/code\u003e - Mathematics (Calculus or Linear Algrbra), and \u003ccode\u003eE\u003c/code\u003e - English. At the mean time, we encourage students by emphasizing on their best ranks \u0026ndash; that is, among the four ranks with respect to the three courses and the average grade, we print the best rank for each student.\u003c/p\u003e","title":"PATç”²çº§ 1012 The Best Rank (25åˆ†)"},{"content":"Given an integer with no more than 9 digits, you are supposed to read it in the traditional Chinese way. Output Fu first if it is negative. For example, -123456789 is read as Fu yi Yi er Qian san Bai si Shi wu Wan liu Qian qi Bai ba Shi jiu. Note: zero (ling) must be handled correctly according to the Chinese tradition. For example, 100800 is yi Shi Wan ling ba Bai.\nInput Specification: Each input file contains one test case, which gives an integer with no more than 9 digits.\nOutput Specification: For each test case, print in a line the Chinese way of reading the number. The characters are separated by a space and there must be no extra space at the end of the line.\nSample Input 1: -123456789 Sample Output 1: Fu yi Yi er Qian san Bai si Shi wu Wan liu Qian qi Bai ba Shi jiu Sample Input 2: 100800 Sample Output 2: yi Shi Wan ling ba Bai æ€è·¯ å°†æ•°å­—æŒ‰å­—ç¬¦ä¸²å¤„ç†ï¼Œè®¾ç½®ä¸‹æ ‡ left å’Œ right æ¥å¤„ç†æ•°å­—çš„ä¸€ä¸ªèŠ‚ï¼ˆä¸ªèŠ‚ã€ä¸‡èŠ‚ã€äº¿èŠ‚ï¼‰çš„è¾“å‡ºï¼Œleft æŒ‡å‘å½“å‰éœ€è¦è¾“å‡ºçš„ä½ï¼Œright æŒ‡å‘ä¸ left åŒèŠ‚çš„ä¸ªä½ã€‚\næ³¨æ„ç‚¹ è¾¹ç•Œæ•°æ® 0 çš„è¾“å‡ºåº”è¯¥ä¸º â€œ0â€œã€‚å¯ä»¥åœ¨åˆ¤æ–­å½“å‰ä½æ˜¯å¦æ˜¯ 0 æ—¶ï¼ŒåŠ ä¸Šä¸ä¸ºé¦–ä½è¿™ä¸€æ¡ä»¶ï¼ˆå³è‹¥ä¸ºé¦–ä½çš„ 0ï¼Œç…§å¸¸è¾“å‡ºï¼‰ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ç‰¹æ®Šåˆ¤æ–­è¾“å‡ºã€‚ å¦‚æœä¸‡èŠ‚æ‰€æœ‰ä½éƒ½ä¸º 0ï¼Œåˆ™ä¸èƒ½è¾“å‡ºå¤šä½™çš„ä¸‡ã€‚ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;cstring\u0026gt; char num[10][5] = {\u0026#34;ling\u0026#34;, \u0026#34;yi\u0026#34;, \u0026#34;er\u0026#34;, \u0026#34;san\u0026#34;, \u0026#34;si\u0026#34;, \u0026#34;wu\u0026#34;, \u0026#34;liu\u0026#34;, \u0026#34;qi\u0026#34;, \u0026#34;ba\u0026#34;, \u0026#34;jiu\u0026#34;}; char wei[5][5] = {\u0026#34;Shi\u0026#34;, \u0026#34;Bai\u0026#34;, \u0026#34;Qian\u0026#34;, \u0026#34;Wan\u0026#34;, \u0026#34;Yi\u0026#34;}; int main() { char str[11]; scanf(\u0026#34;%s\u0026#34;, str); int len = strlen(str), left = 0, right = len - 1; if (str[0] == \u0026#39;-\u0026#39;) { printf(\u0026#34;Fu\u0026#34;); left++; } while (right - 4 \u0026gt;= left) { right -= 4; } while (left \u0026lt; len) { bool flag = false, isPrint = false; while (left \u0026lt;= right) { if (left \u0026gt; 0 \u0026amp;\u0026amp; str[left] == \u0026#39;0\u0026#39;) { flag = true; } else { if (flag == true) { printf(\u0026#34; ling\u0026#34;); flag = false; } if (left \u0026gt; 0) { printf(\u0026#34; \u0026#34;); } printf(\u0026#34;%s\u0026#34;, num[str[left] - \u0026#39;0\u0026#39;]); isPrint = true; if (left != right) { printf(\u0026#34; %s\u0026#34;, wei[right - left - 1]); } } left++; } if (isPrint == true \u0026amp;\u0026amp; right != len - 1) { printf(\u0026#34; %s\u0026#34;, wei[(len - 1 - right) / 4 + 2]); } right += 4; } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1082/","summary":"\u003cp\u003eGiven an integer with no more than 9 digits, you are supposed to read it in the traditional Chinese way. Output \u003ccode\u003eFu\u003c/code\u003e first if it is negative. For example, -123456789 is read as \u003ccode\u003eFu yi Yi er Qian san Bai si Shi wu Wan liu Qian qi Bai ba Shi jiu\u003c/code\u003e. Note: zero (\u003ccode\u003eling\u003c/code\u003e) must be handled correctly according to the Chinese tradition. For example, 100800 is \u003ccode\u003eyi Shi Wan ling ba Bai\u003c/code\u003e.\u003c/p\u003e","title":"PATç”²çº§ 1082 Read Number in Chinese (25åˆ†)"},{"content":"Sherlock Holmes received a note with some strange strings: Let's date! 3485djDkxh4hhGE 2984akDfkkkkggEdsb s\u0026amp;hgsfdk d\u0026amp;Hyscvnm. It took him only a minute to figure out that those strange strings are actually referring to the coded time Thursday 14:04 \u0026ndash; since the first common capital English letter (case sensitive) shared by the first two strings is the 4th capital letter D, representing the 4th day in a week; the second common character is the 5th capital letter E, representing the 14th hour (hence the hours from 0 to 23 in a day are represented by the numbers from 0 to 9 and the capital letters from A to N, respectively); and the English letter shared by the last two strings is s at the 4th position, representing the 4th minute. Now given two pairs of strings, you are supposed to help Sherlock decode the dating time.\nInput Specification: Each input file contains one test case. Each case gives 4 non-empty strings of no more than 60 characters without white space in 4 lines.\nOutput Specification: For each test case, print the decoded time in one line, in the format DAY HH:MM, where DAY is a 3-character abbreviation for the days in a week \u0026ndash; that is, MON for Monday, TUE for Tuesday, WED for Wednesday, THU for Thursday, FRI for Friday, SAT for Saturday, and SUN for Sunday. It is guaranteed that the result is unique for each case.\nSample Input: 3485djDkxh4hhGE 2984akDfkkkkggEdsb s\u0026amp;hgsfdk d\u0026amp;Hyscvnm Sample Output: THU 14:04 æ³¨æ„ç‚¹ ä¸‰å¯¹ç›¸åŒçš„å­—ç¬¦éƒ½éœ€è¦åœ¨å¯¹åº”ç›¸åŒçš„ä½ç½®ä¸Šï¼ˆåœ¨å„è‡ªçš„å­—ç¬¦ä¸²ä¸­æ‰€åœ¨çš„ä½ç½®ç›¸åŒï¼‰ï¼Œè¿™ä¸€ç‚¹é¢˜ç›®æ²¡æœ‰è¯´æ¸…æ¥šï¼ˆæˆ‘åˆšå¼€å§‹ä»¥ä¸ºå¯ä»¥åœ¨ä¸åŒä½ç½® ç¬¬ 2 å¯¹ç›¸åŒçš„å­—ç¬¦ï¼Œå…¶å®æ˜¯åœ¨ç¬¬ä¸€å¯¹å­—ç¬¦ä½ç½®ä¹‹åçš„ä¸‹ä¸€å¯¹æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ï¼Œè€Œä¸æ˜¯ä»å¤´æ‰«æç¢°åˆ°çš„ç¬¬ 2 å¯¹ï¼Œè¿™ä¸€ç‚¹é¢˜ç›®ä¹Ÿæ²¡æœ‰è¯´æ¸…æ¥š å‰ä¸¤å¯¹å­—ç¬¦éœ€è¦é™å®šåˆ°å…·ä½“èŒƒå›´ï¼Œå¦‚ Aï½G ä¸ Aï½Nï¼Œè€Œä¸æ˜¯ Aï½Zï¼Œå¦åˆ™ä¼šâ€œç­”æ¡ˆé”™è¯¯â€ æ€»ä¹‹ï¼Œè¿™é¢˜å¾ˆæ¨¡ç³Šï¼Œèƒ½åšå¯¹é çŒœ #include \u0026lt;cstdio\u0026gt; #include \u0026lt;cstring\u0026gt; const int maxn = 61; int main() { char str[4][maxn]; char week[7][4] = {\u0026#34;MON\u0026#34;, \u0026#34;TUE\u0026#34;, \u0026#34;WED\u0026#34;, \u0026#34;THU\u0026#34;, \u0026#34;FRI\u0026#34;, \u0026#34;SAT\u0026#34;, \u0026#34;SUN\u0026#34;}; for (int i = 0; i \u0026lt; 4; i++) { scanf(\u0026#34;%s\u0026#34;, str[i]); } int i, j, len1 = strlen(str[0]), len2 = strlen(str[1]), len3 = strlen(str[2]), len4 = strlen(str[3]); for (i = 0; i \u0026lt; len1 \u0026amp;\u0026amp; i \u0026lt; len2; i++) { if (str[0][i] == str[1][i] \u0026amp;\u0026amp; str[0][i] \u0026gt;= \u0026#39;A\u0026#39; \u0026amp;\u0026amp; str[0][i] \u0026lt;= \u0026#39;G\u0026#39;) { printf(\u0026#34;%s \u0026#34;, week[str[0][i] - \u0026#39;A\u0026#39;]); break; } } for (i++; i \u0026lt; len1 \u0026amp;\u0026amp; i \u0026lt; len2; i++) { if (str[0][i] == str[1][i]) { if (str[0][i] \u0026gt;= \u0026#39;0\u0026#39; \u0026amp;\u0026amp; str[0][i] \u0026lt;= \u0026#39;9\u0026#39;) { printf(\u0026#34;%02d:\u0026#34;, str[0][i] - \u0026#39;0\u0026#39;); break; } else if (str[0][i] \u0026gt;= \u0026#39;A\u0026#39; \u0026amp;\u0026amp; str[0][i] \u0026lt;= \u0026#39;N\u0026#39;) { printf(\u0026#34;%02d:\u0026#34;, str[0][i] - \u0026#39;A\u0026#39; + 10); break; } } } for (int i = 0; i \u0026lt; len3 \u0026amp;\u0026amp; i \u0026lt; len4; i++) { if (str[2][i] == str[3][i] \u0026amp;\u0026amp; (str[2][i] \u0026gt;= \u0026#39;a\u0026#39; \u0026amp;\u0026amp; str[2][i] \u0026lt;= \u0026#39;z\u0026#39; || str[2][i] \u0026gt;= \u0026#39;A\u0026#39; \u0026amp;\u0026amp; str[2][i] \u0026lt;= \u0026#39;Z\u0026#39;)) { printf(\u0026#34;%02d\u0026#34;, i); break; } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1061/","summary":"\u003cp\u003eSherlock Holmes received a note with some strange strings: \u003ccode\u003eLet's date! 3485djDkxh4hhGE 2984akDfkkkkggEdsb s\u0026amp;hgsfdk d\u0026amp;Hyscvnm\u003c/code\u003e. It took him only a minute to figure out that those strange strings are actually referring to the coded time \u003ccode\u003eThursday 14:04\u003c/code\u003e \u0026ndash; since the first common capital English letter (case sensitive) shared by the first two strings is the 4th capital letter \u003ccode\u003eD\u003c/code\u003e, representing the 4th day in a week; the second common character is the 5th capital letter \u003ccode\u003eE\u003c/code\u003e, representing the 14th hour (hence the hours from 0 to 23 in a day are represented by the numbers from 0 to 9 and the capital letters from \u003ccode\u003eA\u003c/code\u003e to \u003ccode\u003eN\u003c/code\u003e, respectively); and the English letter shared by the last two strings is \u003ccode\u003es\u003c/code\u003e at the 4th position, representing the 4th minute. Now given two pairs of strings, you are supposed to help Sherlock decode the dating time.\u003c/p\u003e","title":"PATç”²çº§ 1061 Dating (20åˆ†)"},{"content":"è®¾è®¡å‡½æ•°æ±‚ä¸€å…ƒå¤šé¡¹å¼çš„å¯¼æ•°ã€‚ï¼ˆæ³¨ï¼šx^nï¼ˆnä¸ºæ•´æ•°ï¼‰çš„ä¸€é˜¶å¯¼æ•°ä¸ºnx^{nâˆ’1}ã€‚ï¼‰\nè¾“å…¥æ ¼å¼: ä»¥æŒ‡æ•°é€’é™æ–¹å¼è¾“å…¥å¤šé¡¹å¼éé›¶é¡¹ç³»æ•°å’ŒæŒ‡æ•°ï¼ˆç»å¯¹å€¼å‡ä¸ºä¸è¶…è¿‡ 1000 çš„æ•´æ•°ï¼‰ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚\nè¾“å‡ºæ ¼å¼: ä»¥ä¸è¾“å…¥ç›¸åŒçš„æ ¼å¼è¾“å‡ºå¯¼æ•°å¤šé¡¹å¼éé›¶é¡¹çš„ç³»æ•°å’ŒæŒ‡æ•°ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ï¼Œä½†ç»“å°¾ä¸èƒ½æœ‰å¤šä½™ç©ºæ ¼ã€‚æ³¨æ„â€œé›¶å¤šé¡¹å¼â€çš„æŒ‡æ•°å’Œç³»æ•°éƒ½æ˜¯ 0ï¼Œä½†æ˜¯è¡¨ç¤ºä¸º 0 0ã€‚\nè¾“å…¥æ ·ä¾‹: 3 4 -5 2 6 1 -2 0 è¾“å‡ºæ ·ä¾‹: 12 3 -10 1 6 0 æ³¨æ„ç‚¹ ç”¨ whileâ€¦â€¦EOF çš„æ ¼å¼æ¥è¯»å…¥ç³»æ•°å’ŒæŒ‡æ•°ï¼ˆé»‘æ¡†ä¸­è§¦å‘ EOF è¦æŒ‰ ctrl + Zï¼Œå¹¶å›è½¦ï¼‰ ç»æµ‹è¯•ï¼Œè¯¥é¢˜çš„æŒ‡æ•°éƒ½æ˜¯éè´Ÿæ•´æ•° æ±‚å¯¼å¿…é¡»ä»ä½æ¬¡é¡¹æšä¸¾åˆ°é«˜æ¬¡é¡¹ï¼Œå¦åˆ™ç»“æœå¯èƒ½ä¸ºå‡ºé”™ åœ¨æ±‚å¯¼åï¼Œå½“å‰ç³»æ•°å¿…é¡»æ¸…ç©ºä¸º0ï¼Œå¦åˆ™å½“å‰æ— æ³•è¢«åé¢è¦†ç›– å¦‚æœæ±‚å¯¼ä¹‹åæ²¡æœ‰ä»»ä½•éé›¶é¡¹ï¼Œéœ€è¦è¾“å‡º 0 0 #include \u0026lt;cstdio\u0026gt; const int maxn = 1001; int main() { int n[maxn] = {0}, c, e, cnt = 0; while (scanf(\u0026#34;%d%d\u0026#34;, \u0026amp;c, \u0026amp;e) != EOF) { n[e] = c; } n[0] = 0; for (int i = 1; i \u0026lt; maxn; i++) { n[i - 1] = i * n[i]; n[i] = 0; if (n[i - 1] != 0) { cnt++; } } if (cnt == 0) { printf(\u0026#34;0 0\u0026#34;); } else { for (int i = maxn - 1; i \u0026gt;= 0; i--) { if (n[i] != 0) { printf(\u0026#34;%d %d\u0026#34;, n[i], i); cnt--; if (cnt != 0) { printf(\u0026#34; \u0026#34;); } else { break; } } } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/basic_level/b1010/","summary":"\u003cp\u003eè®¾è®¡å‡½æ•°æ±‚ä¸€å…ƒå¤šé¡¹å¼çš„å¯¼æ•°ã€‚ï¼ˆæ³¨ï¼šx^nï¼ˆ\u003cem\u003en\u003c/em\u003eä¸ºæ•´æ•°ï¼‰çš„ä¸€é˜¶å¯¼æ•°ä¸ºnx^{nâˆ’1}ã€‚ï¼‰\u003c/p\u003e\n\u003ch1 id=\"è¾“å…¥æ ¼å¼\"\u003eè¾“å…¥æ ¼å¼:\u003c/h1\u003e\n\u003cp\u003eä»¥æŒ‡æ•°é€’é™æ–¹å¼è¾“å…¥å¤šé¡¹å¼éé›¶é¡¹ç³»æ•°å’ŒæŒ‡æ•°ï¼ˆç»å¯¹å€¼å‡ä¸ºä¸è¶…è¿‡ 1000 çš„æ•´æ•°ï¼‰ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚\u003c/p\u003e\n\u003ch1 id=\"è¾“å‡ºæ ¼å¼\"\u003eè¾“å‡ºæ ¼å¼:\u003c/h1\u003e\n\u003cp\u003eä»¥ä¸è¾“å…¥ç›¸åŒçš„æ ¼å¼è¾“å‡ºå¯¼æ•°å¤šé¡¹å¼éé›¶é¡¹çš„ç³»æ•°å’ŒæŒ‡æ•°ã€‚æ•°å­—é—´ä»¥ç©ºæ ¼åˆ†éš”ï¼Œä½†ç»“å°¾ä¸èƒ½æœ‰å¤šä½™ç©ºæ ¼ã€‚æ³¨æ„â€œé›¶å¤šé¡¹å¼â€çš„æŒ‡æ•°å’Œç³»æ•°éƒ½æ˜¯ 0ï¼Œä½†æ˜¯è¡¨ç¤ºä¸º \u003ccode\u003e0 0\u003c/code\u003eã€‚\u003c/p\u003e\n\u003ch1 id=\"è¾“å…¥æ ·ä¾‹\"\u003eè¾“å…¥æ ·ä¾‹:\u003c/h1\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-in\" data-lang=\"in\"\u003e3 4 -5 2 6 1 -2 0\n\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"è¾“å‡ºæ ·ä¾‹\"\u003eè¾“å‡ºæ ·ä¾‹:\u003c/h1\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode class=\"language-out\" data-lang=\"out\"\u003e12 3 -10 1 6 0\n\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"æ³¨æ„ç‚¹\"\u003eæ³¨æ„ç‚¹\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eç”¨ whileâ€¦â€¦EOF çš„æ ¼å¼æ¥è¯»å…¥ç³»æ•°å’ŒæŒ‡æ•°ï¼ˆé»‘æ¡†ä¸­è§¦å‘ EOF è¦æŒ‰ \u003ccode\u003ectrl + Z\u003c/code\u003eï¼Œå¹¶å›è½¦ï¼‰\u003c/li\u003e\n\u003cli\u003eç»æµ‹è¯•ï¼Œè¯¥é¢˜çš„æŒ‡æ•°éƒ½æ˜¯éè´Ÿæ•´æ•°\u003c/li\u003e\n\u003cli\u003eæ±‚å¯¼å¿…é¡»ä»ä½æ¬¡é¡¹æšä¸¾åˆ°é«˜æ¬¡é¡¹ï¼Œå¦åˆ™ç»“æœå¯èƒ½ä¸ºå‡ºé”™\u003c/li\u003e\n\u003cli\u003eåœ¨æ±‚å¯¼åï¼Œå½“å‰ç³»æ•°å¿…é¡»æ¸…ç©ºä¸º0ï¼Œå¦åˆ™å½“å‰æ— æ³•è¢«åé¢è¦†ç›–\u003c/li\u003e\n\u003cli\u003eå¦‚æœæ±‚å¯¼ä¹‹åæ²¡æœ‰ä»»ä½•éé›¶é¡¹ï¼Œéœ€è¦è¾“å‡º \u003ccode\u003e0 0\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#include\u003c/span\u003e \u003cspan style=\"color:#75715e\"\u003e\u0026lt;cstdio\u0026gt;\u003c/span\u003e\u003cspan style=\"color:#75715e\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003econst\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e maxn \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1001\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e() {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e n[maxn] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e}, c, e, cnt \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ewhile\u003c/span\u003e (scanf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%d%d\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ec, \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u003c/span\u003ee) \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e EOF) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        n[e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e c;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    n[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e (\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e i \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e; i \u003cspan style=\"color:#f92672\"\u003e\u0026lt;\u003c/span\u003e maxn; i\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        n[i \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e i \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e n[i];\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        n[i] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (n[i \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            cnt\u003cspan style=\"color:#f92672\"\u003e++\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (cnt \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        printf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;0 0\u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e (\u003cspan style=\"color:#66d9ef\"\u003eint\u003c/span\u003e i \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e maxn \u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e; i \u003cspan style=\"color:#f92672\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e; i\u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (n[i] \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                printf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;%d %d\u0026#34;\u003c/span\u003e, n[i], i);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                cnt\u003cspan style=\"color:#f92672\"\u003e--\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e (cnt \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    printf(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                } \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                    \u003cspan style=\"color:#66d9ef\"\u003ebreak\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","title":"PATä¹™çº§ 1010 ä¸€å…ƒå¤šé¡¹å¼æ±‚å¯¼ (25åˆ†)"},{"content":"Given three integers A, B and C in [âˆ’2^63,2^63], you are supposed to tell whether A+B\u0026gt;C.\nInput Specification: The first line of the input gives the positive number of test cases, T (â‰¤10). Then T test cases follow, each consists of a single line containing three integers A, B and C, separated by single spaces.\nOutput Specification: For each test case, output in one line Case #X: true if A+B\u0026gt;C, or Case #X: false otherwise, where X is the case number (starting from 1).\nSample Input: 3 1 2 3 2 3 4 9223372036854775807 -9223372036854775808 0 Sample Output: Case #1: false Case #2: true Case #3: false æ€è·¯ å½“æ­£æº¢å‡ºæ—¶ï¼ŒA + B å¤§å°çš„èŒƒå›´åŒºé—´ä¸º [2^63, 2^64 - 2]ï¼Œæ‰€ä»¥æº¢å‡ºåçš„åŒºé—´ä¸º [-2^63, -2]ã€‚æ‰€ä»¥ï¼Œå½“ A \u0026gt; 0, B \u0026gt; 0, A + B \u0026lt; 0 æ—¶ï¼Œä¸ºæ­£æº¢å‡ºï¼Œè¾“å…¥ trueã€‚ å½“è´Ÿæº¢å‡ºæ—¶ï¼ŒA + B å¤§å°çš„èŒƒå›´åŒºé—´ä¸º [-2^64, -2^63 - 1]ï¼Œæ‰€ä»¥æº¢å‡ºåçš„åŒºé—´ä¸º [0, 2^63 - 1]ã€‚æ‰€ä»¥ï¼Œå½“ A \u0026lt; 0, B \u0026lt; 0, A + B \u0026gt;= 0 æ—¶ä¸ºï¼Œä¸ºè´Ÿæº¢å‡ºï¼Œè¾“å‡º falseã€‚ åœ¨æ²¡æœ‰æº¢å‡ºçš„æƒ…å†µä¸‹ï¼Œæ­£å¸¸æ¯”è¾ƒã€‚ æ³¨æ„ç‚¹ A + B å¿…é¡»å­˜æ”¾åˆ° long long å‹å˜é‡ä¸­æ‰å¯ä¸ C è¿›è¡Œæ¯”è¾ƒï¼Œè€Œä¸å¯ä»¥åœ¨ if çš„æ¡ä»¶ä¸­ç›´æ¥ç›¸åŠ ä¸ C æ¯”è¾ƒï¼Œå¦åˆ™ä¼šé€ æˆåä¸¤ç»„æ•°æ®é”™è¯¯ã€‚ #include \u0026lt;cstdio\u0026gt; int main() { int t; long long a, b, c; bool flag; scanf(\u0026#34;%d\u0026#34;, \u0026amp;t); for (int i = 1; i \u0026lt;= t; i++) { scanf(\u0026#34;%lld %lld %lld\u0026#34;, \u0026amp;a, \u0026amp;b, \u0026amp;c); long long res = a + b; if (a \u0026gt; 0 \u0026amp;\u0026amp; b \u0026gt; 0 \u0026amp;\u0026amp; res \u0026lt; 0) { flag = true; } else if (a \u0026lt; 0 \u0026amp;\u0026amp; b \u0026lt; 0 \u0026amp;\u0026amp; res \u0026gt;= 0) { flag = false; } else if (res \u0026gt; c) { flag = true; } else { flag = false; } printf(\u0026#34;Case #%d: %s\\n\u0026#34;, i, flag ? \u0026#34;true\u0026#34; : \u0026#34;false\u0026#34;); } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1065/","summary":"\u003cp\u003eGiven three integers \u003cem\u003eA\u003c/em\u003e, \u003cem\u003eB\u003c/em\u003e and \u003cem\u003eC\u003c/em\u003e in [âˆ’2^63,2^63], you are supposed to tell whether \u003cem\u003eA\u003c/em\u003e+\u003cem\u003eB\u003c/em\u003e\u0026gt;\u003cem\u003eC\u003c/em\u003e.\u003c/p\u003e\n\u003ch1 id=\"input-specification\"\u003eInput Specification:\u003c/h1\u003e\n\u003cp\u003eThe first line of the input gives the positive number of test cases, \u003cem\u003eT\u003c/em\u003e (â‰¤10). Then \u003cem\u003eT\u003c/em\u003e test cases follow, each consists of a single line containing three integers \u003cem\u003eA\u003c/em\u003e, \u003cem\u003eB\u003c/em\u003e and \u003cem\u003eC\u003c/em\u003e, separated by single spaces.\u003c/p\u003e\n\u003ch1 id=\"output-specification\"\u003eOutput Specification:\u003c/h1\u003e\n\u003cp\u003eFor each test case, output in one line \u003ccode\u003eCase #X: true\u003c/code\u003e if \u003cem\u003eA\u003c/em\u003e+\u003cem\u003eB\u003c/em\u003e\u0026gt;\u003cem\u003eC\u003c/em\u003e, or \u003ccode\u003eCase #X: false\u003c/code\u003e otherwise, where \u003cem\u003eX\u003c/em\u003e is the case number (starting from 1).\u003c/p\u003e","title":"PATç”²çº§ 1065 A+B and C (64bit) (20åˆ†)"},{"content":"ç« èŠ‚æ¦‚è¦ å­¦ä¼š API ç½‘å…³æƒé™éªŒè¯å’Œå…¶ä»–æœåŠ¡äº¤äº’ å­¦ä¼šå¼€å‘ SpringBoot çš„è‡ªå®šä¹‰é…ç½® å­¦ä¼š Dubbo è´Ÿè½½å‡è¡¡ç­–ç•¥é€‰æ‹©å’Œä½¿ç”¨ ä¿®æ”¹ Guns ä¸­çš„ JWT æ¨¡å— å¢åŠ å¿½ç•¥éªŒè¯ URL é…ç½® ä¿®æ”¹è¿”å›å†…å®¹åŒ¹é…ä¸šåŠ¡ å¢åŠ  Threadlocal çš„ç”¨æˆ·ä¿¡æ¯ä¿å­˜ ä¸šåŠ¡åŠŸèƒ½å¼€å‘ å¢åŠ ç”¨æˆ·æœåŠ¡å¹¶æä¾›æ¥å£ åˆæ­¥äº†è§£ API ç½‘å…³ä¸æœåŠ¡ä¹‹é—´äº¤äº’çš„è¿‡ç¨‹ æ ¹æ®æ¥å£æ–‡æ¡£å¼€å‘ç”¨æˆ·æ¥å£ åˆ›å»ºç”¨æˆ·è¡¨ DROP TABLE IF EXISTS user; CREATE TABLE user( UUID INT PRIMARY KEY AUTO_INCREMENT COMMENT \u0026#39;ä¸»é”®ç¼–å·\u0026#39;, user_name VARCHAR(50) COMMENT \u0026#39;ç”¨æˆ·è´¦å·\u0026#39;, user_pwd VARCHAR(50) COMMENT \u0026#39;ç”¨æˆ·å¯†ç \u0026#39;, nick_name VARCHAR(50) COMMENT \u0026#39;ç”¨æˆ·æ˜µç§°\u0026#39;, user_sex INT COMMENT \u0026#39;ç”¨æˆ·æ€§åˆ« 0-ç”·ï¼Œ1-å¥³\u0026#39;, birthday VARCHAR(50) COMMENT \u0026#39;å‡ºç”Ÿæ—¥æœŸ\u0026#39;, email VARCHAR(50) COMMENT \u0026#39;ç”¨æˆ·é‚®ç®±\u0026#39;, user_phone VARCHAR(50) COMMENT \u0026#39;ç”¨æˆ·æ‰‹æœºå·\u0026#39;, address VARCHAR(50) COMMENT \u0026#39;ç”¨æˆ·ä½å€\u0026#39;, head_url VARCHAR(50) COMMENT \u0026#39;å¤´åƒURL\u0026#39;, biography VARCHAR(200) COMMENT \u0026#39;ä¸ªäººä»‹ç»\u0026#39;, life_state INT COMMENT \u0026#39;ç”Ÿæ´»çŠ¶æ€ 0-å•èº«ï¼Œ1-çƒ­æ‹ä¸­ï¼Œ2-å·²å©šï¼Œ3-ä¸ºäººçˆ¶æ¯\u0026#39;, begin_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT \u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;, update_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT \u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39; ) COMMENT \u0026#39;ç”¨æˆ·è¡¨\u0026#39; ENGINE = INNODB AUTO_INCREMENT = 2 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = DYNAMIC; insert into user(user_name,user_pwd,nick_name,user_sex,birthday,email,user_phone,address,head_url,life_state,biography) values(\u0026#39;admin\u0026#39;,\u0026#39;0192023a7bbd73250516f069df18b500\u0026#39;,\u0026#39;ç®¡ç†å‘˜\u0026#39;,0,\u0026#39;2018-07-31\u0026#39;,\u0026#39;admin@gmail.com\u0026#39;,\u0026#39;13888888888\u0026#39;,\u0026#39;æµ™æ±Ÿçœæ­å·å¸‚è¥¿æ¹–åŒºæŸè·¯æŸå·\u0026#39;,\u0026#39;cinema/img/head-img.jpg\u0026#39;,0,\u0026#39;æˆ‘æ˜¯è‹¦é€¼çš„ç®¡ç†å‘˜\u0026#39;); insert into user(user_name,user_pwd,nick_name,user_sex,birthday,email,user_phone,address,head_url,life_state,biography) values(\u0026#39;test\u0026#39;,\u0026#39;5e2de6bd1c9b50f6e27d4e55da43b917\u0026#39;,\u0026#39;æµ‹è¯•ç”¨æˆ·\u0026#39;,0,\u0026#39;2018-08-20\u0026#39;,\u0026#39;test@gmail.com\u0026#39;,\u0026#39;13866666666\u0026#39;,\u0026#39;æµ‹è¯•åœ°å€\u0026#39;,\u0026#39;cinema/img/head-img.jpg\u0026#39;,1,\u0026#39;æˆ‘æ˜¯æµ‹è¯•ç”¨æˆ·\u0026#39;); ç”¨æˆ·æœåŠ¡ä¸ç½‘å…³äº¤äº’ åœ¨ guns é¡¹ç›®ä¸­å¤åˆ¶ä¸€ä»½ guns-gateway æ¨¡å—å¹¶é‡å‘½åä¸º guns-userï¼ˆä¿®æ”¹ç›¸åº”å­æ¨¡å—å’Œä¸»æ¨¡å—çš„ pom.xml ç­‰ï¼‰ï¼Œå¹¶åœ¨ application.yml ä¸­å°†å…¶é‰´æƒæœºåˆ¶ç­‰å…³é—­ï¼ˆç½‘å…³æ‰éœ€è¦ï¼‰\nrest: auth-open: false #jwté‰´æƒæœºåˆ¶æ˜¯å¦å¼€å¯(trueæˆ–è€…false) sign-open: false #ç­¾åæœºåˆ¶æ˜¯å¦å¼€å¯(trueæˆ–false) ç«¯å£è®¾ä¸º8083\nserver: port: 8083 #é¡¹ç›®ç«¯å£ åœ¨ spring:dubbo: ä¸‹æ·»åŠ  Dubbo åè®®å’Œç«¯å£ï¼ˆUserApplication éœ€è¦å‘å¤–éƒ¨æš´éœ²æ¥å£ï¼Œå…ˆå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œç„¶åé€šè¿‡ Dubbo åè®®è¢«è¿œç¨‹è°ƒç”¨ï¼‰\nspring: application: name: cinema-user dubbo: server: true registry: zookeeper://localhost:2181 protocol: name: dubbo port: 20881 åœ¨ guns-user ä¸­ç¼–å†™ UserAPI çš„å®ç°ç±»ï¼Œå…¶ä¸­ UserAPI æ¥å£æ˜¯æ¥è‡ªäº guns-api çš„ï¼ˆåœ¨å‰ä¸€ç« å·²ç»åšäº†ä¸šåŠ¡ API æŠ½ç¦»ï¼‰ï¼Œå¹¶é€šè¿‡ @Service å‘å¤–éƒ¨æš´éœ²\n@Component @Service(interfaceClass = UserAPI.class) public class UserImpl implements UserAPI { @Override public boolean login(String username, String password) { System.out.println(\u0026#34;This is user service! \u0026#34; + username + \u0026#34;, \u0026#34; + password); return false; } } ç„¶åï¼Œåœ¨ guns-gateway ä¸­å°±å¯ä»¥è¿œç¨‹è°ƒç”¨ UserAPI æ¥å£äº†\n@Reference(interfaceClass = UserAPI.class) private UserAPI userAPI; userAPI.login(username, password); åŸºäº SpringBoot é…ç½®å¿½ç•¥åˆ—è¡¨ é…ç½® guns-gateway ç½‘å…³æ¨¡å—ä¸­çš„ application.ymlï¼Œåœ¨ jwt ä¸‹æ·»åŠ  ignore-url é…ç½®ï¼Œç”¨é€—å·åˆ†éš” urlï¼ˆæ³¨æ„ä¸èƒ½æœ‰ç©ºæ ¼ï¼ï¼‰ï¼Œè¿™äº›æ¥å£å°†ä¸é€šè¿‡ jwt éªŒè¯è¿‡æ»¤å™¨\njwt: header: Authorization #httpè¯·æ±‚å¤´æ‰€éœ€è¦çš„å­—æ®µ secret: mySecret #jwtç§˜é’¥ expiration: 604800 #7å¤© å•ä½:ç§’ auth-path: auth #è®¤è¯è¯·æ±‚çš„è·¯å¾„ md5-key: randomKey #md5åŠ å¯†æ··æ·†key ignore-url: /user/,/film/ #å¿½ç•¥åˆ—è¡¨ åœ¨ JwtProperties ä¸­æ·»åŠ ä¸€é¡¹æˆå‘˜å˜é‡ï¼Œå¹¶æ·»åŠ  getã€set å‡½æ•°ï¼Œè¿™ä¸ªç±»æ˜¯é…ç½®ç±»ï¼Œ@ConfigurationProperties(prefix = JwtProperties.JWT_PREFIX) è¡¨ç¤ºç”¨äºä»é…ç½®æ–‡ä»¶ application.yml ä¸­è·å– jwt å¼€å¤´çš„é…ç½®å˜é‡\n@Configuration @ConfigurationProperties(prefix = JwtProperties.JWT_PREFIX) public class JwtProperties { public static final String JWT_PREFIX = \u0026#34;jwt\u0026#34;; private String header = \u0026#34;Authorization\u0026#34;; private String secret = \u0026#34;defaultSecret\u0026#34;; private Long expiration = 604800L; private String authPath = \u0026#34;auth\u0026#34;; private String md5Key = \u0026#34;randomKey\u0026#34;; private String ignoreUrl = \u0026#34;\u0026#34;; åœ¨ AuthFilter çš„ doFilterInternal æ–¹æ³•ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œç”¨äºå¿½ç•¥é…ç½®åˆ—è¡¨\n// é…ç½®å¿½ç•¥åˆ—è¡¨ String ignoreUrl = jwtProperties.getIgnoreUrl(); String[] ignoreUrls = ignoreUrl.split(\u0026#34;,\u0026#34;); for (int i = 0; i \u0026lt; ignoreUrls.length; i++) { if (request.getServletPath().equals(ignoreUrls[i])) { chain.doFilter(request, response); return; } } ä¿®æ”¹ JWT ç”³è¯·çš„è¿”å›æŠ¥æ–‡ åœ¨ guns-gateway æ¨¡å—ä¸­çš„ modular.vo ä¸‹ï¼Œåˆ›å»º ResponseVO ç±»ä½œä¸ºå“åº”VOç±»ï¼Œå…¶ä¸­åŒ…å«äº†ä¸‰ç§çŠ¶æ€ Status ï¼š0-æˆåŠŸï¼Œ1-ä¸šåŠ¡å¤±è´¥ï¼Œ999-ç³»ç»Ÿå¼‚å¸¸\npublic class ResponseVO\u0026lt;M\u0026gt; { /** * è¿”å›çŠ¶æ€ [0-æˆåŠŸï¼Œ1-ä¸šåŠ¡å¤±è´¥ï¼Œ999-ç³»ç»Ÿå¼‚å¸¸] */ private Integer status; /** * è¿”å›ä¿¡æ¯ */ private String msg; /** * è¿”å›æ•°æ®å®ä½“ */ private M data; private ResponseVO() {} public static\u0026lt;M\u0026gt; ResponseVO success(M m) { ResponseVO responseVO = new ResponseVO(); responseVO.setStatus(0); responseVO.setData(m); return responseVO; } public static ResponseVO serviceFail(String msg) { ResponseVO responseVO = new ResponseVO(); responseVO.setStatus(1); responseVO.setMsg(msg); return responseVO; } public static ResponseVO appFail(String msg) { ResponseVO responseVO = new ResponseVO(); responseVO.setStatus(999); responseVO.setMsg(msg); return responseVO; } ä¹‹ååœ¨ AuthController ä¸­å°±å¯ä»¥ç”¨è¯¥ç±»ä½œä¸ºè¿”å›å¯¹è±¡äº†\n@RequestMapping(value = \u0026#34;${jwt.auth-path}\u0026#34;) public ResponseVO createAuthenticationToken(AuthRequest authRequest) { boolean validate = true; // å»æ‰gunsè‡ªèº«æºå¸¦çš„ç”¨æˆ·åå¯†ç éªŒè¯æœºåˆ¶ï¼Œä½¿ç”¨è‡ªå·±çš„ int userId = userAPI.login(authRequest.getUserName(), authRequest.getPassword()); if (userId == 0) { validate = false; } if (validate) { // randomKeyå’Œtokenå·²ç»ç”Ÿæˆå®Œæ¯• final String randomKey = jwtTokenUtil.getRandomKey(); final String token = jwtTokenUtil.generateToken(\u0026#34;\u0026#34; + userId, randomKey); // è¿”å›å€¼ return ResponseVO.success(new AuthResponse(token, randomKey)); } else { return ResponseVO.serviceFail(\u0026#34;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯\u0026#34;); } } å¢åŠ  Threadlocal çš„ç”¨æˆ·ä¿¡æ¯ä¿å­˜ åœ¨ guns-gateway ä¸­çš„ common ä¸‹åˆ›å»º CurrentUser ç±»ç”¨äºä¿å­˜ userIdï¼ˆä¸ç›´æ¥ä¿å­˜ userInfoModel æ˜¯å› ä¸ºæ›´çœç©ºé—´ï¼Œé¿å…ç”¨æˆ·é‡å¤§æ—¶å‡ºç°å†…å­˜æº¢å‡ºï¼‰ï¼Œè¯¥ userId å­˜åœ¨ ThreadLocal ä¸­å’Œçº¿ç¨‹ç»‘å®šï¼ŒåŒä¸€çº¿ç¨‹å†…å…±äº«\npublic class CurrentUser { /** * çº¿ç¨‹ç»‘å®šçš„å­˜å‚¨ç©ºé—´ */ private static final ThreadLocal\u0026lt;String\u0026gt; threadLocal = new ThreadLocal\u0026lt;\u0026gt;(); public static void saveUserId(String userId) { threadLocal.set(userId); } public static String getCurrentUser() { return threadLocal.get(); } } ä¹‹åï¼Œåœ¨ AuthFilter éªŒè¯ token æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡ token è·å– userIDï¼Œå¹¶ä¸”å°†ä¹‹å­˜å…¥ ThreadLocalï¼Œä»¥ä¾¿åç»­ä¸šåŠ¡è°ƒç”¨äº†\nString userId = jwtTokenUtil.getUsernameFromToken(authToken); if (userId == null) { return; } else { CurrentUser.saveUserId(userId); } åœ¨ç”¨æˆ·åç»­è®¿é—®æ—¶ï¼Œå°±å¯ä»¥å–å‡º userIdï¼Œå¹¶ä»æ•°æ®åº“æˆ– redis ä¸­è·å–ç”¨æˆ·ä¿¡æ¯äº†\n@Controller @RequestMapping(\u0026#34;/hello\u0026#34;) public class ExampleController { @RequestMapping(\u0026#34;\u0026#34;) public ResponseEntity hello() { System.out.println(CurrentUser.getCurrentUser()); // è¿™é‡Œå°†ä»¥userIdä¸ºkeyï¼ŒuserInfoä¸ºvalueå­˜åœ¨redisä¸­ï¼ŒTTLä¸º30åˆ†é’Ÿ // æˆ–ä»¥userIdä¸ºæ¡ä»¶å»æ•°æ®åº“å–å‡ºï¼ˆå’Œredisåªæœ‰å¿«æ…¢çš„åŒºåˆ«ï¼‰ return ResponseEntity.ok(\u0026#34;è¯·æ±‚æˆåŠŸ!\u0026#34;); } } ç”¨æˆ·æ¨¡å—å¼€å‘ ä¸šåŠ¡åŠŸèƒ½å¼€å‘æµç¨‹ ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ç”Ÿæˆæ•°æ®é¡¹ åœ¨æ¯ä¸ª guns æ¨¡å—çš„ test ä¸‹ï¼Œéƒ½æœ‰ enerator.EntityGenerator è¿™ä¸ªç”¨äºå®ä½“ç”Ÿæˆçš„ç±»ï¼Œåªéœ€æ ¹æ®éœ€è¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹æ–¹æ³•çš„å‚æ•°å³å¯ã€‚åœ¨ guns-user æ¨¡å—ä¸­ç”Ÿæˆå³å¯å¾—åˆ°ï¼šUserT, UserTMapper, UserTMapper.xml\n... // ç”Ÿæˆä»£ç çš„ç»å¯¹ç›®å½• gc.setOutputDir(\u0026#34;/Users/zjxjwxk/Documents/GitHub/Cinema-Dubbo/guns-user/src/main/java\u0026#34;); ... // ä½œè€…ä¿¡æ¯ gc.setAuthor(\u0026#34;zjxjwxk\u0026#34;); ... // æ•°æ®åº“è¿æ¥é…ç½® dsc.setUsername(\u0026#34;root\u0026#34;); dsc.setPassword(\u0026#34;19981018\u0026#34;); dsc.setUrl(\u0026#34;jdbc:mysql://127.0.0.1:3306/guns_rest?autoReconnect=true\u0026amp;useUnicode=true\u0026amp;characterEncoding=utf8\u0026amp;serverTimezone=GMT%2B8\u0026#34;); ... // æ•°æ®åº“è¡¨å‰ç¼€ strategy.setInclude(new String[]{\u0026#34;user_t\u0026#34;}); ... // ç”Ÿæˆ Entityã€Mapperã€XML çš„åŒ…çš„ç›¸å¯¹ç›®å½• pc.setEntity(\u0026#34;com.stylefeng.guns.rest.common.persistence.model\u0026#34;); pc.setMapper(\u0026#34;com.stylefeng.guns.rest.common.persistence.dao\u0026#34;); pc.setXml(\u0026#34;com.stylefeng.guns.rest.common.persistence.dao.mapping\u0026#34;); ... æ­¤å¤„ç”Ÿæˆçš„å®ä½“ç±»å±äº guns-user æ¨¡å—ï¼Œç”¨äºå’Œæ•°æ®åº“æ‰“äº¤é“ã€‚ä»¥ä¸‹æ˜¯ guns-gateway æ¨¡å—å’Œ guns-user æ¨¡å—ä¸åŒçš„ä¸‰ç§ user ç±»ï¼ŒUserModel å’Œ UserInfoModel å±äº BOï¼Œè€Œ MoocUserT ï¼ˆå³UserTï¼‰ å±äº DOã€‚\nå®ç°ç›¸åº”çš„æ¥å£åŠŸèƒ½ åœ¨ guns-user æ¨¡å—çš„ UserServiceImpl ä¸­å®ç° UserAPI ï¼ˆåœ¨ guns-api ä¸­ï¼‰çš„æ¥å£ï¼Œå¦‚ï¼š\n@Component @Service(interfaceClass = UserAPI.class) public class UserServiceImpl implements UserAPI { @Autowired private UserTMapper userTMapper; @Override public boolean register(UserModel userModel) { ... } } åœ¨ guns-gateway æ¨¡å—çš„ UserController ä¸­å®ç°ç¼–å†™ç›¸åº” url å’Œæ§åˆ¶å±‚ä»£ç ï¼Œå¦‚ï¼š\n@RequestMapping(\u0026#34;/user/\u0026#34;) @RestController public class UserController { @Reference(interfaceClass = UserAPI.class) private UserAPI userAPI; @RequestMapping(name = \u0026#34;register\u0026#34;, method = RequestMethod.POST) public ResponseVO register(UserModel userModel) { ... } } Dubbo ç‰¹æ€§ å­˜åœ¨çš„é—®é¢˜ å¿…é¡»å…ˆå¯åŠ¨æœåŠ¡æä¾›è€…ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼ˆå¦‚ä¸‹ï¼‰ã€‚å¦‚æœæœ‰ä¸¤ä¸ªæœåŠ¡äº’ç›¸ä¾èµ–ï¼Œé‚£ä¹ˆä¸¤ä¸ªæœåŠ¡éƒ½æ— æ³•å¯åŠ¨æˆåŠŸã€‚ï¼ˆDubbo å¯åŠ¨æ£€æŸ¥ï¼‰ Caused by: java.lang.IllegalStateException: Failed to check the status of the service com.stylefeng.guns.api.user.UserAPI. No provider available for the service com.stylefeng.guns.api.user.UserAPI from the url zookeeper://localhost:2181/com.alibaba.dubbo.registry.RegistryService?application=cinema-gateway\u0026amp;dubbo=2.6.0\u0026amp;interface=com.stylefeng.guns.api.user.UserAPI\u0026amp;methods=updateUserInfo,checkUserName,getUserInfo,login,register\u0026amp;pid=10451\u0026amp;register.ip=192.168.6.102\u0026amp;side=consumer\u0026amp;timestamp=1584633672918 to the consumer 192.168.6.102 use dubbo version 2.6.0 å¦‚æœæˆ‘ä»¬å°†ç”¨æˆ·æ¨¡å—éƒ¨ç½²å¤šå°ï¼Œæ¶ˆè´¹è€…ä¼šå¦‚ä½•è®¿é—®ï¼Ÿï¼ˆDubbo è´Ÿè½½å‡è¡¡ï¼‰ spring: dubbo: ä¸­çš„ protocol å±æ€§æ˜¯åšä»€ä¹ˆçš„ï¼Ÿï¼ˆDubbo å¤šåè®®æ”¯æŒï¼‰ Dubbo å¯åŠ¨æ£€æŸ¥ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/preflight-check.html\næœåŠ¡å¯åŠ¨è¿‡ç¨‹ä¸­éªŒè¯æœåŠ¡æä¾›è€…çš„å¯ç”¨æ€§ éªŒè¯è¿‡ç¨‹å‡ºç°é—®é¢˜ï¼Œåˆ™é˜»æ­¢æ•´ä¸ª Spring å®¹å™¨åˆå§‹åŒ– æœåŠ¡å¯åŠ¨æ£€æŸ¥å¯ä»¥å°½å¯èƒ½æ—©çš„å‘ç°æœåŠ¡é—®é¢˜ Dubbo é»˜è®¤æ‰“å¼€äº†å¯åŠ¨æ£€æŸ¥ï¼Œæ¯ä¸ªæ¥å£çš„ @Reference æ³¨è§£éƒ½é»˜è®¤ check = trueï¼Œå¦‚æœç¡®å®æƒ³å–æ¶ˆå¯åŠ¨æ£€æŸ¥ï¼Œåªéœ€åœ¨æ¯ä¸ªæ¶ˆè´¹è€…æ‰€å¼•ç”¨çš„æ¥å£çš„ @Reference æ³¨è§£åæ‰‹åŠ¨è®¾ç½® check = false å³å¯ï¼ˆä½†æ˜¯å¹¶ä¸æ¨èï¼‰ã€‚å…³é—­å¯åŠ¨æ£€æŸ¥åï¼Œæ— è®ºæ‰€è°ƒç”¨æ¥å£çš„æœåŠ¡æœ‰æ²¡æœ‰å¯åŠ¨ï¼Œéƒ½èƒ½å¤Ÿæ­£å¸¸å¯åŠ¨ã€‚ä½†å¦‚æœå…¶è°ƒç”¨æ²¡æœ‰å¯åŠ¨çš„æœåŠ¡ï¼Œå°†ä¼šæŠ¥ä»¥ä¸‹é”™è¯¯ï¼š\ncom.alibaba.dubbo.rpc.RpcException: No provider available from registry localhost:2181 for service com.stylefeng.guns.api.user.UserAPI on consumer 192.168.6.102 use dubbo version 2.6.0, may be providers disabled or not registered ? Dubbo è´Ÿè½½å‡è¡¡ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/loadbalance.html\nåœ¨é›†ç¾¤è´Ÿè½½å‡è¡¡æ—¶ï¼ŒDubbo æä¾›äº†å¤šç§å‡è¡¡ç­–ç•¥ï¼Œç¼ºçœä¸º random éšæœºè°ƒç”¨ã€‚\nè´Ÿè½½å‡è¡¡ç­–ç•¥ ç­–ç•¥åç§° ç­–ç•¥æè¿° Random éšæœºï¼ŒæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ RoundRobin è½®è¯¢ï¼ŒæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®è¯¢æ¯”ç‡ LeastActive æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·® ConsistentHash ä¸€è‡´æ€§ Hashï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°åŒä¸€æä¾›è€… é…ç½® æœåŠ¡ç«¯æœåŠ¡çº§åˆ« \u0026lt;dubbo:service interface=\u0026#34;...\u0026#34; loadbalance=\u0026#34;roundrobin\u0026#34;/\u0026gt; å®¢æˆ·ç«¯æœåŠ¡çº§åˆ« \u0026lt;dubbo:reference interface=\u0026#34;...\u0026#34; loadbalance=\u0026#34;roundrobin\u0026#34; /\u0026gt; æœåŠ¡ç«¯æ–¹æ³•çº§åˆ« \u0026lt;dubbo:service interface=\u0026#34;...\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;...\u0026#34; loadbalance=\u0026#34;roundrobin\u0026#34;/\u0026gt; \u0026lt;/dubbo:service\u0026gt; å®¢æˆ·ç«¯æ–¹æ³•çº§åˆ« \u0026lt;dubbo:reference interface=\u0026#34;...\u0026#34;\u0026gt; \u0026lt;dubbo:method name=\u0026#34;...\u0026#34; loadbalance=\u0026#34;roundrobin\u0026#34;/\u0026gt; \u0026lt;/dubbo:reference\u0026gt; Dubbo å¤šåè®®æ”¯æŒ å®˜æ–¹æ–‡æ¡£ï¼šhttps://dubbo.apache.org/zh-cn/docs/user/demos/multi-protocols.html\nå¤šåè®®æ”¯æ’‘ Dubbo æ”¯æŒå¤šç§åè®® æœ€å¸¸è§çš„åè®®æ˜¯ dubbo RMIã€Hessianã€HTTPã€Redisã€Memcached ç­‰å¤šç§åè®® åè®®å¯¹æ¯” ç‰¹æ€§å¯¹æ¯” dubbo RMI Hessian è¿æ¥æ•° å•è¿æ¥ å¤šè¿æ¥ å¤šè¿æ¥ è¿æ¥æ–¹å¼ é•¿è¿æ¥ çŸ­è¿æ¥ çŸ­è¿æ¥ ä¼ è¾“åè®® TCP ä¼ è¾“ åŒæ­¥ä¼ è¾“ åŒæ­¥ä¼ è¾“ ä¼ è¾“æ–¹å¼ NIO å¼‚æ­¥ä¼ è¾“ åŒæ­¥ä¼ è¾“ åŒæ­¥ä¼ è¾“ é€‚ç”¨åœºæ™¯ 1. æ•°æ®åŒ…è¾ƒå°2. æ¶ˆè´¹è€…ä¸ªæ•°å¤š3. å¸¸è§„æ–¹å¼ 1. æ•°æ®åŒ…å¤§å°ä¸ä¸€2. æ¶ˆè´¹è€…å’Œæä¾›è€…æ•°é‡ç›¸å·®ä¸å¤§ 1. æ•°æ®åŒ…å¤§å°ä¸ä¸€2. æ¶ˆè´¹è€…å’Œæä¾›è€…æ•°é‡ç›¸å·®ä¸å¤§ æ€»ç»“ API ç½‘å…³ä¸æœåŠ¡æ¨¡å—è°ƒç”¨æ–¹å¼ï¼ˆAPI ç½‘å…³ç›¸å½“äºæœåŠ¡æ¶ˆè´¹è€…ï¼ŒæœåŠ¡æ¨¡å—ç›¸å½“äºæœåŠ¡æä¾›è€…ï¼‰ Dubbo ç‰¹æ€§ï¼šè´Ÿè½½å‡è¡¡ã€å¯åŠ¨æ£€æŸ¥ã€Dubbo åè®® JWT çš„ä¸šåŠ¡åº”ç”¨ ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/5.dubbo%E5%9F%BA%E6%9C%AC%E7%89%B9%E6%80%A7%E7%94%A8%E6%88%B7%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91/","summary":"\u003ch1 id=\"ç« èŠ‚æ¦‚è¦\"\u003eç« èŠ‚æ¦‚è¦\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eå­¦ä¼š API ç½‘å…³æƒé™éªŒè¯å’Œå…¶ä»–æœåŠ¡äº¤äº’\u003c/li\u003e\n\u003cli\u003eå­¦ä¼šå¼€å‘ SpringBoot çš„è‡ªå®šä¹‰é…ç½®\u003c/li\u003e\n\u003cli\u003eå­¦ä¼š Dubbo è´Ÿè½½å‡è¡¡ç­–ç•¥é€‰æ‹©å’Œä½¿ç”¨\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ä¿®æ”¹-guns-ä¸­çš„-jwt-æ¨¡å—\"\u003eä¿®æ”¹ Guns ä¸­çš„ JWT æ¨¡å—\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eå¢åŠ å¿½ç•¥éªŒè¯ URL é…ç½®\u003c/li\u003e\n\u003cli\u003eä¿®æ”¹è¿”å›å†…å®¹åŒ¹é…ä¸šåŠ¡\u003c/li\u003e\n\u003cli\u003eå¢åŠ  Threadlocal çš„ç”¨æˆ·ä¿¡æ¯ä¿å­˜\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ä¸šåŠ¡åŠŸèƒ½å¼€å‘\"\u003eä¸šåŠ¡åŠŸèƒ½å¼€å‘\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eå¢åŠ ç”¨æˆ·æœåŠ¡å¹¶æä¾›æ¥å£\u003c/li\u003e\n\u003cli\u003eåˆæ­¥äº†è§£ API ç½‘å…³ä¸æœåŠ¡ä¹‹é—´äº¤äº’çš„è¿‡ç¨‹\u003c/li\u003e\n\u003cli\u003eæ ¹æ®æ¥å£æ–‡æ¡£å¼€å‘ç”¨æˆ·æ¥å£\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"åˆ›å»ºç”¨æˆ·è¡¨\"\u003eåˆ›å»ºç”¨æˆ·è¡¨\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eDROP\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eIF\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eEXISTS\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   UUID INT \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e AUTO_INCREMENT \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ä¸»é”®ç¼–å·\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   user_name VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç”¨æˆ·è´¦å·\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   user_pwd VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç”¨æˆ·å¯†ç \u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   nick_name VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç”¨æˆ·æ˜µç§°\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   user_sex INT \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç”¨æˆ·æ€§åˆ« 0-ç”·ï¼Œ1-å¥³\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   birthday VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;å‡ºç”Ÿæ—¥æœŸ\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   email VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç”¨æˆ·é‚®ç®±\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   user_phone VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç”¨æˆ·æ‰‹æœºå·\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   address VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç”¨æˆ·ä½å€\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   head_url VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;å¤´åƒURL\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   biography VARCHAR(\u003cspan style=\"color:#ae81ff\"\u003e200\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ä¸ªäººä»‹ç»\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   life_state INT \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç”Ÿæ´»çŠ¶æ€ 0-å•èº«ï¼Œ1-çƒ­æ‹ä¸­ï¼Œ2-å·²å©šï¼Œ3-ä¸ºäººçˆ¶æ¯\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   begin_time \u003cspan style=\"color:#66d9ef\"\u003eTIMESTAMP\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eCURRENT_TIMESTAMP\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;åˆ›å»ºæ—¶é—´\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e   update_time \u003cspan style=\"color:#66d9ef\"\u003eTIMESTAMP\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eCURRENT_TIMESTAMP\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eON\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eUPDATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eCURRENT_TIMESTAMP\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ä¿®æ”¹æ—¶é—´\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) \u003cspan style=\"color:#66d9ef\"\u003eCOMMENT\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç”¨æˆ·è¡¨\u0026#39;\u003c/span\u003e ENGINE \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e INNODB AUTO_INCREMENT \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e utf8 \u003cspan style=\"color:#66d9ef\"\u003eCOLLATE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e utf8_general_ci ROW_FORMAT \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eDYNAMIC\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003einsert\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einto\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e(user_name,user_pwd,nick_name,user_sex,birthday,email,user_phone,address,head_url,life_state,biography) \u003cspan style=\"color:#66d9ef\"\u003evalues\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;admin\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;0192023a7bbd73250516f069df18b500\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ç®¡ç†å‘˜\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;2018-07-31\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;admin@gmail.com\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;13888888888\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;æµ™æ±Ÿçœæ­å·å¸‚è¥¿æ¹–åŒºæŸè·¯æŸå·\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cinema/img/head-img.jpg\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;æˆ‘æ˜¯è‹¦é€¼çš„ç®¡ç†å‘˜\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003einsert\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003einto\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e(user_name,user_pwd,nick_name,user_sex,birthday,email,user_phone,address,head_url,life_state,biography) \u003cspan style=\"color:#66d9ef\"\u003evalues\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;test\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;5e2de6bd1c9b50f6e27d4e55da43b917\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;æµ‹è¯•ç”¨æˆ·\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;2018-08-20\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;test@gmail.com\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;13866666666\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;æµ‹è¯•åœ°å€\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cinema/img/head-img.jpg\u0026#39;\u003c/span\u003e,\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;æˆ‘æ˜¯æµ‹è¯•ç”¨æˆ·\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch1 id=\"ç”¨æˆ·æœåŠ¡ä¸ç½‘å…³äº¤äº’\"\u003eç”¨æˆ·æœåŠ¡ä¸ç½‘å…³äº¤äº’\u003c/h1\u003e\n\u003cp\u003eåœ¨ guns é¡¹ç›®ä¸­å¤åˆ¶ä¸€ä»½ guns-gateway æ¨¡å—å¹¶é‡å‘½åä¸º guns-userï¼ˆä¿®æ”¹ç›¸åº”å­æ¨¡å—å’Œä¸»æ¨¡å—çš„ pom.xml ç­‰ï¼‰ï¼Œå¹¶åœ¨ application.yml ä¸­å°†å…¶é‰´æƒæœºåˆ¶ç­‰å…³é—­ï¼ˆç½‘å…³æ‰éœ€è¦ï¼‰\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ5ï¼‰ï¼šDubboåŸºæœ¬ç‰¹æ€§ï¼ˆç”¨æˆ·æ¨¡å—å¼€å‘ï¼‰"},{"content":"ç« èŠ‚æ¦‚è¦ æ„å»ºåŸºäº Guns + SpringBoot + Dubbo çš„æ¡†æ¶ å­¦ä¼šæŠ½ç¦»ä¸šåŠ¡æ¥å£ å­¦ä¼š API ç½‘å…³å˜å½¢åº”ç”¨ API ç½‘å…³ä»‹ç» API ç½‘å…³æœ‰ç‚¹ç±»ä¼¼äºè®¾è®¡æ¨¡å¼ä¸­çš„ Facade æ¨¡å¼ API ç½‘å…³ä¸€èˆ¬éƒ½æ˜¯å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„é—¨é¢ API ç½‘å…³æ˜¯å¾®æœåŠ¡çš„é‡è¦ç»„æˆéƒ¨åˆ† API ç½‘å…³çš„å¸¸è§ä½œç”¨ èº«ä»½éªŒè¯å’Œå®‰å…¨ å®¡æŸ¥å’Œæ£€æµ‹ åŠ¨æ€è·¯ç”± å‹åŠ›æµ‹è¯• è´Ÿè½½å‡è¡¡ï¼ˆDubbo è‡ªå¸¦ï¼‰ é™æ€ç›¸åº”å¤„ç† Guns ç¯å¢ƒæ„å»º å¯¼å…¥ guns é¡¹ç›® åˆ›å»º guns_rest æ•°æ®åº“ åˆ›å»º user è¡¨ -- ---------------------------- -- Table structure for user -- ---------------------------- DROP TABLE IF EXISTS `user`; CREATE TABLE `user` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `userName` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL, PRIMARY KEY (`id`) USING BTREE ) ENGINE = InnoDB AUTO_INCREMENT = 2 CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic; -- ---------------------------- -- Records of user -- ---------------------------- INSERT INTO `user` VALUES (1, \u0026#39;admin\u0026#39;); SET FOREIGN_KEY_CHECKS = 1; æ·»åŠ  log4j ä¾èµ– \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;log4j\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;log4j\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.17\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; ä¿®æ”¹ datasource çš„ url ä¿®æ”¹ application.yml ä¸­ spring çš„ datasource çš„ url ä¸º\nurl: jdbc:mysql://127.0.0.1:3306/guns_rest?autoReconnect=true\u0026amp;useUnicode=true\u0026amp;characterEncoding=utf8\u0026amp;serverTimezone=GMT%2B8 éªŒè¯ç¯å¢ƒ å¯åŠ¨ GunsRestApplicationï¼Œè®¿é—® url http://localhost/auth?userName=admin\u0026amp;password=adminï¼Œè‹¥è¿”å›å¦‚ä¸‹ token åˆ™ç¯å¢ƒæ­å»ºæˆåŠŸã€‚\n{ \u0026#34;randomKey\u0026#34;: \u0026#34;zd8rb8\u0026#34;, \u0026#34;token\u0026#34;: \u0026#34;eyJhbGciOiJIUzUxMiJ9.eyJyYW5kb21LZXkiOiJ6ZDhyYjgiLCJzdWIiOiJhZG1pbiIsImV4cCI6MTU4NDM2MjkxOCwiaWF0IjoxNTgzNzU4MTE4fQ.mR7Elro8oK8T2Rx6FE02FWTvORJnUAcFfPka4-KbQYsSpoMQQl5iUgd-wd9wYIw_5wbXpn3TFoii72suPn0b4A\u0026#34; } API ç½‘å…³æ¨¡å—æ„å»ºæµ‹è¯• åœ¨ guns é¡¹ç›®ä¸­å¤åˆ¶ä¸€ä»½ guns-rest æ¨¡å—å¹¶é‡å‘½åä¸º guns-gatewayï¼Œåœ¨ä¸»æ¨¡å— pom.xml ä¸­æ·»åŠ  guns-gateway\n\u0026lt;modules\u0026gt; \u0026lt;module\u0026gt;guns-admin\u0026lt;/module\u0026gt; \u0026lt;module\u0026gt;guns-core\u0026lt;/module\u0026gt; \u0026lt;module\u0026gt;guns-rest\u0026lt;/module\u0026gt; \u0026lt;module\u0026gt;guns-generator\u0026lt;/module\u0026gt; \u0026lt;module\u0026gt;guns-gateway\u0026lt;/module\u0026gt; \u0026lt;/modules\u0026gt; ä¿®æ”¹å…¶ pom.xml ä¸­æœ‰å…³åç§°ä¸º guns-gatewayï¼Œå¹¶åœ¨ Project Structure ä¸­å°†è¯¥æ¨¡å—é‡å‘½åä¸º guns-gatewayï¼ŒåŒæ—¶åˆ é™¤åŸæ¥ guns-rest ä¸­å¤šä½™çš„ Content Rootï¼ˆä» guns-gateway åŠ å…¥çš„ï¼‰\nè¿™æ · guns-gateway å°±æ„å»ºå¥½äº†ï¼ˆæµ‹è¯•åŒ guns-restï¼‰ã€‚\nAPI ç½‘å…³é›†æˆ Dubbo åœ¨ guns-gateway é¡¹ç›®çš„ pom.xml æ–‡ä»¶ä¸­æ·»åŠ  Dubbo å’Œ ZooKeeper çš„ä¾èµ–\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba.spring.boot\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;dubbo-spring-boot-starter\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.0.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.101tec\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zkclient\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.10\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; åœ¨ application.yml ä¸­æ·»åŠ \nspring: application: name: cinema-gateway dubbo: server: true registry: zookeeper://localhost:2181 åœ¨ Application ç±»ä¸Šæ·»åŠ æ³¨è§£ @EnableDubboConfiguration åœ¨ Service å®ç°ç±»ä¸Šæ·»åŠ æ³¨è§£ @Component å’Œ @Service(interfaceClass = UserAPI.class)ï¼Œå…¶ä¸­ @Service æ¥è‡ªDubbo æŠ½ç¦»ä¸šåŠ¡ API åœ¨ guns é¡¹ç›®ä¸­å¤åˆ¶ä¸€ä»½ guns-core æ¨¡å—å¹¶é‡å‘½åä¸º guns-api ä¿®æ”¹å…¶ pom.xml ä¸­å„åç§°åï¼Œåˆ é™¤å…¶æ‰€æœ‰ä¾èµ– åˆ é™¤æ‰€æœ‰ java ä¸‹æ‰€æœ‰åŒ…ï¼Œåˆ›å»º api åŒ…ï¼Œå…¶ä¸­å¯åˆ›å»ºå…¬ç”¨æ¥å£ç±» ä½¿ç”¨ Maven çš„ install æŒ‡ä»¤å°†å…¶æ”¾å…¥åº“ä¸­ åœ¨ä¸»æ¨¡å—çš„ pom.xml ä¸­æ·»åŠ ä¾èµ– \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.stylefeng\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;guns-api\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;${guns.version}\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; åœ¨ guns-gateway çš„ pom.xml ä¸­æ·»åŠ ä¾èµ– \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.stylefeng\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;guns-api\u0026lt;/artifactId\u0026gt; \u0026lt;/dependency\u0026gt; ä¹‹åï¼Œå°±å¯ä»¥åœ¨ guns-gateway æ¨¡å—ä¸­ï¼Œå¼•å…¥ guns-api ä¸­çš„æ¥å£æ¥ä½¿ç”¨äº†ã€‚è¿™æ ·æ¥å£ç±»åªéœ€è¦åœ¨ guns-api ä¸­å†™ä¸€ä»½å°±å¤Ÿäº†ï¼Œé¿å…äº†å†—ä½™ï¼Œè¾¾åˆ°äº†æŠ½ç¦»ä¸šåŠ¡ API çš„æ•ˆæœã€‚\n","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/4.%E4%B8%9A%E5%8A%A1%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E6%9E%84%E5%BB%BA/","summary":"\u003ch1 id=\"ç« èŠ‚æ¦‚è¦\"\u003eç« èŠ‚æ¦‚è¦\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eæ„å»ºåŸºäº Guns + SpringBoot + Dubbo çš„æ¡†æ¶\u003c/li\u003e\n\u003cli\u003eå­¦ä¼šæŠ½ç¦»ä¸šåŠ¡æ¥å£\u003c/li\u003e\n\u003cli\u003eå­¦ä¼š API ç½‘å…³å˜å½¢åº”ç”¨\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"api-ç½‘å…³ä»‹ç»\"\u003eAPI ç½‘å…³ä»‹ç»\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eAPI ç½‘å…³æœ‰ç‚¹ç±»ä¼¼äºè®¾è®¡æ¨¡å¼ä¸­çš„ Facade æ¨¡å¼\u003c/li\u003e\n\u003cli\u003eAPI ç½‘å…³ä¸€èˆ¬éƒ½æ˜¯å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„é—¨é¢\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAPI  ç½‘å…³æ˜¯å¾®æœåŠ¡çš„é‡è¦ç»„æˆéƒ¨åˆ†\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg alt=\"APIç½‘å…³ç¤ºæ„å›¾\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/4.%E4%B8%9A%E5%8A%A1%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E6%9E%84%E5%BB%BA/images/image-20200309195624129.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"api-ç½‘å…³çš„å¸¸è§ä½œç”¨\"\u003eAPI ç½‘å…³çš„å¸¸è§ä½œç”¨\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eèº«ä»½éªŒè¯å’Œå®‰å…¨\u003c/li\u003e\n\u003cli\u003eå®¡æŸ¥å’Œæ£€æµ‹\u003c/li\u003e\n\u003cli\u003eåŠ¨æ€è·¯ç”±\u003c/li\u003e\n\u003cli\u003eå‹åŠ›æµ‹è¯•\u003c/li\u003e\n\u003cli\u003eè´Ÿè½½å‡è¡¡ï¼ˆDubbo è‡ªå¸¦ï¼‰\u003c/li\u003e\n\u003cli\u003eé™æ€ç›¸åº”å¤„ç†\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg alt=\"APIç½‘å…³ä½œç”¨\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/4.%E4%B8%9A%E5%8A%A1%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E6%9E%84%E5%BB%BA/images/image-20200309200432132.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"guns-ç¯å¢ƒæ„å»º\"\u003eGuns ç¯å¢ƒæ„å»º\u003c/h1\u003e\n\u003ch2 id=\"å¯¼å…¥-guns-é¡¹ç›®\"\u003eå¯¼å…¥ guns é¡¹ç›®\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"gunsé¡¹ç›®ç»“æ„\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/4.%E4%B8%9A%E5%8A%A1%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E6%9E%84%E5%BB%BA/images/image-20200309203515871.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"åˆ›å»º-guns_rest-æ•°æ®åº“\"\u003eåˆ›å»º guns_rest æ•°æ®åº“\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"guns_restæ•°æ®åº“\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/4.%E4%B8%9A%E5%8A%A1%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E6%9E%84%E5%BB%BA/images/image-20200309203649262.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"åˆ›å»º-user-è¡¨\"\u003eåˆ›å»º user è¡¨\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- ----------------------------\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- Table structure for user\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- ----------------------------\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eDROP\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eIF\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eEXISTS\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eCREATE\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTABLE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e  (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eid\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e bigint(\u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eNOT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e AUTO_INCREMENT,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003euserName\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e varchar(\u003cspan style=\"color:#ae81ff\"\u003e255\u003c/span\u003e) CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e utf8 \u003cspan style=\"color:#66d9ef\"\u003eCOLLATE\u003c/span\u003e utf8_general_ci \u003cspan style=\"color:#66d9ef\"\u003eDEFAULT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eNULL\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#66d9ef\"\u003ePRIMARY\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eKEY\u003c/span\u003e (\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003eid\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eUSING\u003c/span\u003e BTREE\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e) ENGINE \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e InnoDB AUTO_INCREMENT \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e CHARACTER \u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e utf8 \u003cspan style=\"color:#66d9ef\"\u003eCOLLATE\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e utf8_general_ci ROW_FORMAT \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eDynamic\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- ----------------------------\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- Records of user\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e-- ----------------------------\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eINSERT\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eINTO\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e`\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eVALUES\u003c/span\u003e (\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;admin\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003eSET\u003c/span\u003e FOREIGN_KEY_CHECKS \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"æ·»åŠ -log4j-ä¾èµ–\"\u003eæ·»åŠ  log4j ä¾èµ–\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003elog4j\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003elog4j\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e1.2.17\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"ä¿®æ”¹-datasource-çš„-url\"\u003eä¿®æ”¹ datasource çš„ url\u003c/h2\u003e\n\u003cp\u003eä¿®æ”¹ application.yml ä¸­ spring çš„ datasource çš„ url ä¸º\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ4ï¼‰ï¼šä¸šåŠ¡åŸºç¡€ç¯å¢ƒæ„å»º"},{"content":"åŸºç¡€ç¯å¢ƒæ­å»º åŸºäºGuns + SpringBoot + Dubboæ„å»ºå½±é™¢å¹³å° Spring + Dubbo SpringBoot + Dubbo å¾®æœåŠ¡åŸºæœ¬æ¦‚å¿µ Providerï¼šæœåŠ¡æä¾›è€… Consumerï¼šæœåŠ¡è°ƒç”¨è€…ï¼Œè°ƒç”¨ Provider æä¾›çš„æœåŠ¡å®ç° åŒä¸€ä¸ªæœåŠ¡å¯ä»¥å³æ˜¯ Providerï¼Œåˆæ˜¯ Consumer ä»¥ä¸‹å¯ä»¥é€‰ç”¨ Spring æˆ– SpringBoot\nSpringåŸºç¡€ç¯å¢ƒæ„å»º é¡¹ç›®ç»“æ„ ä¸»æ¨¡å—ï¼ˆSpring-Dubbo-Demoï¼‰ åœ¨ pom.xml ä¸­æ·»åŠ  dependencies\n\u0026lt;dependencies\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.101tec\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zkclient\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.9\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.apache.zookeeper\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zookeeper\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.4.9\u0026lt;/version\u0026gt; \u0026lt;type\u0026gt;pom\u0026lt;/type\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;dubbo\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.5.3\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;io.netty\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;netty-all\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.1.6.Final\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;commons-logging\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;commons-logging\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.javassist\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;javassist\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.21.0-GA\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;log4j\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;log4j\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.17\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;!-- springç›¸å…³jar --\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-context\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.3.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-context-support\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.3.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-core\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.3.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-beans\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.3.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-aop\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.3.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-aspects\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.3.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;org.springframework\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;spring-expression\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.3.3.RELEASE\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;junit\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;junit\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;4.12\u0026lt;/version\u0026gt; \u0026lt;scope\u0026gt;test\u0026lt;/scope\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;/dependencies\u0026gt; å­æ¨¡å—ï¼ˆproviderã€consumerï¼‰ åœ¨ resources ä¸­æ·»åŠ  applicationContext.xmlï¼ˆå¯æ›´æ”¹åç¼€ï¼‰\n\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;beans xmlns=\u0026#34;http://www.springframework.org/schema/beans\u0026#34; xmlns:xsi=\u0026#34;http://www.w3.org/2001/XMLSchema-instance\u0026#34; xmlns:context=\u0026#34;http://www.springframework.org/schema/context\u0026#34; xmlns:aop=\u0026#34;http://www.springframework.org/schema/aop\u0026#34; xmlns:tx=\u0026#34;http://www.springframework.org/schema/tx\u0026#34; xmlns:dubbo=\u0026#34;http://code.alibabatech.com/schema/dubbo\u0026#34; xsi:schemaLocation=\u0026#34; http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd \u0026#34; \u0026gt; \u0026lt;/beans\u0026gt; Springçš„ç›´è¿æä¾›è€… provider applicationContext-hello-provider.xml é…ç½®\n\u0026lt;dubbo:application name=\u0026#34;hello-world-app\u0026#34; /\u0026gt; \u0026lt;dubbo:protocol name=\u0026#34;dubbo\u0026#34; port=\u0026#34;20880\u0026#34; /\u0026gt; \u0026lt;bean id=\u0026#34;quickStartService\u0026#34; class=\u0026#34;com.zjut.zjxjwxk.dubbo.quickstart.QuickStartServiceImpl\u0026#34;\u0026gt;\u0026lt;/bean\u0026gt; \u0026lt;dubbo:service registry=\u0026#34;N/A\u0026#34; interface=\u0026#34;com.zjut.zjxjwxk.dubbo.ServiceAPI\u0026#34; ref=\u0026#34;quickStartService\u0026#34; /\u0026gt; å¯åŠ¨ provider\npublic class ProviderClient { public static void main(String[] args) { ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(\u0026#34;applicationContext-hello-provider.xml\u0026#34;); context.start(); try { System.in.read(); } catch (IOException e) { e.printStackTrace(); } } } consumer consumer çš„ applicationContext-hello-consumer.xml é…ç½®\n\u0026lt;dubbo:application name=\u0026#34;consumer-of-hello-world-app\u0026#34; /\u0026gt; \u0026lt;dubbo:reference id=\u0026#34;consumerService\u0026#34; interface=\u0026#34;com.zjut.zjxjwxk.dubbo.ServiceAPI\u0026#34; url=\u0026#34;dubbo://localhost:20880\u0026#34; /\u0026gt; å¯åŠ¨ consumer å³å¯è·å–å’Œè°ƒç”¨ provider æä¾›çš„æ¥å£\npublic class ConsumerClient { public static void main(String[] args) { ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(\u0026#34;applicationContext-hello-consumer.xml\u0026#34;); context.start(); while (true) { Scanner scanner = new Scanner(System.in); String message = scanner.next(); // è·å–æ¥å£ ServiceAPI serviceAPI = (ServiceAPI) context.getBean(\u0026#34;consumerService\u0026#34;); System.out.println(serviceAPI.sendMessage(message)); } } } SpringBootåŸºç¡€ç¯å¢ƒæ„å»º é¡¹ç›®ç»“æ„ ä¸»æ¨¡å—ï¼ˆSpringBoot-Dubbo-Demoï¼‰ å­æ¨¡å—ï¼ˆconsumerã€providerï¼‰ provider é…ç½® application.properties spring.application.name=dubbo-spring-boot-starter spring.dubbo.server=true spring.dubbo.registry=N/A consumer é…ç½® application.properties spring.application.name=dubbo-spring-boot-starter SpringBootçš„ç›´è¿æä¾›è€… ç»™ provider å’Œ consumer çš„ Application éƒ½æ·»åŠ  @EnableDubboConfiguration æ³¨è§£ã€‚\nprovider ç»™å®ç°ç±»æ·»åŠ  @Component å’Œ @Service æ³¨è§£ï¼ˆæ¥è‡ªdubboçš„ï¼‰ @Service æŒ‡æ˜å®ç°æ¥å£çš„ Class @Component @Service(interfaceClass = ServiceAPI.class) public class QuickStartServiceImpl implements ServiceAPI { @Override public String sendMessage(String message) { return \u0026#34;quickstart-provider-message=\u0026#34; + message; } } consumer consumer å³å¯æ³¨å…¥å¹¶è°ƒç”¨æ¥å£ å£°æ˜çš„æ¥å£æ·»åŠ  @Reference æ³¨è§£å¹¶æ³¨æ˜ url ï¼ˆdubboé»˜è®¤åœ¨20880ç«¯å£ï¼‰ @Component public class QuickStartConsumer { @Reference(url = \u0026#34;dubbo://localhost:20880\u0026#34;) ServiceAPI serviceAPI; public void sendMessage(String message) { System.out.println(serviceAPI.sendMessage(message)); } } é¡¹ç›®ç»“æ„ æ³¨å†Œä¸­å¿ƒæ¦‚å¿µ ç›´è¿æä¾›è€… æ¶ˆè´¹ç«¯çŸ¥é“æœåŠ¡æä¾›è€…çš„åœ°å€ï¼Œç›´æ¥è¿›è¡Œè¿æ¥ è¯¥ç§æ–¹å¼ä¸€èˆ¬åªåœ¨æµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ ç›´è¿æä¾›è€…é™åˆ¶äº†åˆ†å¸ƒå¼çš„æ˜“æ‰©å±•æ€§ Dubboæ¶æ„ èŠ‚ç‚¹ è§’è‰²è¯´æ˜ Provider æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ Consumer è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ Registry æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒï¼Œé€šå¸¸ä½¿ç”¨ ZooKeeper Monitor ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒ Container æœåŠ¡è¿è¡Œå®¹å™¨ ZooKeeperå®‰è£…å’Œå¯åŠ¨ ä» Apache ZooKeeper å®˜ç½‘ä¸‹è½½ https://www.apache.org/dyn/closer.cgi/zookeeper åœ¨ conf ç›®å½•ä¸‹å°† zoo-sample.cfg æ”¹ä¸º zoo.cfg åœ¨ bin ç›®å½•ä¸‹å¯åŠ¨ zkServer.sh sh zkServer.sh start Springé›†æˆæ³¨å†Œä¸­å¿ƒ provider åœ¨ applicationContext-hello-provider.xml ä¸­æ·»åŠ æ³¨å†Œä¸­å¿ƒé…ç½®\n\u0026lt;dubbo:registry address=\u0026#34;zookeeper://localhost:2181\u0026#34;/\u0026gt; å»é™¤ service ä¸­çš„ registry å±æ€§\n\u0026lt;dubbo:service interface=\u0026#34;com.zjut.zjxjwxk.dubbo.ServiceAPI\u0026#34; ref=\u0026#34;quickStartService\u0026#34; /\u0026gt; \u0026lt;!--registry=\u0026#34;N/A\u0026#34;--\u0026gt; consumer åœ¨ applicationContext-hello-consumer.xml ä¸­æ·»åŠ æ³¨å†Œä¸­å¿ƒé…ç½®\n\u0026lt;dubbo:registry address=\u0026#34;zookeeper://localhost:2181\u0026#34;/\u0026gt; å»é™¤ reference ä¸­çš„ url å±æ€§ï¼ˆéç›´è¿ï¼Œè€Œæ˜¯é€šè¿‡ zookeeper æ³¨å†Œä¸­å¿ƒï¼‰\n\u0026lt;dubbo:reference id=\u0026#34;consumerService\u0026#34; interface=\u0026#34;com.zjut.zjxjwxk.dubbo.ServiceAPI\u0026#34; /\u0026gt; \u0026lt;!--url=\u0026#34;dubbo://localhost:20880\u0026#34;--\u0026gt; SpringBooté›†æˆæ³¨å†Œä¸­å¿ƒ provider åœ¨ pom.xml ä¸­æ·»åŠ  ZooKeeper ä¾èµ–\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.101tec\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zkclient\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.10\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; åœ¨ application.properties ä¸­æ·»åŠ æ³¨å†Œä¸­å¿ƒ\nspring.dubbo.registry=zookeeper://localhost:2181 consumer åœ¨ pom.xml ä¸­æ·»åŠ  ZooKeeper ä¾èµ–\n\u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.101tec\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;zkclient\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;0.10\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; åœ¨ application.properties ä¸­æ·»åŠ æ³¨å†Œä¸­å¿ƒ\nspring.dubbo.registry=zookeeper://localhost:2181 å»æ‰ @Reference æ‹¬å·ä¸­çš„ url ï¼ˆéç›´è¿ï¼Œè€Œæ˜¯é€šè¿‡ zookeeper æ³¨å†Œä¸­å¿ƒï¼‰\n@Reference ServiceAPI serviceAPI; ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/3.%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","summary":"\u003ch1 id=\"åŸºç¡€ç¯å¢ƒæ­å»º\"\u003eåŸºç¡€ç¯å¢ƒæ­å»º\u003c/h1\u003e\n\u003ch2 id=\"åŸºäºguns--springboot--dubboæ„å»ºå½±é™¢å¹³å°\"\u003eåŸºäºGuns + SpringBoot + Dubboæ„å»ºå½±é™¢å¹³å°\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eSpring + Dubbo\u003c/li\u003e\n\u003cli\u003eSpringBoot + Dubbo\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"å¾®æœåŠ¡åŸºæœ¬æ¦‚å¿µ\"\u003eå¾®æœåŠ¡åŸºæœ¬æ¦‚å¿µ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eProviderï¼šæœåŠ¡æä¾›è€…\u003c/li\u003e\n\u003cli\u003eConsumerï¼šæœåŠ¡è°ƒç”¨è€…ï¼Œè°ƒç”¨ Provider æä¾›çš„æœåŠ¡å®ç°\u003c/li\u003e\n\u003cli\u003eåŒä¸€ä¸ªæœåŠ¡å¯ä»¥å³æ˜¯ Providerï¼Œåˆæ˜¯ Consumer\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eä»¥ä¸‹å¯ä»¥é€‰ç”¨ Spring æˆ– SpringBoot\u003c/p\u003e\n\u003ch2 id=\"springåŸºç¡€ç¯å¢ƒæ„å»º\"\u003eSpringåŸºç¡€ç¯å¢ƒæ„å»º\u003c/h2\u003e\n\u003ch3 id=\"é¡¹ç›®ç»“æ„\"\u003eé¡¹ç›®ç»“æ„\u003c/h3\u003e\n\u003cp\u003e\u003cimg alt=\"SpringåŸºç¡€ç¯å¢ƒé¡¹ç›®ç»“æ„\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/3.%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/images/image-20200306232618900.png\"\u003e\u003c/p\u003e\n\u003ch3 id=\"ä¸»æ¨¡å—spring-dubbo-demo\"\u003eä¸»æ¨¡å—ï¼ˆSpring-Dubbo-Demoï¼‰\u003c/h3\u003e\n\u003cp\u003eåœ¨ pom.xml ä¸­æ·»åŠ  dependencies\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependencies\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003ecom.101tec\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003ezkclient\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e0.9\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.apache.zookeeper\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003ezookeeper\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e3.4.9\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;type\u0026gt;\u003c/span\u003epom\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/type\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003ecom.alibaba\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003edubbo\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e2.5.3\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eio.netty\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003enetty-all\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e4.1.6.Final\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003ecommons-logging\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003ecommons-logging\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e1.2\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.javassist\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003ejavassist\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e3.21.0-GA\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003elog4j\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003elog4j\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e1.2.17\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e\u0026lt;!-- springç›¸å…³jar --\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.springframework\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003espring-context\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e4.3.3.RELEASE\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.springframework\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003espring-context-support\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e4.3.3.RELEASE\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.springframework\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003espring-core\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e4.3.3.RELEASE\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.springframework\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003espring-beans\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e4.3.3.RELEASE\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.springframework\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003espring-aop\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e4.3.3.RELEASE\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.springframework\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003espring-aspects\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e4.3.3.RELEASE\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003eorg.springframework\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003espring-expression\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e4.3.3.RELEASE\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;groupId\u0026gt;\u003c/span\u003ejunit\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/groupId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;artifactId\u0026gt;\u003c/span\u003ejunit\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/artifactId\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;version\u0026gt;\u003c/span\u003e4.12\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/version\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003e\u0026lt;scope\u0026gt;\u003c/span\u003etest\u003cspan style=\"color:#f92672\"\u003e\u0026lt;/scope\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependency\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003e\u0026lt;/dependencies\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"å­æ¨¡å—providerconsumer\"\u003eå­æ¨¡å—ï¼ˆproviderã€consumerï¼‰\u003c/h3\u003e\n\u003cp\u003eåœ¨ resources ä¸­æ·»åŠ  applicationContext.xmlï¼ˆå¯æ›´æ”¹åç¼€ï¼‰\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ3ï¼‰ï¼šç¯å¢ƒæ­å»º"},{"content":"Suppose a bank has N windows open for service. There is a yellow line in front of the windows which devides the waiting area into two parts. The rules for the customers to wait in line are:\nThe space inside the yellow line in front of each window is enough to contain a line with M customers. Hence when all the N lines are full, all the customers after (and including) the (NM+1)st one will have to wait in a line behind the yellow line. Each customer will choose the shortest line to wait in when crossing the yellow line. If there are two or more lines with the same length, the customer will always choose the window with the smallest number. Customer[i] will take T[i] minutes to have his/her transaction processed. The first N customers are assumed to be served at 8:00am. Now given the processing time of each customer, you are supposed to tell the exact time at which a customer has his/her business done.\nFor example, suppose that a bank has 2 windows and each window may have 2 customers waiting inside the yellow line. There are 5 customers waiting with transactions taking 1, 2, 6, 4 and 3 minutes, respectively. At 08:00 in the morning, customer[1] is served at window[1] while customer[2] is served at window[2]. Customer[3] will wait in front of window[1] and customer[4] will wait in front of window[2]. Customer[5] will wait behind the yellow line.\nAt 08:01, customer[1] is done and customer[5] enters the line in front of window[1] since that line seems shorter now. Customer[2] will leave at 08:02, customer[4] at 08:06, customer[3] at 08:07, and finally customer[5] at 08:10.\nInput Specification: Each input file contains one test case. Each case starts with a line containing 4 positive integers: N (â‰¤20, number of windows), M (â‰¤10, the maximum capacity of each line inside the yellow line), K (â‰¤1000, number of customers), and Q (â‰¤1000, number of customer queries).\nThe next line contains K positive integers, which are the processing time of the K customers.\nThe last line contains Q positive integers, which represent the customers who are asking about the time they can have their transactions done. The customers are numbered from 1 to K.\nOutput Specification: For each of the Q customers, print in one line the time at which his/her transaction is finished, in the format HH:MM where HH is in [08, 17] and MM is in [00, 59]. Note that since the bank is closed everyday after 17:00, for those customers who cannot be served before 17:00, you must output Sorry instead.\nSample Input: 2 2 7 5 1 2 6 4 3 534 2 3 4 5 6 7 Sample Output: 08:07 08:06 08:10 17:00 Sorry æ³¨æ„ç‚¹ å¦‚æœâ¼€ä¸ªå®¢æˆ·åœ¨17:00ä»¥åŠä»¥åè¿˜æ²¡æœ‰å¼€å§‹æœåŠ¡ï¼ˆæ­¤å¤„ä¸æ˜¯ç»“æŸæœåŠ¡æ˜¯å¼€å§‹æœåŠ¡ï¼‰å°±ä¸å†æœåŠ¡è¾“å‡ºsorryï¼›å¦‚æœè¿™ä¸ªæœåŠ¡å·²ç»å¼€å§‹äº†äº†ï¼Œæ— è®ºæ—¶é—´å¤šé•¿éƒ½è¦ç­‰ä»–æœåŠ¡å®Œæ¯•ã€‚å¦‚æœå½“æˆç»“æŸæœåŠ¡ï¼Œåˆ™æµ‹è¯•ç‚¹2ï¼Œ4ï¼Œ5ä¸èƒ½é€šè¿‡ã€‚\n#include \u0026lt;cstdio\u0026gt; #include \u0026lt;queue\u0026gt; using namespace std; const int maxk = 1001, maxn = 21, maxTime = 540; int n, m, k, q, t[maxk], ans[maxk] = {0}; int main() { scanf(\u0026#34;%d %d %d %d\u0026#34;, \u0026amp;n, \u0026amp;m, \u0026amp;k, \u0026amp;q); for (int i = 1; i \u0026lt;= k; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;t[i]); } queue\u0026lt;int\u0026gt; que[maxn]; int time = 0, index = 0, query; for (int i = 1; i \u0026lt;= m; i++) { for (int j = 1; j \u0026lt;= n; j++) { que[j].push(++index); if (index == k) { break; } } if (index == k) { break; } } while (time != maxTime - 1) { time++; for (int i = 1; i \u0026lt;= n; i++) { if (que[i].size() \u0026gt; 0) { int front = que[i].front(); if (t[front] \u0026gt; 0) { t[front]--; if (t[front] == 0) { que[i].pop(); ans[front] = time; if (index != k) { que[i].push(++index); } } } } } } // é¢å¤–å¤„ç†åˆ°17:00è¿˜æ²¡æœ‰æœåŠ¡å®Œçš„å®¢æˆ· for (int i = 1; i \u0026lt;= n; i++) { if (que[i].size() \u0026gt; 0) { int front = que[i].front(); ans[front] = time + t[front]; } } for (int i = 0; i \u0026lt; q; i++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;query); if (ans[query] != 0) { printf(\u0026#34;%02d:%02d\\n\u0026#34;, 8 + ans[query] / 60, ans[query] % 60); } else { printf(\u0026#34;Sorry\\n\u0026#34;); } } return 0; } ","permalink":"https://zjxjwxk.github.io/posts/pat/advanced_level/a1014/","summary":"\u003cp\u003eSuppose a bank has N windows open for service. There is a yellow line in front of the windows which devides the waiting area into two parts. The rules for the customers to wait in line are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe space inside the yellow line in front of each window is enough to contain a line with M customers. Hence when all the N lines are full, all the customers after (and including) the (NM+1)st one will have to wait in a line behind the yellow line.\u003c/li\u003e\n\u003cli\u003eEach customer will choose the shortest line to wait in when crossing the yellow line. If there are two or more lines with the same length, the customer will always choose the window with the smallest number.\u003c/li\u003e\n\u003cli\u003eCustomer[i] will take T[i] minutes to have his/her transaction processed.\u003c/li\u003e\n\u003cli\u003eThe first N customers are assumed to be served at 8:00am.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNow given the processing time of each customer, you are supposed to tell the exact time at which a customer has his/her business done.\u003c/p\u003e","title":"PATç”²çº§ 1014 Waiting in Line (30åˆ†)"},{"content":"ä¼ ç»Ÿä¸šåŠ¡åº”ç”¨ ä¼ ç»Ÿåº”ç”¨å¸¦æ¥çš„é—®é¢˜ å•ä¸€ä¸šåŠ¡å¼€å‘å’Œè¿­ä»£å›°éš¾ æ‰©å®¹å›°éš¾ éƒ¨ç½²å’Œå›æ»šå›°éš¾ å¾®æœåŠ¡å‘å±•å†ç¨‹ é¢å‘æœåŠ¡å¼€å‘ - SOA å¾®æœåŠ¡å¼€å‘ å¾®æœåŠ¡æ¦‚è¿° å¾®æœåŠ¡æ˜¯ä¸€ç§å°†ä¸šåŠ¡ç³»ç»Ÿè¿›ä¸€æ­¥æ‹†åˆ†çš„æ¶æ„é£æ ¼ å¾®æœåŠ¡å¼ºè°ƒæ¯ä¸ªå•ä¸€ä¸šåŠ¡éƒ½ç‹¬ç«‹è¿è¡Œ æ¯ä¸ªå•ä¸€æœåŠ¡éƒ½åº”è¯¥ä½¿ç”¨æ›´è½»é‡çš„æœºåˆ¶ä¿æŒé€šä¿¡ æœåŠ¡ä¸å¼ºè°ƒç¯å¢ƒï¼Œå¯ä»¥ä¸åŒè¯­è¨€æˆ–æ•°æ®æº å¾®æœåŠ¡é€‰æ‹© Dubbo Spring Cloud Zero ICE ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/2.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8/","summary":"\u003ch1 id=\"ä¼ ç»Ÿä¸šåŠ¡åº”ç”¨\"\u003eä¼ ç»Ÿä¸šåŠ¡åº”ç”¨\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"ä¼ ç»Ÿä¸šåŠ¡åº”ç”¨\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/2.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8/images/image-20200306231434458.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"ä¼ ç»Ÿåº”ç”¨å¸¦æ¥çš„é—®é¢˜\"\u003eä¼ ç»Ÿåº”ç”¨å¸¦æ¥çš„é—®é¢˜\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eå•ä¸€ä¸šåŠ¡å¼€å‘å’Œè¿­ä»£å›°éš¾\u003c/li\u003e\n\u003cli\u003eæ‰©å®¹å›°éš¾\u003c/li\u003e\n\u003cli\u003eéƒ¨ç½²å’Œå›æ»šå›°éš¾\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"å¾®æœåŠ¡å‘å±•å†ç¨‹\"\u003eå¾®æœåŠ¡å‘å±•å†ç¨‹\u003c/h1\u003e\n\u003ch2 id=\"é¢å‘æœåŠ¡å¼€å‘---soa\"\u003eé¢å‘æœåŠ¡å¼€å‘ - SOA\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"SOA\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/2.%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8/images/image-20200306231555431.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"å¾®æœåŠ¡å¼€å‘\"\u003eå¾®æœåŠ¡å¼€å‘\u003c/h2\u003e\n\u003ch1 id=\"å¾®æœåŠ¡æ¦‚è¿°\"\u003eå¾®æœåŠ¡æ¦‚è¿°\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eå¾®æœåŠ¡æ˜¯ä¸€ç§å°†ä¸šåŠ¡ç³»ç»Ÿè¿›ä¸€æ­¥æ‹†åˆ†çš„æ¶æ„é£æ ¼\u003c/li\u003e\n\u003cli\u003eå¾®æœåŠ¡å¼ºè°ƒæ¯ä¸ªå•ä¸€ä¸šåŠ¡éƒ½ç‹¬ç«‹è¿è¡Œ\u003c/li\u003e\n\u003cli\u003eæ¯ä¸ªå•ä¸€æœåŠ¡éƒ½åº”è¯¥ä½¿ç”¨æ›´è½»é‡çš„æœºåˆ¶ä¿æŒé€šä¿¡\u003c/li\u003e\n\u003cli\u003eæœåŠ¡ä¸å¼ºè°ƒç¯å¢ƒï¼Œå¯ä»¥ä¸åŒè¯­è¨€æˆ–æ•°æ®æº\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"å¾®æœåŠ¡é€‰æ‹©\"\u003eå¾®æœåŠ¡é€‰æ‹©\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eDubbo\u003c/li\u003e\n\u003cli\u003eSpring Cloud\u003c/li\u003e\n\u003cli\u003eZero ICE\u003c/li\u003e\n\u003c/ul\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ2ï¼‰ï¼šå¾®æœåŠ¡å…¥é—¨"},{"content":"ä¸ºä»€ä¹ˆä½¿ç”¨Dubbo Dubbo æ˜¯åŸºäº RPC é€šä¿¡åè®®ï¼Œé€Ÿåº¦æ›´å¿« Dubbo çš„å¤šä¸­å¿ƒé…ç½®æ›´çµæ´» ZooKeeper Redis Dubbo å¯ä»¥æŒ‰éœ€é›†æˆå…¶ä»–ç»„ä»¶ï¼Œå®Œæˆå¾®æœåŠ¡ç”Ÿæ€ç¯å¢ƒæ„å»º Hystrix Zipkin åŒ…æ‹¬é˜¿é‡Œã€å°ç±³ã€äº¬ä¸œç­‰å¤šå®¶äº’è”ç½‘å…¬å¸éƒ½æœ‰ä½¿ç”¨ å­¦ä¹ ç›®æ ‡ æ„å»ºä¸šåŠ¡å®Œæ•´çš„å•†ä¸šåŒ–é¡¹ç›® æŒæ¡ä»¥ Dubbo ä¸ºåº•çš„å„é¡¹å¾®æœåŠ¡å¥—ä»¶çš„åº”ç”¨ æŒæ¡åŸºäº Dubbo çš„å¾®æœåŠ¡å¸¸è§é¢è¯•é—®é¢˜ ä¸šåŠ¡ç»“æ„å›¾ æ ¸å¿ƒåŠŸèƒ½ ä¸»è¦çŸ¥è¯†ç‚¹ æŠ€æœ¯æ¶æ„å›¾ ","permalink":"https://zjxjwxk.github.io/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/1.%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%AD%A6/","summary":"\u003ch1 id=\"ä¸ºä»€ä¹ˆä½¿ç”¨dubbo\"\u003eä¸ºä»€ä¹ˆä½¿ç”¨Dubbo\u003c/h1\u003e\n\u003ch2 id=\"dubbo-æ˜¯åŸºäº-rpc-é€šä¿¡åè®®é€Ÿåº¦æ›´å¿«\"\u003eDubbo æ˜¯åŸºäº RPC é€šä¿¡åè®®ï¼Œé€Ÿåº¦æ›´å¿«\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"åƒä¸‡æ¬¡è°ƒç”¨\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/1.%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%AD%A6/images/image-20200306225758803.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"dubbo-çš„å¤šä¸­å¿ƒé…ç½®æ›´çµæ´»\"\u003eDubbo çš„å¤šä¸­å¿ƒé…ç½®æ›´çµæ´»\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eZooKeeper\u003c/li\u003e\n\u003cli\u003eRedis\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"dubbo-å¯ä»¥æŒ‰éœ€é›†æˆå…¶ä»–ç»„ä»¶å®Œæˆå¾®æœåŠ¡ç”Ÿæ€ç¯å¢ƒæ„å»º\"\u003eDubbo å¯ä»¥æŒ‰éœ€é›†æˆå…¶ä»–ç»„ä»¶ï¼Œå®Œæˆå¾®æœåŠ¡ç”Ÿæ€ç¯å¢ƒæ„å»º\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eHystrix\u003c/li\u003e\n\u003cli\u003eZipkin\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"åŒ…æ‹¬é˜¿é‡Œå°ç±³äº¬ä¸œç­‰å¤šå®¶äº’è”ç½‘å…¬å¸éƒ½æœ‰ä½¿ç”¨\"\u003eåŒ…æ‹¬é˜¿é‡Œã€å°ç±³ã€äº¬ä¸œç­‰å¤šå®¶äº’è”ç½‘å…¬å¸éƒ½æœ‰ä½¿ç”¨\u003c/h2\u003e\n\u003ch1 id=\"å­¦ä¹ ç›®æ ‡\"\u003eå­¦ä¹ ç›®æ ‡\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eæ„å»ºä¸šåŠ¡å®Œæ•´çš„å•†ä¸šåŒ–é¡¹ç›®\u003c/li\u003e\n\u003cli\u003eæŒæ¡ä»¥ Dubbo ä¸ºåº•çš„å„é¡¹å¾®æœåŠ¡å¥—ä»¶çš„åº”ç”¨\u003c/li\u003e\n\u003cli\u003eæŒæ¡åŸºäº Dubbo çš„å¾®æœåŠ¡å¸¸è§é¢è¯•é—®é¢˜\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"ä¸šåŠ¡ç»“æ„å›¾\"\u003eä¸šåŠ¡ç»“æ„å›¾\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"ä¸šåŠ¡ç»“æ„å›¾\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/1.%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%AD%A6/images/image-20200306230144862.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"æ ¸å¿ƒåŠŸèƒ½\"\u003eæ ¸å¿ƒåŠŸèƒ½\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"æ ¸å¿ƒåŠŸèƒ½\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/1.%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%AD%A6/images/image-20200306230227966.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"ä¸»è¦çŸ¥è¯†ç‚¹\"\u003eä¸»è¦çŸ¥è¯†ç‚¹\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"ä¸»è¦çŸ¥è¯†ç‚¹\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/1.%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%AD%A6/images/image-20200306230255648.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"æŠ€æœ¯æ¶æ„å›¾\"\u003eæŠ€æœ¯æ¶æ„å›¾\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"æŠ€æœ¯æ¶æ„å›¾\" loading=\"lazy\" src=\"/posts/dubbo/dubbo%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BD%B1%E9%99%A2%E7%B3%BB%E5%88%97/1.%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%AD%A6/images/image-20200306230335981.png\"\u003e\u003c/p\u003e","title":"Dubboå¾®æœåŠ¡å½±é™¢ç³»åˆ—ï¼ˆ1ï¼‰ï¼šè¯¾ç¨‹å¯¼å­¦"},{"content":"What is GSE? GSE is a complex phenomenon that unites many different collaboration models and project organization models.\nReason for GSE? Reduce overheads, free up resources Improve efficiency Offload non-core functions Get access to specialized skills Get access to a specific market Differences between co-located team and global team According to What, When, Where to determine whether the supplier is suitable Alternative Different transfers Different transfers can result in Full relocation of a product to the receiving site Relocation of a component / task / phase which overall is developed jointly (18P) There are several ways or models to transfer GSE project globally. Please tell at least three models that you would apply in your GSE project, and give your comments about their advantages and disadvantages in applying them respectively. Customization model advantages: customization can satisfy customers according to their special requirements\ndisadvantages: customization will use more resource, such as, human resources, time and money.\nFollow-the-sun model advantages: It works for defect resolution and support\ndisadvantages: Not good for development\nModularized model advantage: This reduce the need for inter-site coordination and communication; good for decoupled and clear tasks.\ndisadvantage: Increase the cost of whole project.\nCritical factors that alleviate transfers Describe 6 reasons for applying Global Software Engineering(GSE) and 3 reasons for not good to do GSE. Good: Reduce development costs Leveraging time zone effectiveness Access to large skilled labor pool Closer proximity to market and customer Innovation and shared best practice Improved resource allocation Not good: Loss of knowledge within the product Temporary productivity decrease Temporal decrease in quality Causes of failure of global projects Many specific problems, but mainly because managers are unaware of these problems and fail to properly coordinate work in a distributed environment\n(16P) The course discussed quite lot about 3C in GSE, since they are important factors for successful project in GES The 3C are (6P) (1) C_____________ (2) C_________________ (3) C__________________ Please tell the main contents or activities that involved in each C (10P) Communication Cohesiveness, teamness, mutual trust Common background, language and culture Coordination Joint processes and tools Plan-driven standardized approach Control Process transparency and visibility Managers directly supervise team performance What is a project? A project is a temporary endeavour undertaken to create a unique product or service. Temporary means that every project has a definite beginning and a definite end. Unique means that the product or service is different in some distinguishing way from all similar products or services. (15P) Both development models of agile method and waterfall method can be applied in GSE project. Briefly describe the two methods (just some basic idea or steps without details) and why you would choose which method in your project development. The waterfall model is a sequential (non-iterative) design process, used in software development processes, in which progress is flowing steadily downwards (like a waterfall). Steps can be described in following picture:\nAgile method is a group of software development methods in which requirements and solutions evolve through collaboration between self-organizing, cross-functional teams. It promotes adaptive planning, evolutionary development, early delivery, continuous improvement, and encourages rapid and flexible response to change. Steps can be described in following picture:\nAdvantage of Agile Focus on the question of how to address key problems in software development: too long, too costly, poor quality Have the potential to improve communication and, as a result, reduce coordination and control overhead Small co-located teams, so it is easily for coordination. Scrum Agile method is a simple and effective way to have control over your development process, make sure things go according to plan The Difference: Agility vs. Waterfall (20P) Culture does matter in GSE, then what is culture (can be examples) (5P)? What are building blocks (elements) for a culture (5P)? And describe Hofstedeâ€™s 5 dimensions of culture (10P). What is culture? Culture is a set of shared experiences, understandings, and meanings among members of a group, an organization, a community, or a nation.\nCulture provides members with images of:\nthe basic concerns, principles, ethics bodies of manners Rituals(ç¤¼ä»ªï¼‰, ideologies strategies, tactics of self-survival notions of good acts and bad various forms of folklore and legends What are building blocks (elements) for a culture? values, including preferences people use to make work related and communication related decisions in projects.\npractices, including cultural norms for adopting specific project management styles and organization structures.\nHofstedeâ€™s 5 dimensions of culture? Power distance - how a society handles inequalities; A higher degree of the Index indicates that hierarchy is clearly established and executed in society, without doubt or reason. A lower degree of the Index signifies that people question authority and attempt to distribute power. Individualism/collectivism - behavior towards the group; individualism has loose ties that often only relates an individual. Collectivism emphasizes on building skills and has tightly-integrated relations into group. Masculinity/femininity - behavior according to gender; besides distinction of gender, masculinity is defined as a preference in society for achievement, heroism, assertiveness and material rewards for success. Femininity represents a preference for cooperation, modesty, caring for the weak and quality of life. Uncertainty avoidance - the need for structure; a high degree in this index strictly follows laws, guidelines, behaviors and etc. a low degree in this index shows more acceptance of differing thoughts or ideas. Long term orientation(LTO\u0003) - value of long-standing traditions; a high degree in this index indicates the factors of family, elders, strong work ethic and high value. A low degree in this index emphasizes creativity, individualism, equality and selfactualization. The effect of culture in software development organizations (5P) You are a project leader for GSE project, and you know it is important to build up to the team work. What would you do to build up your team to trust each other? Provide at least 5 ways or kinds of activities to this team building. kick-off meetings regular traveling team-building activities cultural training regular video-conferences Phase in forming a team Forming: the team gets together and gets to know each other. It clarifies roles, figures out the tasks and objectives\nStorming: conflicts break out over roles, objectives, and task allocations. Different leaders, official or otherwise, are pursuing different goals\nNorming: the team begins to form norms, roles, and protocols for working together. Some team cohesion may begin.\nPerforming: the team begins to perform well, working together toward a common goal. Conflicts are handled constructively\n","permalink":"https://zjxjwxk.github.io/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/outsourcing/","summary":"\u003ch1 id=\"what-is-gse\"\u003eWhat is GSE?\u003c/h1\u003e\n\u003cp\u003eGSE is a complex phenomenon that unites many different collaboration models and project organization models.\u003c/p\u003e\n\u003ch1 id=\"reason-for-gse\"\u003eReason for GSE?\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eReduce overheads, free up resources\u003c/li\u003e\n\u003cli\u003eImprove efficiency\u003c/li\u003e\n\u003cli\u003eOffload non-core functions\u003c/li\u003e\n\u003cli\u003eGet access to specialized skills\u003c/li\u003e\n\u003cli\u003eGet access to a specific market\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"differences-between-co-located-team-and-global-team\"\u003eDifferences between co-located team and global team\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"Differences between co-located team and global team\" loading=\"lazy\" src=\"/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/outsourcing/images/image-20190623152437638.png\"\u003e\u003c/p\u003e\n\u003ch1 id=\"according-to-what-when-where-to-determine-whether-the-supplier-is-suitable\"\u003eAccording to What, When, Where to determine whether the supplier is suitable\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"Each combination is unique\" loading=\"lazy\" src=\"/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/outsourcing/images/image-20190622103720847.png\"\u003e\u003c/p\u003e","title":"Outsourcing"},{"content":"å¤šä½™çš„åˆ†é¡µä¿¡æ¯ Spring Data çš„ Page æ¥å£è¿›è¡Œæ•°æ®åˆ†é¡µè¿”å›äº†å¾ˆå¤šå¾ˆå¤šåƒåœ¾ä¿¡æ¯ï¼š\n{ \u0026#34;status\u0026#34;: 0, \u0026#34;data\u0026#34;: { \u0026#34;content\u0026#34;: [ { \u0026#34;goodsId\u0026#34;: 1, \u0026#34;producerId\u0026#34;: 1, \u0026#34;categoryId\u0026#34;: 4, \u0026#34;name\u0026#34;: \u0026#34;è€å…‹sbæ»‘æ¿é‹\u0026#34;, \u0026#34;price\u0026#34;: 500, \u0026#34;stock\u0026#34;: 500, \u0026#34;status\u0026#34;: \u0026#34;æ­£å¸¸\u0026#34;, \u0026#34;createTime\u0026#34;: \u0026#34;2019-02-02T03:48:33.000+0000\u0026#34;, \u0026#34;updateTime\u0026#34;: null }, { \u0026#34;goodsId\u0026#34;: 2, \u0026#34;producerId\u0026#34;: 1, \u0026#34;categoryId\u0026#34;: 4, \u0026#34;name\u0026#34;: \u0026#34;é˜¿è¿ªè¾¾æ–¯å°ç™½é‹\u0026#34;, \u0026#34;price\u0026#34;: 500, \u0026#34;stock\u0026#34;: 300, \u0026#34;status\u0026#34;: \u0026#34;æ­£å¸¸\u0026#34;, \u0026#34;createTime\u0026#34;: \u0026#34;2019-02-02T03:48:59.000+0000\u0026#34;, \u0026#34;updateTime\u0026#34;: null } ], \u0026#34;pageable\u0026#34;: { \u0026#34;sort\u0026#34;: { \u0026#34;sorted\u0026#34;: false, \u0026#34;unsorted\u0026#34;: true, \u0026#34;empty\u0026#34;: true }, \u0026#34;offset\u0026#34;: 0, \u0026#34;pageSize\u0026#34;: 10, \u0026#34;pageNumber\u0026#34;: 0, \u0026#34;paged\u0026#34;: true, \u0026#34;unpaged\u0026#34;: false }, \u0026#34;last\u0026#34;: true, \u0026#34;totalPages\u0026#34;: 1, \u0026#34;totalElements\u0026#34;: 2, \u0026#34;size\u0026#34;: 10, \u0026#34;number\u0026#34;: 0, \u0026#34;numberOfElements\u0026#34;: 2, \u0026#34;sort\u0026#34;: { \u0026#34;sorted\u0026#34;: false, \u0026#34;unsorted\u0026#34;: true, \u0026#34;empty\u0026#34;: true }, \u0026#34;first\u0026#34;: true, \u0026#34;empty\u0026#34;: false } } å®é™…éœ€è¦çš„åˆ†é¡µä¿¡æ¯ å®é™…ä¸Šæˆ‘åªéœ€è¦ä¸‹é¢è¿™äº›åˆ†é¡µä¿¡æ¯ï¼š\n\u0026#34;totalPages\u0026#34;: 3, \u0026#34;totalElements\u0026#34;: 20, \u0026#34;pageNumber\u0026#34;: 2, \u0026#34;numberOfElements\u0026#34;: 7 åˆ›å»º PageChunk ç±»è¿›è¡Œå°è£… æˆ‘çš„ GoodsRepository æ¥å£ä¸ºï¼š\nPage\u0026lt;Goods\u0026gt; findByCategoryId(Integer categoryId, Pageable pageable); æˆ‘ä»¬çœ‹åˆ°è¿”å›äº†å¾ˆå¤šå¤šä½™çš„ï¼Œé‡å¤çš„æ•°æ®ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåˆ›å»ºä¸€ä¸ªPagination DTO(PageChunk)æ¥åŒ…è£…ä¸€ä¸‹åˆ†é¡µæ•°æ®ã€‚è¿™ä¸ªç±»çš„ä½œç”¨å¾ˆç®€å•å°±æ˜¯åŒ…å«æ¯ä¸€æ¬¡åˆ†é¡µçš„å†…å®¹å’Œåˆ†é¡µå…ƒæ•°æ®ï¼ˆæ€»é¡µæ•°ï¼Œæœç´¢ç»“æœæ€»æ•°ï¼Œå½“å‰é¡µå·ï¼Œ å½“å‰é¡µåŒ…å«å¤šå°‘é¡¹ï¼‰ã€‚\nimport lombok.Data; import java.util.List; /** * @author zjxjwxk */ @Data public class PageChunk\u0026lt;T\u0026gt; { private List\u0026lt;T\u0026gt; content; private int totalPages; private long totalElements; private int pageNumber; private int numberOfElements; } åŒæ—¶ï¼Œæˆ‘æ ¹æ®ä¸šåŠ¡éœ€æ±‚å¯¹å•†å“ä¿¡æ¯è¿›è¡Œäº†DTOçš„åŒ…è£…ï¼Œï¼ˆåªéœ€è¦å•†å“idï¼Œåç§°å’Œä»·æ ¼å³å¯ï¼‰ã€‚\nimport lombok.Data; /** * @author zjxjwxk */ @Data public class GoodsDTO { private Integer goodsId; private String name; private Integer price; } ç”¨ PageChunk æ›¿ä»£ Page ç¼–å†™ä»¥ä¸‹ getPageChunk æ–¹æ³•ç”¨äºå°† Page å¯¹è±¡è½¬åŒ–ä¸º PageChunk å¯¹è±¡ï¼Œä»…ä»…æå– Page å¯¹è±¡ä¸­æ‰€éœ€è¦çš„Content å’Œä¸€äº›åˆ†é¡µä¿¡æ¯ï¼Œå°† PageChunk å¯¹è±¡å°è£…å¹¶è¿”å›ã€‚ç¼–å†™ getGoodsDTO æ–¹æ³•ç”¨äºç®€åŒ–å•†å“ä¿¡æ¯ã€‚\n@Service(\u0026#34;GoodsService\u0026#34;) public class GoodsServiceImpl implements GoodsService { private final GoodsRepository goodsRepository; @Autowired public GoodsServiceImpl(GoodsRepository goodsRepository) { this.goodsRepository = goodsRepository; } @Override public ServerResponse getList(String keyword, Integer categoryId, Integer pageNum, Integer pageSize, String orderBy) { PageRequest pageRequest = PageRequest.of(pageNum - 1, pageSize); Page\u0026lt;Goods\u0026gt; goodsPage = goodsRepository.findByCategoryId(categoryId, pageRequest); return ServerResponse.createBySuccess(getPageChunk(goodsPage)); } private PageChunk\u0026lt;GoodsDTO\u0026gt; getPageChunk(Page\u0026lt;Goods\u0026gt; goodsPage) { PageChunk\u0026lt;GoodsDTO\u0026gt; pageChunk = new PageChunk\u0026lt;\u0026gt;(); pageChunk.setContent(getGoodsDTO(goodsPage.getContent())); pageChunk.setTotalPages(goodsPage.getTotalPages()); pageChunk.setTotalElements(goodsPage.getTotalElements()); pageChunk.setPageNumber(goodsPage.getPageable().getPageNumber() + 1); pageChunk.setNumberOfElements(goodsPage.getNumberOfElements()); return pageChunk; } private List\u0026lt;GoodsDTO\u0026gt; getGoodsDTO(List\u0026lt;Goods\u0026gt; goodsList) { List\u0026lt;GoodsDTO\u0026gt; goodsDTOList = new ArrayList\u0026lt;\u0026gt;(); for (Goods goods : goodsList) { GoodsDTO goodsDTO = new GoodsDTO(); goodsDTO.setGoodsId(goods.getGoodsId()); goodsDTO.setName(goods.getName()); goodsDTO.setPrice(goods.getPrice()); goodsDTOList.add(goodsDTO); } return goodsDTOList; } } ä¸ºäº†è¿”å› JSON æ•°æ®ï¼Œæˆ‘è‡ªå®šä¹‰äº†ä¸€ä¸ª ServerResponse æœåŠ¡å“åº”å¯¹è±¡ï¼Œå®ƒçš„ä½œç”¨æ˜¯è®©æˆ‘ä»¬è¿”å›çš„ JSON æœ‰ä¸€ä¸ªé€šç”¨çš„æ ¼å¼\nç®€åŒ–åçš„ç»“æœ { \u0026#34;status\u0026#34;: 0, \u0026#34;data\u0026#34;: { \u0026#34;content\u0026#34;: [ { \u0026#34;goodsId\u0026#34;: 8, \u0026#34;name\u0026#34;: \u0026#34;Clarks ç”· Tri Sparkç”Ÿæ´»ä¼‘é—²é‹26135668\u0026#34;, \u0026#34;price\u0026#34;: 459 }, { \u0026#34;goodsId\u0026#34;: 9, \u0026#34;name\u0026#34;: \u0026#34;Adidasä¸‰å¶è‰ ç”· ä¼‘é—²è·‘æ­¥é‹ STAN SMITH M20324\u0026#34;, \u0026#34;price\u0026#34;: 415 }, { \u0026#34;goodsId\u0026#34;: 10, \u0026#34;name\u0026#34;: \u0026#34;Skechers æ–¯å‡¯å¥‡ SKECHERS SPORTç³»åˆ— ç”· ç»‘å¸¦è¿åŠ¨é‹ 999732-NVOR\u0026#34;, \u0026#34;price\u0026#34;: 355 }, { \u0026#34;goodsId\u0026#34;: 11, \u0026#34;name\u0026#34;: \u0026#34;Saucony åœ£åº·å°¼ RSP ç”· ä¼‘é—²è·‘æ­¥é‹ KINETA RELAY S2524465\u0026#34;, \u0026#34;price\u0026#34;: 479 }, { \u0026#34;goodsId\u0026#34;: 12, \u0026#34;name\u0026#34;: \u0026#34;Mustang ç”· å¸†å¸ƒé‹ä¼‘é—²è¿åŠ¨ 4058-305ï¼ˆäºšé©¬é€Šè¿›å£ç›´é‡‡,å¾·å›½å“ç‰Œï¼‰\u0026#34;, \u0026#34;price\u0026#34;: 324 }, { \u0026#34;goodsId\u0026#34;: 13, \u0026#34;name\u0026#34;: \u0026#34;Clarks ç”· Tri Sparkç”Ÿæ´»ä¼‘é—²é‹26135655\u0026#34;, \u0026#34;price\u0026#34;: 123425 }, { \u0026#34;goodsId\u0026#34;: 14, \u0026#34;name\u0026#34;: \u0026#34;New Balance 574ç³»åˆ— ç”· ä¼‘é—²è·‘æ­¥é‹ ML574EG-D\u0026#34;, \u0026#34;price\u0026#34;: 324 } ], \u0026#34;totalPages\u0026#34;: 3, \u0026#34;totalElements\u0026#34;: 20, \u0026#34;pageNumber\u0026#34;: 2, \u0026#34;numberOfElements\u0026#34;: 7 } } ","permalink":"https://zjxjwxk.github.io/posts/spring-boot/spring-boot-%E7%AE%80%E5%8C%96%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2page%E6%8E%A5%E5%8F%A3%E7%9A%84json%E5%93%8D%E5%BA%94/","summary":"\u003ch3 id=\"å¤šä½™çš„åˆ†é¡µä¿¡æ¯\"\u003eå¤šä½™çš„åˆ†é¡µä¿¡æ¯\u003c/h3\u003e\n\u003cp\u003eSpring Data çš„ Page æ¥å£è¿›è¡Œæ•°æ®åˆ†é¡µè¿”å›äº†å¾ˆå¤šå¾ˆå¤šåƒåœ¾ä¿¡æ¯ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026#34;status\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003e\u0026#34;data\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;content\u0026#34;\u003c/span\u003e: [\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;goodsId\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;producerId\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;categoryId\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;è€å…‹sbæ»‘æ¿é‹\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;price\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;stock\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;status\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;æ­£å¸¸\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;createTime\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2019-02-02T03:48:33.000+0000\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;updateTime\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003enull\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;goodsId\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;producerId\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;categoryId\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;é˜¿è¿ªè¾¾æ–¯å°ç™½é‹\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;price\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;stock\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e300\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;status\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;æ­£å¸¸\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;createTime\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;2019-02-02T03:48:59.000+0000\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;updateTime\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003enull\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        ],\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;pageable\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026#34;sort\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;sorted\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;unsorted\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                \u003cspan style=\"color:#f92672\"\u003e\u0026#34;empty\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026#34;offset\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026#34;pageSize\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026#34;pageNumber\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026#34;paged\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026#34;unpaged\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;last\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;totalPages\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;totalElements\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;size\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;number\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;numberOfElements\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;sort\u0026#34;\u003c/span\u003e: {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026#34;sorted\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026#34;unsorted\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#f92672\"\u003e\u0026#34;empty\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        },\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;first\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003etrue\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#f92672\"\u003e\u0026#34;empty\u0026#34;\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"å®é™…éœ€è¦çš„åˆ†é¡µä¿¡æ¯\"\u003eå®é™…éœ€è¦çš„åˆ†é¡µä¿¡æ¯\u003c/h3\u003e\n\u003cp\u003eå®é™…ä¸Šæˆ‘åªéœ€è¦ä¸‹é¢è¿™äº›åˆ†é¡µä¿¡æ¯ï¼š\u003c/p\u003e","title":"Spring Boot ç®€åŒ–åˆ†é¡µæŸ¥è¯¢Pageæ¥å£çš„JSONå“åº”"},{"content":"Spring Cloud Eureka åŸºäº Netflix Eureka åšäº†äºŒæ¬¡å°è£… ä¸¤ä¸ªç»„ä»¶ç»„æˆï¼š Eureka Server æ³¨å†Œä¸­å¿ƒ ä½œä¸ºå…·æœ‰æœåŠ¡æ³¨å†ŒåŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œæ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œç³»ç»Ÿä¸­çš„å…¶ä»–å¾®æœåŠ¡ä½¿ç”¨ Eureka Client è¿æ¥åˆ°Eureka Server ï¼Œå¹¶ç»´æŒå¿ƒè·³è¿æ¥ä»¥ç›‘æ§å„ä¸ªå¾®æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚ Eureka Client æœåŠ¡æ³¨å†Œ ç”¨äºç®€åŒ–ä¸æœåŠ¡å™¨çš„äº¤äº’ï¼Œä½œä¸ºè½®è¯¢è´Ÿè½½å‡è¡¡å™¨ï¼Œå¹¶æä¾›æœåŠ¡çš„æ•…éšœåˆ‡æ¢æ”¯æŒã€‚ å¯åŠ¨ Eureka Server 1. åˆ›å»ºSpringé¡¹ç›® 2. å¡«å……é¡¹ç›®ä¿¡æ¯ 3. é€‰æ‹©é¡¹ç›®ç±»å‹ä¸º Cloud Discovery ä¸­çš„ Eureka Server 4. å®Œæˆåˆ›å»º 5. æ·»åŠ æ³¨è§£ @EnableEurekaServer @SpringBootApplication @EnableEurekaServer public class EurekaApplication { public static void main(String[] args) { SpringApplication.run(EurekaApplication.class, args); } } 6. é…ç½® application.yml eureka: client: service-url: defaultZone: http://localhost:8761/eureka/ register-with-eureka: false spring: application: name: eureka server: port: 8761 7. å¯åŠ¨ Eureka Server è¿™æ ·ï¼Œä¸€ä¸ªç®€å•çš„Eureka Serverå°±å¯åŠ¨å®Œæˆäº†ã€‚\n","permalink":"https://zjxjwxk.github.io/posts/spring-cloud/%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0/","summary":"\u003ch1 id=\"spring-cloud-eureka\"\u003eSpring Cloud Eureka\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eåŸºäº Netflix Eureka åšäº†äºŒæ¬¡å°è£…\u003c/li\u003e\n\u003cli\u003eä¸¤ä¸ªç»„ä»¶ç»„æˆï¼š\n\u003cul\u003e\n\u003cli\u003eEureka Server æ³¨å†Œä¸­å¿ƒ\n\u003cul\u003e\n\u003cli\u003eä½œä¸ºå…·æœ‰æœåŠ¡æ³¨å†ŒåŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œæ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œç³»ç»Ÿä¸­çš„å…¶ä»–å¾®æœåŠ¡ä½¿ç”¨ Eureka Client è¿æ¥åˆ°Eureka Server ï¼Œå¹¶ç»´æŒå¿ƒè·³è¿æ¥ä»¥ç›‘æ§å„ä¸ªå¾®æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eEureka Client æœåŠ¡æ³¨å†Œ\n\u003cul\u003e\n\u003cli\u003eç”¨äºç®€åŒ–ä¸æœåŠ¡å™¨çš„äº¤äº’ï¼Œä½œä¸ºè½®è¯¢è´Ÿè½½å‡è¡¡å™¨ï¼Œå¹¶æä¾›æœåŠ¡çš„æ•…éšœåˆ‡æ¢æ”¯æŒã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"å¯åŠ¨-eureka-server\"\u003eå¯åŠ¨ Eureka Server\u003c/h1\u003e\n\u003ch2 id=\"1-åˆ›å»ºspringé¡¹ç›®\"\u003e1. åˆ›å»ºSpringé¡¹ç›®\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"åˆ›å»ºSpringé¡¹ç›®\" loading=\"lazy\" src=\"/posts/spring-cloud/%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0/images/image-20190131155138441.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"2-å¡«å……é¡¹ç›®ä¿¡æ¯\"\u003e2. å¡«å……é¡¹ç›®ä¿¡æ¯\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"å¡«å……é¡¹ç›®ä¿¡æ¯\" loading=\"lazy\" src=\"/posts/spring-cloud/%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0/images/image-20190131155241197.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"3-é€‰æ‹©é¡¹ç›®ç±»å‹ä¸º-cloud-discovery-ä¸­çš„-eureka-server\"\u003e3. é€‰æ‹©é¡¹ç›®ç±»å‹ä¸º Cloud Discovery ä¸­çš„ Eureka Server\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"é€‰æ‹©Eureka Server\" loading=\"lazy\" src=\"/posts/spring-cloud/%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0/images/image-20190131155453826.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"4-å®Œæˆåˆ›å»º\"\u003e4. å®Œæˆåˆ›å»º\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"å®Œæˆåˆ›å»º\" loading=\"lazy\" src=\"/posts/spring-cloud/%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0/images/image-20190131160337079.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"5-æ·»åŠ æ³¨è§£-enableeurekaserver\"\u003e5. æ·»åŠ æ³¨è§£ @EnableEurekaServer\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@SpringBootApplication\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003e@EnableEurekaServer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003epublic\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eclass\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eEurekaApplication\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003epublic\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003estatic\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003evoid\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003emain\u003c/span\u003e(String\u003cspan style=\"color:#f92672\"\u003e[]\u003c/span\u003e args) {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        SpringApplication.\u003cspan style=\"color:#a6e22e\"\u003erun\u003c/span\u003e(EurekaApplication.\u003cspan style=\"color:#a6e22e\"\u003eclass\u003c/span\u003e, args);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    }\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"6-é…ç½®-applicationyml\"\u003e6. é…ç½® application.yml\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-yml\" data-lang=\"yml\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eeureka\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eclient\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eservice-url\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e      \u003cspan style=\"color:#f92672\"\u003edefaultZone\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003ehttp://localhost:8761/eureka/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003eregister-with-eureka\u003c/span\u003e: \u003cspan style=\"color:#66d9ef\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003espring\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eapplication\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#f92672\"\u003ename\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003eeureka\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eserver\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#f92672\"\u003eport\u003c/span\u003e: \u003cspan style=\"color:#ae81ff\"\u003e8761\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"7-å¯åŠ¨-eureka-server\"\u003e7. å¯åŠ¨ Eureka Server\u003c/h2\u003e\n\u003cp\u003e\u003cimg alt=\"Eureka Serverä¿¡æ¯\" loading=\"lazy\" src=\"/posts/spring-cloud/%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0/images/image-20190131172458551.png\"\u003e\u003c/p\u003e","title":"Spring Cloud Eureka"},{"content":"images å®šä¹‰ The microservice architectural style is an approach to developing a single application running as a suite of small services, each running its own process and communicating with lightweight mechanisms, often an HTTP resource API. These services are built around business capabilities and independently deployable by fully automated deployment machinery. There is a bare minimum of centralized management of these services, which may be written in different programming languages and use different data storage technologies.\nä¸€ç³»åˆ—å¾®å°çš„æœåŠ¡å…±åŒç»„æˆ è·‘åœ¨è‡ªå·±çš„è¿›ç¨‹é‡Œ æ¯ä¸ªæœåŠ¡ä¸ºç‹¬ç«‹çš„ä¸šåŠ¡å¼€å‘ ç‹¬ç«‹éƒ¨ç½² åˆ†å¸ƒå¼çš„ç®¡ç† èƒŒæ™¯ éšç€äº’è”ç½‘çš„å‘å±•ï¼Œç½‘ç«™åº”ç”¨çš„è§„æ¨¡ä¸æ–­æ‰©å¤§ï¼Œå¸¸è§„çš„å‚ç›´åº”ç”¨æ¶æ„å·²æ— æ³•åº”å¯¹ï¼Œåˆ†å¸ƒå¼æœåŠ¡æ¶æ„ä»¥åŠæµåŠ¨è®¡ç®—æ¶æ„åŠ¿åœ¨å¿…è¡Œï¼ŒäºŸéœ€ä¸€ä¸ªæ²»ç†ç³»ç»Ÿç¡®ä¿æ¶æ„æœ‰æ¡ä¸ç´Šçš„æ¼”è¿›ã€‚\nå•ä¸€åº”ç”¨æ¶æ„ å½“ç½‘ç«™æµé‡å¾ˆå°æ—¶ï¼Œåªéœ€ä¸€ä¸ªåº”ç”¨ï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½éƒ¨ç½²åœ¨ä¸€èµ·ï¼Œä»¥å‡å°‘éƒ¨ç½²èŠ‚ç‚¹å’Œæˆæœ¬ã€‚æ­¤æ—¶ï¼Œç”¨äºç®€åŒ–å¢åˆ æ”¹æŸ¥å·¥ä½œé‡çš„æ•°æ®è®¿é—®æ¡†æ¶(ORM)æ˜¯å…³é”®ã€‚\nå‚ç›´åº”ç”¨æ¶æ„ å½“è®¿é—®é‡é€æ¸å¢å¤§ï¼Œå•ä¸€åº”ç”¨å¢åŠ æœºå™¨å¸¦æ¥çš„åŠ é€Ÿåº¦è¶Šæ¥è¶Šå°ï¼Œå°†åº”ç”¨æ‹†æˆäº’ä¸ç›¸å¹²çš„å‡ ä¸ªåº”ç”¨ï¼Œä»¥æå‡æ•ˆç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºåŠ é€Ÿå‰ç«¯é¡µé¢å¼€å‘çš„Webæ¡†æ¶(MVC)æ˜¯å…³é”®ã€‚\nåˆ†å¸ƒå¼æœåŠ¡æ¶æ„ å½“å‚ç›´åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ä¸å¯é¿å…ï¼Œå°†æ ¸å¿ƒä¸šåŠ¡æŠ½å–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œé€æ¸å½¢æˆç¨³å®šçš„æœåŠ¡ä¸­å¿ƒï¼Œä½¿å‰ç«¯åº”ç”¨èƒ½æ›´å¿«é€Ÿçš„å“åº”å¤šå˜çš„å¸‚åœºéœ€æ±‚ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨åŠæ•´åˆçš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶(RPC)æ˜¯å…³é”®ã€‚\næµåŠ¨è®¡ç®—æ¶æ„ å½“æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå®¹é‡çš„è¯„ä¼°ï¼Œå°æœåŠ¡èµ„æºçš„æµªè´¹ç­‰é—®é¢˜é€æ¸æ˜¾ç°ï¼Œæ­¤æ—¶éœ€å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºæé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒ(SOA)æ˜¯å…³é”®ã€‚\nå•ä½“æ¶æ„ ä¼˜ç‚¹ å®¹æ˜“æµ‹è¯• å®¹æ˜“éƒ¨ç½² ç¼ºç‚¹ å¼€å‘æ•ˆç‡ä½ ä»£ç ç»´æŠ¤éš¾ éƒ¨ç½²ä¸çµæ´» ç¨³å®šæ€§ä¸é«˜ æ‰©å±•æ€§ä¸å¤Ÿ åˆ†å¸ƒå¼å®šä¹‰ æ—¨åœ¨æ”¯æŒåº”ç”¨ç¨‹åºå’ŒæœåŠ¡çš„å¼€å‘ï¼Œå¯ä»¥åˆ©ç”¨ç‰©ç†æ¶æ„ï¼Œç”±å¤šä¸ªè‡ªæ²»çš„å¤„ç†å…ƒç´ ï¼Œä¸å…±äº«ä¸»å†…å­˜ï¼Œä½†é€šè¿‡ç½‘ç»œå‘é€æ¶ˆæ¯åˆä½œã€‚â€”â€”Leslie Lamport\nç®€å•çš„å¾®æœåŠ¡ å¾®æœåŠ¡æ¶æ„çš„åŸºç¡€æ¡†æ¶/ç»„ä»¶ æœåŠ¡æ³¨å†Œå‘ç°\næœåŠ¡ç½‘å…³ï¼ˆService Gatewayï¼‰\nåç«¯é€šç”¨æœåŠ¡ï¼ˆä¹Ÿç§°ä¸­é—´å±‚æœåŠ¡ Middle Tire Serviceï¼‰\nå‰ç«¯æœåŠ¡ï¼ˆä¹Ÿç§°è¾¹ç¼˜æœåŠ¡ Edge Serviceï¼‰\nèšåˆ å¯¹å¤šä¸ªAPIè°ƒç”¨è¿›è¡Œèšåˆï¼Œä»è€Œå‡å°‘å®¢æˆ·ç«¯çš„è¯·æ±‚æ•° è£å‰ª å¯¹è¿”å›ä¸åŒçš„è®¾å¤‡çš„å†…å®¹è¿›è¡Œè£å‰ªï¼ˆPCã€ç§»åŠ¨ç«¯ï¼‰ ä¸¤å¤§é˜µè¥ é˜¿é‡Œç³» Dubboï¼ˆæœåŠ¡åŒ–æ²»ç†ï¼‰ Zookeeperï¼ˆæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼‰ Spring MVC or SpringBoot \u0026hellip; Spring Cloud Spring Cloud Netflix Eureka SpringBoot \u0026hellip; Spring Cloud æ˜¯ä»€ä¹ˆ Spring Cloud æ˜¯ä¸€ä¸ªå¼€å‘å·¥å…·é›†ï¼Œå«äº†å¤šä¸ªå­é¡¹ç›® åˆ©ç”¨Spring Bootçš„å¼€å‘ä¾¿åˆ© ä¸»è¦æ˜¯åŸºäºå¯¹Netflixå¼€æºç»„ä»¶çš„è¿›ä¸€æ­¥å°è£… Spring Cloud ç®€åŒ–äº†åˆ†å¸ƒå¼å¼€å‘ æŒæ¡å¦‚ä½•ä½¿ç”¨ï¼Œæ›´è¦ç†è§£åˆ†å¸ƒå¼ã€æ¶æ„çš„ç‰¹ç‚¹ ","permalink":"https://zjxjwxk.github.io/posts/spring-cloud/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84/","summary":"\u003ch1 id=\"images\"\u003eimages\u003c/h1\u003e\n\u003ch2 id=\"å®šä¹‰\"\u003eå®šä¹‰\u003c/h2\u003e\n\u003cp\u003eThe microservice architectural style is an approach to developing a single application running as \u003cstrong\u003ea suite of small services\u003c/strong\u003e, each \u003cstrong\u003erunning its own process\u003c/strong\u003e and communicating with lightweight mechanisms, often an HTTP resource API. These services are \u003cstrong\u003ebuilt around business capabilities\u003c/strong\u003e and \u003cstrong\u003eindependently deployable\u003c/strong\u003e by fully automated deployment machinery. There is \u003cstrong\u003ea bare minimum of centralized management of these services\u003c/strong\u003e, which may be written in different programming languages and use different data storage technologies.\u003c/p\u003e","title":"å¾®æœåŠ¡ç®€ä»‹"},{"content":"è¿è¡ŒjaråŒ…å‘½ä»¤ java -jar application.jar å½“å‰sshçª—å£è¢«é”å®šï¼Œå¯æŒ‰CTRL + Cæ‰“æ–­ç¨‹åºè¿è¡Œï¼Œæˆ–ç›´æ¥å…³é—­çª—å£è®©ç¨‹åºé€€å‡ºã€‚\né‚£å¦‚ä½•è®©çª—å£ä¸è¢«é”å®šï¼Ÿ\næ–¹æ³•ä¸€ java -jar application.jar \u0026amp; \u0026amp;ä»£è¡¨åœ¨åå°è¿è¡Œã€‚\nå½“å‰sshçª—å£ä¸è¢«é”å®šï¼Œä½†æ˜¯å½“çª—å£å…³é—­æ—¶ï¼Œç¨‹åºä¸­æ­¢è¿è¡Œã€‚\nç»§ç»­æ”¹è¿›ï¼Œå¦‚ä½•è®©çª—å£å…³é—­æ—¶ï¼Œç¨‹åºä»ç„¶è¿è¡Œï¼Ÿ\næ–¹æ³•äºŒ nohup java -jar application.jar \u0026amp; nohup æ„æ€æ˜¯ä¸æŒ‚æ–­è¿è¡Œå‘½ä»¤,å½“è´¦æˆ·é€€å‡ºæˆ–ç»ˆç«¯å…³é—­æ—¶,ç¨‹åºä»ç„¶è¿è¡Œã€‚\né‚£æ€ä¹ˆä¸æ‰“å°è¯¥ç¨‹åºè¾“å‡ºçš„å†…å®¹ï¼Œè€Œå†™å…¥æŸä¸ªæ–‡ä»¶ä¸­å‘¢ï¼Ÿ\næ–¹æ³•å›› nohup java -jar application.jar \u0026gt;out.txt \u0026amp; å½“ç”¨ nohup å‘½ä»¤æ‰§è¡Œä½œä¸šæ—¶ï¼Œç¼ºçœæƒ…å†µä¸‹è¯¥ä½œä¸šçš„æ‰€æœ‰è¾“å‡ºè¢«é‡å®šå‘åˆ°nohup.outçš„æ–‡ä»¶ä¸­ï¼Œé™¤éå¦å¤–æŒ‡å®šäº†è¾“å‡ºæ–‡ä»¶ï¼Œå¦‚ out.txtã€‚\ncommand \u0026gt;out.txtæ˜¯å°†commandçš„è¾“å‡ºé‡å®šå‘åˆ°out.txtæ–‡ä»¶ï¼Œå³è¾“å‡ºå†…å®¹ä¸æ‰“å°åˆ°å±å¹•ä¸Šï¼Œè€Œæ˜¯è¾“å‡ºåˆ°out.txtæ–‡ä»¶ä¸­ã€‚\né€šè¿‡jobså‘½ä»¤æŸ¥çœ‹åå°è¿è¡Œä»»åŠ¡ jobs é‚£ä¹ˆå°±ä¼šåˆ—å‡ºæ‰€æœ‰åå°æ‰§è¡Œçš„ä½œä¸šï¼Œå¹¶ä¸”æ¯ä¸ªä½œä¸šå‰é¢éƒ½æœ‰ä¸ªç¼–å·ã€‚\nå¦‚æœæƒ³å°†æŸä¸ªä½œä¸šè°ƒå›å‰å°æ§åˆ¶ï¼Œåªéœ€è¦ fg + ç¼–å·å³å¯ã€‚ fg 23 æŸ¥çœ‹æŸç«¯å£å ç”¨çš„çº¿ç¨‹çš„pid netstat -nlp |grep :9181 ","permalink":"https://zjxjwxk.github.io/posts/linux/centos/centos-jar%E5%8C%85%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C/","summary":"\u003ch1 id=\"è¿è¡ŒjaråŒ…å‘½ä»¤\"\u003eè¿è¡ŒjaråŒ…å‘½ä»¤\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejava -jar application.jar\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå½“å‰sshçª—å£è¢«é”å®šï¼Œå¯æŒ‰CTRL + Cæ‰“æ–­ç¨‹åºè¿è¡Œï¼Œæˆ–ç›´æ¥å…³é—­çª—å£è®©ç¨‹åºé€€å‡ºã€‚\u003c/p\u003e\n\u003cp\u003eé‚£å¦‚ä½•è®©çª—å£ä¸è¢«é”å®šï¼Ÿ\u003c/p\u003e\n\u003ch1 id=\"æ–¹æ³•ä¸€\"\u003eæ–¹æ³•ä¸€\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejava -jar application.jar \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u0026amp;ä»£è¡¨åœ¨åå°è¿è¡Œã€‚\u003c/p\u003e\n\u003cp\u003eå½“å‰sshçª—å£ä¸è¢«é”å®šï¼Œä½†æ˜¯å½“çª—å£å…³é—­æ—¶ï¼Œç¨‹åºä¸­æ­¢è¿è¡Œã€‚\u003c/p\u003e\n\u003cp\u003eç»§ç»­æ”¹è¿›ï¼Œå¦‚ä½•è®©çª—å£å…³é—­æ—¶ï¼Œç¨‹åºä»ç„¶è¿è¡Œï¼Ÿ\u003c/p\u003e\n\u003ch1 id=\"æ–¹æ³•äºŒ\"\u003eæ–¹æ³•äºŒ\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enohup java -jar application.jar \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003enohup æ„æ€æ˜¯ä¸æŒ‚æ–­è¿è¡Œå‘½ä»¤,å½“è´¦æˆ·é€€å‡ºæˆ–ç»ˆç«¯å…³é—­æ—¶,ç¨‹åºä»ç„¶è¿è¡Œã€‚\u003c/p\u003e\n\u003cp\u003eé‚£æ€ä¹ˆä¸æ‰“å°è¯¥ç¨‹åºè¾“å‡ºçš„å†…å®¹ï¼Œè€Œå†™å…¥æŸä¸ªæ–‡ä»¶ä¸­å‘¢ï¼Ÿ\u003c/p\u003e\n\u003ch1 id=\"æ–¹æ³•å››\"\u003eæ–¹æ³•å››\u003c/h1\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enohup java -jar application.jar \u0026gt;out.txt \u0026amp;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå½“ç”¨ nohup å‘½ä»¤æ‰§è¡Œä½œä¸šæ—¶ï¼Œç¼ºçœæƒ…å†µä¸‹è¯¥ä½œä¸šçš„æ‰€æœ‰è¾“å‡ºè¢«é‡å®šå‘åˆ°nohup.outçš„æ–‡ä»¶ä¸­ï¼Œé™¤éå¦å¤–æŒ‡å®šäº†è¾“å‡ºæ–‡ä»¶ï¼Œå¦‚ out.txtã€‚\u003c/p\u003e\n\u003cp\u003ecommand \u0026gt;out.txtæ˜¯å°†commandçš„è¾“å‡ºé‡å®šå‘åˆ°out.txtæ–‡ä»¶ï¼Œå³è¾“å‡ºå†…å®¹ä¸æ‰“å°åˆ°å±å¹•ä¸Šï¼Œè€Œæ˜¯è¾“å‡ºåˆ°out.txtæ–‡ä»¶ä¸­ã€‚\u003c/p\u003e\n\u003ch3 id=\"é€šè¿‡jobså‘½ä»¤æŸ¥çœ‹åå°è¿è¡Œä»»åŠ¡\"\u003eé€šè¿‡jobså‘½ä»¤æŸ¥çœ‹åå°è¿è¡Œä»»åŠ¡\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejobs\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eé‚£ä¹ˆå°±ä¼šåˆ—å‡ºæ‰€æœ‰åå°æ‰§è¡Œçš„ä½œä¸šï¼Œå¹¶ä¸”æ¯ä¸ªä½œä¸šå‰é¢éƒ½æœ‰ä¸ªç¼–å·ã€‚\u003c/p\u003e\n\u003ch3 id=\"å¦‚æœæƒ³å°†æŸä¸ªä½œä¸šè°ƒå›å‰å°æ§åˆ¶åªéœ€è¦-fg--ç¼–å·å³å¯\"\u003eå¦‚æœæƒ³å°†æŸä¸ªä½œä¸šè°ƒå›å‰å°æ§åˆ¶ï¼Œåªéœ€è¦ fg + ç¼–å·å³å¯ã€‚\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efg \u003cspan style=\"color:#ae81ff\"\u003e23\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"æŸ¥çœ‹æŸç«¯å£å ç”¨çš„çº¿ç¨‹çš„pid\"\u003eæŸ¥çœ‹æŸç«¯å£å ç”¨çš„çº¿ç¨‹çš„pid\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003enetstat -nlp |grep :9181\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","title":"CentOS jaråŒ…åå°è¿è¡Œ"},{"content":"General characteristics of a project A project is a temporary endeavour undertaken to create a unique product or service. It is specific, timely, usually multidisciplinary, and always conflict ridden. Projects are parts of overall programs and may be broken down into tasks, subtasks, and further if desired.\nVary in size Vary in type Have desired completion dates Requires various kinds of knowledge Requires domain knowledge Requires team work Requires responsibilities and authorities Do not exist in isolation General management vs. Project management General management Organizational management Portfolio management Program management Not time limited? No completion dates? No managerial hierarchy? Routine activities Annual budgeting Project management Project management is the application of knowledge, skills, tools, and techniques to project activities to meet the project requirements Five categories of activities Initiating Planning Executing Monitoring and Controlling Closing How does the world look like? Uncertainty Plans go awry Even the closest future is unpredictable Chance events occur frequently The life is a rough road We need to do trade-offs every day We constantly negotiate We need flexibility Risk management â€œProject management is risk managementâ€ Identify potential problems before they occur Put preventive actions in place before unrecoverable harm occurs Risks possible events that may affect the project negatively Problems events that have or will affect the project negatively Stages in risk management: Risk identification; project, product and business risks Risk analysis; probability and consequences, triggers Risk planning; how to address risks â€“ eliminate, reduce, ignore Risk monitoring; controlling and updating the risks Decision matrix Gantt chart RACI matrix Usually derived from the WBS Clarify responsibilities R Responsible, who is responsible for actually doing the activity A Accountable, who is accountable for the completion of the task C Consult, who should be consulted I Informed, who must be informed\nNote that combinations may exist, e.g. AR, CI, AC\nExample Critical path A path from the projects start event to its finish event that, if delayed, will delay the completion date Brainstorming Sprint, Sprint backlog Sprint A fixed period of time, usually 2 or 3 weeks but can be more\nAlways use the same fixed period\nThe development team should have full authority during the sprint\nThe Sprint goal must be defined in advance\nThe team can change (the depth of) the functionality of the Sprint, as long as it meets its sprint goal\nProduct backlog Requirements gathering for the Product Backlog Identify the stakeholders and their goals Identify the different categories of stakeholders Ask the question: â€œWhy do you need this?â€ What are the business objectives and goals? How do we measure goal accomplishment? The goals shall be SMART: Specific Measurable Acceptable Realistic Time-based Gather requirements for the Product Backlog Meet the stakeholders Understand the stakeholders needs Use the â€œTree and Forestâ€ analogy Identify the trees, branches and leaves Use a top down approach mixed with bottom-up? The leaves may be user stories Group the leaves into branches Group the branches into trees Verify the stories with the stakeholders The CUTFIT rules Validate the user stories Consistent no conflict between user stories Unambiguous one interpretation Testable test cases can be created Feasible possible to implement Independent independent of other user stories Traceable you can link the story to the project goals Do not write stories endlessly. You can stop when you cannot decompose anymore or when you can derive tasks with working effort of approximately one day Product Backlog Item (PBI), example Scrum board Some thoughts about the Backlog Scrum in action recommends items to be stories (branches) Frequently, in practice, it seems to be a mix of stories, features, functions, tasks, improvements and incidents If you choose stories, you should consider defining tasks (leaves) in the stories The tasks should be transferred to activities in the sprint planning Burndown charts \u0026amp; EVM method Earned Value Method - EVM Trend projection - EV Agile and Scrum tracking Release tracking Tracking story progress Release burndown chart Sprint tracking Tracking task progress Sprint burndown chart Burndown charts Displays the remaining effort for a given period of time Do have good value for the stakeholders and the team Visualization is a good thing to do Conversation starters Over time it will give you the average number of points for a sprint You will learn the teams velocity You need to have a clear definition of done (DoD) Sprint burndown chart Burndown charts X axis displays working days Y axis displays remaining effort Ideal effort is (may be) a good guideline Consists of real progress of effort Scrum team Why is Scrum effective? Systematic reduction of problems and risks A leaner software development cycle More adaptive process PeopleÂ´s motivation and pride are in focus Monitoring and Controlling Determine the current status of the project schedule Influencing the factors that create schedule changes Determining if the project schedule has changed Managing the actual changes as they occur Monitoring All parties, stakeholders and others, must have available the information required to exercise control over the project An effective information system is needed Automated and manual Collection, recording and reporting project information Activities and performance need to be monitored Controlling Uses monitored data and information to bring actual performance into agreement with the plan Do we have the right information? How shall we interpret the information? How to balance into decisions? Without control there would be confusion, scope risks and conflict among stakeholders Chaos could be the norm of the project Monitoring and Controlling are easily treated together Execute plan - Design the monitoring system Identify characteristics of scope, time and cost Identify the goals, the objectives Define the boundaries when do we need to take action? Thresholds. Monitor progress against the sub-goals (e.g. milestones, sprint goals) Define data gathering mechanisms Define communication plan Measure activities, but always measure against RESULTS Define the system before-hand, up front Obtain results Decide on the data format Frequency, e.g. occurrence of event Raw numbers, actual amount Subjective numeric ratings, estimates, ranking Indicators, indirect measures Verbal characterization, team spirit, soft issues, feelings Collect data Decide on how to collect the defined data. More easily and preferably automated. Analyse results Analyse BEFORE reporting Simple aggregation can be done Compare with the planned results Averages, summaries, medians, trends Examples Number of activities done/left Actual cost/remaining cost Number of bugs per unit Performance or velocity You should use data for discovering, and as input for decision making Identify variance and Analyse results Identify deviations from the plan Variances can lead to severe problems The goal is to identify variances as early as possible Use plots, bars, lines, dots, etc. for analyzing trends (more later) Compare the variances towards the planned (allowed) variances Variances Acceptable â€“ continue to monitor Unacceptable â€“ additional action is required Consult personnel Consult expertise Could it generate more problems? Any additional risks? Call for meeting, analyze in groups Identify root cause and consider options Do not immediately adopt the first identified solution Try to find the optimal solution Analyse side-effects to the different solutions Resources needed? Cost? Time? Need help/decisions from sponsor/stakeholders? Corrective action and implementation Decide on corrective actions Review options Define success measures if possible Make choices of actions Who decide? Implement How will it be implemented? By whom? When? Who is responsible? Analyse the results Analyse the results of the corrective actions Compare against the defined measurements If unacceptable result then go to root cause analysis (again) If acceptable close the problem and store into lessons learned Repository of Lessons Learned: Take care of your Best Practices Avoid the situation from re-occurring Reporting Different kinds of reports Status reports Progress reports Forecast report Time/Cost report Variance report Presentations Demos SWOT analysis Strengths and Weaknesses Internal factors Human factors Finances Organisational factors Physical resources Experiences and knowledge Opportunities and Threats Trends New research Funding Competitors Competence Channels (marketing) SWOT analysis Prioritize elements in the analysis Define possible activities Analyse if it is feasible Decide on further management and activities Close down strategic direction if found necessary Keep the SWOT-analysis continuously updated Focus on the prioritized elements Stakeholder Management Definition of the term stakeholder: An individual A group An organisation who may affect, be affected by, or perceive itself to be affected by a decision, activity, or outcome of a project. Project governance the alignment of the project stakeholdersÂ´ needs or objectives Stakeholder can be The sponsor, the one who provides the resources and support Customers and users persons or organisations that will approve and manage the projectÂ´s product, service or result. Sellers provides components or services necessary for the project Business partners provides special expertise, e.g. installation, training, support. Example Organizational groups internal groups affected by the project activities Functional managers human resource, financial, accounting, procurement, IT Other stakeholders government experts, subject matter experts, consultants, Project Cost estimation Budgeting the project Must (always) be approved by management Resources must be allocated based on the estimations Should be connected to the vision and goals Should be supporting to the portfolio and program management Upper management is always (?) relating the project success to its relation to the approved budget Budgeting the project, necessities Shall always be related to the stakeholder requirements You need to have an idea of which resources you have Correct data must be collected Timely reporting Strong focus on resource and cost predictions Confirm approval of changes Consider always changed cost predictions when decisions are taken Consider changed cost predictions when problems occur Estimate changed cost predictions if risks become problems Forecasting What resources will be needed? How much resources will be needed? When will they be needed? How much will the resources cost? The resource cost can be differentiated by Unit, role Individual, level of competence or salary Need to consider Unit (hours, days, weeks, money,â€¦) Level of precision (round up or down) Level of accuracy (range) Links to backlog and stories Threshold (agreed variations, if any) Performance measurement (earned value or story points left) Cost estimation tools and techniques Expert judgment Analogous estimation Parametric estimation Top-Down estimating Bottom-Up estimating Three-Point estimating Group-decision techniques Wide-band Delphi technique User story \u0026amp; story points User story A story is a feature a bit of functionality with some characteristics (non-functional characteristics) Keep the stories simple and as short as possible A story is an agreement between the customer and the supplier It must provide some value to the customer Stories should be independent of each other Stories must be testable Examples As a power user, I can specify files or folders to backup based on file size, date created and date modified. As a user, I can indicate folders not to backup so that my backup drive isn\u0026rsquo;t filled up with things I don\u0026rsquo;t need saved. As a consumer, I want shopping cart functionality to easily purchase items online. Agile and Scrum Agile and Scrum Agile volatile, easy to move, easy to change Scrum start the game over again. Was originally launched as a contrast to plan-driven development The goal is: To produce software more effectively Embrace change Embrace change quickly! The change towards agile is not easy You need to have the organization with you See change as something positive You need to change your mind-set Scrum is a risk reduction mechanism a leaner software process a more adaptive software project management process A framework based on a teamÂ´s self-organization, motivation, ownership and pride. Scrum master Ensuring that Scrum values, practices and rules are used Represents the management and the team to each other Guide and coach the team towards achieving the goals Should protect the team towards outside disturbances Support in keeping track of progress Organize retrospectives to help the team and the organization to learn how to be more effective Enforces immediate decisions needed 7 qualities In-depth theoretical and practical knowledge about Scrum Great servant-leadership ability Strong organizational skills Great communication skills Excellent presentation skills Conflict resolution skills Great human development skills Product Owner Guards the product vision Ensure the fulfilment of goals Focus is on delivering business values and results The dependence of a good product owner is high The focus is to control the backlog by working with the stakeholders identified Gather requirements for the backlog Solely controls the backlog Collaborate with the team and the scrum master to do release planning Guide and support the team Keeps himself/herself updated with project progress Are available to the team, give the team feedback Is one person, not a team 7 qualities Know how to manage stakeholderÂ´s expectations and sometimes their conflicting priorities Have a clear vision and knowledge of the product Know how to gather the requirements and turn them into a good product backlog Be available for the team Know how to be a good organizer Know how to communicate better than the average person Knows that it is all about servant leadership The Development Team, the Scrum team Self-managed and self-organized Estimate backlog items, stories Turns items, stories into tasks to work on in the Sprints Commits to the sprint goals Keeps track of progress Responsible for Sprint demos The team should solve their internal problems by themselves The team should be small, 7 +- 2 persons Minimize communication interfaces Teams should be cross-functional, including different capabilities Open work environments are to be preferred Agile Manifesto Individuals and interactionsâ€”â€”over processes and tools Working softwareâ€”â€”over comprehensive documentation Customer collaborationâ€”â€”over contract negotiation Responding to changeâ€”â€”over following a plan Daily Scrum meetings Where the team communicates Approximately 15 minutes, short meetings Stand-up meeting Focus on three things: What has been done since the previous meeting? What are we going to do? What risks and problems exists? Removing obstacles Making necessary decisions Leadership style, Situational leadership style Project Manager The person assigned by the performing organization to lead the team that is responsible for achieving the project objectives Interpersonal skills needed Leadership Team building Motivation Communication Influencing Decision making Political (company and business) awareness Cultural awareness Negotiation Trust building Conflict (healthy and unhealthy) management Coaching ","permalink":"https://zjxjwxk.github.io/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/applied-software-project-management/","summary":"\u003ch1 id=\"general-characteristics-of-a-project\"\u003eGeneral characteristics of a project\u003c/h1\u003e\n\u003cp\u003eA project is a temporary endeavour undertaken to create a unique product or service. It is specific, timely, usually multidisciplinary, and always conflict ridden. Projects are parts of overall programs and may be broken down into tasks, subtasks, and further if desired.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eVary in size\u003c/li\u003e\n\u003cli\u003eVary in type\u003c/li\u003e\n\u003cli\u003eHave desired completion dates\u003c/li\u003e\n\u003cli\u003eRequires various kinds of knowledge\u003c/li\u003e\n\u003cli\u003eRequires domain knowledge\u003c/li\u003e\n\u003cli\u003eRequires team work\u003c/li\u003e\n\u003cli\u003eRequires responsibilities and authorities\u003c/li\u003e\n\u003cli\u003eDo not exist in isolation\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"general-management-vs-project-management\"\u003eGeneral management vs. Project management\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eGeneral management\n\u003cul\u003e\n\u003cli\u003eOrganizational management\u003c/li\u003e\n\u003cli\u003ePortfolio management\u003c/li\u003e\n\u003cli\u003eProgram management\u003c/li\u003e\n\u003cli\u003eNot time limited?\u003c/li\u003e\n\u003cli\u003eNo completion dates?\u003c/li\u003e\n\u003cli\u003eNo managerial hierarchy?\u003c/li\u003e\n\u003cli\u003eRoutine activities\u003c/li\u003e\n\u003cli\u003eAnnual budgeting\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eProject management\n\u003cul\u003e\n\u003cli\u003eProject management is the application of knowledge, skills, tools, and techniques to project activities to meet the project requirements\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"five-categories-of-activities\"\u003eFive categories of activities\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eInitiating\u003c/li\u003e\n\u003cli\u003ePlanning\u003c/li\u003e\n\u003cli\u003eExecuting\u003c/li\u003e\n\u003cli\u003eMonitoring and Controlling\u003c/li\u003e\n\u003cli\u003eClosing\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"how-does-the-world-look-like\"\u003eHow does the world look like?\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eUncertainty\u003c/li\u003e\n\u003cli\u003ePlans go awry\u003c/li\u003e\n\u003cli\u003eEven the closest future is unpredictable\u003c/li\u003e\n\u003cli\u003eChance events occur frequently\u003c/li\u003e\n\u003cli\u003eThe life is a rough road\u003c/li\u003e\n\u003cli\u003eWe need to do trade-offs every day\u003c/li\u003e\n\u003cli\u003eWe constantly negotiate\u003c/li\u003e\n\u003cli\u003eWe need flexibility\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"risk-management\"\u003eRisk management\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eâ€œProject management is risk managementâ€\u003c/li\u003e\n\u003cli\u003eIdentify potential problems before they occur\u003c/li\u003e\n\u003cli\u003ePut preventive actions in place before unrecoverable harm occurs\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"risks\"\u003eRisks\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003epossible events that may affect the project negatively\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"problems\"\u003eProblems\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eevents that have or will affect the project negatively\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"stages-in-risk-management\"\u003eStages in risk management:\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eRisk identification; project, product and business risks\u003c/li\u003e\n\u003cli\u003eRisk analysis; probability and consequences, triggers\u003c/li\u003e\n\u003cli\u003eRisk planning; how to address risks â€“ eliminate, reduce, ignore\u003c/li\u003e\n\u003cli\u003eRisk monitoring; controlling and updating the risks\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg alt=\"Risk reporting Matrix\" loading=\"lazy\" src=\"/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/applied-software-project-management/images/1548175505399.png\"\u003e\u003c/p\u003e","title":"Applied Software Project Management"},{"content":"CH 1. What is software architecture? What is software architecture The software architecture of a system is the set of structures needed to reason about the system, which comprise software elements, relations among them, and properties of both.\nTo find out what users of the system think about the system. Ã— To assist in marketing activities. Ã— To make estimate for projects planning purposes. âˆš To use as input for dividing up the work into tasks. âˆš To analyze and predict characteristics of the implemented system. âˆš To present the future development of the product. Ã— Categories of structures First, some structures partition systems into implementation units called modules. Other structures are dynamic, meaning that they focus on the way the elements interact with each other at runtime to carry out the systemâ€™s functions. we will call runtime structures component-and-connector (C\u0026amp;C) structures. A third kind of structure describes the mapping from software structures to the systemâ€™s organizational, developmental, installation, and execution environments. These mappings are called allocation structures. Three Kinds of Structures Module structures embody decisions as to how the system is to be structured as a set of code or data units that have to be constructed or procured.\nDecomposition structure. The units are modules that are related to each other by the is-a-submodule-of relation, showing how modules are decomposed into smaller modules recursively until the modules are small enough to be easily understood. Uses structure. The units are related by the uses relation, a specialized form of dependency. Layer structure. The modules in this structure are called layers. A layer is an abstract â€œvirtual machineâ€ that provides a cohesive set of services through a managed interface. Component-and-connector structures embody decisions as to how the system is to be structured as a set of elements that have runtime behavior (components) and interactions (connectors).\nService structure. The units here are services that interoperate with each other by service coordination mechanisms. Concurrency structure. This component-and-connector structure allows the architect to determine opportunities for parallelism and the locations where resource contention may occur. Allocation structures embody decisions as to how the system will relate to nonsoftware structures in its environment (such as CPUs, file systems, networks, development teams, etc.).\nDeployment structure. The deployment structure shows how software is assigned to hardware processing and communication elements. Implementation structure. This structure shows how software elements (usually modules) are mapped to the file structure(s) in the systemâ€™s development, integration, or configuration control environments. Work assignment structure. This structure assigns responsibility for implementing and integrating the modules to the teams who will carry it out. CH 4. Understanding Quality Attributes System requirements can be categorized as Functional requirements. These requirements state what the system must do, and how it must behave or react to run-time stimuli.\nQuality attribute requirements. These requirements annotate (qualify) functional requirements. Qualification might be how fast the function must be performed, how resilient it must be to erroneous input, how easy the function is to learn, etc.\nConstraints. A constraint is a design decision with zero degrees of freedom. That is, it\u0026rsquo;s a design decision that has already been made for you.\nQuality Attribute Requirements six parts Source of stimulus. This is some entity (a human, a computer system, or any other actuator) that generated the stimulus. Stimulus. The stimulus is a condition that requires a response when it arrives at a system. Environment. The stimulus occurs under certain conditions. The system may be in an overload condition or in normal operation, or some other relevant state. For many systems, â€œnormalâ€ operation can refer to one of a number of modes. For these kinds of systems, the environment should specify in which mode the system is executing. Artifact. Some artifact is stimulated. This may be a collection of systems, the whole system, or some piece or pieces of it. Response. The response is the activity undertaken as the result of the arrival of the stimulus. Response measure. When the response occurs, it should be measurable in some fashion so that the requirement can be tested. Guiding Quality Design Decisions Architecture design is a systematic approach to making design decisions. We categorize the design decisions that an architect needs to make as follows: Allocation of responsibilities Coordination model Data model Management of resources Mapping among architectural elements Binding time decisions Choice of technology Coordination model Software works by having elements interact with each other through designed mechanisms. These mechanisms are collectively referred to as a coordination model. Decisions about the coordination model include these: Identifying the elements of the system that must coordinate, or are prohibited from coordinating. Determining the properties of the coordination, such as timeliness, currency, completeness, correctness, and consistency. Choosing the communication mechanisms (between systems, between our system and external entities, between elements of our system) that realize those properties. Important properties of the communication mechanisms include stateful versus stateless, synchronous versus asynchronous, guaranteed versus nonguaranteed delivery, and performance-related properties such as throughput and latency. Example: Both asynchronous communication and synchronous communication can be used in the same system Asynchronous communication does not block the program thread until a response is ready Asynchronous communication guarantees when a response is returned Data model Every system must represent artifacts of system-wide interestâ€”dataâ€”in some internal fashion. The collection of those representations and how to interpret them is referred to as the data model. Decisions about the data model include the following: Choosing the major data abstractions, their operations, and their properties. This includes determining how the data items are created, initialized, accessed, persisted, manipulated, translated, and destroyed. Compiling metadata needed for consistent interpretation of the data. Organizing the data. This includes determining whether the data is going to be kept in a relational database, a collection of objects, or both. If both, then the mapping between the two different locations of the data must be determined. Example: Choosing the major data abstractions, their operations, and their properties. Compiling metadata needed for consistent interpretation of the data. Organizing the data. Binding time decisions Binding time decisions introduce allowable ranges of variation. This variation can be bound at different times in the software life cycle by different entitiesâ€” from design time by a developer to runtime by an end user. A binding time decision establishes the scope, the point in the life cycle, and the mechanism for achieving the variation. The decisions in the other six categories have an associated binding time decision. Examples of such binding time decisions include the following: For allocation of responsibilities, you can have build-time selection of modules via a parameterized makefile. For choice of coordination model, you can design runtime negotiation of protocols. For resource management, you can design a system to accept new peripheral devices plugged in at runtime, after which the system recognizes them and downloads and installs the right drivers automatically. For choice of technology, you can build an app store for a smartphone that automatically downloads the version of the app appropriate for the phone of the customer buying the app. Example: Setting the hostname of the server in a configuration file Using the user input to set the destination of a message Using inheritance in the code to execute the different subclass implementations depending on program state Quality attributes Availability Interoperability Modifiability Performance Security Testability Usability Development time qualities Modifiability Testability CH5. Availability Terms Fault A failureâ€™s cause is called a fault. A fault can be either internal or external to the system under consideration. Intermediate states between the occurrence of a fault and the occurrence of a failure are called errors. Failure A failure is the deviation of the system from its specification, where the deviation is externally visible. Fault and failure Fault Internal or external deviation of correct function Failure When the system cannot provide its intended service Caused by faults that could not be handled/repaired Resilient Faults can be prevented, tolerated, removed, or forecast. In this way a system becomes â€œresilientâ€ to faults. Degraded operation mode we are often concerned with the level of capability that remains when a failure has occurredâ€”a degraded operating mode. MTBF mean time between failures MTTR mean time to repair Formula $$ MTBF\\over(MTBF+MTTR)\u0013 $$\nService Level Agreement, SLA The availability provided by a computer system or hosting service is frequently expressed as a service-level agreement. This SLA specifies the availability level that is guaranteed and, usually, the penalties that the computer system or hosting service will suffer if the SLA is violated. Tactic Detect Faults Heart-beat Heartbeat is a fault detection mechanism that employs a periodic message exchange between a system monitor and a process being monitored. Ping/Echo Ping/echo refers to an asynchronous request/response message pair exchanged between nodes, used to determine reachability and the round-trip delay through the associated network path. Heart-beat tactic vs. Ping/Echo- tactic The big difference between heartbeat and ping/echo is who holds the responsibility for initiating the health checkâ€”the monitor or the component itself. Recover from Faults Active Redundancy Active redundancy (hot spare). This refers to a configuration where all of the nodes (active or redundant spare) in a protection group receive and process identical inputs in parallel, allowing the redundant spare(s) to maintain synchronous state with the active node(s). Passive Redundancy Passive redundancy (warm spare). This refers to a configuration where only the active members of the protection group process input traffic; one of their duties is to provide the redundant spare(s) with periodic state updates. Spare Spare (cold spare). Cold sparing refers to a configuration where the redundant spares of a protection group remain out of service until a fail-over occurs, at which point a power-on-reset procedure is initiated on the redundant spare prior to its being placed in service. Rollback Rollback. This tactic permits the system to revert to a previous known good state, referred to as the â€œrollback lineâ€â€”rolling back timeâ€”upon the detection of a failure. Fault tree Fault tree analysis is an analytical technique that specifies a state of the system that negatively impacts safety or reliability, and then analyzes the systemâ€™s context and operation to find all the ways that the undesired state could occur.\nCH7. Modifiability What is Modifiabilityï¼Ÿ Modifiability is about change and our interest in it is in the cost and risk of making change To plan for modifiability, an architect has to consider four questions: What can change? A change can occur to any aspect of a system: the functions that the system computes, the platform (the hardware, operating system, middleware), the environment in which the system operates (the systems with which it must interoperate, the protocols it uses to communicate with the rest of the world), the qualities the system exhibits (its performance, its reliability, and even its future modifications), and its capacity (number of users supported, number of simultaneous operations). What is the likelihood of the change? One cannot plan a system for all potential changesâ€”the system would never be done, or if it was done it would be far too expensive and would likely suffer quality attribute problems in other dimensions. Although anything might change, the architect has to make the tough decisions about which changes are likely, and hence which changes are to be supported, and which are not. When is the change made and who makes it? Most commonly in the past, a change was made to source code. Changes can be made to the implementation (by modifying the source code), during compile (using compile-time switches), during build (by choice of libraries), during configuration setup (by a range of techniques, including parameter setting), or during execution (by parameter settings, plugins, etc.). A change can also be made by a developer, an end user, or a system administrator. What is the cost of the change? Making a system more modifiable involves two types of cost: The cost of introducing the mechanism(s) to make the system more modifiable The cost of making the modification using the mechanism(s) CH8. Performance Performance General Scenario Portion of Scenario Possible Values Source Internal or external to the system Stimulus Arrival of a periodic, sporadic, or stochastic event Artifact System or one or more components in the system Environment Operational mode: normal, emergency, peak load, overload Response Process events, change level of service Response Measure Latency, deadline, throughput, jitter, miss rate Tactics for Performance Control Resource Demand Manage sampling rate. If it is possible to reduce the sampling frequency at which a stream of environmental data is captured, then demand can be reduced, typically with some attendant loss of fidelity. Limit event response. Process events only up to a set maximum rate, thereby ensuring more predictable processing when the events are actually processed. Prioritize events. If not all events are equally important, you can impose a priority scheme that ranks events according to how important it is to service them. Manage Resources Increase resources. Faster processors, additional processors, additional memory, and faster networks all have the potential for reducing latency. Introduce concurrency. Concurrency can be introduced by processing different streams of events on different threads or by creating additional threads to process different sets of activities. Maintain multiple copies of computations. Reduce the contention that would occur if all computations took place on a single server. CH13. Patterns and Tactics What is a Pattern? An architectural pattern\nis a package of design decisions that is found repeatedly in practice, has known properties that permit reuse, and describes a class of architectures. Architectural Pattern A context. A recuSrring, common situation in the world that gives rise to a problem. A problem. The problem, appropriately generalized, that arises in the given context. A solution. A successful architectural resolution to the problem, appropriately abstracted. The solution for a pattern is determined and described by: A set of element types (for example, data repositories, processes, and objects) A set of interaction mechanisms or connectors (for example, method calls, events, or message bus) A topological layout of the components A set of semantic constraints covering topology, element behavior, and interaction mechanisms CH18. Architecture Document View consistency A view is consistent with its definition when: All elements that fulfills the selection criterion is in the view All relations that fulfills the selection criterion is in the view That all properties that fulfills the selection criterion is in the view THAT NO additional elements, relation or properties that does not meet the selection is in the view Elements All elements in the view must have a corresponding part in the view definition.\nRelation Only relations that meet the selection criteria must be in the view.\nProperties Properties must have values in the view.\nCriteria Selection criteria can exclude certain elements or relations from the view.\n4+1 view model Logical, Process, Development, Physical + Use Cases\n","permalink":"https://zjxjwxk.github.io/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/software-architecture-and-quality/","summary":"\u003ch1 id=\"ch-1-what-is-software-architecture\"\u003eCH 1. What is software architecture?\u003c/h1\u003e\n\u003ch2 id=\"what-is-software-architecture\"\u003eWhat is software architecture\u003c/h2\u003e\n\u003cp\u003eThe software architecture of a system is the set of structures needed to reason about the system, which comprise software elements, relations among them, and properties of both.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eTo find out what users of the system think about the system. Ã—\u003c/li\u003e\n\u003cli\u003eTo assist in marketing activities. Ã—\u003c/li\u003e\n\u003cli\u003eTo make estimate for projects planning purposes. âˆš\u003c/li\u003e\n\u003cli\u003eTo use as input for dividing up the work into tasks. âˆš\u003c/li\u003e\n\u003cli\u003eTo analyze and predict characteristics of the implemented system. âˆš\u003c/li\u003e\n\u003cli\u003eTo present the future development of the product. Ã—\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"categories-of-structures\"\u003eCategories of structures\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eFirst, some structures partition systems into implementation units called \u003cstrong\u003emodules\u003c/strong\u003e.\u003c/li\u003e\n\u003cli\u003eOther structures are dynamic, meaning that they focus on the way the elements interact with each other at runtime to carry out the systemâ€™s functions. we will call runtime structures \u003cstrong\u003ecomponent-and-connector (C\u0026amp;C) structures\u003c/strong\u003e.\u003c/li\u003e\n\u003cli\u003eA third kind of structure describes the mapping from software structures to the systemâ€™s organizational, developmental, installation, and execution environments. These mappings are called \u003cstrong\u003eallocation structures\u003c/strong\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"three-kinds-of-structures\"\u003eThree Kinds of Structures\u003c/h2\u003e\n\u003ch3 id=\"module-structures\"\u003e\u003cstrong\u003eModule structures\u003c/strong\u003e\u003c/h3\u003e\n\u003cp\u003eembody decisions as to how the system is to be structured as a set of code or data units that have to be constructed or procured.\u003c/p\u003e","title":"Software Architecture and Quality"},{"content":"Career decision making cycle Know the elements Communication, Analysis, Synthesis, Valuing, Execution\nKnow the definition Communication: Identifying the gap Analysis: Thinking about alternatives Synthesis: Creating likely alternatives Valuing: Prioritizing alternatives Execution: Taking action to narrow the gap\nBe able to elaborate the elements Communication: â€¢ Become aware of the gap â€¢ Discomfort, not so much fear of change â€¢ Seek assistance if needed â€¢ Emotions Analysis: â€¢ Clarify your knowledge â€¢ Clarify gap â€¢ Understand how you make decisions â€¢ Understand what influences you â€¢ What do you want? â€¢ What have you learned? â€¢ What are your values, interests and skills? â€¢ Do you want to take responsibility? â€¢ Self-awareness Synthesis: â€¢ Solve the gap â€¢ Avoid missing alternatives â€¢ Reduce to a manageable amount of options. â€¢ Brainstorm and reduce. Valuing: â€¢ Judge the benefit (and cost) â€¢ Rank â€¢ WhatÂ´s the best choice? â€¢ Select an option Execution: â€¢ Convert decisions into action â€¢ Formulate a goal and a plan â€¢ Execute the plan â€¢ Plan, try, evaluate\nDescribe forces that affect our career The world is rapidly changing The economy goes up and down New companies emerges Some companies close down Unemployment goes up and down Organizational failures appears sometimes Career planning vs. workforce planning Career development What the individuals in the organization do in order to ensure their interests and future Workforce planning What the organization does in order to ensure growth and profit Activities to find employers Business/Industry Government Education Non-profit Private The elements of a job campaign, describe and elaborate Gain Experience Create Connections First Impressions Count Be Professional Be Prepared and Persistent Be Realistic, Open-minded and Flexible Elements and recommendations for writing a CV Elements Identification Career objective Education/Training Experience Other categories as appropriate References Recommendations Be brief Be consistent Be positive Be honest Be neat Know basic elements for good communication Treat others as you would like to be treated yourself\nThe typical team, as defined by Brown Designers Managers Subject Matter Experts Stakeholders The three values of the glue of a team Respect Humility Empathy Be able to distinguish between assignment and commitment Assignments Assignments should be commitments Pressure to deliver Requirements to perform The expected result The expected cost Within the expected time frame Normally, these three items are pushed to its limits Commitment Should be voluntarily Deadlines, delivery dates should be defined Should be specific, clearly defined Clearly motivated Admit problems and risks Practice commitment culture Mindset defined (Perception, Attitude, Disposition) Perception â€“ How to interpret thing\nAttitude â€“ How to react\nDisposition â€“ Decide course of action, what to do\nDifferent mindsets Active listening Active listening Understanding Acknowledge Encourage Elaborate Hear others ideas See others ideas Types of listening Prepare â€“ Get ready\nPause â€“ Give time for speaking\nProbe â€“ Let people elaborate\nParaphrase/re-phrase â€“ Summarize\nâ€“ Repeat\nâ€“ Confirm\nThree obstacles to listening Short-circuiting Closed doors Embattled egos Browns definition of conflict Conflict is the way teams come to a shared understanding of each decision made in the process\nOrigins to conflicts â€¢ Differences in objectives â€¢ Different opinions â€¢ Different values â€¢ Argumentation and friction are unavoidable â€¢ Negotiations with the customer â€¢ Argumentation within the project organization â€¢ Different or changed priorities\nPositive consequences of conflicts Produces better ideas Forces people to search for new approaches Causes problems to surface Forces clarification Stimulates interest and creativity An opportunity for people to test capacities Shared understanding Obstacles to shared understanding Unclear goals Unclear process, directions Unknown constraints Personal disagreements Misconception Ego Disinterest Healthy and unhealthy conflicts Unhealthy conflict A mask for â€“ Not understanding â€“ Not knowing â€“ Anxiety for the decision â€“ Personal conflicts\nRoot causes to conflicts External Four types of tensions â€“ Disconnectedness â€“ Exclusion â€“ Misdirection â€“ Ambiguity\nInternal Method conflict â€“ Different ways of interpreting the method â€“ HOW things are to be done â€“ Different criteria for success â€“ Re-do things â€“ Adapt and tailor the method â€“ Could be hidden by an outcome conflict â€“ Usually it is healthy, it progresses work\nOutcome conflict â€“ â€œThe content of a decisionâ€ â€“ Product outcomes â€“ how the product look like â€“ Poor performance â€“ how to work â€“ How to structure (Plan) the project â€“ Purpose conflict â€“ Why is this done? â€“ Lack of decisions, lack of clarity\nKnow the five principles of behaviour patterns There is no single right answer Patterns may introduce new approaches Not every pattern works in every situation Several patterns may give the same result Patterns that are experienced as comfortable may be your favourite patterns \u0013The four types of patterns to solve root causes of conflicts Empathize â€“ Break down misunderstandings â€“ shared understanding â€“ Let a neutral person take notes Involve â€“ To get more involvement â€“ Story telling. Could use neutral persons Redirect â€“ Find focus, narrow the scope, take baby steps Reframe â€“ Use different words, find other approaches The definition of collaboration â€¢ Collaboration means â€œworking togetherâ€ according to the dictionary â€¢ In software projects it also includes â€œproducing somethingâ€\nCollaboration vs. Groupthink Collaboration Working together Groupthink When you agree rather than come up with something better Collaboration should lead to groupthink\nAspects of collaboration Tools The tools have different focus Tools helps in sharing and collaboration Software tools for â€“ Messages â€“ Chats â€“ Video\nMindset Perception â€“ How to interpret thing\nAttitude â€“ How to react\nDisposition â€“ Decide course of action, what to do\nCulture â€¢ Open workspaces or closed rooms? â€¢ Dislike in some way of communicating â€¢ Against or for face-to-face communication â€¢ Organizational limitations and boundaries â€¢ Competition between people â€¢ Heading for a promotion?\nThe four virtues of collaboration Clarity and Definition Accountability and Ownership Awareness and Respect Openness and Honesty situations example interpretation pattern design ignorance â€œI donâ€™t see why we even need to spend time on this.â€æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦æµªè´¹æ—¶é—´åšè¿™ä¸ª Designers sometimes find themselves defending the practice of design itself. reflect the position(è€ƒè™‘ä»–çš„ä½ç½®); anticipate agendas; communicate implications è®¨è®ºå½±å“ï¼ˆå¦‚æœ..ä¼š..?ï¼‰ Distracted by internal competitionå†…éƒ¨çŸ›ç›¾ â€œThe marketing team is setting up their own Web site.â€ Members of the project team lose focus on project objectives because they are distracted by a competitor Help me prioritize; Fame the conversition; Recount previous conversation Distracted by shiny objectsï¼ˆconsequence of distractionï¼‰ â€œOur site needs social sharing functions.â€ â€œShiny objectsâ€ is one term for ideas or technologies or techniques that have captured the imagination of the public or the industry. make it real; hold a workshop; offer alternatives(åšä¸€äº› mock-upæ¥æ¯”è¾ƒ) Donâ€™t know what we need â€œWhat do you think we should do?â€ Without a clear definition of the design problem, the project team may run in different directions. provide starting points; set reasonable expectations; make assumption; Efforts ignored â€œThis stuff doesnâ€™t really matter because weâ€™re working on a separate track.â€ åˆ©ç›Šç›¸å…³è€…æˆ–å…¶ä»–æˆå‘˜é€‰æ‹©å¿½è§†outputs, recommendations, and solutions provided by people assigned to those activities. convert failure to action; help me help you; blame a â€œbad copâ€ Excluded from planning â€œItâ€™s a shame sheâ€™s not in the meeting. All these action items are for her.â€ In this situation, the people responsible for delivering and executing are not included in the planning process. acknowledge achievements; communicate implications; reduce the assignment False consensus â€œI think we all agree here.â€ å¤§å®¶éƒ½è®¤ä¸ºå·²ç»è¾¾åˆ°å…±è¯†äº†ï¼Œä½†ä»”ç»†æƒ³æƒ³å…¶å®æ²¡æœ‰ In this situation the team comes to some agreement (on direction or approach, for example) but doesnâ€™t re ask for a story; communicate implications; help me make this better(è¯´å‡ºæœ‰æŒ‘æˆ˜çš„ç‚¹) Inconsistent expectations â€œThatâ€™s not what I said!â€ From one conversation to the next, team members change their expectations. Blame a â€œbad copâ€; make it real; set reasonable expectations Insufficient progress é¡¹ç›®è¿›åº¦å¾ˆæ…¢ï¼Œå’Œæ‡’æƒ°æœ‰å…³ â€œYouâ€™ve done how much?â€ assigned tasks remain incomplete, design problems remain unsolved, or feedback isnâ€™t fully incorporated. Go back to basics; Reduce the assignment; set reasonable expectations Irrelevant (æ— å…³ç´§è¦çš„)comparisons â€œHave you seen this Web site?â€ someone contributes comparative examples with little or no practical relevance to the design problem consider micro/macro perspectives; help me prioritizeæŒ‡å‡ºå“ªé‡Œç›¸å…³; communicate implications Lack of clear inputs â€œMmm\u0026hellip; yeah\u0026hellip; weâ€™re not going to have the budget to do user research.â€ Designers donâ€™t have detailed inputs (requirements, starting points, etc.) to frame the problem and inform the solution. Make a plan; Make it real; Make assumptions Lack of context â€œThereâ€™s a lot going on behind the scenes here\u0026hellip;â€ Teams do not have insight into the organizational, business, or operational context surrounding a project. Pick one thing; Help me help you; List assumptions Lack of decision maker â€œSo, what does the group think?â€ Design decisions drag out because no authority is capable of rendering executive decisions when necessary. anticipate agendas; hold a workshop; communicate implications Lack of stable strategy â€œSo, things have changed since we last spoke\u0026hellip;â€ the projectâ€™s objectives, parameters, or constraints change regularly. make assumptionä¸€äº›åŸåˆ™; blame a â€œbad copâ€åˆ¶å®šdeadline; treat it like a project Late-breaking requirements â€œNow that I think about it, weâ€™re also going to need\u0026hellip;â€ the stakeholder who didnâ€™t have time to participate in the process; the one thing that one guy forgot; a change to the business that has a ripple effect throughout all the companyâ€™s systems. Help me prioritize; make it real; make a plan Misinterpretation of tone â€œYour email was really snippy.â€ breeds hostility(æ•Œæ„) or disrespect in the communications. Change the channel; reflect the position; come back later New perspectives â€œI know Iâ€™m coming in with this late, but\u0026hellip;â€ stakeholders offering new perspectives may not welcome their positions being hastily dismissed.(ç«‹åœºè¢«é©³å›) assert your process; frame the conversation(å’Œåˆ©ç›Šç›¸å…³è€…å»ºç«‹è°ˆè¯); offer alternativesï¼ˆæä¾›æ›´å¤šçš„é€‰æ‹©ï¼‰ No plan â€œOK, so what do we do next?â€ In this situation, the project lacks a plan that defines desired outcomes, activities, schedule, and assignments. Blame a â€œbad copâ€; draw pictures; offer alternatives No time to design â€œJust get some rough ideas down by tomorrow, OK?â€ Forces outside the design team establish an unreasonable schedule for producing design ideas assert your process(åšæŒè‡ªå·±ï¼Œè¯´å®Œä¸æˆ); help me help you; set reasonable expectations Not a team player æ‹’ç»å’Œåˆ«äººåˆä½œ â€œI can take care of this.â€ Someone on the team refuses to engage with other members Ask for help; Go back to basic; communicate implications Overpreparationè®¤ä¸ºå·²ç»è§£å†³äº†é—®é¢˜ â€œI think weâ€™ve got the solution already.â€ Product teams may create early mock-ups to frame the problem, which locks them into a particular way of thinking about the problem. Hold a workshop; ask questions; ask for a story Poorly composed feedback â€œThat just doesnâ€™t look right to me.â€ The team receives feedback that doesnâ€™t clearly articulate the next steps, the desired improvements, or the issues with the current version. Frame the conversation; take baby steps(go through the design point by point); change the metaphor Poorly planned presentation or discussion â€œI hate to put you on the spot, but\u0026hellip;â€ Project stakeholders do not understand the design work because the design team hasnâ€™t assembled a meaningful narrative set reasonable expectations; assert your process; ask questions Reluctant participation in design activities (ä¸€äº›äººä¸ç§¯æå‚ä¸design) â€œIâ€™ll leave the drawing to my colleagues.â€ Some members of the team may not actively participate in creative games and brainstorming activities. provide starting points; assert your process; communicate implications Responses not timely â€œ[This quote intentionally left blank.]â€ provide starting points; assert your process; communicate implications(å’Œ25patternä¸€æ ·) Separated from key stakeholders â€œLet me take this to the VP, and Iâ€™ll let you know what she says.â€ Designers find themselves separated from the true client or customer through layers of bureaucracy. Hold a workshop; assert your process; take baby steps Tasks and goals not aligned â€œEveryone says we need to hold a daylong brainstorming session.â€ Designers sometimes engage in design activities with no real rationale. Such activities yield outcomes that likely donâ€™t move the project forward, or do so inefficiently. set expectations; ask for the first step; make a plan Uncoordinated collaboration â€œSo, which one of us is doing this?â€(åˆ†é…ä»»åŠ¡) Some project teams have no plan, no overall direction of where theyâ€™re going long-term and the activities required to get there. Take responsibility; provide starting points; enumerate issues Unfounded design directionï¼ˆæ¯«æ— æ ¹æ®çš„è®¾è®¡æ–¹å‘ï¼‰ â€œHey, I did some mock-ups!â€ Someone outside the design team prepares screen designs, concepts, or other artifacts attempting to establish a creative direction. When a non-designer shows up with design artifacts, the team may feel tension because it implies lack of performance from the designers. Ask questions; take responsibility; acknowledge achievements Unreasonable constraints â€œI want the design to look the same on every Web browser.â€ Designers thrive on constraints: boundaries help designers understand what constitutes a good solution for the challenge. Some projects, however, are bounded by constraints that are arbitrary. consider micro/macro perspectives; help me prioritize; make it real Wrong scope â€œWhat do you mean I wasnâ€™t supposed to work on that?â€ A designer works on the wrong thing. Take responsibility; acknowledge achievements; Go back to basics pattern Acknowledge achievementsï¼ˆinvolve â€œWow, you guys did a great job on this. I can see the effort you put in. Can you walk me through to make sure I understand everything?â€ Engaging with someone about his or her work, and potentially balancing achievements with opportunities for improvement. Anticipate agendasï¼ˆempathize â€œI know there are a few things that are especially important to you, so I wanted to address them right away.â€ Imagine whatâ€™s important to other members of the team or project stakeholders before engaging in a discussion with them. Entering a conversation with people expected to be competitive or confrontational, to demonstrate that you have their best interest in mind. ask for a storyï¼ˆreframe Ask someone to describe their ideas or thoughts or needs in the form of a story. Someone struggles to articulate their needs in the abstract, and you want to help them make it more concrete. ask for helpï¼ˆinvolve Directly ask someone to help you with your task. You need help. Youâ€™re preoccupied with proving yourself instead of solving the design problem. ask for the first step(Reframe) Ask someone what their first step will be in attempting to achieve an objective. Someone struggles to articulate their process for performing a task, by getting them to focus only on a small slice. ask questions(Reframe,Involve) Instead of jumping to conclusions, ask questions to make sure both you and the other people understand whatâ€™s going on. All. The. Time. No other skill is as essential to designers as being able to ask good questions. Except, perhaps, listening to the answers. assert your process(redirect) Remind participants of the schedule and the process on which it is based, providing lots of detail about activities, outcomes, and goals. Someone introduces factors that may compromise or derail the process, like late-breaking requirements. Blame a â€œbad copâ€(reframe) Use another team member (not present) as a scapegoat. By putting a human face on the situation, people might work harder to find a compromise, or might forgive ignorance. Facing unreasonable constraints or being put on the spot for a question you canâ€™t answer immediately. Call their bluff(æ­å‘åº•ç‰Œ) reframe Take a challenge to its inevitable conclusion and hold everyone involved accountable for meeting the challenge. Help other team members understand the impact of their request. Presented with unreasonable requests that aim to put pressure on the design team without any meaningful outcome. Capture lessons learnedï¼ˆinvolveï¼Œredirectï¼‰ Make a list of issues, obstacles, and difficulties that came out of a prior project or situation or challenge. The project team hasnâ€™t taken a moment to reflect on their previous work and how they could have done it better. change the channelï¼ˆemailï¼Œvoiceï¼Œetcï¼‰ï¼ˆreframe Find a different â€œchannelâ€ in which to communicate. Sometimes this means moving from email to voice, or in person to email, or instant messenger to video chat. Sometimes this means taking a conversation out of a public venue. The medium of communications is impacting participantsâ€™ ability to express themselves clearly. Change the metaphorï¼ˆreframeï¼‰ Use a different concept to explore or explain a complex idea. Participants become fixated on the metaphor and not the problem being solved, or when participants need a new way of looking at the same old problem. Channel your colleaguesâ€™ best qualitiesï¼ˆredirect ï¼Œæƒ³æƒ³ä¸€ä¸ªèƒ½å¤„ç†å¥½è¿™ä»¶äº‹çš„äººã€‚è€ƒè™‘ä»–ä»¬å°†å¦‚ä½•è¡¨ç°,å¹¶è¯•å›¾å°†å…¶èå…¥åˆ°æƒ…å†µã€‚ Confronting a situation that is causing you particular anxiety or frustration. Sometimes, pretending to be a different person allows us to tap into not only their capabilities, but also their strength. come back laterï¼ˆEmpathize, Redirect Postpone(å»¶æœŸ) taking action until participants can consider the situation more deliberately. The situation has gotten out of hand, such that the participants arenâ€™t providing reasonable and appropriate contributions Communicate implicationsï¼ˆreframe â€œIf we donâ€™t get feedback until next week, weâ€™ll have to shift our delivery milestones. Without feedback, Iâ€™m worried that weâ€™ll have more work later in the project dealing with late-breaking requirements.â€ State, in the simplest terms possible, the consequences of a decision Participants make decisions without realizing the negative consequences for the process or project outcome. Consider micro/macro perspectivesï¼ˆredirect Look at the situation from two different angles, broad versus narrow or high versus low. Adopting a new perspective can help expose new issues and solutions. Participants become so focused on one perspective that they lose sight of the project or task objectives Consider your work/their workï¼ˆreframe Offer encouragement and deflate the anxiety of critique by reminding colleagues that stakeholders and other team members are just doing their jobs. Confrontations have escalated to the extent that participants are having trouble hearing each otherâ€™s concerns Convert failure to actionï¼ˆredirect Take outcomes that seem to be dead ends and use those as starting points for subsequent tasks. Confronted by people who approach failure with a gloom and doom attitude, thinking that nothing is recoverable from such outcomes draw picturesï¼ˆreframe Use visual aids, spontaneous sketches, whiteboards, diagrams, or other visualizations to organize thoughts. Encourage participants to draw or embellish othersâ€™ drawings. Participants are having trouble making sense of each otherâ€™s statements Frame the conversationï¼ˆInvolve, Redirectï¼‰ Establish a structure for conversations, with clearly articulated topics and goals. To the extent feasible, identify items outside the scope of the discussion to avoid getting off track. Participants struggle to keep conversations focused or the agenda becomes dominated by a few players that distract from objectives. Go back to basics(redirect, involve) Rely on tried-and-true project management tools and techniques to keep project teams aligned and on track. Project teams begin to spin out of control because they take project management basics for granted Help me help you (empathize) â€œI know how important this design project is to your work here. Iâ€™d like to make sure you can be successful and meet the milestones of the larger project. What I can I do to help you meet those goals?â€ Position the teamâ€™s work and the teamâ€™s role relative to anotherâ€™s goals. å±•ç¤ºå›¢é˜Ÿçš„ç›®æ ‡æ˜¯å¦‚ä½•ä¸ä¸ªäººç›®æ ‡ç›¸ä¸€è‡´çš„ã€‚ A stakeholder or participant signals that they see themselves as competitive with or opposed to the rest of the team. Help me make this betterï¼ˆinvolveï¼‰ è®©expertå»å¸®åŠ©improve the design å‚ä¸è€…ä¸æ„¿æ„æˆ–ä¸èƒ½æä¾›å»ºè®¾æ€§çš„åé¦ˆã€‚ Help me prioritize ï¼ˆredirectï¼‰ Ask participants to prioritize issues, requirements, feedback, or whatever else may be driving subsequent activities.ï¼ˆæ‰¾é‡ç‚¹ï¼‰ Presented with a list of issues that will impact the teamâ€™s ability to execute their plan or to complete tasks within the projectâ€™s constraints.ï¼ˆæœ‰å¥½å¤šé—®é¢˜è¦è§£å†³ï¼‰ Hold a workshopï¼ˆinvolveï¼‰ ç»„ç»‡ä¸€ä¸ªmeetingï¼Œå¯ä»¥è®©åˆ©ç›Šç›¸å…³è€…æ¥Structure a meeting as a collection of participatory activities combined with presentations, as if team members were attending a training workshop. By making the activity more participatory, teams can engage all stakeholders. Working with a team of people who need structure to actively contribute to a project. List assumptionsï¼ˆreframeï¼‰ List the educated guesses the team made to allow them to move forward with the project. Assumptions may be related to any context: product, performance, plan, or purpose The list of assumptions may be used to justify decisions or as a tool to validate assumptions.å›¢é˜Ÿé‡Œä¸€äº›äººæ²¡æœ‰ä»€ä¹ˆçœ‹æ³•ï¼Œä¾èµ–äºåˆ«äººçš„çœ‹æ³•ã€‚ make a plan ï¼ˆrefame Identify a goal, a set of activities to reach that goal, and a set of milestones leading up to the goal. With multiple goals, be sure to prioritize. é¢å¯¹å¤§é‡çš„å·¥ä½œï¼Œæ²¡æœ‰æ˜ç¡®çš„ä¸‹ä¸€æ­¥å¦‚ä½•å–å¾—è¿›å±• make assumptions ï¼ˆredirectï¼‰ ä¸è¦è®©æœªçŸ¥çš„ä¿¡æ¯é˜»ç¢äº†é¡¹ç›®ç›®æ ‡çš„å®ç°ã€‚å¯¹ä¸¢å¤±çš„ä¿¡æ¯è¿›è¡Œæœ‰æ ¹æ®çš„çŒœæµ‹ã€‚ä¸€å®šè¦åˆ†äº«è¿™äº›å‡è®¾ä¸é¡¹ç›®å›¢é˜Ÿæä¾›è®¾è®¡å†³ç­–çš„åŸºæœ¬åŸç†ã€‚ æ‚¨å·²ç»å‡†å¤‡å¥½å¼€å§‹è®¾è®¡è¿‡ç¨‹ï¼Œä½†æ˜¯æ— æ³•å¼¥è¡¥åœ¨ç†è§£ä¸Šçš„å·®è· make it real ï¼ˆredirectï¼‰ Take steps to embody abstract ideas å‚ä¸è€…åœ¨ä¸è€ƒè™‘å¯è¡Œæ€§çš„æƒ…å†µä¸‹æŠ›å‡ºæƒ³æ³•å’Œåé¦ˆã€‚ Offer alternativesï¼ˆinvolve æä¾›ä¸¤ä¸‰ä¸ªæƒ³æ³•ï¼Œè®©å‚ä¸è€…å¯¹æ¯”å’Œæ¯”è¾ƒ æå‡ºäº†ä¸€ä¸ªæ¨¡ç³Šçš„é—®é¢˜ï¼Œå°†æ²¡æœ‰æ˜ç¡®çš„æ ‡å‡†æ¥è¯„ä¼°ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚ Offer a sneak peek(æä¾›ä¸€ä¸ªå…ˆç¹ä¸ºå¿«)ï¼ˆinvole æˆ‘ä»¬æ˜å¤©è¦è®²ä¸‰ä¸ªæ¦‚å¿µï¼Œæˆ‘å…ˆè¯´ä¸€ä¸‹ä½ ä»¬æ˜å¤©ä¼šçœ‹åˆ°çš„ã€‚ Show or describe upcoming work in brief to set expectations about what will be seen or what participants will need to comment on. Presenting ideas or approaches that will challenge some underlying assumptions, as a way to build the right mindset in key participants. Pick one thing ï¼ˆredirectï¼‰ Select one item from a list to focus on. æœ‰å¾ˆå¤šissueå›°æ‰°ç€ Pick your battlesï¼ˆempathizeï¼‰ é¿å…å¯¹æŠ—ï¼Œä»¥åå†è¯´ Choose the right time to engage in active conflict. Facing a potentially major conflict that, compared to confrontations likely to emerge later, will have little impact on the final outcome. Prioritize the portfolioï¼ˆä¼˜å…ˆè€ƒè™‘æŠ•èµ„ç»„åˆï¼‰redirect è™½ç„¶ä¸å–œæ¬¢è¿™ä¸ªprojectï¼Œä½†èƒ½æé«˜èŒä¸šç›®æ ‡ ä¸€ä¸ªé¡¹ç›®æˆ–ä»»åŠ¡çš„çº¿ç¨‹å·²ç»å˜å¾—å¦‚æ­¤å¦¥åï¼Œä»¥è‡³äºå¾ˆéš¾åœ¨å…¶ä¸­æ‰¾åˆ°ä¸ªäººæ„ä¹‰æˆ–æ»¡è¶³æ„Ÿ Provide starting pointsï¼ˆempathizeï¼‰ ç»™äººä»¬ä¸¾ä¸€äº›ä¾‹å­æ¥è¯´æ˜ä½ æ‰€æœŸæœ›çš„å·¥ä½œæ°´å¹³ è¦ç»™æ–°äººåˆ†é…ä»»åŠ¡ï¼Œå›¢é˜Ÿï¼Œç¡®ç«‹æ–¹å‘å’ŒæœŸæœ›å€¼ Recount previous conversationï¼ˆreframe æ€»ç»“ä¹‹å‰çš„å¯¹è¯ï¼Œä¸ºå½“å‰çš„å¯¹è¯å¥ å®šåŸºç¡€ å½“å’Œè®°å¿†é‡Œä¸å¥½çš„äººä¸€èµ·å·¥ä½œæ—¶ï¼Œå…ˆç¡®å®šå¥¹ä»¬agreeä¹‹å‰çš„å¯¹è¯è¦ç‚¹ã€‚ï¼ˆé¿å…ä»–ä»¬ç»å¸¸åœ¨ä¼šè®®ä¸­æ”¹å˜è‡ªå·±çš„æƒ³æ³•ï¼‰ Reduce the assignmentï¼ˆredirect redirect æŠŠæ‰‹å¤´ä»»åŠ¡çš„ä¸€å°éƒ¨åˆ†ç”¨æ¥æ§åˆ¶èŒƒå›´ æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é¡¹ç›®ï¼Œä¸€å°å—çš„åˆ†é…å…è®¸äººä»¬å…³æ³¨ä¸€ä¸ªå¯æ§çš„è®¾è®¡é—®é¢˜å’Œè°ƒæ•´ä»–ä»¬çš„é¢„æœŸã€‚ Reflect the positionï¼ˆeï¼‰ é‡å¤åˆ«äººè¯´çš„è¯æ¥ç¡®ä¿è‡ªå·±å¬åˆ°çš„æ˜¯æ­£ç¡®çš„ï¼Œä¹Ÿå¯ä»¥ä½“ç°respect å½“å‚ä¸è€…è§‰å¾—ä»–ä»¬å¯èƒ½ä¸ç†è§£å¯¹æ–¹çš„ç«‹åœºæ—¶ Seek small victoriesï¼ˆredirectï¼‰ Drive toward a win, no matter how small, to demonstrate success or establish a foundation of success. åŠªåŠ›äº‰å–èƒœåˆ©ï¼Œæ— è®ºå¤šä¹ˆå° Set reasonable expectationsï¼ˆredirectï¼‰ Provide a clear account of how long tasks will take. è¢«é—®åˆ°é¡¹ç›®çš„æˆªæ­¢æ—¶é—´å’ŒèŒƒå›´ï¼Œä½•æ—¶äº¤ä»˜é¡¹ç›® Show the goalï¼ˆEmpathize, Involve, Redirect è®©åˆ©ç›Šç›¸å…³è€…å°½å¯èƒ½ç”ŸåŠ¨åœ°æè¿°é¡¹ç›®æˆ–ä»»åŠ¡çš„æœŸæœ›ç»“æœï¼Œç¡®ä¿ä»–ä»¬çŸ¥é“ä»–ä»¬è¦ä»€ä¹ˆã€‚Ask stakeholders to describe as vividly as possible the desired outcome of a project or task. This isnâ€™t so much to describe the final design as it is to make sure they know what theyâ€™re getting. é¡¹ç›®å·²ç»èŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œä½†è¿˜æ˜¯ä¸æ¸…æ¥šstakeholdersåˆ°åº•è¦ä»€ä¹ˆ show your workï¼ˆinvole æ­ç¤ºè®¾è®¡å…³é”®ç‚¹ï¼Œæä¾›äº†åŸºç¡€å’Œè®¾è®¡å†³ç­–çš„ç†ç”± å½“ç»™stakeholdersçœ‹ä½ çš„design ideaæ—¶ take baby stapsï¼ˆredirectï¼Œinvolve introduceå¼•è¿›å°å°çš„æ”¹å˜ ç»™é¡¹ç›®ï¼Œä¸€ç§æ–‡åŒ–æ¥å½±å“å¤§çš„charge å›¢é˜Ÿæˆ–ç»„ç»‡çš„ä¹ æƒ¯æ ¹æ·±è’‚å›º,æ–°çš„æ€ç»´æ–¹å¼éš¾ä»¥å®ç°ã€‚ take responsibilityï¼ˆEmpathize è¯šå®å¦ç‡åœ°é¢å¯¹é”™è¯¯ã€‚ä¸»åŠ¨å¸®å¿™æ”¶æ‹¾æ®‹å±€ Be honest and forthright with errors. Offer to help clean up the mess. Facing an error that has an impact on other team members or the success of the project. treat it like a projectï¼ˆreframeï¼‰ æœ‰ä¸€ä¸ªé—®é¢˜å¾ˆéš¾è¾¾æˆä¸€è‡´ï¼Œ create a plan å»è§£å†³ å»ºç«‹ç›®æ ‡ã€æ´»åŠ¨ã€ä¾èµ–å…³ç³»ã€è§’è‰²å’Œå…¶ä»–ç»“æ„ï¼Œä»¥æ¨åŠ¨å†²çªçš„è§£å†³æ–¹æ¡ˆEstablish a goal, activities, dependencies, roles, and other structure to drive toward a solution for a conflict Facing a conflict with so many moving parts that resolution requires careful planning. behavior how virtue interpretation ask questions that yield specific answers Clarity and Definition Structure questions to encourage increasingly direct and detailed responses. Yes/no questions are OK, so long as they validate a specific decision or direction. Centralize decision making é›†ä¸­å†³ç­– At the beginning of the project, ask who owns final decisions about design. Lean on the decision maker to validate direction and approach Accountability and Ownership Clarify expectations regarding ability and delivery åœ¨æ”¶åˆ°ä»»åŠ¡åï¼Œç¡®ä¿ä½ æ˜ç™½ä»»åŠ¡çš„äº¤ä»˜æ—¶é—´å’Œä»»åŠ¡ Accountability and Ownership é¡¹ç›®å‚ä¸è€…åº”è¯¥è®©å¯¹æ–¹è¯šå®åœ°ã€å…¬å¼€åœ°äº†è§£ä»–ä»¬çš„å·¥ä½œåœ°ç‚¹ Communicate progress æ—¥å¸¸ä¿æŒå°ç«è‹—ï¼Establish a rhythm for communicating updates to project leads. Use a simple template for email or other electronic messages to communicate updates. Accountability and Ownership Donâ€™t hog opportunitiesä¸è¦å ç”¨æœºä¼šï¼Ÿï¼Ÿï¼Ÿ åœ¨è¦è¯´è¯ä¹‹å‰ï¼Œä¿æŒ15åˆ†é’Ÿæ²‰é»˜ï¼Œè®©åˆ«äººå…ˆè¯´ Awareness and Respect è®©æ¯ä¸ªå‚ä¸è€…éƒ½å‚ä¸è¿›æ¥ã€‚ Embrace constructive criticismæ¥å—å»ºè®¾æ€§çš„å»ºè®® å…ˆè€ƒè™‘ä¸€ä¸‹è¿™æ˜¯ä»–ä»¬çš„å·¥ä½œï¼Œä¹Ÿä¸ç®—ä»–ä»¬çš„é”™ã€‚åœ¨ä»–ä»¬æ‰“å‡»ä¹‹å‰ï¼Œå…ˆé¢„æµ‹ä¸€ä¸‹Anticipate critiques before they happen to soften the blow. Accountability and Ownership Embrace risk æ˜ç™½é£é™©ï¼Œå¯èƒ½çš„æ¶ˆæåæœ Accountability and Ownership Employé‡‡ç”¨ tools that yield meaningful outcomes åˆ¤æ–­å·¥å…·æ˜¯å¦èƒ½è®©é¡¹ç›®ç»§ç»­Question the value of every activity or deliverable, and seek to understand how it will move the project forward and how it will lead to the next step Clarity and Definition make a contribution Encourage disruptive communications é‡‡ç”¨å¤šç§æ²Ÿé€šæ¸ é“ï¼Œä¸ºå›¢é˜Ÿæˆå‘˜æä¾›å„ç§ç›¸äº’äº¤æµçš„æ–¹å¼ã€‚ Clarity and Definition Engage in dialogue Show up to meetings with lots of questions prepared, whether youâ€™re responsible for presenting concepts or not. Clarity and Definition é¼“åŠ±å¯¹è¯æ¥é˜è¿°é¡¹ç›®çš„æ¦‚å¿µã€è®¾è®¡è¦æ±‚ç­‰ã€‚ Engage multiple senses to communicate è°ƒç”¨å¤šç§æ„Ÿå®˜æ¥äº¤æµ è®¡åˆ’ä¼šè®®ä¸åªæ˜¯è¯´ä»€ä¹ˆï¼Œè€Œæ˜¯è¦å±•ç¤ºä»€ä¹ˆã€‚æœ‰ä¸€ä¸ªæ–‡æ¡£ç›¸æœºå‡†å¤‡æ˜¾ç¤ºå±å¹•ä¸Šå¿«é€Ÿè‰å›¾æˆ–æŠ•å°„åœ¨å¢™ä¸Šã€‚æ³¨æ„å›¾ç‰‡æ‰€ç¤ºçš„èŠ‚å¥,ç‰¹åˆ«æ˜¯,äººä»¬ä¼šèŠ±æœ€å¤šçš„æ—¶é—´çœ‹çœ‹ç…§ç‰‡ Clarity and Definition Use both speaking and pictures to engage team members. Establish role definitions If youâ€™re not in charge of defining roles, ask for each participantâ€™s responsibilities Clarity and Definition ç¡®ä¿å›¢é˜Ÿä¸­çš„æ¯ä¸ªäººéƒ½çŸ¥é“ä»–æˆ–å¥¹çš„èŒè´£æ˜¯ä»€ä¹ˆã€‚Take the time to ensure they understand whether they own particular activities, or are just contributors. Give others room to learn from mistakes Offer to help colleagues reflect on their failures. Awareness and Respect Have a communications plan ä½¿ç”¨æ¨¡æ¿ä¸ºå¸¸è§çš„ç”µå­é‚®ä»¶æ ¼å¼ã€‚å»ºç«‹ä¸€äº›è§„åˆ™ç”¨ä¸åŒçš„äº¤æµæ–¹å¼ã€‚Identify who can respond to inquiries from different stakeholders Clarity and Definition ä¸ºå›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„äº¤æµåˆ›å»ºæ ‡å‡†ã€‚ Have a project plan ensure you can answer who, what, where, when, why, and how questions about the project.ç¡®ä¿ä½ èƒ½å›ç­”è°ï¼Œä»€ä¹ˆï¼Œä»€ä¹ˆï¼Œä½•æ—¶ï¼Œä¸ºä»€ä¹ˆï¼Œä»¥åŠå¦‚ä½•å¯¹è¿™ä¸ªé¡¹ç›®çš„é—®é¢˜ Clarity and Definition Create a project schedule with milestones and resource assignments. Clearly state how much time each team member should spend on each activity. Have decision-making mechanismsæœ‰å†³ç­–æœºåˆ¶ ä¸ºè®¾è®¡æˆ–é¡¹ç›®è®¡åˆ’åˆ¶å®šç›®æ ‡æˆ–åŸåˆ™ä»¥æŒ‡å¯¼å†³ç­–ã€‚æŒ‡å®šå…·ä½“çš„äººè´Ÿè´£,è´Ÿè´£å…·ä½“çš„å†³ç­–ã€‚Establish goals or principles for the design or project plan to guide decisions. Designate specific people responsible and accountable for specific decisions. Clarity and Definition Have objectives for every discussion If youâ€™re organizing the meeting, send an agenda, a list of topics, or even a one-sentence objective beforehand. If youâ€™re not organizing the meeting, ask the organizer for the agenda or objectives. If itâ€™s an ad hoc meeting, take a moment to validate expectations with other participants. Clarity and Definition know beforehand what you expect to come out of it. Keep meetings focused and short Conclude a meeting when itâ€™s over, not when the clock says itâ€™s over. Show up with an agenda and objectives so you know when itâ€™s over. Awareness and Respect Golden Rule: Assume other peopleâ€™s time is as valuable as yours. å‡è®¾åˆ«äººçš„æ—¶é—´å’Œä½ çš„ä¸€æ ·å®è´µ Know when youâ€™re â€œspinningâ€ çŸ¥é“ä½ é‡åˆ°ç“¶é¢ˆçš„æ—¶å€™ åœ¨ä»»åŠ¡æˆ–ä»»åŠ¡ä¸ŠèŠ±ä¸€å°æ®µæ—¶é—´(å¤§çº¦10% - 20%çš„æ—¶é—´)ï¼Œç„¶åè¯„ä¼°è¿›åº¦ã€‚å¦‚æœå¼€å§‹é€‚åº”,åšæŒä¸‹å»ã€‚å¦‚æœæ²¡æœ‰æ˜ç¡®çš„æ–¹å‘ï¼Œå¯ä»¥å‘åŒäº‹å¯»æ±‚å¸®åŠ©ã€‚ Accountability and Ownership æ„è¯†åˆ°ä½ çš„åŠªåŠ›æ²¡æœ‰æˆæ•ˆã€‚æ—‹è½¬çš„è¡Œä¸ºå°†æ˜¯ä¸€ä¸ªé—®é¢˜è§£å†³,æ²¡æœ‰åšå‡ºä»»ä½•å®è´¨æ€§çš„è¿›å±•ã€‚æœ‰äº›äººåšæŒå•ƒä¸€ä¸ªé—®é¢˜,æ¶ˆè€—æ—¶é—´å’Œé‡‘é’±,å› ä¸ºä»–ä»¬éœ€è¦è¯æ˜è‡ªå·±ã€‚ Offer direct critiques Avoid generalizations like â€œItâ€™s not good.â€é¿å…ç¬¼ç»Ÿåœ°è¯´â€œè¿™ä¸å¥½â€ã€‚ Awareness and Respect Play to strengths å‘æŒ¥ä¼˜åŠ¿ Reflect on abilities and skills to identify strengthsåæ€èƒ½åŠ›å’ŒæŠ€èƒ½ï¼Œä»¥ç¡®å®šä¼˜åŠ¿ Accountability and Ownership ç¡®ä¿é¡¹ç›®ä¸­çš„è§’è‰²å’Œè´£ä»»ä¸å›¢é˜Ÿæˆå‘˜çš„ä¸ªäººèƒ½åŠ›ã€æŠ€èƒ½å’Œæ€§æ ¼ç›¸ä¸€è‡´ã€‚ Provide a rationale for decisionsä¸ºå†³ç­–æä¾›ä¾æ® Enumerate key decisions and identify the primary rationale for driving them.åˆ—ä¸¾å…³é”®å†³ç­–å¹¶ç¡®å®šé©±åŠ¨å®ƒä»¬çš„åŸºæœ¬åŸç†ã€‚ Accountability and Ownership ç¡®ä¿æ‰€æœ‰çš„å†³å®šâ€”â€”å…³äºäº§å“ï¼Œå…³äºè®¡åˆ’ï¼Œå…³äºé¡¹ç›®â€”â€”éƒ½æœ‰åˆç†çš„ç†ç”± Recognize contributionsæ‰¿è®¤è´¡çŒ® Accountability and Ownership if someone inspired a particular direction or lent an insight, give them a shout-out. Reduce competition In competitions, there is always a loser. Losers no longer feel as invested in the project. When people feel like they will make a meaningful contribution, regardless of their role, they will do better work and support each other in the pursuit of the projectâ€™s goals Accountability and Ownership ä»è®¾è®¡è¿‡ç¨‹ä¸­æ¶ˆé™¤å¯¹å½¼æ­¤ä¸åˆ©çš„è®¾è®¡è¿‡ç¨‹ã€‚é¼“åŠ±äººä»¬ä¸€èµ·å·¥ä½œ,è€Œä¸æ˜¯ç«é€‰ã€‚ Reflect on your performance Awareness and Respect èŠ±ç‚¹æ—¶é—´è€ƒè™‘ä¸€ä¸‹ä½ åœ¨ä¸€ä¸ªé¡¹ç›®æˆ–ä»»åŠ¡ä¸Šçš„è¡¨ç°ã€‚è¯†åˆ«é¢†åŸŸä½ å¯ä»¥è¡¨ç°çš„æ›´å¥½,å‘æŒ¥ä½ çš„é•¿å¤„ã€‚ç¡®å®šä¸‹æ¬¡ä½ ä¼šåšä¸åŒçš„äº‹æƒ…ï¼Œç„¶åå¸å–æ•™è®­ï¼Œä¸‹æ¬¡å†ç”¨ã€‚ Respect the calendar Awareness and Respect Set availability expectations Awareness and Respect Set performance expectations Awareness and Respect Clearly communicate ability to complete tasks and assignments. Traits Adaptability Adherence to style Assumption threshold å‡è®¾é˜ˆå€¼ Creative triggers Defining the challenge Desired cadence æœŸæœ›çš„èŠ‚æ‹ Workloadï¼Œ client culture Dogmatism æ•™æ¡ä¸»ä¹‰ Format for feedback Giving and getting recognition Knee-jerk reaction å¾ˆå¿«çš„ååº” è¦ä¹ˆä¸æ€è€ƒé©¬ä¸ŠèµåŒï¼Œè¦ä¹ˆé©¬ä¸Šåå¯¹ Level of abstraction å–œæ¬¢åšæŠ½è±¡çš„äº‹æƒ… Perception of control Preferred environment Preferred perspective Project load Structure of design reviews Transparency é€æ˜åº¦ ","permalink":"https://zjxjwxk.github.io/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/team-collaboration-and-career-development/","summary":"\u003ch1 id=\"career-decision-making-cycle\"\u003eCareer decision making cycle\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"Career decision making cycle\" loading=\"lazy\" src=\"/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/team-collaboration-and-career-development/images/1547727641728.png\"\u003e\u003c/p\u003e\n\u003ch2 id=\"know-the-elements\"\u003eKnow the elements\u003c/h2\u003e\n\u003cp\u003eCommunication, Analysis, Synthesis, Valuing, Execution\u003c/p\u003e\n\u003ch2 id=\"know-the-definition\"\u003eKnow the definition\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eCommunication\u003c/strong\u003e: Identifying the gap\n\u003cstrong\u003eAnalysis\u003c/strong\u003e: Thinking about alternatives\n\u003cstrong\u003eSynthesis\u003c/strong\u003e: Creating likely alternatives\n\u003cstrong\u003eValuing\u003c/strong\u003e: Prioritizing alternatives\n\u003cstrong\u003eExecution\u003c/strong\u003e: Taking action to narrow the gap\u003c/p\u003e\n\u003ch2 id=\"be-able-to-elaborate-the-elements\"\u003eBe able to elaborate the elements\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eCommunication\u003c/strong\u003e:\nâ€¢ Become aware of the gap\nâ€¢ Discomfort, not so much fear of change\nâ€¢ Seek assistance if needed\nâ€¢ Emotions\n\u003cstrong\u003eAnalysis\u003c/strong\u003e:\nâ€¢ Clarify your knowledge\nâ€¢ Clarify gap\nâ€¢ Understand how you make decisions\nâ€¢ Understand what influences you\nâ€¢ What do you want?\nâ€¢ What have you learned?\nâ€¢ What are your values, interests and skills?\nâ€¢ Do you want to take responsibility?\nâ€¢ Self-awareness\n\u003cstrong\u003eSynthesis\u003c/strong\u003e:\nâ€¢ Solve the gap\nâ€¢ Avoid missing alternatives\nâ€¢ Reduce to a manageable amount of options.\nâ€¢ Brainstorm and reduce.\n\u003cstrong\u003eValuing\u003c/strong\u003e:\nâ€¢ Judge the benefit (and cost)\nâ€¢ Rank\nâ€¢ WhatÂ´s the best choice?\nâ€¢ Select an option\n\u003cstrong\u003eExecution\u003c/strong\u003e:\nâ€¢ Convert decisions into action\nâ€¢ Formulate a goal and a plan\nâ€¢ Execute the plan\nâ€¢ Plan, try, evaluate\u003c/p\u003e","title":"Team Collaboration and Career Development"},{"content":"During the lectures we defined three different areas important for every individual: Values, Interests and Skills. These should be described regarding your internal focus in a resume. a. Describe, explain, these three areas, including at least two examples from each area. (15)\nValues are what is important for you, what you really care about, and which give you a sense of purpose. Example: High Income, Helping others. Interests are what is fun for you, what enjoys you, and those work activities which hold your attention and fire your enthusiasm. Example: Technical, Scientific. Skills are things you can do well, things you have learned, special talent and special abilities. Example: Technical skills, Leadership. b. What is a GAP? Give at least one example of a possible GAP relating to your own experiences, one example from each area. (6) A GAP is where you are and where you want to be. The GAP for me: I hope that I can enter a big company like Alibaba to work as a Java developer. The GAP for me is that my understanding of the Java virtual machine is not deep enough, I don\u0026rsquo;t have enough knowledge of multithreading, don\u0026rsquo;t know enough about the principle and implementation of the database, and don\u0026rsquo;t know much about the distributed architecture. 2. Name the 5 elements of the Career Development Cycle. Draw the model of the cycle. Describe shortly, 1-2 sentences, every action in the cycle. (12) Communication, Analysis, Synthesis, Valuing, Execution Communication: Become aware of the gap and feel discomfort about the gap. Seek assistance if needed. Analysis: Clarify your knowledge, what do you want, what are your values, interests and skills and so on. Synthesis: Solve the gap, avoid missing alternatives and reduce to a manageable amount of options. Valuing: Judge the benefit (and cost) and rank them to find the best choice. Select an option. Execution: Convert decisions into action, formulate a goal and a plan, and execute the plan. Communication: Review the state and think has the gap been closed. It is an on-going process. 3. Brown talks about four general role categories of people in teams. Name these roles and describe them shortly? (12) Designers: People responsible for generating and documenting ideas about how the product works, looks, or behaves. Managers: People responsible for ensuring the project team delivers on its obligations, creates plans to do so, and successfully executes against those plans. Subject Matter Experts: People responsible for contributing information to the design process. Stakeholders: People ultimately accountable for the success of the project. 4. Consider the following questions among individuals where we have different characteristics. Select three of them. Describe how people (individuals), can have different characteristics. Describe pros and cons, and possible consequences to a characteristic. Comments if the characteristics you choose are good characteristics or not. a. Can I interrupt you? b. Do you attend agreed meetings? c. Are you late to meetings? d. Are you focusing on details or the big-picture? e. Which tasks do you prefer to commit to? f. How quickly do you respond to e-mail? g. Do you treat others how you would like to be treated yourself? h. Can she/he say no? Can you say no? i. Does she/he usually say no/yes? (12)\n5. Describe at least 4 positive consequences to conflicts. (8) Produces better ideas Forces people to search for new approaches Causes problems to surface Forces clarification 6. Brown draws a triangle for the model of conflict. Specify this triangle and describe the elements and how they are connected. (9) Situations: The different ways conflict manifests itself\nPatterns: The behaviors team members can use to deal with conflict\nTraits: The inherent characteristics that shape our behaviors and perceptions\nSituations \u0026lt; \u0026gt; Patterns Designers can use patterns (specific behaviors) to untangle situations Situations can also affect the outcome of patterns Patterns \u0026lt; \u0026gt; Traits A designerâ€™s traits influences which pattern she chooses for a particular situation By using a particular pattern successfully, a designer may take that to reinforce part of her personality Traits \u0026lt; \u0026gt; Situations Traits can make certain situations worse by reinforcing the misunderstanding between people Some situations may amplify a designerâ€™s trait 7. Brown lists three areas important for self-awareness. Describe these areas and give one example from each area for improving it. (9) To understand your limitations, your boundaries, strengths\nLimitations: Boundaries: By understanding their limitations, designers can be honest and open about their capabilities, their ability to contribute to a project, and their level of comfort in asking for help. Strengths: ","permalink":"https://zjxjwxk.github.io/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/team-collaboration-and-career-development-for-exam/","summary":"\u003ch3 id=\"during-the-lectures-we-defined-three-different-areas-important-for-every-individual-values-interests-and-skills-these-should-be-described-regarding-your-internal-focus-in-a-resume\"\u003eDuring the lectures we defined three different areas important for every individual: Values, Interests and Skills. These should be described regarding your internal focus in a resume.\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003ea. Describe, explain, these three areas, including at least two examples from each area. (15)\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eValues\u003c/strong\u003e are what is important for you, what you really care about, and which give you a sense of purpose. \u003cstrong\u003eExample\u003c/strong\u003e: High Income, Helping others.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eInterests\u003c/strong\u003e are what is fun for you, what enjoys you, and those work activities which hold your attention and fire your enthusiasm. \u003cstrong\u003eExample\u003c/strong\u003e: Technical, Scientific.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSkills\u003c/strong\u003e are things you can do well, things you have learned, special talent and special abilities. \u003cstrong\u003eExample\u003c/strong\u003e: Technical skills, Leadership.\n\u003cstrong\u003eb. What is a GAP? Give at least one example of a possible GAP relating to your own experiences, one example from each area. (6)\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003eA GAP is where you are and where you want to be.\u003c/li\u003e\n\u003cli\u003eThe GAP for me: I hope that I can enter a big company like Alibaba to work as a Java developer. The GAP for me is that my understanding of the Java virtual machine is not deep enough, I don\u0026rsquo;t have enough knowledge of multithreading, don\u0026rsquo;t know enough about the principle and implementation of the database, and don\u0026rsquo;t know much about the distributed architecture.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"2-name-the-5-elements-of-the-career-development-cycle-draw-the-model-of-the-cycle-describe-shortly-1-2-sentences-every-action-in-the-cycle-12\"\u003e2. Name the 5 elements of the Career Development Cycle. Draw the model of the cycle. Describe shortly, 1-2 sentences, every action in the cycle. (12)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eCommunication, Analysis, Synthesis, Valuing, Execution\n\u003cimg loading=\"lazy\" src=\"/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/team-collaboration-and-career-development-for-exam/images/1547730517318.png\"\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCommunication\u003c/strong\u003e: Become aware of the gap and feel discomfort about the gap. Seek assistance if needed.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAnalysis\u003c/strong\u003e: Clarify your knowledge, what do you want, what are your values, interests and skills and so on.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSynthesis\u003c/strong\u003e: Solve the gap, avoid missing alternatives and reduce to a manageable amount of options.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eValuing\u003c/strong\u003e: Judge the benefit (and cost) and rank them to find the best choice. Select an option.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eExecution\u003c/strong\u003e: Convert decisions into action, formulate a goal and a plan, and execute the plan.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCommunication\u003c/strong\u003e: Review the state and think has the gap been closed. It is an on-going process.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"3-brown-talks-about-four-general-role-categories-of-people-in-teams-name-these-roles-and-describe-them-shortly-12\"\u003e3. Brown talks about four general role categories of people in teams. Name these roles and describe them shortly? (12)\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eDesigners\u003c/strong\u003e: People responsible for generating and documenting ideas about how the product works, looks, or behaves.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eManagers\u003c/strong\u003e: People responsible for ensuring the project team delivers on its obligations, creates plans to do so, and successfully executes against those plans.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSubject Matter Experts\u003c/strong\u003e: People responsible for contributing information to the design process.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eStakeholders\u003c/strong\u003e: People ultimately accountable for the success of the project.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"4-consider-the-following-questions-among-individuals-where-we-have-different-characteristics-select-three-of-them-describe-how-people-individuals-can-have-different-characteristics-describe-pros-and-cons-and-possible-consequences-to-a-characteristic-comments-if-the-characteristics-you-choose-are-good-characteristics-or-not\"\u003e4. Consider the following questions among individuals where we have different characteristics. Select three of them. Describe how people (individuals), can have different characteristics. Describe pros and cons, and possible consequences to a characteristic. Comments if the characteristics you choose are good characteristics or not.\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003ea. Can I interrupt you?\u003c/strong\u003e\n\u003cstrong\u003eb. Do you attend agreed meetings?\u003c/strong\u003e\n\u003cstrong\u003ec. Are you late to meetings?\u003c/strong\u003e\n\u003cstrong\u003ed. Are you focusing on details or the big-picture?\u003c/strong\u003e\n\u003cstrong\u003ee. Which tasks do you prefer to commit to?\u003c/strong\u003e\n\u003cstrong\u003ef. How quickly do you respond to e-mail?\u003c/strong\u003e\n\u003cstrong\u003eg. Do you treat others how you would like to be treated yourself?\u003c/strong\u003e\n\u003cstrong\u003eh. Can she/he say no? Can you say no?\u003c/strong\u003e\n\u003cstrong\u003ei. Does she/he usually say no/yes?\u003c/strong\u003e\n\u003cstrong\u003e(12)\u003c/strong\u003e\u003c/p\u003e","title":"Team Collaboration and Career Development for Exam"},{"content":"This question tests your knowledge on algorithms and algorithm construction: (a) A function that is defined in terms of itself is called a recursive function. Describe the purpose of a base case in a recursive function.(3p)\nA base case is an (input) value for which the function can be calculated without recursion.\nThere needs to be at least one base case, which can be solved without recursion.\nFor the cases that are solved using recursion, the recursive calls must progress towards a base case.\n(b) Mergesort is based on the principles of divide-and-conquer. Briefly describe what the mergesort algorithm does in the divide step and in the conquer step. (4p)\nDivide step: Divide the array into two parts to convert the problem of sorting the entire array into sub-problems (to sort the left and right arrays separately) until the size of the array is 1.\nConquer step: Repeatedly merging sorted lists into sorted lists of larger size until the initial list is sorted.\n(c) A constructive heuristic is a method that iteratively â€œbuilds upâ€ a solution. It starts with nothing and adds (fixes) the value of exactly one variable (solution component) in each of the iterations. The algorithm ends when all variables have been assigned a value. Describe what is a greedy constructive heuristic. (3p)\nEach variable fixing is chosen as the variable that (locally) improves the objective most. Of course, variable fixings are chosen without breaking feasibility.\nThis question test your knowledge on graphs and trees. (a) What does a â€œworst caseâ€ binary tree look like? (5p)\nIn the worst case, if the binary search tree has n nodes, it can have O(n) height, when the unbalanced tree looks like a linked list.\nThe worst case occurs when inserting an sorted list into the tree in order.\n(b) Describe what is a topological ordering. (4p)\nA topological ordering of a directed non-cyclic graph is an ordering of the vertices such that if there is an edge (u, v) between u and v, then u comes before v in the ordering.\n(c) Illustrate and explain using an example why there can be no topological ordering of a graph that contains a cycle. (6p)\nConsider the cycle v5 -\u0026gt; v6 -\u0026gt; v8 -\u0026gt; v5:\n(v5, v6) å±äº E =\u0026gt; v5 needs to come before v6 in the topological order. (v6, v8) å±äº E =\u0026gt; v6 needs to come before v8 in the topological order =\u0026gt; v5 before v8 in the topological order. (v8, v5) å±äº E =\u0026gt; v8 needs to come before v5 in the topological order, which is not possible as we previously concluded the opposite. This question concerns complexity analysis. (a) Briefly describe the complexity class P. (3p)\nAll problems that can be solved using a polynomial bound algorithm belongs to the same complexity class (complexity class P).\n(b) Describe what is a basic operation of an algorithm. (3p)\nA basic operation can be seen as an operation that is fundamental for the performance of a particular algorithm.\nThe performance of the algorithm is in principle proportional to the number of basic operations.\n(c) Describe the concepts of worst-case and average-case complexity of an algorithm. (6p)\nThe worst-case complexity W(n) of an algorithm is the maximum number of basic operations performed for any input of size n.\nThe average-case complexity A(n) of an algorithm is the average number of basic operations performed by the algorithm, where each input I occurs with some probability p(I).\n(d) What does it mean to say that a data structure has an amortized bound of O(n) per operation? (3p).\nThis means that regardless of which sequence of n operations, the worst-case average cost per operation is O(n).\nYour task for this question is to insert a node with value 5 into the following splay tree. You are required to show what the tree looks like after inserting the new node and after each of the (3) splay operations.\nHint: you will have to perform all three types of splay operations. (20p)\nYour task is to apply dynamic programming in order to solve a knapsack problem instance with 4 items: Item 1: Value: p1 = 8 - Weight: w1 = 2 Item 2: Value: p2 = 6 - Weight: w2 = 1 Item 3: Value: p3 = 7 - Weight: w3 = 2 Item 4: Value: p4 = 5 - Weight: w4 = 1 The knapsack (bag) has a weight capacity of 4 (W = 4). You should graphically illustrate your solution. (20p)\n","permalink":"https://zjxjwxk.github.io/posts/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/the-design-and-analysis-of-algorithms/","summary":"\u003ch1 id=\"this-question-tests-your-knowledge-on-algorithms-and-algorithm-construction\"\u003eThis question tests your knowledge on algorithms and algorithm construction:\u003c/h1\u003e\n\u003cp\u003e\u003cstrong\u003e(a) A function that is defined in terms of itself is called a recursive function. Describe the purpose of a base case in a recursive function.(3p)\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eA base case is an (input) value for which the function can be calculated without recursion.\u003c/p\u003e\n\u003cp\u003eThere needs to be at least one base case, which can be solved without recursion.\u003c/p\u003e\n\u003cp\u003eFor the cases that are solved using recursion, the recursive calls must progress towards a base case.\u003c/p\u003e","title":"The Design and Analysis of Algorithms for Exam"},{"content":"CentOS 7 Tomcatå¼€æœºè‡ªå¯åŠ¨é…ç½® é…ç½®å¼€æœºè¿è¡Œ Tomcatå¢åŠ å¯åŠ¨å‚æ•° Tomcatéœ€è¦å¢åŠ ä¸€ä¸ªpidæ–‡ä»¶ï¼Œåœ¨ $CATALINA_HOME/bin ç›®å½•ä¸‹é¢ï¼Œå¢åŠ  setenv.sh é…ç½®ï¼Œcatalina.shå¯åŠ¨çš„æ—¶å€™ä¼šè°ƒç”¨ï¼ŒåŒæ—¶é…ç½®Javaå†…å­˜å‚æ•°ã€‚æ·»åŠ å¦‚ä¸‹å‘½ä»¤ï¼š [root@vps bin]# vim setenv.sh\n#Tomcat startup pid #set Java runtime environment variable export JAVA_HOME=/usr/java/jdk1.8.0_191-amd64 export PATH=$PATH:$JAVA_HOME/bin export CATALINA_HOME=/developer/apache-tomcat-7.0.91 export CATALINA_BASE=/developer/apache-tomcat-7.0.91 #add Tomcat pid CATALINA_PID=\u0026#34;$CATALINA_BASE/tomcat.pid\u0026#34; #add Java opts JAVA_OPTS=\u0026#34;-server -XX:PermSize=256M -XX:MaxPermSize=1024m -Xms512M -Xmx1024M -XX:MaxNewSize=256m\u0026#34; æ³¨æ„: é…ç½®å¼€æœºè¿è¡Œæ—¶,éœ€è¦å†æ¬¡æ·»åŠ  JAVA_HOME\nå¢åŠ  tomcat.service åœ¨/usr/lib/systemd/systemç›®å½•ä¸‹å¢åŠ tomcat.serviceï¼Œç›®å½•å¿…é¡»æ˜¯ç»å¯¹ç›®å½•ï¼Œæ·»åŠ å¦‚ä¸‹å‘½ä»¤ï¼š [root@vps bin]# vim /usr/lib/systemd/system/tomcat.service\n# conf service desc ,set do this after network started [Unit] Description=tomcat After=syslog.target network.target remote-fs.target nss-lookup.target # conf service pid, start,stop and restart [Service] Type=forking PIDFile=/developer/apache-tomcat-7.0.91/tomcat.pid ExecStart=/developer/apache-tomcat-7.0.91/bin/startup.sh ExecStop=/bin/kill -s QUIT $MAINPID ExecReload=/bin/kill -s HUP $MAINPID PrivateTmp=true # conf user [Install] WantedBy=multi-user.target [unit]: é…ç½®äº†æœåŠ¡çš„æè¿°ï¼Œè§„å®šäº†åœ¨networkå¯åŠ¨ä¹‹åæ‰§è¡Œï¼Œ\n[service]: é…ç½®æœåŠ¡çš„pidï¼ŒæœåŠ¡çš„å¯åŠ¨ï¼Œåœæ­¢ï¼Œé‡å¯\n[install]: é…ç½®äº†ä½¿ç”¨ç”¨æˆ·\nä½¿ç”¨tomcat.service centos7ä½¿ç”¨systemctlæ›¿æ¢äº†serviceå‘½ä»¤ï¼Œå¦‚éœ€è®¾ç½®å…¶ä»–æœåŠ¡ï¼Œæ›¿æ¢æ­¤å¤„çš„tomcatå³å¯ï¼Œå¦‚:systemctl start vsftp.service\nå¯åŠ¨æœåŠ¡ systemctl start tomcat.service åœæ­¢æœåŠ¡ systemctl stop tomcat.service é‡å¯æœåŠ¡ systemctl restart tomcat.service å¢åŠ å¼€æœºå¯åŠ¨ systemctl enable tomcat.service åˆ é™¤å¼€æœºå¯åŠ¨ systemctl disable tomcat.service å› ä¸ºé…ç½®pidï¼Œåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šåœ¨Tomcatçš„æ ¹ç›®å½•ä¸‹ç”Ÿäº§tomcat.pidæ–‡ä»¶,æœåŠ¡åœæ­¢ååˆ é™¤ã€‚ åŒæ—¶Tomcatåœ¨å¯åŠ¨æ—¶ï¼Œæ‰§è¡Œstartä¸ä¼šå¯åŠ¨ä¸¤ä¸ªTomcatï¼Œä¿è¯å§‹ç»ˆåªæœ‰ä¸€ä¸ªTomcatæœåŠ¡åœ¨è¿è¡Œã€‚å¤šä¸ªTomcatå¯ä»¥é…ç½®åœ¨å¤šä¸ªç›®å½•ä¸‹ï¼Œäº’ä¸å½±å“ã€‚\næŸ¥çœ‹æ•ˆæœ é‡å¯æœåŠ¡å™¨å,é€šè¿‡wgetè®¿é—®ï¼Œç»ˆç«¯è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼Œé…ç½®tomcatå¼€æœºè‡ªå¯åŠ¨æˆåŠŸï¼\n[root@vps ~]# wget 35.234.8.23:8080 --2019-01-12 16:02:41-- http://35.234.8.23:8080/ Connecting to 35.234.8.23:8080... connected. HTTP request sent, awaiting response... 200 OK Length: 909 [text/html] Saving to: â€˜index.htmlâ€™ 100%[===========================================================\u0026gt;] 909 --.-K/s in 0s 2019-01-12 16:02:41 (157 MB/s) - â€˜index.htmlâ€™ saved [909/909] åŒæ—¶,å®¢æˆ·ç«¯æµè§ˆå™¨ä¹Ÿèƒ½æˆåŠŸè®¿é—®ã€‚\n","permalink":"https://zjxjwxk.github.io/posts/linux/centos/centos-7-tomcat%E7%9A%84%E5%AE%89%E8%A3%85%E5%8F%8A%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE/","summary":"\u003ch1 id=\"centos-7-tomcatå¼€æœºè‡ªå¯åŠ¨é…ç½®\"\u003eCentOS 7 Tomcatå¼€æœºè‡ªå¯åŠ¨é…ç½®\u003c/h1\u003e\n\u003ch2 id=\"é…ç½®å¼€æœºè¿è¡Œ\"\u003eé…ç½®å¼€æœºè¿è¡Œ\u003c/h2\u003e\n\u003ch3 id=\"tomcatå¢åŠ å¯åŠ¨å‚æ•°\"\u003eTomcatå¢åŠ å¯åŠ¨å‚æ•°\u003c/h3\u003e\n\u003cp\u003eTomcatéœ€è¦å¢åŠ ä¸€ä¸ªpidæ–‡ä»¶ï¼Œåœ¨ \u003ccode\u003e$CATALINA_HOME/bin\u003c/code\u003e ç›®å½•ä¸‹é¢ï¼Œå¢åŠ  \u003ccode\u003esetenv.sh\u003c/code\u003e é…ç½®ï¼Œ\u003ccode\u003ecatalina.sh\u003c/code\u003eå¯åŠ¨çš„æ—¶å€™ä¼šè°ƒç”¨ï¼ŒåŒæ—¶é…ç½®Javaå†…å­˜å‚æ•°ã€‚æ·»åŠ å¦‚ä¸‹å‘½ä»¤ï¼š\n\u003ccode\u003e[root@vps bin]# vim setenv.sh\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#Tomcat startup pid\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#set Java runtime environment variable \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport JAVA_HOME\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/usr/java/jdk1.8.0_191-amd64\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport PATH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e$PATH:$JAVA_HOME/bin\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport CATALINA_HOME\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/developer/apache-tomcat-7.0.91\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport CATALINA_BASE\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/developer/apache-tomcat-7.0.91\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#add Tomcat pid\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCATALINA_PID\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\u003c/span\u003e$CATALINA_BASE\u003cspan style=\"color:#e6db74\"\u003e/tomcat.pid\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e#add Java opts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eJAVA_OPTS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-server -XX:PermSize=256M -XX:MaxPermSize=1024m -Xms512M -Xmx1024M -XX:MaxNewSize=256m\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eæ³¨æ„:\u003c/strong\u003e é…ç½®å¼€æœºè¿è¡Œæ—¶,éœ€è¦å†æ¬¡æ·»åŠ  JAVA_HOME\u003c/p\u003e\n\u003ch3 id=\"å¢åŠ -tomcatservice\"\u003eå¢åŠ  tomcat.service\u003c/h3\u003e\n\u003cp\u003eåœ¨/usr/lib/systemd/systemç›®å½•ä¸‹å¢åŠ tomcat.serviceï¼Œç›®å½•å¿…é¡»æ˜¯ç»å¯¹ç›®å½•ï¼Œæ·»åŠ å¦‚ä¸‹å‘½ä»¤ï¼š\n\u003ccode\u003e[root@vps bin]# vim /usr/lib/systemd/system/tomcat.service\u003c/code\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# conf service desc ,set do this after network started\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eUnit\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eDescription\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etomcat \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eAfter\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003esyslog.target network.target remote-fs.target nss-lookup.target\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# conf service pid, start,stop and restart\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eService\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eType\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eforking\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePIDFile\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/developer/apache-tomcat-7.0.91/tomcat.pid\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStart\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/developer/apache-tomcat-7.0.91/bin/startup.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecStop\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/bin/kill -s QUIT $MAINPID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eExecReload\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/bin/kill -s HUP $MAINPID\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ePrivateTmp\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# conf user \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003e[\u003c/span\u003eInstall\u003cspan style=\"color:#f92672\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eWantedBy\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003emulti-user.target\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cem\u003e[unit]:\u003c/em\u003e é…ç½®äº†æœåŠ¡çš„æè¿°ï¼Œè§„å®šäº†åœ¨networkå¯åŠ¨ä¹‹åæ‰§è¡Œï¼Œ\u003c/p\u003e","title":"CentOS 7 Tomcatå¼€æœºè‡ªå¯åŠ¨é…ç½®"},{"content":"Servletæ€»ç»“ åœ¨Java Webç¨‹åºä¸­ï¼ŒServletä¸»è¦è´Ÿè´£æ¥æ”¶ç”¨æˆ·è¯·æ±‚HttpServletRequest,åœ¨doGet(),doPost()ä¸­åšç›¸åº”çš„å¤„ç†ï¼Œå¹¶å°†å›åº”HttpServletResponseåé¦ˆç»™ç”¨æˆ·ã€‚Servletå¯ä»¥è®¾ç½®åˆå§‹åŒ–å‚æ•°ï¼Œä¾›Servletå†…éƒ¨ä½¿ç”¨ã€‚ä¸€ä¸ªServletç±»åªä¼šæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œåœ¨å®ƒåˆå§‹åŒ–æ—¶è°ƒç”¨init()æ–¹æ³•ï¼Œé”€æ¯æ—¶è°ƒç”¨destroy()æ–¹æ³•ã€‚Servletéœ€è¦åœ¨web.xmlä¸­é…ç½®ï¼ˆMyEclipseä¸­åˆ›å»ºServletä¼šè‡ªåŠ¨é…ç½®ï¼‰ï¼Œä¸€ä¸ªServletå¯ä»¥è®¾ç½®å¤šä¸ªURLè®¿é—®ã€‚Servletä¸æ˜¯çº¿ç¨‹å®‰å…¨ï¼Œå› æ­¤è¦è°¨æ…ä½¿ç”¨ç±»å˜é‡ã€‚\né˜è¿°Servletå’ŒCGIçš„åŒºåˆ«? CGIçš„ä¸è¶³ä¹‹å¤„: 1ï¼Œéœ€è¦ä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨ä¸€ä¸ªæ“ä½œCGIç¨‹åºçš„ç³»ç»Ÿè¿›ç¨‹ã€‚å¦‚æœè¯·æ±‚é¢‘ç¹ï¼Œè¿™å°†ä¼šå¸¦æ¥å¾ˆå¤§çš„å¼€é”€ã€‚\n2ï¼Œéœ€è¦ä¸ºæ¯ä¸ªè¯·æ±‚åŠ è½½å’Œè¿è¡Œä¸€ä¸ªCGIç¨‹åºï¼Œè¿™å°†å¸¦æ¥å¾ˆå¤§çš„å¼€é”€\n3ï¼Œéœ€è¦é‡å¤ç¼–å†™å¤„ç†ç½‘ç»œåè®®çš„ä»£ç ä»¥åŠç¼–ç ï¼Œè¿™äº›å·¥ä½œéƒ½æ˜¯éå¸¸è€—æ—¶çš„ã€‚\nServletçš„ä¼˜ç‚¹: 1ï¼Œåªéœ€è¦å¯åŠ¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿè¿›ç¨‹ä»¥åŠåŠ è½½ä¸€ä¸ªJVMï¼Œå¤§å¤§é™ä½äº†ç³»ç»Ÿçš„å¼€é”€\n2ï¼Œå¦‚æœå¤šä¸ªè¯·æ±‚éœ€è¦åšåŒæ ·å¤„ç†çš„æ—¶å€™ï¼Œè¿™æ—¶å€™åªéœ€è¦åŠ è½½ä¸€ä¸ªç±»ï¼Œè¿™ä¹Ÿå¤§å¤§é™ä½äº†å¼€é”€\n3ï¼Œæ‰€æœ‰åŠ¨æ€åŠ è½½çš„ç±»å¯ä»¥å®ç°å¯¹ç½‘ç»œåè®®ä»¥åŠè¯·æ±‚è§£ç çš„å…±äº«ï¼Œå¤§å¤§é™ä½äº†å·¥ä½œé‡ã€‚\n4ï¼ŒServletèƒ½ç›´æ¥å’ŒWebæœåŠ¡å™¨äº¤äº’ï¼Œè€Œæ™®é€šçš„CGIç¨‹åºä¸èƒ½ã€‚Servletè¿˜èƒ½åœ¨å„ä¸ªç¨‹åºä¹‹é—´å…±äº«æ•°æ®ï¼Œä½¿æ•°æ®åº“è¿æ¥æ± ä¹‹ç±»çš„åŠŸèƒ½å¾ˆå®¹æ˜“å®ç°ã€‚\nè¡¥å……ï¼šSun Microsystemså…¬å¸åœ¨1996å¹´å‘å¸ƒServletæŠ€æœ¯å°±æ˜¯ä¸ºäº†å’ŒCGIè¿›è¡Œç«äº‰ï¼ŒServletæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„Javaç¨‹åºï¼Œä¸€ä¸ªåŸºäºJavaçš„Webåº”ç”¨é€šå¸¸åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªServletç±»ã€‚Servletä¸èƒ½å¤Ÿè‡ªè¡Œåˆ›å»ºå¹¶æ‰§è¡Œï¼Œå®ƒæ˜¯åœ¨Servletå®¹å™¨ä¸­è¿è¡Œçš„ï¼Œå®¹å™¨å°†ç”¨æˆ·çš„è¯·æ±‚ä¼ é€’ç»™Servletç¨‹åºï¼Œå¹¶å°†Servletçš„å“åº”å›ä¼ ç»™ç”¨æˆ·ã€‚é€šå¸¸ä¸€ä¸ªServletä¼šå…³è”ä¸€ä¸ªæˆ–å¤šä¸ªJSPé¡µé¢ã€‚ä»¥å‰CGIç»å¸¸å› ä¸ºæ€§èƒ½å¼€é”€ä¸Šçš„é—®é¢˜è¢«è¯Ÿç—…ï¼Œç„¶è€ŒFast CGIæ—©å°±å·²ç»è§£å†³äº†CGIæ•ˆç‡ä¸Šçš„é—®é¢˜ï¼Œæ‰€ä»¥é¢è¯•çš„æ—¶å€™å¤§å¯ä¸å¿…ä¿¡å£å¼€æ²³çš„è¯Ÿç—…CGIï¼Œäº‹å®ä¸Šæœ‰å¾ˆå¤šä½ ç†Ÿæ‚‰çš„ç½‘ç«™éƒ½ä½¿ç”¨äº†CGIæŠ€æœ¯ã€‚\nå‚è€ƒï¼šã€Šjavawebæ•´åˆå¼€å‘ç‹è€…å½’æ¥ã€‹P7\nServletæ¥å£ä¸­æœ‰å“ªäº›æ–¹æ³•åŠServletç”Ÿå‘½å‘¨æœŸæ¢ç§˜ Servletæ¥å£å®šä¹‰äº†5ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­å‰ä¸‰ä¸ªæ–¹æ³•ä¸Servletç”Ÿå‘½å‘¨æœŸç›¸å…³ï¼š\nvoid init(ServletConfig config) throws ServletException void service(ServletRequest req, ServletResponse resp) throws ServletException, java.io.IOException void destory() java.lang.String getServletInfo() ServletConfig getServletConfig() ç”Ÿå‘½å‘¨æœŸï¼š Webå®¹å™¨åŠ è½½Servletå¹¶å°†å…¶å®ä¾‹åŒ–åï¼ŒServletç”Ÿå‘½å‘¨æœŸå¼€å§‹ï¼Œå®¹å™¨è¿è¡Œå…¶init()æ–¹æ³•è¿›è¡ŒServletçš„åˆå§‹åŒ–ï¼›è¯·æ±‚åˆ°è¾¾æ—¶è°ƒç”¨Servletçš„service()æ–¹æ³•ï¼Œservice()æ–¹æ³•ä¼šæ ¹æ®éœ€è¦è°ƒç”¨ä¸è¯·æ±‚å¯¹åº”çš„doGetæˆ–doPostç­‰æ–¹æ³•ï¼›å½“æœåŠ¡å™¨å…³é—­æˆ–é¡¹ç›®è¢«å¸è½½æ—¶æœåŠ¡å™¨ä¼šå°†Servletå®ä¾‹é”€æ¯ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨Servletçš„destroy()æ–¹æ³•ã€‚initæ–¹æ³•å’Œdestoryæ–¹æ³•åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œserviceæ–¹æ³•å®¢æˆ·ç«¯æ¯æ¬¡è¯·æ±‚Servletéƒ½ä¼šæ‰§è¡Œã€‚Servletä¸­æœ‰æ—¶ä¼šç”¨åˆ°ä¸€äº›éœ€è¦åˆå§‹åŒ–ä¸é”€æ¯çš„èµ„æºï¼Œå› æ­¤å¯ä»¥æŠŠåˆå§‹åŒ–èµ„æºçš„ä»£ç æ”¾å…¥initæ–¹æ³•ä¸­ï¼Œé”€æ¯èµ„æºçš„ä»£ç æ”¾å…¥destroyæ–¹æ³•ä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯æ¬¡å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½è¦åˆå§‹åŒ–ä¸é”€æ¯èµ„æºã€‚\nå‚è€ƒï¼šã€Šjavawebæ•´åˆå¼€å‘ç‹è€…å½’æ¥ã€‹P81\ngetå’Œpostè¯·æ±‚çš„åŒºåˆ« ç½‘ä¸Šä¹Ÿæœ‰æ–‡ç« è¯´ï¼šgetå’Œpostè¯·æ±‚å®é™…ä¸Šæ˜¯æ²¡æœ‰åŒºåˆ«ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥è¯¢ç›¸å…³æ–‡ç« ï¼æˆ‘ä¸‹é¢ç»™å‡ºçš„åªæ˜¯ä¸€ç§å¸¸è§çš„ç­”æ¡ˆã€‚\nâ‘ getè¯·æ±‚ç”¨æ¥ä»æœåŠ¡å™¨ä¸Šè·å¾—èµ„æºï¼Œè€Œpostæ˜¯ç”¨æ¥å‘æœåŠ¡å™¨æäº¤æ•°æ®ï¼›\nâ‘¡getå°†è¡¨å•ä¸­æ•°æ®æŒ‰ç…§name=valueçš„å½¢å¼ï¼Œæ·»åŠ åˆ°action æ‰€æŒ‡å‘çš„URL åé¢ï¼Œå¹¶ä¸”ä¸¤è€…ä½¿ç”¨\u0026quot;?\u0026ldquo;è¿æ¥ï¼Œè€Œå„ä¸ªå˜é‡ä¹‹é—´ä½¿ç”¨\u0026rdquo;\u0026amp;\u0026ldquo;è¿æ¥ï¼›postæ˜¯å°†è¡¨å•ä¸­çš„æ•°æ®æ”¾åœ¨HTTPåè®®çš„è¯·æ±‚å¤´æˆ–æ¶ˆæ¯ä½“ä¸­ï¼Œä¼ é€’åˆ°actionæ‰€æŒ‡å‘URLï¼›\nâ‘¢getä¼ è¾“çš„æ•°æ®è¦å—åˆ°URLé•¿åº¦é™åˆ¶ï¼ˆ1024å­—èŠ‚å³256ä¸ªå­—ç¬¦ï¼‰ï¼›è€Œpostå¯ä»¥ä¼ è¾“å¤§é‡çš„æ•°æ®ï¼Œä¸Šä¼ æ–‡ä»¶é€šå¸¸è¦ä½¿ç”¨postæ–¹å¼ï¼›\nâ‘£ä½¿ç”¨getæ—¶å‚æ•°ä¼šæ˜¾ç¤ºåœ¨åœ°å€æ ä¸Šï¼Œå¦‚æœè¿™äº›æ•°æ®ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨getï¼›å¯¹äºæ•æ„Ÿæ•°æ®è¿˜æ˜¯åº”ç”¨ä½¿ç”¨postï¼›\nâ‘¤getä½¿ç”¨MIMEç±»å‹application/x-www-form-urlencodedçš„URLç¼–ç ï¼ˆä¹Ÿå«ç™¾åˆ†å·ç¼–ç ï¼‰æ–‡æœ¬çš„æ ¼å¼ä¼ é€’å‚æ•°ï¼Œä¿è¯è¢«ä¼ é€çš„å‚æ•°ç”±éµå¾ªè§„èŒƒçš„æ–‡æœ¬ç»„æˆï¼Œä¾‹å¦‚ä¸€ä¸ªç©ºæ ¼çš„ç¼–ç æ˜¯\u0026rdquo;%20\u0026quot;ã€‚\nè¡¥å……ï¼šGETæ–¹å¼æäº¤è¡¨å•çš„å…¸å‹åº”ç”¨æ˜¯æœç´¢å¼•æ“ã€‚GETæ–¹å¼å°±æ˜¯è¢«è®¾è®¡ä¸ºæŸ¥è¯¢ç”¨çš„ã€‚\nè¿˜æœ‰å¦å¤–ä¸€ç§å›ç­”ã€‚æ¨èå¤§å®¶çœ‹ä¸€ä¸‹ï¼š\nhttps://www.zhihu.com/question/28586791 https://mp.weixin.qq.com/s?__biz=MzI3NzIzMzg3Mw==\u0026amp;mid=100000054\u0026amp;idx=1\u0026amp;sn=71f6c214f3833d9ca20b9f7dcd9d33e4#rd ä»€ä¹ˆæƒ…å†µä¸‹è°ƒç”¨doGet()å’ŒdoPost() Formæ ‡ç­¾é‡Œçš„methodçš„å±æ€§ä¸ºgetæ—¶è°ƒç”¨doGet()ï¼Œä¸ºpostæ—¶è°ƒç”¨doPost()ã€‚\nè½¬å‘(Forward)å’Œé‡å®šå‘(Redirect)çš„åŒºåˆ« è½¬å‘æ˜¯æœåŠ¡å™¨è¡Œä¸ºï¼Œé‡å®šå‘æ˜¯å®¢æˆ·ç«¯è¡Œä¸ºã€‚\nè½¬å‘ï¼ˆForwordï¼‰ é€šè¿‡RequestDispatcherå¯¹è±¡çš„forwardï¼ˆHttpServletRequest request,HttpServletResponse responseï¼‰æ–¹æ³•å®ç°çš„ã€‚RequestDispatcherå¯ä»¥é€šè¿‡HttpServletRequest çš„getRequestDispatcher()æ–¹æ³•è·å¾—ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç å°±æ˜¯è·³è½¬åˆ°login_success.jspé¡µé¢ã€‚\nrequest.getRequestDispatcher(\u0026#34;login_success.jsp\u0026#34;).forward(request, response); é‡å®šå‘ï¼ˆRedirectï¼‰ æ˜¯åˆ©ç”¨æœåŠ¡å™¨è¿”å›çš„çŠ¶æ€å—æ¥å®ç°çš„ã€‚å®¢æˆ·ç«¯æµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªçŠ¶æ€ç ã€‚æœåŠ¡å™¨é€šè¿‡HttpServletRequestResponseçš„setStatus(int status)æ–¹æ³•è®¾ç½®çŠ¶æ€ç ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›301æˆ–è€…302ï¼Œåˆ™æµè§ˆå™¨ä¼šåˆ°æ–°çš„ç½‘å€é‡æ–°è¯·æ±‚è¯¥èµ„æºã€‚\nä»åœ°å€æ æ˜¾ç¤ºæ¥è¯´ forwardæ˜¯æœåŠ¡å™¨è¯·æ±‚èµ„æº,æœåŠ¡å™¨ç›´æ¥è®¿é—®ç›®æ ‡åœ°å€çš„URL,æŠŠé‚£ä¸ªURLçš„å“åº”å†…å®¹è¯»å–è¿‡æ¥,ç„¶åæŠŠè¿™äº›å†…å®¹å†å‘ç»™æµè§ˆå™¨.æµè§ˆå™¨æ ¹æœ¬ä¸çŸ¥é“æœåŠ¡å™¨å‘é€çš„å†…å®¹ä»å“ªé‡Œæ¥çš„,æ‰€ä»¥å®ƒçš„åœ°å€æ è¿˜æ˜¯åŸæ¥çš„åœ°å€. redirectæ˜¯æœåŠ¡ç«¯æ ¹æ®é€»è¾‘,å‘é€ä¸€ä¸ªçŠ¶æ€ç ,å‘Šè¯‰æµè§ˆå™¨é‡æ–°å»è¯·æ±‚é‚£ä¸ªåœ°å€.æ‰€ä»¥åœ°å€æ æ˜¾ç¤ºçš„æ˜¯æ–°çš„URL.\nä»æ•°æ®å…±äº«æ¥è¯´ forward:è½¬å‘é¡µé¢å’Œè½¬å‘åˆ°çš„é¡µé¢å¯ä»¥å…±äº«requesté‡Œé¢çš„æ•°æ®. redirect:ä¸èƒ½å…±äº«æ•°æ®.\nä»è¿ç”¨åœ°æ–¹æ¥è¯´ forward:ä¸€èˆ¬ç”¨äºç”¨æˆ·ç™»é™†çš„æ—¶å€™,æ ¹æ®è§’è‰²è½¬å‘åˆ°ç›¸åº”çš„æ¨¡å—. redirect:ä¸€èˆ¬ç”¨äºç”¨æˆ·æ³¨é”€ç™»é™†æ—¶è¿”å›ä¸»é¡µé¢å’Œè·³è½¬åˆ°å…¶å®ƒçš„ç½‘ç«™ç­‰\nä»æ•ˆç‡æ¥è¯´ forward:é«˜. redirect:ä½.\nè‡ªåŠ¨åˆ·æ–°(Refresh) è‡ªåŠ¨åˆ·æ–°ä¸ä»…å¯ä»¥å®ç°ä¸€æ®µæ—¶é—´ä¹‹åè‡ªåŠ¨è·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œè¿˜å¯ä»¥å®ç°ä¸€æ®µæ—¶é—´ä¹‹åè‡ªåŠ¨åˆ·æ–°æœ¬é¡µé¢ã€‚Servletä¸­é€šè¿‡HttpServletResponseå¯¹è±¡è®¾ç½®Headerå±æ€§å®ç°è‡ªåŠ¨åˆ·æ–°ä¾‹å¦‚ï¼š\nResponse.setHeader(\u0026#34;Refresh\u0026#34;,\u0026#34;5;URL=http://localhost:8080/servlet/example.htm\u0026#34;); å…¶ä¸­5ä¸ºæ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚URLæŒ‡å®šå°±æ˜¯è¦è·³è½¬çš„é¡µé¢ï¼ˆå¦‚æœè®¾ç½®è‡ªå·±çš„è·¯å¾„ï¼Œå°±ä¼šå®ç°æ¯è¿‡ä¸€ç§’è‡ªåŠ¨åˆ·æ–°æœ¬é¡µé¢ä¸€æ¬¡ï¼‰\nServletä¸çº¿ç¨‹å®‰å…¨ Servletä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¤šçº¿ç¨‹å¹¶å‘çš„è¯»å†™ä¼šå¯¼è‡´æ•°æ®ä¸åŒæ­¥çš„é—®é¢˜ã€‚ è§£å†³çš„åŠæ³•æ˜¯å°½é‡ä¸è¦å®šä¹‰nameå±æ€§ï¼Œè€Œæ˜¯è¦æŠŠnameå˜é‡åˆ†åˆ«å®šä¹‰åœ¨doGet()å’ŒdoPost()æ–¹æ³•å†…ã€‚è™½ç„¶ä½¿ç”¨synchronized(name){}è¯­å¥å—å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä¼šé€ æˆçº¿ç¨‹çš„ç­‰å¾…ï¼Œä¸æ˜¯å¾ˆç§‘å­¦çš„åŠæ³•ã€‚ æ³¨æ„ï¼šå¤šçº¿ç¨‹çš„å¹¶å‘çš„è¯»å†™Servletç±»å±æ€§ä¼šå¯¼è‡´æ•°æ®ä¸åŒæ­¥ã€‚ä½†æ˜¯å¦‚æœåªæ˜¯å¹¶å‘åœ°è¯»å–å±æ€§è€Œä¸å†™å…¥ï¼Œåˆ™ä¸å­˜åœ¨æ•°æ®ä¸åŒæ­¥çš„é—®é¢˜ã€‚å› æ­¤Servleté‡Œçš„åªè¯»å±æ€§æœ€å¥½å®šä¹‰ä¸ºfinalç±»å‹çš„ã€‚\nå‚è€ƒï¼šã€Šjavawebæ•´åˆå¼€å‘ç‹è€…å½’æ¥ã€‹P92\nJSPå’ŒServletæ˜¯ä»€ä¹ˆå…³ç³» å…¶å®è¿™ä¸ªé—®é¢˜åœ¨ä¸Šé¢å·²ç»é˜è¿°è¿‡äº†ï¼ŒServletæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„Javaç¨‹åºï¼Œå®ƒè¿è¡ŒäºæœåŠ¡å™¨çš„JVMä¸­ï¼Œèƒ½å¤Ÿä¾é æœåŠ¡å™¨çš„æ”¯æŒå‘æµè§ˆå™¨æä¾›æ˜¾ç¤ºå†…å®¹ã€‚JSPæœ¬è´¨ä¸Šæ˜¯Servletçš„ä¸€ç§ç®€æ˜“å½¢å¼ï¼ŒJSPä¼šè¢«æœåŠ¡å™¨å¤„ç†æˆä¸€ä¸ªç±»ä¼¼äºServletçš„Javaç¨‹åºï¼Œå¯ä»¥ç®€åŒ–é¡µé¢å†…å®¹çš„ç”Ÿæˆã€‚Servletå’ŒJSPæœ€ä¸»è¦çš„ä¸åŒç‚¹åœ¨äºï¼ŒServletçš„åº”ç”¨é€»è¾‘æ˜¯åœ¨Javaæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å®Œå…¨ä»è¡¨ç¤ºå±‚ä¸­çš„HTMLåˆ†ç¦»å¼€æ¥ã€‚è€ŒJSPçš„æƒ…å†µæ˜¯Javaå’ŒHTMLå¯ä»¥ç»„åˆæˆä¸€ä¸ªæ‰©å±•åä¸º.jspçš„æ–‡ä»¶ã€‚æœ‰äººè¯´ï¼ŒServletå°±æ˜¯åœ¨Javaä¸­å†™HTMLï¼Œè€ŒJSPå°±æ˜¯åœ¨HTMLä¸­å†™Javaä»£ç ï¼Œå½“ç„¶è¿™ä¸ªè¯´æ³•æ˜¯å¾ˆç‰‡é¢ä¸”ä¸å¤Ÿå‡†ç¡®çš„ã€‚JSPä¾§é‡äºè§†å›¾ï¼ŒServletæ›´ä¾§é‡äºæ§åˆ¶é€»è¾‘ï¼Œåœ¨MVCæ¶æ„æ¨¡å¼ä¸­ï¼ŒJSPé€‚åˆå……å½“è§†å›¾ï¼ˆviewï¼‰è€ŒServleté€‚åˆå……å½“æ§åˆ¶å™¨ï¼ˆcontrollerï¼‰ã€‚\nJSPå·¥ä½œåŸç† JSPæ˜¯ä¸€ç§Servletï¼Œä½†æ˜¯ä¸HttpServletçš„å·¥ä½œæ–¹å¼ä¸å¤ªä¸€æ ·ã€‚HttpServletæ˜¯å…ˆç”±æºä»£ç ç¼–è¯‘ä¸ºclassæ–‡ä»¶åéƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸‹ï¼Œä¸ºå…ˆç¼–è¯‘åéƒ¨ç½²ã€‚è€ŒJSPåˆ™æ˜¯å…ˆéƒ¨ç½²åç¼–è¯‘ã€‚JSPä¼šåœ¨å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚JSPæ–‡ä»¶æ—¶è¢«ç¼–è¯‘ä¸ºHttpJspPageç±»ï¼ˆæ¥å£Servletçš„ä¸€ä¸ªå­ç±»ï¼‰ã€‚è¯¥ç±»ä¼šè¢«æœåŠ¡å™¨ä¸´æ—¶å­˜æ”¾åœ¨æœåŠ¡å™¨å·¥ä½œç›®å½•é‡Œé¢ã€‚ä¸‹é¢é€šè¿‡å®ä¾‹ç»™å¤§å®¶ä»‹ç»ã€‚ å·¥ç¨‹JspLoginDemoä¸‹æœ‰ä¸€ä¸ªåä¸ºlogin.jspçš„Jspæ–‡ä»¶ï¼ŒæŠŠå·¥ç¨‹ç¬¬ä¸€æ¬¡éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šåè®¿é—®è¿™ä¸ªJspæ–‡ä»¶ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸ªç›®å½•ä¸‹å¤šäº†ä¸‹å›¾è¿™ä¸¤ä¸ªä¸œä¸œã€‚ .classæ–‡ä»¶ä¾¿æ˜¯JSPå¯¹åº”çš„Servletã€‚ç¼–è¯‘å®Œæ¯•åå†è¿è¡Œclassæ–‡ä»¶æ¥å“åº”å®¢æˆ·ç«¯è¯·æ±‚ã€‚ä»¥åå®¢æˆ·ç«¯è®¿é—®login.jspçš„æ—¶å€™ï¼ŒTomcatå°†ä¸å†é‡æ–°ç¼–è¯‘JSPæ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥è°ƒç”¨classæ–‡ä»¶æ¥å“åº”å®¢æˆ·ç«¯è¯·æ±‚ã€‚\nç”±äºJSPåªä¼šåœ¨å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™è¢«ç¼–è¯‘ ï¼Œå› æ­¤ç¬¬ä¸€æ¬¡è¯·æ±‚JSPæ—¶ä¼šæ„Ÿè§‰æ¯”è¾ƒæ…¢ï¼Œä¹‹åå°±ä¼šæ„Ÿè§‰å¿«å¾ˆå¤šã€‚å¦‚æœæŠŠæœåŠ¡å™¨ä¿å­˜çš„classæ–‡ä»¶åˆ é™¤ï¼ŒæœåŠ¡å™¨ä¹Ÿä¼šé‡æ–°ç¼–è¯‘JSPã€‚\nå¼€å‘Webç¨‹åºæ—¶ç»å¸¸éœ€è¦ä¿®æ”¹JSPã€‚Tomcatèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹åˆ°JSPç¨‹åºçš„æ”¹åŠ¨ã€‚å¦‚æœæ£€æµ‹åˆ°JSPæºä»£ç å‘ç”Ÿäº†æ”¹åŠ¨ã€‚Tomcatä¼šåœ¨ä¸‹æ¬¡å®¢æˆ·ç«¯è¯·æ±‚JSPæ—¶é‡æ–°ç¼–è¯‘JSPï¼Œè€Œä¸éœ€è¦é‡å¯Tomcatã€‚è¿™ç§è‡ªåŠ¨æ£€æµ‹åŠŸèƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œæ£€æµ‹æ”¹åŠ¨ä¼šæ¶ˆè€—å°‘é‡çš„æ—¶é—´ï¼Œåœ¨éƒ¨ç½²Webåº”ç”¨çš„æ—¶å€™å¯ä»¥åœ¨web.xmlä¸­å°†å®ƒå…³æ‰ã€‚\nå‚è€ƒï¼šã€Šjavawebæ•´åˆå¼€å‘ç‹è€…å½’æ¥ã€‹P97\nJSPæœ‰å“ªäº›å†…ç½®å¯¹è±¡ã€ä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆ JSPå†…ç½®å¯¹è±¡ - CSDNåšå®¢\nJSPæœ‰9ä¸ªå†…ç½®å¯¹è±¡ï¼š\nrequestï¼šå°è£…å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ªGETæˆ–POSTè¯·æ±‚çš„å‚æ•°ï¼› responseï¼šå°è£…æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„å“åº”ï¼› pageContextï¼šé€šè¿‡è¯¥å¯¹è±¡å¯ä»¥è·å–å…¶ä»–å¯¹è±¡ï¼› sessionï¼šå°è£…ç”¨æˆ·ä¼šè¯çš„å¯¹è±¡ï¼› applicationï¼šå°è£…æœåŠ¡å™¨è¿è¡Œç¯å¢ƒçš„å¯¹è±¡ï¼› outï¼šè¾“å‡ºæœåŠ¡å™¨å“åº”çš„è¾“å‡ºæµå¯¹è±¡ï¼› configï¼šWebåº”ç”¨çš„é…ç½®å¯¹è±¡ï¼› pageï¼šJSPé¡µé¢æœ¬èº«ï¼ˆç›¸å½“äºJavaç¨‹åºä¸­çš„thisï¼‰ï¼› exceptionï¼šå°è£…é¡µé¢æŠ›å‡ºå¼‚å¸¸çš„å¯¹è±¡ã€‚ Requestå¯¹è±¡çš„ä¸»è¦æ–¹æ³•æœ‰å“ªäº› setAttribute(String name,Object)ï¼šè®¾ç½®åå­—ä¸ºnameçš„request çš„å‚æ•°å€¼ getAttribute(String name)ï¼šè¿”å›ç”±nameæŒ‡å®šçš„å±æ€§å€¼ getAttributeNames()ï¼šè¿”å›request å¯¹è±¡æ‰€æœ‰å±æ€§çš„åå­—é›†åˆï¼Œç»“æœæ˜¯ä¸€ä¸ªæšä¸¾çš„å®ä¾‹ getCookies()ï¼šè¿”å›å®¢æˆ·ç«¯çš„æ‰€æœ‰ Cookie å¯¹è±¡ï¼Œç»“æœæ˜¯ä¸€ä¸ªCookie æ•°ç»„ getCharacterEncoding() ï¼šè¿”å›è¯·æ±‚ä¸­çš„å­—ç¬¦ç¼–ç æ–¹å¼ = getContentLength() ï¼šè¿”å›è¯·æ±‚çš„ Bodyçš„é•¿åº¦ getHeader(String name) ï¼šè·å¾—HTTPåè®®å®šä¹‰çš„æ–‡ä»¶å¤´ä¿¡æ¯ getHeaders(String name) ï¼šè¿”å›æŒ‡å®šåå­—çš„request Header çš„æ‰€æœ‰å€¼ï¼Œç»“æœæ˜¯ä¸€ä¸ªæšä¸¾çš„å®ä¾‹ getHeaderNames() ï¼šè¿”å›æ‰€ä»¥request Header çš„åå­—ï¼Œç»“æœæ˜¯ä¸€ä¸ªæšä¸¾çš„å®ä¾‹ getInputStream() ï¼šè¿”å›è¯·æ±‚çš„è¾“å…¥æµï¼Œç”¨äºè·å¾—è¯·æ±‚ä¸­çš„æ•°æ® getMethod() ï¼šè·å¾—å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯ä¼ é€æ•°æ®çš„æ–¹æ³• getParameter(String name) ï¼šè·å¾—å®¢æˆ·ç«¯ä¼ é€ç»™æœåŠ¡å™¨ç«¯çš„æœ‰ nameæŒ‡å®šçš„å‚æ•°å€¼ getParameterNames() ï¼šè·å¾—å®¢æˆ·ç«¯ä¼ é€ç»™æœåŠ¡å™¨ç«¯çš„æ‰€æœ‰å‚æ•°çš„åå­—ï¼Œç»“æœæ˜¯ä¸€ä¸ªæšä¸¾çš„å®ä¾‹ getParameterValues(String name)ï¼šè·å¾—æœ‰nameæŒ‡å®šçš„å‚æ•°çš„æ‰€æœ‰å€¼ getProtocol()ï¼šè·å–å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯ä¼ é€æ•°æ®æ‰€ä¾æ®çš„åè®®åç§° getQueryString() ï¼šè·å¾—æŸ¥è¯¢å­—ç¬¦ä¸² getRequestURI() ï¼šè·å–å‘å‡ºè¯·æ±‚å­—ç¬¦ä¸²çš„å®¢æˆ·ç«¯åœ°å€ getRemoteAddr()ï¼šè·å–å®¢æˆ·ç«¯çš„ IP åœ°å€ getRemoteHost() ï¼šè·å–å®¢æˆ·ç«¯çš„åå­— getSession([Boolean create]) ï¼šè¿”å›å’Œè¯·æ±‚ç›¸å…³ Session getServerName() ï¼šè·å–æœåŠ¡å™¨çš„åå­— getServletPath()ï¼šè·å–å®¢æˆ·ç«¯æ‰€è¯·æ±‚çš„è„šæœ¬æ–‡ä»¶çš„è·¯å¾„ getServerPort()ï¼šè·å–æœåŠ¡å™¨çš„ç«¯å£å· removeAttribute(String name)ï¼šåˆ é™¤è¯·æ±‚ä¸­çš„ä¸€ä¸ªå±æ€§ request.getAttribute()å’Œ request.getParameter()æœ‰ä½•åŒºåˆ« ä»è·å–æ–¹å‘æ¥çœ‹ï¼š\ngetParameter()æ˜¯è·å– POST/GET ä¼ é€’çš„å‚æ•°å€¼ï¼›\ngetAttribute()æ˜¯è·å–å¯¹è±¡å®¹å™¨ä¸­çš„æ•°æ®å€¼ï¼›\nä»ç”¨é€”æ¥çœ‹ï¼š\ngetParameterç”¨äºå®¢æˆ·ç«¯é‡å®šå‘æ—¶ï¼Œå³ç‚¹å‡»äº†é“¾æ¥æˆ–æäº¤æŒ‰æ‰­æ—¶ä¼ å€¼ç”¨ï¼Œå³ç”¨äºåœ¨ç”¨è¡¨å•æˆ–urlé‡å®šå‘ä¼ å€¼æ—¶æ¥æ”¶æ•°æ®ç”¨ã€‚\ngetAttributeç”¨äºæœåŠ¡å™¨ç«¯é‡å®šå‘æ—¶ï¼Œå³åœ¨ sevlet ä¸­ä½¿ç”¨äº† forward å‡½æ•°,æˆ– struts ä¸­ä½¿ç”¨äº† mapping.findForwardã€‚ getAttribute åªèƒ½æ”¶åˆ°ç¨‹åºç”¨ setAttribute ä¼ è¿‡æ¥çš„å€¼ã€‚\nå¦å¤–ï¼Œå¯ä»¥ç”¨ setAttribute,getAttribute å‘é€æ¥æ”¶å¯¹è±¡.è€Œ getParameter æ˜¾ç„¶åªèƒ½ä¼ å­—ç¬¦ä¸²ã€‚ setAttribute æ˜¯åº”ç”¨æœåŠ¡å™¨æŠŠè¿™ä¸ªå¯¹è±¡æ”¾åœ¨è¯¥é¡µé¢æ‰€å¯¹åº”çš„ä¸€å—å†…å­˜ä¸­å»ï¼Œå½“ä½ çš„é¡µé¢æœåŠ¡å™¨é‡å®šå‘åˆ°å¦ä¸€ä¸ªé¡µé¢æ—¶ï¼Œåº”ç”¨æœåŠ¡å™¨ä¼šæŠŠè¿™å—å†…å­˜æ‹·è´å¦ä¸€ä¸ªé¡µé¢æ‰€å¯¹åº”çš„å†…å­˜ä¸­ã€‚è¿™æ ·getAttributeå°±èƒ½å–å¾—ä½ æ‰€è®¾ä¸‹çš„å€¼ï¼Œå½“ç„¶è¿™ç§æ–¹æ³•å¯ä»¥ä¼ å¯¹è±¡ã€‚sessionä¹Ÿä¸€æ ·ï¼Œåªæ˜¯å¯¹è±¡åœ¨å†…å­˜ä¸­çš„ç”Ÿå‘½å‘¨æœŸä¸ä¸€æ ·è€Œå·²ã€‚getParameteråªæ˜¯åº”ç”¨æœåŠ¡å™¨åœ¨åˆ†æä½ é€ä¸Šæ¥çš„ requesté¡µé¢çš„æ–‡æœ¬æ—¶ï¼Œå–å¾—ä½ è®¾åœ¨è¡¨å•æˆ– url é‡å®šå‘æ—¶çš„å€¼ã€‚\næ€»ç»“ï¼š\ngetParameter è¿”å›çš„æ˜¯String,ç”¨äºè¯»å–æäº¤çš„è¡¨å•ä¸­çš„å€¼;ï¼ˆè·å–ä¹‹åä¼šæ ¹æ®å®é™…éœ€è¦è½¬æ¢ä¸ºè‡ªå·±éœ€è¦çš„ç›¸åº”ç±»å‹ï¼Œæ¯”å¦‚æ•´å‹ï¼Œæ—¥æœŸç±»å‹å•Šç­‰ç­‰ï¼‰\ngetAttribute è¿”å›çš„æ˜¯Objectï¼Œéœ€è¿›è¡Œè½¬æ¢,å¯ç”¨setAttribute è®¾ç½®æˆä»»æ„å¯¹è±¡ï¼Œä½¿ç”¨å¾ˆçµæ´»ï¼Œå¯éšæ—¶ç”¨\nincludeæŒ‡ä»¤includeçš„è¡Œä¸ºçš„åŒºåˆ« includeæŒ‡ä»¤ï¼š JSPå¯ä»¥é€šè¿‡includeæŒ‡ä»¤æ¥åŒ…å«å…¶ä»–æ–‡ä»¶ã€‚è¢«åŒ…å«çš„æ–‡ä»¶å¯ä»¥æ˜¯JSPæ–‡ä»¶ã€HTMLæ–‡ä»¶æˆ–æ–‡æœ¬æ–‡ä»¶ã€‚åŒ…å«çš„æ–‡ä»¶å°±å¥½åƒæ˜¯è¯¥JSPæ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œä¼šè¢«åŒæ—¶ç¼–è¯‘æ‰§è¡Œã€‚ è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š \u0026lt;%@ include file=\u0026ldquo;æ–‡ä»¶ç›¸å¯¹ url åœ°å€\u0026rdquo; %\u0026gt;\nincludeåŠ¨ä½œï¼š jsp:includeåŠ¨ä½œå…ƒç´ ç”¨æ¥åŒ…å«é™æ€å’ŒåŠ¨æ€çš„æ–‡ä»¶ã€‚è¯¥åŠ¨ä½œæŠŠæŒ‡å®šæ–‡ä»¶æ’å…¥æ­£åœ¨ç”Ÿæˆçš„é¡µé¢ã€‚è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š \u0026lt;jsp:include page=\u0026ldquo;ç›¸å¯¹ URL åœ°å€\u0026rdquo; flush=\u0026ldquo;true\u0026rdquo; /\u0026gt;\nJSPä¹å¤§å†…ç½®å¯¹è±¡ï¼Œä¸ƒå¤§åŠ¨ä½œï¼Œä¸‰å¤§æŒ‡ä»¤ JSPä¹å¤§å†…ç½®å¯¹è±¡ï¼Œä¸ƒå¤§åŠ¨ä½œï¼Œä¸‰å¤§æŒ‡ä»¤æ€»ç»“\nè®²è§£JSPä¸­çš„å››ç§ä½œç”¨åŸŸ JSPä¸­çš„å››ç§ä½œç”¨åŸŸåŒ…æ‹¬pageã€requestã€sessionå’Œapplicationï¼Œå…·ä½“æ¥è¯´ï¼š\npageä»£è¡¨ä¸ä¸€ä¸ªé¡µé¢ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚ requestä»£è¡¨ä¸Webå®¢æˆ·æœºå‘å‡ºçš„ä¸€ä¸ªè¯·æ±‚ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚ä¸€ä¸ªè¯·æ±‚å¯èƒ½è·¨è¶Šå¤šä¸ªé¡µé¢ï¼Œæ¶‰åŠå¤šä¸ªWebç»„ä»¶ï¼›éœ€è¦åœ¨é¡µé¢æ˜¾ç¤ºçš„ä¸´æ—¶æ•°æ®å¯ä»¥ç½®äºæ­¤ä½œç”¨åŸŸã€‚ sessionä»£è¡¨ä¸æŸä¸ªç”¨æˆ·ä¸æœåŠ¡å™¨å»ºç«‹çš„ä¸€æ¬¡ä¼šè¯ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚è·ŸæŸä¸ªç”¨æˆ·ç›¸å…³çš„æ•°æ®åº”è¯¥æ”¾åœ¨ç”¨æˆ·è‡ªå·±çš„sessionä¸­ã€‚ applicationä»£è¡¨ä¸æ•´ä¸ªWebåº”ç”¨ç¨‹åºç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ï¼Œå®ƒå®è´¨ä¸Šæ˜¯è·¨è¶Šæ•´ä¸ªWebåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å¤šä¸ªé¡µé¢ã€è¯·æ±‚å’Œä¼šè¯çš„ä¸€ä¸ªå…¨å±€ä½œç”¨åŸŸã€‚ å¦‚ä½•å®ç°JSPæˆ–Servletçš„å•çº¿ç¨‹æ¨¡å¼ å¯¹äºJSPé¡µé¢ï¼Œå¯ä»¥é€šè¿‡pageæŒ‡ä»¤è¿›è¡Œè®¾ç½®ã€‚ \u0026lt;%@page isThreadSafe=â€falseâ€%\u0026gt;\nå¯¹äºServletï¼Œå¯ä»¥è®©è‡ªå®šä¹‰çš„Servletå®ç°SingleThreadModelæ ‡è¯†æ¥å£ã€‚\nè¯´æ˜ï¼šå¦‚æœå°†JSPæˆ–Servletè®¾ç½®æˆå•çº¿ç¨‹å·¥ä½œæ¨¡å¼ï¼Œä¼šå¯¼è‡´æ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªServletå®ä¾‹ï¼Œè¿™ç§å®è·µå°†å¯¼è‡´ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼ˆæœåŠ¡å™¨çš„å†…å­˜å‹åŠ›å¾ˆå¤§ï¼Œè¿˜ä¼šå¯¼è‡´é¢‘ç¹çš„åƒåœ¾å›æ”¶ï¼‰ï¼Œæ‰€ä»¥é€šå¸¸æƒ…å†µä¸‹å¹¶ä¸ä¼šè¿™ä¹ˆåšã€‚\nå®ç°ä¼šè¯è·Ÿè¸ªçš„æŠ€æœ¯æœ‰å“ªäº› ä½¿ç”¨Cookie å‘å®¢æˆ·ç«¯å‘é€Cookie\nCookie c =new Cookie(\u0026#34;name\u0026#34;,\u0026#34;value\u0026#34;); //åˆ›å»ºCookie c.setMaxAge(60*60*24); //è®¾ç½®æœ€å¤§æ—¶æ•ˆï¼Œæ­¤å¤„è®¾ç½®çš„æœ€å¤§æ—¶æ•ˆä¸ºä¸€å¤© response.addCookie(c); //æŠŠCookieæ”¾å…¥åˆ°HTTPå“åº”ä¸­ ä»å®¢æˆ·ç«¯è¯»å–Cookie\nString name =\u0026#34;name\u0026#34;; Cookie[]cookies =request.getCookies(); if(cookies !=null){ for(int i= 0;i\u0026lt;cookies.length;i++){ Cookie cookie =cookies[i]; if(name.equals(cookis.getName())) //something is here. //you can get the value cookie.getValue(); } } ä¼˜ç‚¹: æ•°æ®å¯ä»¥æŒä¹…ä¿å­˜ï¼Œä¸éœ€è¦æœåŠ¡å™¨èµ„æºï¼Œç®€å•ï¼ŒåŸºäºæ–‡æœ¬çš„Key-Value\nç¼ºç‚¹: å¤§å°å—åˆ°é™åˆ¶ï¼Œç”¨æˆ·å¯ä»¥ç¦ç”¨CookieåŠŸèƒ½ï¼Œç”±äºä¿å­˜åœ¨æœ¬åœ°ï¼Œæœ‰ä¸€å®šçš„å®‰å…¨é£é™©ã€‚\nURL é‡å†™ åœ¨URLä¸­æ·»åŠ ç”¨æˆ·ä¼šè¯çš„ä¿¡æ¯ä½œä¸ºè¯·æ±‚çš„å‚æ•°ï¼Œæˆ–è€…å°†å”¯ä¸€çš„ä¼šè¯IDæ·»åŠ åˆ°URLç»“å°¾ä»¥æ ‡è¯†ä¸€ä¸ªä¼šè¯ã€‚\nä¼˜ç‚¹ï¼š åœ¨Cookieè¢«ç¦ç”¨çš„æ—¶å€™ä¾ç„¶å¯ä»¥ä½¿ç”¨\nç¼ºç‚¹ï¼š å¿…é¡»å¯¹ç½‘ç«™çš„URLè¿›è¡Œç¼–ç ï¼Œæ‰€æœ‰é¡µé¢å¿…é¡»åŠ¨æ€ç”Ÿæˆï¼Œä¸èƒ½ç”¨é¢„å…ˆè®°å½•ä¸‹æ¥çš„URLè¿›è¡Œè®¿é—®ã€‚\n3.éšè—çš„è¡¨å•åŸŸ\n\u0026lt;input type=\u0026#34;hidden\u0026#34; name =\u0026#34;session\u0026#34; value=\u0026#34;...\u0026#34;/\u0026gt; ä¼˜ç‚¹ï¼š Cookieè¢«ç¦æ—¶å¯ä»¥ä½¿ç”¨\nç¼ºç‚¹ï¼š æ‰€æœ‰é¡µé¢å¿…é¡»æ˜¯è¡¨å•æäº¤ä¹‹åçš„ç»“æœã€‚\nHttpSession åœ¨æ‰€æœ‰ä¼šè¯è·Ÿè¸ªæŠ€æœ¯ä¸­ï¼ŒHttpSessionå¯¹è±¡æ˜¯æœ€å¼ºå¤§ä¹Ÿæ˜¯åŠŸèƒ½æœ€å¤šçš„ã€‚å½“ä¸€ä¸ªç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æŸä¸ªç½‘ç«™æ—¶ä¼šè‡ªåŠ¨åˆ›å»º HttpSessionï¼Œæ¯ä¸ªç”¨æˆ·å¯ä»¥è®¿é—®ä»–è‡ªå·±çš„HttpSessionã€‚å¯ä»¥é€šè¿‡HttpServletRequestå¯¹è±¡çš„getSessionæ–¹ æ³•è·å¾—HttpSessionï¼Œé€šè¿‡HttpSessionçš„setAttributeæ–¹æ³•å¯ä»¥å°†ä¸€ä¸ªå€¼æ”¾åœ¨HttpSessionä¸­ï¼Œé€šè¿‡è°ƒç”¨ HttpSessionå¯¹è±¡çš„getAttributeæ–¹æ³•ï¼ŒåŒæ—¶ä¼ å…¥å±æ€§åå°±å¯ä»¥è·å–ä¿å­˜åœ¨HttpSessionä¸­çš„å¯¹è±¡ã€‚ä¸ä¸Šé¢ä¸‰ç§æ–¹å¼ä¸åŒçš„ æ˜¯ï¼ŒHttpSessionæ”¾åœ¨æœåŠ¡å™¨çš„å†…å­˜ä¸­ï¼Œå› æ­¤ä¸è¦å°†è¿‡å¤§çš„å¯¹è±¡æ”¾åœ¨é‡Œé¢ï¼Œå³ä½¿ç›®å‰çš„Servletå®¹å™¨å¯ä»¥åœ¨å†…å­˜å°†æ»¡æ—¶å°†HttpSession ä¸­çš„å¯¹è±¡ç§»åˆ°å…¶ä»–å­˜å‚¨è®¾å¤‡ä¸­ï¼Œä½†æ˜¯è¿™æ ·åŠ¿å¿…å½±å“æ€§èƒ½ã€‚æ·»åŠ åˆ°HttpSessionä¸­çš„å€¼å¯ä»¥æ˜¯ä»»æ„Javaå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ€å¥½å®ç°äº† Serializableæ¥å£ï¼Œè¿™æ ·Servletå®¹å™¨åœ¨å¿…è¦çš„æ—¶å€™å¯ä»¥å°†å…¶åºåˆ—åŒ–åˆ°æ–‡ä»¶ä¸­ï¼Œå¦åˆ™åœ¨åºåˆ—åŒ–æ—¶å°±ä¼šå‡ºç°å¼‚å¸¸ã€‚\nCookieå’ŒSessionçš„çš„åŒºåˆ« ç”±äºHTTPåè®®æ˜¯æ— çŠ¶æ€çš„åè®®ï¼Œæ‰€ä»¥æœåŠ¡ç«¯éœ€è¦è®°å½•ç”¨æˆ·çš„çŠ¶æ€æ—¶ï¼Œå°±éœ€è¦ç”¨æŸç§æœºåˆ¶æ¥è¯†å…·ä½“çš„ç”¨æˆ·ï¼Œè¿™ä¸ªæœºåˆ¶å°±æ˜¯Session.å…¸å‹çš„åœºæ™¯æ¯”å¦‚è´­ç‰©è½¦ï¼Œå½“ä½ ç‚¹å‡»ä¸‹å•æŒ‰é’®æ—¶ï¼Œç”±äºHTTPåè®®æ— çŠ¶æ€ï¼Œæ‰€ä»¥å¹¶ä¸çŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·æ“ä½œçš„ï¼Œæ‰€ä»¥æœåŠ¡ç«¯è¦ä¸ºç‰¹å®šçš„ç”¨æˆ·åˆ›å»ºäº†ç‰¹å®šçš„Sessionï¼Œç”¨ç”¨äºæ ‡è¯†è¿™ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”è·Ÿè¸ªç”¨æˆ·ï¼Œè¿™æ ·æ‰çŸ¥é“è´­ç‰©è½¦é‡Œé¢æœ‰å‡ æœ¬ä¹¦ã€‚è¿™ä¸ªSessionæ˜¯ä¿å­˜åœ¨æœåŠ¡ç«¯çš„ï¼Œæœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ã€‚åœ¨æœåŠ¡ç«¯ä¿å­˜Sessionçš„æ–¹æ³•å¾ˆå¤šï¼Œå†…å­˜ã€æ•°æ®åº“ã€æ–‡ä»¶éƒ½æœ‰ã€‚é›†ç¾¤çš„æ—¶å€™ä¹Ÿè¦è€ƒè™‘Sessionçš„è½¬ç§»ï¼Œåœ¨å¤§å‹çš„ç½‘ç«™ï¼Œä¸€èˆ¬ä¼šæœ‰ä¸“é—¨çš„SessionæœåŠ¡å™¨é›†ç¾¤ï¼Œç”¨æ¥ä¿å­˜ç”¨æˆ·ä¼šè¯ï¼Œè¿™ä¸ªæ—¶å€™ Session ä¿¡æ¯éƒ½æ˜¯æ”¾åœ¨å†…å­˜çš„ï¼Œä½¿ç”¨ä¸€äº›ç¼“å­˜æœåŠ¡æ¯”å¦‚Memcachedä¹‹ç±»çš„æ¥æ”¾ Sessionã€‚ æ€è€ƒä¸€ä¸‹æœåŠ¡ç«¯å¦‚ä½•è¯†åˆ«ç‰¹å®šçš„å®¢æˆ·ï¼Ÿè¿™ä¸ªæ—¶å€™Cookieå°±ç™»åœºäº†ã€‚æ¯æ¬¡HTTPè¯·æ±‚çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯éƒ½ä¼šå‘é€ç›¸åº”çš„Cookieä¿¡æ¯åˆ°æœåŠ¡ç«¯ã€‚å®é™…ä¸Šå¤§å¤šæ•°çš„åº”ç”¨éƒ½æ˜¯ç”¨ Cookie æ¥å®ç°Sessionè·Ÿè¸ªçš„ï¼Œç¬¬ä¸€æ¬¡åˆ›å»ºSessionçš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯ä¼šåœ¨HTTPåè®®ä¸­å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œéœ€è¦åœ¨ Cookie é‡Œé¢è®°å½•ä¸€ä¸ªSession IDï¼Œä»¥åæ¯æ¬¡è¯·æ±‚æŠŠè¿™ä¸ªä¼šè¯IDå‘é€åˆ°æœåŠ¡å™¨ï¼Œæˆ‘å°±çŸ¥é“ä½ æ˜¯è°äº†ã€‚æœ‰äººé—®ï¼Œå¦‚æœå®¢æˆ·ç«¯çš„æµè§ˆå™¨ç¦ç”¨äº† Cookie æ€ä¹ˆåŠï¼Ÿä¸€èˆ¬è¿™ç§æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨ä¸€ç§å«åšURLé‡å†™çš„æŠ€æœ¯æ¥è¿›è¡Œä¼šè¯è·Ÿè¸ªï¼Œå³æ¯æ¬¡HTTPäº¤äº’ï¼ŒURLåé¢éƒ½ä¼šè¢«é™„åŠ ä¸Šä¸€ä¸ªè¯¸å¦‚ sid=xxxxx è¿™æ ·çš„å‚æ•°ï¼ŒæœåŠ¡ç«¯æ®æ­¤æ¥è¯†åˆ«ç”¨æˆ·ã€‚ Cookieå…¶å®è¿˜å¯ä»¥ç”¨åœ¨ä¸€äº›æ–¹ä¾¿ç”¨æˆ·çš„åœºæ™¯ä¸‹ï¼Œè®¾æƒ³ä½ æŸæ¬¡ç™»é™†è¿‡ä¸€ä¸ªç½‘ç«™ï¼Œä¸‹æ¬¡ç™»å½•çš„æ—¶å€™ä¸æƒ³å†æ¬¡è¾“å…¥è´¦å·äº†ï¼Œæ€ä¹ˆåŠï¼Ÿè¿™ä¸ªä¿¡æ¯å¯ä»¥å†™åˆ°Cookieé‡Œé¢ï¼Œè®¿é—®ç½‘ç«™çš„æ—¶å€™ï¼Œç½‘ç«™é¡µé¢çš„è„šæœ¬å¯ä»¥è¯»å–è¿™ä¸ªä¿¡æ¯ï¼Œå°±è‡ªåŠ¨å¸®ä½ æŠŠç”¨æˆ·åç»™å¡«äº†ï¼Œèƒ½å¤Ÿæ–¹ä¾¿ä¸€ä¸‹ç”¨æˆ·ã€‚è¿™ä¹Ÿæ˜¯Cookieåç§°çš„ç”±æ¥ï¼Œç»™ç”¨æˆ·çš„ä¸€ç‚¹ç”œå¤´ã€‚æ‰€ä»¥ï¼Œæ€»ç»“ä¸€ä¸‹ï¼šSessionæ˜¯åœ¨æœåŠ¡ç«¯ä¿å­˜çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç”¨æ¥è·Ÿè¸ªç”¨æˆ·çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ•°æ®å¯ä»¥ä¿å­˜åœ¨é›†ç¾¤ã€æ•°æ®åº“ã€æ–‡ä»¶ä¸­ï¼›Cookieæ˜¯å®¢æˆ·ç«¯ä¿å­˜ç”¨æˆ·ä¿¡æ¯çš„ä¸€ç§æœºåˆ¶ï¼Œç”¨æ¥è®°å½•ç”¨æˆ·çš„ä¸€äº›ä¿¡æ¯ï¼Œä¹Ÿæ˜¯å®ç°Sessionçš„ä¸€ç§æ–¹å¼ã€‚ å‚è€ƒï¼š\nhttps://www.zhihu.com/question/19786827/answer/28752144\nã€Šjavawebæ•´åˆå¼€å‘ç‹è€…å½’æ¥ã€‹P158 Cookieå’ŒSessionçš„æ¯”è¾ƒ\n","permalink":"https://zjxjwxk.github.io/posts/java/j2ee/","summary":"\u003ch2 id=\"servletæ€»ç»“\"\u003eServletæ€»ç»“\u003c/h2\u003e\n\u003cp\u003eåœ¨Java Webç¨‹åºä¸­ï¼Œ\u003cstrong\u003eServlet\u003c/strong\u003eä¸»è¦è´Ÿè´£æ¥æ”¶ç”¨æˆ·è¯·æ±‚\u003cstrong\u003eHttpServletRequest\u003c/strong\u003e,åœ¨\u003cstrong\u003edoGet()\u003c/strong\u003e,\u003cstrong\u003edoPost()ä¸­åšç›¸åº”çš„å¤„ç†ï¼Œå¹¶å°†å›åº”HttpServletResponse\u003c/strong\u003eåé¦ˆç»™ç”¨æˆ·ã€‚Servletå¯ä»¥è®¾ç½®åˆå§‹åŒ–å‚æ•°ï¼Œä¾›Servletå†…éƒ¨ä½¿ç”¨ã€‚ä¸€ä¸ªServletç±»åªä¼šæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œåœ¨å®ƒåˆå§‹åŒ–æ—¶è°ƒç”¨\u003cstrong\u003einit()æ–¹æ³•\u003c/strong\u003eï¼Œé”€æ¯æ—¶è°ƒç”¨\u003cstrong\u003edestroy()æ–¹æ³•\u003c/strong\u003eã€‚\u003cstrong\u003eServletéœ€è¦åœ¨web.xmlä¸­é…ç½®\u003c/strong\u003eï¼ˆMyEclipseä¸­åˆ›å»ºServletä¼šè‡ªåŠ¨é…ç½®ï¼‰ï¼Œ\u003cstrong\u003eä¸€ä¸ªServletå¯ä»¥è®¾ç½®å¤šä¸ªURLè®¿é—®\u003c/strong\u003eã€‚\u003cstrong\u003eServletä¸æ˜¯çº¿ç¨‹å®‰å…¨\u003c/strong\u003eï¼Œå› æ­¤è¦è°¨æ…ä½¿ç”¨ç±»å˜é‡ã€‚\u003c/p\u003e\n\u003ch2 id=\"é˜è¿°servletå’Œcgiçš„åŒºåˆ«\"\u003eé˜è¿°Servletå’ŒCGIçš„åŒºåˆ«?\u003c/h2\u003e\n\u003ch3 id=\"cgiçš„ä¸è¶³ä¹‹å¤„\"\u003eCGIçš„ä¸è¶³ä¹‹å¤„:\u003c/h3\u003e\n\u003cp\u003e1ï¼Œéœ€è¦ä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨ä¸€ä¸ªæ“ä½œCGIç¨‹åºçš„ç³»ç»Ÿè¿›ç¨‹ã€‚å¦‚æœè¯·æ±‚é¢‘ç¹ï¼Œè¿™å°†ä¼šå¸¦æ¥å¾ˆå¤§çš„å¼€é”€ã€‚\u003c/p\u003e\n\u003cp\u003e2ï¼Œéœ€è¦ä¸ºæ¯ä¸ªè¯·æ±‚åŠ è½½å’Œè¿è¡Œä¸€ä¸ªCGIç¨‹åºï¼Œè¿™å°†å¸¦æ¥å¾ˆå¤§çš„å¼€é”€\u003c/p\u003e\n\u003cp\u003e3ï¼Œéœ€è¦é‡å¤ç¼–å†™å¤„ç†ç½‘ç»œåè®®çš„ä»£ç ä»¥åŠç¼–ç ï¼Œè¿™äº›å·¥ä½œéƒ½æ˜¯éå¸¸è€—æ—¶çš„ã€‚\u003c/p\u003e\n\u003ch3 id=\"servletçš„ä¼˜ç‚¹\"\u003eServletçš„ä¼˜ç‚¹:\u003c/h3\u003e\n\u003cp\u003e1ï¼Œåªéœ€è¦å¯åŠ¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿè¿›ç¨‹ä»¥åŠåŠ è½½ä¸€ä¸ªJVMï¼Œå¤§å¤§é™ä½äº†ç³»ç»Ÿçš„å¼€é”€\u003c/p\u003e\n\u003cp\u003e2ï¼Œå¦‚æœå¤šä¸ªè¯·æ±‚éœ€è¦åšåŒæ ·å¤„ç†çš„æ—¶å€™ï¼Œè¿™æ—¶å€™åªéœ€è¦åŠ è½½ä¸€ä¸ªç±»ï¼Œè¿™ä¹Ÿå¤§å¤§é™ä½äº†å¼€é”€\u003c/p\u003e\n\u003cp\u003e3ï¼Œæ‰€æœ‰åŠ¨æ€åŠ è½½çš„ç±»å¯ä»¥å®ç°å¯¹ç½‘ç»œåè®®ä»¥åŠè¯·æ±‚è§£ç çš„å…±äº«ï¼Œå¤§å¤§é™ä½äº†å·¥ä½œé‡ã€‚\u003c/p\u003e\n\u003cp\u003e4ï¼ŒServletèƒ½ç›´æ¥å’ŒWebæœåŠ¡å™¨äº¤äº’ï¼Œè€Œæ™®é€šçš„CGIç¨‹åºä¸èƒ½ã€‚Servletè¿˜èƒ½åœ¨å„ä¸ªç¨‹åºä¹‹é—´å…±äº«æ•°æ®ï¼Œä½¿æ•°æ®åº“è¿æ¥æ± ä¹‹ç±»çš„åŠŸèƒ½å¾ˆå®¹æ˜“å®ç°ã€‚\u003c/p\u003e\n\u003cp\u003eè¡¥å……ï¼šSun Microsystemså…¬å¸åœ¨1996å¹´å‘å¸ƒServletæŠ€æœ¯å°±æ˜¯ä¸ºäº†å’ŒCGIè¿›è¡Œç«äº‰ï¼ŒServletæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„Javaç¨‹åºï¼Œä¸€ä¸ªåŸºäºJavaçš„Webåº”ç”¨é€šå¸¸åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªServletç±»ã€‚Servletä¸èƒ½å¤Ÿè‡ªè¡Œåˆ›å»ºå¹¶æ‰§è¡Œï¼Œå®ƒæ˜¯åœ¨Servletå®¹å™¨ä¸­è¿è¡Œçš„ï¼Œå®¹å™¨å°†ç”¨æˆ·çš„è¯·æ±‚ä¼ é€’ç»™Servletç¨‹åºï¼Œå¹¶å°†Servletçš„å“åº”å›ä¼ ç»™ç”¨æˆ·ã€‚é€šå¸¸ä¸€ä¸ªServletä¼šå…³è”ä¸€ä¸ªæˆ–å¤šä¸ªJSPé¡µé¢ã€‚ä»¥å‰CGIç»å¸¸å› ä¸ºæ€§èƒ½å¼€é”€ä¸Šçš„é—®é¢˜è¢«è¯Ÿç—…ï¼Œç„¶è€ŒFast CGIæ—©å°±å·²ç»è§£å†³äº†CGIæ•ˆç‡ä¸Šçš„é—®é¢˜ï¼Œæ‰€ä»¥é¢è¯•çš„æ—¶å€™å¤§å¯ä¸å¿…ä¿¡å£å¼€æ²³çš„è¯Ÿç—…CGIï¼Œäº‹å®ä¸Šæœ‰å¾ˆå¤šä½ ç†Ÿæ‚‰çš„ç½‘ç«™éƒ½ä½¿ç”¨äº†CGIæŠ€æœ¯ã€‚\u003c/p\u003e\n\u003cp\u003eå‚è€ƒï¼šã€Šjavawebæ•´åˆå¼€å‘ç‹è€…å½’æ¥ã€‹P7\u003c/p\u003e\n\u003ch2 id=\"servletæ¥å£ä¸­æœ‰å“ªäº›æ–¹æ³•åŠservletç”Ÿå‘½å‘¨æœŸæ¢ç§˜\"\u003eServletæ¥å£ä¸­æœ‰å“ªäº›æ–¹æ³•åŠServletç”Ÿå‘½å‘¨æœŸæ¢ç§˜\u003c/h2\u003e\n\u003cp\u003eServletæ¥å£å®šä¹‰äº†5ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­\u003cstrong\u003eå‰ä¸‰ä¸ªæ–¹æ³•ä¸Servletç”Ÿå‘½å‘¨æœŸç›¸å…³\u003c/strong\u003eï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003evoid init(ServletConfig config) throws ServletException\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003evoid service(ServletRequest req, ServletResponse resp) throws ServletException, java.io.IOException\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003evoid destory()\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003ejava.lang.String getServletInfo()\u003c/li\u003e\n\u003cli\u003eServletConfig getServletConfig()\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eç”Ÿå‘½å‘¨æœŸï¼š\u003c/strong\u003e \u003cstrong\u003eWebå®¹å™¨åŠ è½½Servletå¹¶å°†å…¶å®ä¾‹åŒ–åï¼ŒServletç”Ÿå‘½å‘¨æœŸå¼€å§‹\u003c/strong\u003eï¼Œå®¹å™¨è¿è¡Œå…¶\u003cstrong\u003einit()æ–¹æ³•\u003c/strong\u003eè¿›è¡ŒServletçš„åˆå§‹åŒ–ï¼›è¯·æ±‚åˆ°è¾¾æ—¶è°ƒç”¨Servletçš„\u003cstrong\u003eservice()æ–¹æ³•\u003c/strong\u003eï¼Œservice()æ–¹æ³•ä¼šæ ¹æ®éœ€è¦è°ƒç”¨ä¸è¯·æ±‚å¯¹åº”çš„\u003cstrong\u003edoGetæˆ–doPost\u003c/strong\u003eç­‰æ–¹æ³•ï¼›å½“æœåŠ¡å™¨å…³é—­æˆ–é¡¹ç›®è¢«å¸è½½æ—¶æœåŠ¡å™¨ä¼šå°†Servletå®ä¾‹é”€æ¯ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨Servletçš„\u003cstrong\u003edestroy()æ–¹æ³•\u003c/strong\u003eã€‚\u003cstrong\u003einitæ–¹æ³•å’Œdestoryæ–¹æ³•åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œserviceæ–¹æ³•å®¢æˆ·ç«¯æ¯æ¬¡è¯·æ±‚Servletéƒ½ä¼šæ‰§è¡Œ\u003c/strong\u003eã€‚Servletä¸­æœ‰æ—¶ä¼šç”¨åˆ°ä¸€äº›éœ€è¦åˆå§‹åŒ–ä¸é”€æ¯çš„èµ„æºï¼Œå› æ­¤å¯ä»¥æŠŠåˆå§‹åŒ–èµ„æºçš„ä»£ç æ”¾å…¥initæ–¹æ³•ä¸­ï¼Œé”€æ¯èµ„æºçš„ä»£ç æ”¾å…¥destroyæ–¹æ³•ä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯æ¬¡å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½è¦åˆå§‹åŒ–ä¸é”€æ¯èµ„æºã€‚\u003c/p\u003e\n\u003cp\u003eå‚è€ƒï¼šã€Šjavawebæ•´åˆå¼€å‘ç‹è€…å½’æ¥ã€‹P81\u003c/p\u003e\n\u003ch2 id=\"getå’Œpostè¯·æ±‚çš„åŒºåˆ«\"\u003egetå’Œpostè¯·æ±‚çš„åŒºåˆ«\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eç½‘ä¸Šä¹Ÿæœ‰æ–‡ç« è¯´ï¼šgetå’Œpostè¯·æ±‚å®é™…ä¸Šæ˜¯æ²¡æœ‰åŒºåˆ«ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥è¯¢ç›¸å…³æ–‡ç« ï¼æˆ‘ä¸‹é¢ç»™å‡ºçš„åªæ˜¯ä¸€ç§å¸¸è§çš„ç­”æ¡ˆã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eâ‘ getè¯·æ±‚ç”¨æ¥ä»æœåŠ¡å™¨ä¸Šè·å¾—èµ„æºï¼Œè€Œpostæ˜¯ç”¨æ¥å‘æœåŠ¡å™¨æäº¤æ•°æ®ï¼›\u003c/p\u003e\n\u003cp\u003eâ‘¡getå°†è¡¨å•ä¸­æ•°æ®æŒ‰ç…§name=valueçš„å½¢å¼ï¼Œæ·»åŠ åˆ°action æ‰€æŒ‡å‘çš„URL åé¢ï¼Œå¹¶ä¸”ä¸¤è€…ä½¿ç”¨\u0026quot;?\u0026ldquo;è¿æ¥ï¼Œè€Œå„ä¸ªå˜é‡ä¹‹é—´ä½¿ç”¨\u0026rdquo;\u0026amp;\u0026ldquo;è¿æ¥ï¼›postæ˜¯å°†è¡¨å•ä¸­çš„æ•°æ®æ”¾åœ¨HTTPåè®®çš„è¯·æ±‚å¤´æˆ–æ¶ˆæ¯ä½“ä¸­ï¼Œä¼ é€’åˆ°actionæ‰€æŒ‡å‘URLï¼›\u003c/p\u003e\n\u003cp\u003eâ‘¢getä¼ è¾“çš„æ•°æ®è¦å—åˆ°URLé•¿åº¦é™åˆ¶ï¼ˆ1024å­—èŠ‚å³256ä¸ªå­—ç¬¦ï¼‰ï¼›è€Œpostå¯ä»¥ä¼ è¾“å¤§é‡çš„æ•°æ®ï¼Œä¸Šä¼ æ–‡ä»¶é€šå¸¸è¦ä½¿ç”¨postæ–¹å¼ï¼›\u003c/p\u003e\n\u003cp\u003eâ‘£ä½¿ç”¨getæ—¶å‚æ•°ä¼šæ˜¾ç¤ºåœ¨åœ°å€æ ä¸Šï¼Œå¦‚æœè¿™äº›æ•°æ®ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨getï¼›å¯¹äºæ•æ„Ÿæ•°æ®è¿˜æ˜¯åº”ç”¨ä½¿ç”¨postï¼›\u003c/p\u003e\n\u003cp\u003eâ‘¤getä½¿ç”¨MIMEç±»å‹application/x-www-form-urlencodedçš„URLç¼–ç ï¼ˆä¹Ÿå«ç™¾åˆ†å·ç¼–ç ï¼‰æ–‡æœ¬çš„æ ¼å¼ä¼ é€’å‚æ•°ï¼Œä¿è¯è¢«ä¼ é€çš„å‚æ•°ç”±éµå¾ªè§„èŒƒçš„æ–‡æœ¬ç»„æˆï¼Œä¾‹å¦‚ä¸€ä¸ªç©ºæ ¼çš„ç¼–ç æ˜¯\u0026rdquo;%20\u0026quot;ã€‚\u003c/p\u003e\n\u003cp\u003eè¡¥å……ï¼šGETæ–¹å¼æäº¤è¡¨å•çš„å…¸å‹åº”ç”¨æ˜¯æœç´¢å¼•æ“ã€‚GETæ–¹å¼å°±æ˜¯è¢«è®¾è®¡ä¸ºæŸ¥è¯¢ç”¨çš„ã€‚\u003c/p\u003e\n\u003cp\u003eè¿˜æœ‰å¦å¤–ä¸€ç§å›ç­”ã€‚æ¨èå¤§å®¶çœ‹ä¸€ä¸‹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.zhihu.com/question/28586791\"\u003ehttps://www.zhihu.com/question/28586791\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://mp.weixin.qq.com/s?__biz=MzI3NzIzMzg3Mw==\u0026amp;mid=100000054\u0026amp;idx=1\u0026amp;sn=71f6c214f3833d9ca20b9f7dcd9d33e4#rd\"\u003ehttps://mp.weixin.qq.com/s?__biz=MzI3NzIzMzg3Mw==\u0026amp;mid=100000054\u0026amp;idx=1\u0026amp;sn=71f6c214f3833d9ca20b9f7dcd9d33e4#rd\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ä»€ä¹ˆæƒ…å†µä¸‹è°ƒç”¨dogetå’Œdopost\"\u003eä»€ä¹ˆæƒ…å†µä¸‹è°ƒç”¨doGet()å’ŒdoPost()\u003c/h2\u003e\n\u003cp\u003eFormæ ‡ç­¾é‡Œçš„methodçš„å±æ€§ä¸ºgetæ—¶è°ƒç”¨doGet()ï¼Œä¸ºpostæ—¶è°ƒç”¨doPost()ã€‚\u003c/p\u003e\n\u003ch2 id=\"è½¬å‘forwardå’Œé‡å®šå‘redirectçš„åŒºåˆ«\"\u003eè½¬å‘(Forward)å’Œé‡å®šå‘(Redirect)çš„åŒºåˆ«\u003c/h2\u003e\n\u003cp\u003e\u003cstrong\u003eè½¬å‘æ˜¯æœåŠ¡å™¨è¡Œä¸ºï¼Œé‡å®šå‘æ˜¯å®¢æˆ·ç«¯è¡Œä¸ºã€‚\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eè½¬å‘ï¼ˆForwordï¼‰\u003c/strong\u003e é€šè¿‡RequestDispatcherå¯¹è±¡çš„forwardï¼ˆHttpServletRequest request,HttpServletResponse responseï¼‰æ–¹æ³•å®ç°çš„ã€‚RequestDispatcherå¯ä»¥é€šè¿‡HttpServletRequest çš„getRequestDispatcher()æ–¹æ³•è·å¾—ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç å°±æ˜¯è·³è½¬åˆ°login_success.jspé¡µé¢ã€‚\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e     request.getRequestDispatcher(\u0026#34;login_success.jsp\u0026#34;).forward(request, response);\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cstrong\u003eé‡å®šå‘ï¼ˆRedirectï¼‰\u003c/strong\u003e æ˜¯åˆ©ç”¨æœåŠ¡å™¨è¿”å›çš„çŠ¶æ€å—æ¥å®ç°çš„ã€‚å®¢æˆ·ç«¯æµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªçŠ¶æ€ç ã€‚æœåŠ¡å™¨é€šè¿‡HttpServletRequestResponseçš„setStatus(int status)æ–¹æ³•è®¾ç½®çŠ¶æ€ç ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›301æˆ–è€…302ï¼Œåˆ™æµè§ˆå™¨ä¼šåˆ°æ–°çš„ç½‘å€é‡æ–°è¯·æ±‚è¯¥èµ„æºã€‚\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eä»åœ°å€æ æ˜¾ç¤ºæ¥è¯´\u003c/strong\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eforwardæ˜¯æœåŠ¡å™¨è¯·æ±‚èµ„æº,æœåŠ¡å™¨ç›´æ¥è®¿é—®ç›®æ ‡åœ°å€çš„URL,æŠŠé‚£ä¸ªURLçš„å“åº”å†…å®¹è¯»å–è¿‡æ¥,ç„¶åæŠŠè¿™äº›å†…å®¹å†å‘ç»™æµè§ˆå™¨.æµè§ˆå™¨æ ¹æœ¬ä¸çŸ¥é“æœåŠ¡å™¨å‘é€çš„å†…å®¹ä»å“ªé‡Œæ¥çš„,æ‰€ä»¥å®ƒçš„åœ°å€æ è¿˜æ˜¯åŸæ¥çš„åœ°å€. redirectæ˜¯æœåŠ¡ç«¯æ ¹æ®é€»è¾‘,å‘é€ä¸€ä¸ªçŠ¶æ€ç ,å‘Šè¯‰æµè§ˆå™¨é‡æ–°å»è¯·æ±‚é‚£ä¸ªåœ°å€.æ‰€ä»¥åœ°å€æ æ˜¾ç¤ºçš„æ˜¯æ–°çš„URL.\u003c/p\u003e","title":"J2EEåŸºç¡€çŸ¥è¯†"},{"content":"1. é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ« é¢å‘è¿‡ç¨‹ ä¼˜ç‚¹ï¼š æ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ï¼Œå› ä¸ºç±»è°ƒç”¨æ—¶éœ€è¦å®ä¾‹åŒ–ï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œæ¯”è¾ƒæ¶ˆè€—èµ„æº;æ¯”å¦‚å•ç‰‡æœºã€åµŒå…¥å¼å¼€å‘ã€Linux/Unixç­‰ä¸€èˆ¬é‡‡ç”¨é¢å‘è¿‡ç¨‹å¼€å‘ï¼Œæ€§èƒ½æ˜¯æœ€é‡è¦çš„å› ç´ ã€‚\nç¼ºç‚¹ï¼š æ²¡æœ‰é¢å‘å¯¹è±¡æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•\né¢å‘å¯¹è±¡ ä¼˜ç‚¹ï¼š æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ï¼Œç”±äºé¢å‘å¯¹è±¡æœ‰å°è£…ã€ç»§æ‰¿ã€å¤šæ€æ€§çš„ç‰¹æ€§ï¼Œå¯ä»¥è®¾è®¡å‡ºä½è€¦åˆçš„ç³»ç»Ÿï¼Œä½¿ç³»ç»Ÿæ›´åŠ çµæ´»ã€æ›´åŠ æ˜“äºç»´æŠ¤\nç¼ºç‚¹ï¼š æ€§èƒ½æ¯”é¢å‘è¿‡ç¨‹ä½\n2. Java è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹ ç®€å•æ˜“å­¦ï¼› é¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰ï¼› å¹³å°æ— å…³æ€§ï¼ˆ Java è™šæ‹Ÿæœºå®ç°å¹³å°æ— å…³æ€§ï¼‰ï¼› å¯é æ€§ï¼› å®‰å…¨æ€§ï¼› æ”¯æŒå¤šçº¿ç¨‹ï¼ˆ C++ è¯­è¨€æ²¡æœ‰å†…ç½®çš„å¤šçº¿ç¨‹æœºåˆ¶ï¼Œå› æ­¤å¿…é¡»è°ƒç”¨æ“ä½œç³»ç»Ÿçš„å¤šçº¿ç¨‹åŠŸèƒ½æ¥è¿›è¡Œå¤šçº¿ç¨‹ç¨‹åºè®¾è®¡ï¼Œè€Œ Java è¯­è¨€å´æä¾›äº†å¤šçº¿ç¨‹æ”¯æŒï¼‰ï¼› æ”¯æŒç½‘ç»œç¼–ç¨‹å¹¶ä¸”å¾ˆæ–¹ä¾¿ï¼ˆ Java è¯­è¨€è¯ç”Ÿæœ¬èº«å°±æ˜¯ä¸ºç®€åŒ–ç½‘ç»œç¼–ç¨‹è®¾è®¡çš„ï¼Œå› æ­¤ Java è¯­è¨€ä¸ä»…æ”¯æŒç½‘ç»œç¼–ç¨‹è€Œä¸”å¾ˆæ–¹ä¾¿ï¼‰ï¼› ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜ï¼› 3. ä»€ä¹ˆæ˜¯ JDK ä»€ä¹ˆæ˜¯ JRE ä»€ä¹ˆæ˜¯ JVM ä¸‰è€…ä¹‹é—´çš„è”ç³»ä¸åŒºåˆ« è¿™å‡ ä¸ªæ˜¯Javaä¸­å¾ˆåŸºæœ¬å¾ˆåŸºæœ¬çš„ä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡ä¸€å®šè¿˜æœ‰å¾ˆå¤šäººæä¸æ¸…æ¥šï¼ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬å¤§å¤šæ•°æ—¶å€™åœ¨ä½¿ç”¨ç°æˆçš„ç¼–è¯‘å·¥å…·ä»¥åŠç¯å¢ƒçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰å»è€ƒè™‘è¿™äº›ä¸œè¥¿ã€‚\nJDK: JDKï¼ˆJava Development Kitï¼‰é¡¾åæ€ä¹‰å®ƒæ˜¯ç»™å¼€å‘è€…æä¾›çš„å¼€å‘å·¥å…·ç®±,æ˜¯ç»™ç¨‹åºå¼€å‘è€…ç”¨çš„ã€‚å®ƒé™¤äº†åŒ…æ‹¬å®Œæ•´çš„JREï¼ˆJava Runtime Environmentï¼‰ï¼ŒJavaè¿è¡Œç¯å¢ƒï¼Œè¿˜åŒ…å«äº†å…¶ä»–ä¾›å¼€å‘è€…ä½¿ç”¨çš„å·¥å…·åŒ…ã€‚\nJRE: æ™®é€šç”¨æˆ·è€Œåªéœ€è¦å®‰è£… JREï¼ˆJava Runtime Environmentï¼‰æ¥è¿è¡Œ Java ç¨‹åºã€‚è€Œç¨‹åºå¼€å‘è€…å¿…é¡»å®‰è£…JDKæ¥ç¼–è¯‘ã€è°ƒè¯•ç¨‹åºã€‚\nJVMï¼š å½“æˆ‘ä»¬è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼ŒJVM è´Ÿè´£å°†å­—èŠ‚ç è½¬æ¢ä¸ºç‰¹å®šæœºå™¨ä»£ç ï¼ŒJVM æä¾›äº†å†…å­˜ç®¡ç†/åƒåœ¾å›æ”¶å’Œå®‰å…¨æœºåˆ¶ç­‰ã€‚è¿™ç§ç‹¬ç«‹äºç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿï¼Œæ­£æ˜¯ java ç¨‹åºå¯ä»¥ä¸€æ¬¡ç¼–å†™å¤šå¤„æ‰§è¡Œçš„åŸå› ã€‚\nåŒºåˆ«ä¸è”ç³»ï¼š\nJDK ç”¨äºå¼€å‘ï¼ŒJRE ç”¨äºè¿è¡Œjavaç¨‹åº ï¼› JDK å’Œ JRE ä¸­éƒ½åŒ…å« JVM ï¼› JVM æ˜¯ java ç¼–ç¨‹è¯­è¨€çš„æ ¸å¿ƒå¹¶ä¸”å…·æœ‰å¹³å°ç‹¬ç«‹æ€§ã€‚ 4. ä»€ä¹ˆæ˜¯å­—èŠ‚ç  é‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ å…ˆçœ‹ä¸‹ java ä¸­çš„ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ï¼š Java ä¸­å¼•å…¥äº†è™šæ‹Ÿæœºçš„æ¦‚å¿µï¼Œå³åœ¨æœºå™¨å’Œç¼–è¯‘ç¨‹åºä¹‹é—´åŠ å…¥äº†ä¸€å±‚æŠ½è±¡çš„è™šæ‹Ÿçš„æœºå™¨ã€‚è¿™å°è™šæ‹Ÿçš„æœºå™¨åœ¨ä»»ä½•å¹³å°ä¸Šéƒ½æä¾›ç»™ç¼–è¯‘ç¨‹åºä¸€ä¸ªçš„å…±åŒçš„æ¥å£ã€‚\nç¼–è¯‘ç¨‹åºåªéœ€è¦é¢å‘è™šæ‹Ÿæœºï¼Œç”Ÿæˆè™šæ‹Ÿæœºèƒ½å¤Ÿç†è§£çš„ä»£ç ï¼Œç„¶åç”±è§£é‡Šå™¨æ¥å°†è™šæ‹Ÿæœºä»£ç è½¬æ¢ä¸ºç‰¹å®šç³»ç»Ÿçš„æœºå™¨ç æ‰§è¡Œã€‚åœ¨ Java ä¸­ï¼Œè¿™ç§ä¾›è™šæ‹Ÿæœºç†è§£çš„ä»£ç å«åšå­—èŠ‚ç ï¼ˆå³æ‰©å±•åä¸º .class çš„æ–‡ä»¶ï¼‰ï¼Œå®ƒä¸é¢å‘ä»»ä½•ç‰¹å®šçš„å¤„ç†å™¨ï¼Œåªé¢å‘è™šæ‹Ÿæœºã€‚\næ¯ä¸€ç§å¹³å°çš„è§£é‡Šå™¨æ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯å®ç°çš„è™šæ‹Ÿæœºæ˜¯ç›¸åŒçš„ã€‚Java æºç¨‹åºç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘åå˜æˆå­—èŠ‚ç ï¼Œå­—èŠ‚ç ç”±è™šæ‹Ÿæœºè§£é‡Šæ‰§è¡Œï¼Œè™šæ‹Ÿæœºå°†æ¯ä¸€æ¡è¦æ‰§è¡Œçš„å­—èŠ‚ç é€ç»™è§£é‡Šå™¨ï¼Œè§£é‡Šå™¨å°†å…¶ç¿»è¯‘æˆç‰¹å®šæœºå™¨ä¸Šçš„æœºå™¨ç ï¼Œç„¶ååœ¨ç‰¹å®šçš„æœºå™¨ä¸Šè¿è¡Œã€‚è¿™ä¹Ÿå°±æ˜¯è§£é‡Šäº† Java çš„ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜çš„ç‰¹ç‚¹ã€‚\nJava æºä»£ç \u0026mdash;-\u0026gt;ç¼–è¯‘å™¨\u0026mdash;-\u0026gt;jvm å¯æ‰§è¡Œçš„ Java å­—èŠ‚ç (å³è™šæ‹ŸæŒ‡ä»¤)\u0026mdash;-\u0026gt;jvm\u0026mdash;-\u0026gt;jvm ä¸­è§£é‡Šå™¨\u0026mdash;\u0026ndash;\u0026gt;æœºå™¨å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æœºå™¨ç \u0026mdash;-\u0026gt;ç¨‹åºè¿è¡Œã€‚\né‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„ï¼šã€€Java è¯­è¨€é€šè¿‡å­—èŠ‚ç çš„æ–¹å¼ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†ä¼ ç»Ÿè§£é‡Šå‹è¯­è¨€æ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ï¼ŒåŒæ—¶åˆä¿ç•™äº†è§£é‡Šå‹è¯­è¨€å¯ç§»æ¤çš„ç‰¹ç‚¹ã€‚æ‰€ä»¥ Java ç¨‹åºè¿è¡Œæ—¶æ¯”è¾ƒé«˜æ•ˆï¼Œè€Œä¸”ï¼Œç”±äºå­—èŠ‚ç å¹¶ä¸ä¸“å¯¹ä¸€ç§ç‰¹å®šçš„æœºå™¨ï¼Œå› æ­¤ï¼ŒJavaç¨‹åºæ— é¡»é‡æ–°ç¼–è¯‘ä¾¿å¯åœ¨å¤šç§ä¸åŒçš„è®¡ç®—æœºä¸Šè¿è¡Œã€‚\nè§£é‡Šå‹è¯­è¨€ï¼šè§£é‡Šå‹è¯­è¨€ï¼Œæ˜¯åœ¨è¿è¡Œçš„æ—¶å€™å°†ç¨‹åºç¿»è¯‘æˆæœºå™¨è¯­è¨€ã€‚è§£é‡Šå‹è¯­è¨€çš„ç¨‹åºä¸éœ€è¦åœ¨è¿è¡Œå‰ç¼–è¯‘ï¼Œåœ¨è¿è¡Œç¨‹åºçš„æ—¶å€™æ‰ç¿»è¯‘ï¼Œä¸“é—¨çš„è§£é‡Šå™¨è´Ÿè´£åœ¨æ¯ä¸ªè¯­å¥æ‰§è¡Œçš„æ—¶å€™è§£é‡Šç¨‹åºä»£ç ã€‚è¿™æ ·è§£é‡Šå‹è¯­è¨€æ¯æ‰§è¡Œä¸€æ¬¡å°±è¦ç¿»è¯‘ä¸€æ¬¡ï¼Œæ•ˆç‡æ¯”è¾ƒä½ã€‚â€”â€”ç™¾åº¦ç™¾ç§‘\n5. Javaå’ŒC++çš„åŒºåˆ« æˆ‘çŸ¥é“å¾ˆå¤šäººæ²¡å­¦è¿‡ C++ï¼Œä½†æ˜¯é¢è¯•å®˜å°±æ˜¯æ²¡äº‹å–œæ¬¢æ‹¿å’±ä»¬ Java å’Œ C++ æ¯”å‘€ï¼æ²¡åŠæ³•ï¼ï¼ï¼å°±ç®—æ²¡å­¦è¿‡C++ï¼Œä¹Ÿè¦è®°ä¸‹æ¥ï¼\néƒ½æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œéƒ½æ”¯æŒå°è£…ã€ç»§æ‰¿å’Œå¤šæ€ Java ä¸æä¾›æŒ‡é’ˆæ¥ç›´æ¥è®¿é—®å†…å­˜ï¼Œç¨‹åºå†…å­˜æ›´åŠ å®‰å…¨ Java çš„ç±»æ˜¯å•ç»§æ‰¿çš„ï¼ŒC++ æ”¯æŒå¤šé‡ç»§æ‰¿ï¼›è™½ç„¶ Java çš„ç±»ä¸å¯ä»¥å¤šç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¤šç»§æ‰¿ã€‚ Java æœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾æ— ç”¨å†…å­˜ 6. ä»€ä¹ˆæ˜¯ Java ç¨‹åºçš„ä¸»ç±» åº”ç”¨ç¨‹åºå’Œå°ç¨‹åºçš„ä¸»ç±»æœ‰ä½•ä¸åŒ ä¸€ä¸ªç¨‹åºä¸­å¯ä»¥æœ‰å¤šä¸ªç±»ï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªç±»æ˜¯ä¸»ç±»ã€‚åœ¨ Java åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™ä¸ªä¸»ç±»æ˜¯æŒ‡åŒ…å« mainï¼ˆï¼‰æ–¹æ³•çš„ç±»ã€‚è€Œåœ¨ Java å°ç¨‹åºä¸­ï¼Œè¿™ä¸ªä¸»ç±»æ˜¯ä¸€ä¸ªç»§æ‰¿è‡ªç³»ç»Ÿç±» JApplet æˆ– Applet çš„å­ç±»ã€‚åº”ç”¨ç¨‹åºçš„ä¸»ç±»ä¸ä¸€å®šè¦æ±‚æ˜¯ public ç±»ï¼Œä½†å°ç¨‹åºçš„ä¸»ç±»è¦æ±‚å¿…é¡»æ˜¯ public ç±»ã€‚ä¸»ç±»æ˜¯ Java ç¨‹åºæ‰§è¡Œçš„å…¥å£ç‚¹ã€‚\n7. Java åº”ç”¨ç¨‹åºä¸å°ç¨‹åºä¹‹é—´æœ‰é‚£äº›å·®åˆ« ç®€å•è¯´åº”ç”¨ç¨‹åºæ˜¯ä»ä¸»çº¿ç¨‹å¯åŠ¨(ä¹Ÿå°±æ˜¯ main() æ–¹æ³•)ã€‚applet å°ç¨‹åºæ²¡æœ‰mainæ–¹æ³•ï¼Œä¸»è¦æ˜¯åµŒåœ¨æµè§ˆå™¨é¡µé¢ä¸Šè¿è¡Œ(è°ƒç”¨init()çº¿ç¨‹æˆ–è€…run()æ¥å¯åŠ¨)ï¼ŒåµŒå…¥æµè§ˆå™¨è¿™ç‚¹è·Ÿ flash çš„å°æ¸¸æˆç±»ä¼¼ã€‚\n8. å­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡çš„åŒºåˆ« å½¢å¼ä¸Š: å­—ç¬¦å¸¸é‡æ˜¯å•å¼•å·å¼•èµ·çš„ä¸€ä¸ªå­—ç¬¦ å­—ç¬¦ä¸²å¸¸é‡æ˜¯åŒå¼•å·å¼•èµ·çš„è‹¥å¹²ä¸ªå­—ç¬¦ å«ä¹‰ä¸Š: å­—ç¬¦å¸¸é‡ç›¸å½“äºä¸€ä¸ªæ•´å½¢å€¼( ASCII å€¼),å¯ä»¥å‚åŠ è¡¨è¾¾å¼è¿ç®— å­—ç¬¦ä¸²å¸¸é‡ä»£è¡¨ä¸€ä¸ªåœ°å€å€¼(è¯¥å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­å­˜æ”¾ä½ç½®) å å†…å­˜å¤§å° å­—ç¬¦å¸¸é‡åªå 2ä¸ªå­—èŠ‚ å­—ç¬¦ä¸²å¸¸é‡å è‹¥å¹²ä¸ªå­—èŠ‚(è‡³å°‘ä¸€ä¸ªå­—ç¬¦ç»“æŸæ ‡å¿—) (æ³¨æ„ï¼š charåœ¨Javaä¸­å ä¸¤ä¸ªå­—èŠ‚) 9. æ„é€ å™¨ Constructor æ˜¯å¦å¯è¢« override åœ¨è®²ç»§æ‰¿çš„æ—¶å€™æˆ‘ä»¬å°±çŸ¥é“çˆ¶ç±»çš„ç§æœ‰å±æ€§å’Œæ„é€ æ–¹æ³•å¹¶ä¸èƒ½è¢«ç»§æ‰¿ï¼Œæ‰€ä»¥ Constructor ä¹Ÿå°±ä¸èƒ½è¢« overrideï¼ˆé‡å†™ï¼‰,ä½†æ˜¯å¯ä»¥ overloadï¼ˆé‡è½½ï¼‰,æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç±»ä¸­æœ‰å¤šä¸ªæ„é€ å‡½æ•°çš„æƒ…å†µã€‚\n10. é‡è½½å’Œé‡å†™çš„åŒºåˆ« é‡è½½ï¼š å‘ç”Ÿåœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•åå¿…é¡»ç›¸åŒï¼Œå‚æ•°ç±»å‹ä¸åŒã€ä¸ªæ•°ä¸åŒã€é¡ºåºä¸åŒï¼Œæ–¹æ³•è¿”å›å€¼å’Œè®¿é—®ä¿®é¥°ç¬¦å¯ä»¥ä¸åŒï¼Œå‘ç”Ÿåœ¨ç¼–è¯‘æ—¶ã€‚ é‡å†™ï¼š å‘ç”Ÿåœ¨çˆ¶å­ç±»ä¸­ï¼Œæ–¹æ³•åã€å‚æ•°åˆ—è¡¨å¿…é¡»ç›¸åŒï¼Œè¿”å›å€¼èŒƒå›´å°äºç­‰äºçˆ¶ç±»ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸èŒƒå›´å°äºç­‰äºçˆ¶ç±»ï¼Œè®¿é—®ä¿®é¥°ç¬¦èŒƒå›´å¤§äºç­‰äºçˆ¶ç±»ï¼›å¦‚æœçˆ¶ç±»æ–¹æ³•è®¿é—®ä¿®é¥°ç¬¦ä¸º private åˆ™å­ç±»å°±ä¸èƒ½é‡å†™è¯¥æ–¹æ³•ã€‚\n11. Java é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸‰å¤§ç‰¹æ€§:å°è£…ã€ç»§æ‰¿ã€å¤šæ€ å°è£… å°è£…æŠŠä¸€ä¸ªå¯¹è±¡çš„å±æ€§ç§æœ‰åŒ–ï¼ŒåŒæ—¶æä¾›ä¸€äº›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„å±æ€§çš„æ–¹æ³•ï¼Œå¦‚æœå±æ€§ä¸æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…æä¾›æ–¹æ³•ç»™å¤–ç•Œè®¿é—®ã€‚ä½†æ˜¯å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰æä¾›ç»™å¤–ç•Œè®¿é—®çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ„ä¹‰äº†ã€‚\nç»§æ‰¿ ç»§æ‰¿æ˜¯ä½¿ç”¨å·²å­˜åœ¨çš„ç±»çš„å®šä¹‰ä½œä¸ºåŸºç¡€å»ºç«‹æ–°ç±»çš„æŠ€æœ¯ï¼Œæ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„æ•°æ®æˆ–æ–°çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥ç”¨çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½é€‰æ‹©æ€§åœ°ç»§æ‰¿çˆ¶ç±»ã€‚é€šè¿‡ä½¿ç”¨ç»§æ‰¿æˆ‘ä»¬èƒ½å¤Ÿéå¸¸æ–¹ä¾¿åœ°å¤ç”¨ä»¥å‰çš„ä»£ç ã€‚\nå…³äºç»§æ‰¿å¦‚ä¸‹ 3 ç‚¹è¯·è®°ä½ï¼š\nå­ç±»æ‹¥æœ‰çˆ¶ç±»é private çš„å±æ€§å’Œæ–¹æ³•ã€‚ å­ç±»å¯ä»¥æ‹¥æœ‰è‡ªå·±å±æ€§å’Œæ–¹æ³•ï¼Œå³å­ç±»å¯ä»¥å¯¹çˆ¶ç±»è¿›è¡Œæ‰©å±•ã€‚ å­ç±»å¯ä»¥ç”¨è‡ªå·±çš„æ–¹å¼å®ç°çˆ¶ç±»çš„æ–¹æ³•ã€‚ï¼ˆä»¥åä»‹ç»ï¼‰ã€‚ å¤šæ€ æ‰€è°“å¤šæ€å°±æ˜¯æŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¼•ç”¨å˜é‡æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹å’Œé€šè¿‡è¯¥å¼•ç”¨å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨åœ¨ç¼–ç¨‹æ—¶å¹¶ä¸ç¡®å®šï¼Œè€Œæ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ‰ç¡®å®šï¼Œå³ä¸€ä¸ªå¼•ç”¨å˜é‡å€’åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•ç”¨å˜é‡å‘å‡ºçš„æ–¹æ³•è°ƒç”¨åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„æ–¹æ³•ï¼Œå¿…é¡»åœ¨ç”±ç¨‹åºè¿è¡ŒæœŸé—´æ‰èƒ½å†³å®šã€‚\nåœ¨Javaä¸­æœ‰ä¸¤ç§å½¢å¼å¯ä»¥å®ç°å¤šæ€ï¼šç»§æ‰¿ï¼ˆå¤šä¸ªå­ç±»å¯¹åŒä¸€æ–¹æ³•çš„é‡å†™ï¼‰å’Œæ¥å£ï¼ˆå®ç°æ¥å£å¹¶è¦†ç›–æ¥å£ä¸­åŒä¸€æ–¹æ³•ï¼‰ã€‚\n12. String å’Œ StringBufferã€StringBuilder çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ String ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„ å¯å˜æ€§ ç®€å•çš„æ¥è¯´ï¼šString ç±»ä¸­ä½¿ç”¨ final å…³é”®å­—å­—ç¬¦æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²ï¼Œprivateã€€finalã€€charã€€value[]ï¼Œæ‰€ä»¥ String å¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚è€ŒStringBuilder ä¸ StringBuffer éƒ½ç»§æ‰¿è‡ª AbstractStringBuilder ç±»ï¼Œåœ¨ AbstractStringBuilder ä¸­ä¹Ÿæ˜¯ä½¿ç”¨å­—ç¬¦æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²char[]value ä½†æ˜¯æ²¡æœ‰ç”¨ final å…³é”®å­—ä¿®é¥°ï¼Œæ‰€ä»¥è¿™ä¸¤ç§å¯¹è±¡éƒ½æ˜¯å¯å˜çš„ã€‚\nStringBuilder ä¸ StringBuffer çš„æ„é€ æ–¹æ³•éƒ½æ˜¯è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•ä¹Ÿå°±æ˜¯ AbstractStringBuilder å®ç°çš„ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥é˜…æºç ã€‚\nAbstractStringBuilder.java\nabstract class AbstractStringBuilder implements Appendable, CharSequence { char[] value; int count; AbstractStringBuilder() { } AbstractStringBuilder(int capacity) { value = new char[capacity]; } çº¿ç¨‹å®‰å…¨æ€§\nString ä¸­çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±å¯ä»¥ç†è§£ä¸ºå¸¸é‡ï¼Œçº¿ç¨‹å®‰å…¨ã€‚AbstractStringBuilder æ˜¯ StringBuilder ä¸ StringBuffer çš„å…¬å…±çˆ¶ç±»ï¼Œå®šä¹‰äº†ä¸€äº›å­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œï¼Œå¦‚ expandCapacityã€appendã€insertã€indexOf ç­‰å…¬å…±æ–¹æ³•ã€‚StringBuffer å¯¹æ–¹æ³•åŠ äº†åŒæ­¥é”æˆ–è€…å¯¹è°ƒç”¨çš„æ–¹æ³•åŠ äº†åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚StringBuilder å¹¶æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡ŒåŠ åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚ æ€§èƒ½\næ¯æ¬¡å¯¹ String ç±»å‹è¿›è¡Œæ”¹å˜çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ String å¯¹è±¡ï¼Œç„¶åå°†æŒ‡é’ˆæŒ‡å‘æ–°çš„ String å¯¹è±¡ã€‚StringBuffer æ¯æ¬¡éƒ½ä¼šå¯¹ StringBuffer å¯¹è±¡æœ¬èº«è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯ç”Ÿæˆæ–°çš„å¯¹è±¡å¹¶æ”¹å˜å¯¹è±¡å¼•ç”¨ã€‚ç›¸åŒæƒ…å†µä¸‹ä½¿ç”¨ StirngBuilder ç›¸æ¯”ä½¿ç”¨ StringBuffer ä»…èƒ½è·å¾— 10%~15% å·¦å³çš„æ€§èƒ½æå‡ï¼Œä½†å´è¦å†’å¤šçº¿ç¨‹ä¸å®‰å…¨çš„é£é™©ã€‚\nå¯¹äºä¸‰è€…ä½¿ç”¨çš„æ€»ç»“ï¼š\næ“ä½œå°‘é‡çš„æ•°æ® = String å•çº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ® = StringBuilder å¤šçº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ® = StringBuffer 13. è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®± è£…ç®±ï¼šå°†åŸºæœ¬ç±»å‹ç”¨å®ƒä»¬å¯¹åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼›\næ‹†ç®±ï¼šå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼›\n14. åœ¨ä¸€ä¸ªé™æ€æ–¹æ³•å†…è°ƒç”¨ä¸€ä¸ªéé™æ€æˆå‘˜ä¸ºä»€ä¹ˆæ˜¯éæ³•çš„ ç”±äºé™æ€æ–¹æ³•å¯ä»¥ä¸é€šè¿‡å¯¹è±¡è¿›è¡Œè°ƒç”¨ï¼Œå› æ­¤åœ¨é™æ€æ–¹æ³•é‡Œï¼Œä¸èƒ½è°ƒç”¨å…¶ä»–éé™æ€å˜é‡ï¼Œä¹Ÿä¸å¯ä»¥è®¿é—®éé™æ€å˜é‡æˆå‘˜ã€‚\n15. åœ¨ Java ä¸­å®šä¹‰ä¸€ä¸ªä¸åšäº‹ä¸”æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•çš„ä½œç”¨ Java ç¨‹åºåœ¨æ‰§è¡Œå­ç±»çš„æ„é€ æ–¹æ³•ä¹‹å‰ï¼Œå¦‚æœæ²¡æœ‰ç”¨ super() æ¥è°ƒç”¨çˆ¶ç±»ç‰¹å®šçš„æ„é€ æ–¹æ³•ï¼Œåˆ™ä¼šè°ƒç”¨çˆ¶ç±»ä¸­â€œæ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•â€ã€‚å› æ­¤ï¼Œå¦‚æœçˆ¶ç±»ä¸­åªå®šä¹‰äº†æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œè€Œåœ¨å­ç±»çš„æ„é€ æ–¹æ³•ä¸­åˆæ²¡æœ‰ç”¨ super() æ¥è°ƒç”¨çˆ¶ç±»ä¸­ç‰¹å®šçš„æ„é€ æ–¹æ³•ï¼Œåˆ™ç¼–è¯‘æ—¶å°†å‘ç”Ÿé”™è¯¯ï¼Œå› ä¸º Java ç¨‹åºåœ¨çˆ¶ç±»ä¸­æ‰¾ä¸åˆ°æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•å¯ä¾›æ‰§è¡Œã€‚è§£å†³åŠæ³•æ˜¯åœ¨çˆ¶ç±»é‡ŒåŠ ä¸Šä¸€ä¸ªä¸åšäº‹ä¸”æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚ 16. import javaå’Œjavaxæœ‰ä»€ä¹ˆåŒºåˆ« åˆšå¼€å§‹çš„æ—¶å€™ JavaAPI æ‰€å¿…éœ€çš„åŒ…æ˜¯ java å¼€å¤´çš„åŒ…ï¼Œjavax å½“æ—¶åªæ˜¯æ‰©å±• API åŒ…æ¥è¯´ä½¿ç”¨ã€‚ç„¶è€Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œjavax é€æ¸çš„æ‰©å±•æˆä¸º Java API çš„ç»„æˆéƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œå°†æ‰©å±•ä» javax åŒ…ç§»åŠ¨åˆ° java åŒ…å°†æ˜¯å¤ªéº»çƒ¦äº†ï¼Œæœ€ç»ˆä¼šç ´åä¸€å †ç°æœ‰çš„ä»£ç ã€‚å› æ­¤ï¼Œæœ€ç»ˆå†³å®š javax åŒ…å°†æˆä¸ºæ ‡å‡†APIçš„ä¸€éƒ¨åˆ†ã€‚\næ‰€ä»¥ï¼Œå®é™…ä¸Šjavaå’Œjavaxæ²¡æœ‰åŒºåˆ«ã€‚è¿™éƒ½æ˜¯ä¸€ä¸ªåå­—ã€‚\n17. æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ æ¥å£çš„æ–¹æ³•é»˜è®¤æ˜¯ publicï¼Œæ‰€æœ‰æ–¹æ³•åœ¨æ¥å£ä¸­ä¸èƒ½æœ‰å®ç°(Java 8 å¼€å§‹æ¥å£æ–¹æ³•å¯ä»¥æœ‰é»˜è®¤å®ç°ï¼‰ï¼ŒæŠ½è±¡ç±»å¯ä»¥æœ‰éæŠ½è±¡çš„æ–¹æ³• æ¥å£ä¸­çš„å®ä¾‹å˜é‡é»˜è®¤æ˜¯ final ç±»å‹çš„ï¼Œè€ŒæŠ½è±¡ç±»ä¸­åˆ™ä¸ä¸€å®š ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œä½†æœ€å¤šåªèƒ½å®ç°ä¸€ä¸ªæŠ½è±¡ç±» ä¸€ä¸ªç±»å®ç°æ¥å£çš„è¯è¦å®ç°æ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼Œè€ŒæŠ½è±¡ç±»ä¸ä¸€å®š æ¥å£ä¸èƒ½ç”¨ new å®ä¾‹åŒ–ï¼Œä½†å¯ä»¥å£°æ˜ï¼Œä½†æ˜¯å¿…é¡»å¼•ç”¨ä¸€ä¸ªå®ç°è¯¥æ¥å£çš„å¯¹è±¡ ä»è®¾è®¡å±‚é¢æ¥è¯´ï¼ŒæŠ½è±¡æ˜¯å¯¹ç±»çš„æŠ½è±¡ï¼Œæ˜¯ä¸€ç§æ¨¡æ¿è®¾è®¡ï¼Œæ¥å£æ˜¯è¡Œä¸ºçš„æŠ½è±¡ï¼Œæ˜¯ä¸€ç§è¡Œä¸ºçš„è§„èŒƒã€‚ 18. æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰é‚£äº› ä»è¯­æ³•å½¢å¼ä¸Šï¼Œçœ‹æˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œè€Œå±€éƒ¨å˜é‡æ˜¯åœ¨æ–¹æ³•ä¸­å®šä¹‰çš„å˜é‡æˆ–æ˜¯æ–¹æ³•çš„å‚æ•°ï¼›æˆå‘˜å˜é‡å¯ä»¥è¢« public,private,static ç­‰ä¿®é¥°ç¬¦æ‰€ä¿®é¥°ï¼Œè€Œå±€éƒ¨å˜é‡ä¸èƒ½è¢«è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦åŠ static æ‰€ä¿®é¥°ï¼›ä½†æ˜¯ï¼Œæˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡éƒ½èƒ½è¢« final æ‰€ä¿®é¥°ï¼› ä»å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼æ¥çœ‹ï¼Œæˆå‘˜å˜é‡æ˜¯å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œè€Œå¯¹è±¡å­˜åœ¨äºå †å†…å­˜ï¼Œå±€éƒ¨å˜é‡å­˜åœ¨äºæ ˆå†…å­˜ ä»å˜é‡åœ¨å†…å­˜ä¸­çš„ç”Ÿå­˜æ—¶é—´ä¸Šçœ‹ï¼Œæˆå‘˜å˜é‡æ˜¯å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒéšç€å¯¹è±¡çš„åˆ›å»ºè€Œå­˜åœ¨ï¼Œè€Œå±€éƒ¨å˜é‡éšç€æ–¹æ³•çš„è°ƒç”¨è€Œè‡ªåŠ¨æ¶ˆå¤±ã€‚ æˆå‘˜å˜é‡å¦‚æœæ²¡æœ‰è¢«èµ‹åˆå€¼ï¼Œåˆ™ä¼šè‡ªåŠ¨ä»¥ç±»å‹çš„é»˜è®¤å€¼è€Œèµ‹å€¼ï¼ˆä¸€ç§æƒ…å†µä¾‹å¤–è¢« final ä¿®é¥°çš„æˆå‘˜å˜é‡ä¹Ÿå¿…é¡»æ˜¾ç¤ºåœ°èµ‹å€¼ï¼‰ï¼›è€Œå±€éƒ¨å˜é‡åˆ™ä¸ä¼šè‡ªåŠ¨èµ‹å€¼ã€‚ 19. åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç”¨ä»€ä¹ˆè¿ç®—ç¬¦ï¼Ÿå¯¹è±¡å®ä½“ä¸å¯¹è±¡å¼•ç”¨æœ‰ä½•ä¸åŒï¼Ÿ newè¿ç®—ç¬¦ï¼Œnewåˆ›å»ºå¯¹è±¡å®ä¾‹ï¼ˆå¯¹è±¡å®ä¾‹åœ¨å †å†…å­˜ä¸­ï¼‰ï¼Œå¯¹è±¡å¼•ç”¨æŒ‡å‘å¯¹è±¡å®ä¾‹ï¼ˆå¯¹è±¡å¼•ç”¨å­˜æ”¾åœ¨æ ˆå†…å­˜ä¸­ï¼‰ã€‚ä¸€ä¸ªå¯¹è±¡å¼•ç”¨å¯ä»¥æŒ‡å‘0ä¸ªæˆ–1ä¸ªå¯¹è±¡ï¼ˆä¸€æ ¹ç»³å­å¯ä»¥ä¸ç³»æ°”çƒï¼Œä¹Ÿå¯ä»¥ç³»ä¸€ä¸ªæ°”çƒï¼‰;ä¸€ä¸ªå¯¹è±¡å¯ä»¥æœ‰nä¸ªå¼•ç”¨æŒ‡å‘å®ƒï¼ˆå¯ä»¥ç”¨næ¡ç»³å­ç³»ä½ä¸€ä¸ªæ°”çƒï¼‰ã€‚\n20. ä»€ä¹ˆæ˜¯æ–¹æ³•çš„è¿”å›å€¼ï¼Ÿè¿”å›å€¼åœ¨ç±»çš„æ–¹æ³•é‡Œçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ æ–¹æ³•çš„è¿”å›å€¼æ˜¯æŒ‡æˆ‘ä»¬è·å–åˆ°çš„æŸä¸ªæ–¹æ³•ä½“ä¸­çš„ä»£ç æ‰§è¡Œåäº§ç”Ÿçš„ç»“æœï¼ï¼ˆå‰ææ˜¯è¯¥æ–¹æ³•å¯èƒ½äº§ç”Ÿç»“æœï¼‰ã€‚è¿”å›å€¼çš„ä½œç”¨:æ¥æ”¶å‡ºç»“æœï¼Œä½¿å¾—å®ƒå¯ä»¥ç”¨äºå…¶ä»–çš„æ“ä½œï¼\n21. ä¸€ä¸ªç±»çš„æ„é€ æ–¹æ³•çš„ä½œç”¨æ˜¯ä»€ä¹ˆ è‹¥ä¸€ä¸ªç±»æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ï¼Œè¯¥ç¨‹åºèƒ½æ­£ç¡®æ‰§è¡Œå— ä¸ºä»€ä¹ˆ ä¸»è¦ä½œç”¨æ˜¯å®Œæˆå¯¹ç±»å¯¹è±¡çš„åˆå§‹åŒ–å·¥ä½œã€‚å¯ä»¥æ‰§è¡Œã€‚å› ä¸ºä¸€ä¸ªç±»å³ä½¿æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ä¹Ÿä¼šæœ‰é»˜è®¤çš„ä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚\n22. æ„é€ æ–¹æ³•æœ‰å“ªäº›ç‰¹æ€§ åå­—ä¸ç±»åç›¸åŒï¼› æ²¡æœ‰è¿”å›å€¼ï¼Œä½†ä¸èƒ½ç”¨voidå£°æ˜æ„é€ å‡½æ•°ï¼› ç”Ÿæˆç±»çš„å¯¹è±¡æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œæ— éœ€è°ƒç”¨ã€‚ 23. é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä½•ä¸åŒ åœ¨å¤–éƒ¨è°ƒç”¨é™æ€æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨\u0026quot;ç±»å.æ–¹æ³•å\u0026quot;çš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨\u0026quot;å¯¹è±¡å.æ–¹æ³•å\u0026quot;çš„æ–¹å¼ã€‚è€Œå®ä¾‹æ–¹æ³•åªæœ‰åé¢è¿™ç§æ–¹å¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè°ƒç”¨é™æ€æ–¹æ³•å¯ä»¥æ— éœ€åˆ›å»ºå¯¹è±¡ã€‚ é™æ€æ–¹æ³•åœ¨è®¿é—®æœ¬ç±»çš„æˆå‘˜æ—¶ï¼Œåªå…è®¸è®¿é—®é™æ€æˆå‘˜ï¼ˆå³é™æ€æˆå‘˜å˜é‡å’Œé™æ€æ–¹æ³•ï¼‰ï¼Œè€Œä¸å…è®¸è®¿é—®å®ä¾‹æˆå‘˜å˜é‡å’Œå®ä¾‹æ–¹æ³•ï¼›å®ä¾‹æ–¹æ³•åˆ™æ— æ­¤é™åˆ¶. 24. å¯¹è±¡çš„ç›¸ç­‰ä¸æŒ‡å‘ä»–ä»¬çš„å¼•ç”¨ç›¸ç­‰ï¼Œä¸¤è€…æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ å¯¹è±¡çš„ç›¸ç­‰ï¼Œæ¯”çš„æ˜¯å†…å­˜ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚è€Œå¼•ç”¨ç›¸ç­‰ï¼Œæ¯”è¾ƒçš„æ˜¯ä»–ä»¬æŒ‡å‘çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ã€‚\n25. åœ¨è°ƒç”¨å­ç±»æ„é€ æ–¹æ³•ä¹‹å‰ä¼šå…ˆè°ƒç”¨çˆ¶ç±»æ²¡æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œå…¶ç›®çš„æ˜¯ï¼Ÿ å¸®åŠ©å­ç±»åšåˆå§‹åŒ–å·¥ä½œã€‚\n26. == ä¸ equals(é‡è¦) == : å®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯ä¸æ˜¯ç›¸ç­‰ã€‚å³ï¼Œåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚(åŸºæœ¬æ•°æ®ç±»å‹==æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¼•ç”¨æ•°æ®ç±»å‹==æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€)\nequals() : å®ƒçš„ä½œç”¨ä¹Ÿæ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ä½†å®ƒä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š\næƒ…å†µ1ï¼šç±»æ²¡æœ‰è¦†ç›– equals() æ–¹æ³•ã€‚åˆ™é€šè¿‡ equals() æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡â€œ==â€æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ã€‚ æƒ…å†µ2ï¼šç±»è¦†ç›–äº† equals() æ–¹æ³•ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬éƒ½è¦†ç›– equals() æ–¹æ³•æ¥ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å†…å®¹ç›¸ç­‰ï¼Œåˆ™è¿”å› true (å³ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰)ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š\npublic class test1 { public static void main(String[] args) { String a = new String(\u0026#34;ab\u0026#34;); // a ä¸ºä¸€ä¸ªå¼•ç”¨ String b = new String(\u0026#34;ab\u0026#34;); // bä¸ºå¦ä¸€ä¸ªå¼•ç”¨,å¯¹è±¡çš„å†…å®¹ä¸€æ · String aa = \u0026#34;ab\u0026#34;; // æ”¾åœ¨å¸¸é‡æ± ä¸­ String bb = \u0026#34;ab\u0026#34;; // ä»å¸¸é‡æ± ä¸­æŸ¥æ‰¾ if (aa == bb) // true System.out.println(\u0026#34;aa==bb\u0026#34;); if (a == b) // falseï¼ŒéåŒä¸€å¯¹è±¡ System.out.println(\u0026#34;a==b\u0026#34;); if (a.equals(b)) // true System.out.println(\u0026#34;aEQb\u0026#34;); if (42 == 42.0) { // true System.out.println(\u0026#34;true\u0026#34;); } } } è¯´æ˜ï¼š\nString ä¸­çš„ equals æ–¹æ³•æ˜¯è¢«é‡å†™è¿‡çš„ï¼Œå› ä¸º object çš„ equals æ–¹æ³•æ˜¯æ¯”è¾ƒçš„å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œè€Œ String çš„ equals æ–¹æ³•æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å€¼ã€‚ å½“åˆ›å»º String ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œè™šæ‹Ÿæœºä¼šåœ¨å¸¸é‡æ± ä¸­æŸ¥æ‰¾æœ‰æ²¡æœ‰å·²ç»å­˜åœ¨çš„å€¼å’Œè¦åˆ›å»ºçš„å€¼ç›¸åŒçš„å¯¹è±¡ï¼Œå¦‚æœæœ‰å°±æŠŠå®ƒèµ‹ç»™å½“å‰å¼•ç”¨ã€‚å¦‚æœæ²¡æœ‰å°±åœ¨å¸¸é‡æ± ä¸­é‡æ–°åˆ›å»ºä¸€ä¸ª String å¯¹è±¡ã€‚ 27. hashCode ä¸ equalsï¼ˆé‡è¦ï¼‰ é¢è¯•å®˜å¯èƒ½ä¼šé—®ä½ ï¼šâ€œä½ é‡å†™è¿‡ hashcode å’Œ equals ä¹ˆï¼Œä¸ºä»€ä¹ˆé‡å†™equalsæ—¶å¿…é¡»é‡å†™hashCodeæ–¹æ³•ï¼Ÿâ€\nhashCodeï¼ˆï¼‰ä»‹ç» hashCode() çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ï¼›å®ƒå®é™…ä¸Šæ˜¯è¿”å›ä¸€ä¸ªintæ•´æ•°ã€‚è¿™ä¸ªå“ˆå¸Œç çš„ä½œç”¨æ˜¯ç¡®å®šè¯¥å¯¹è±¡åœ¨å“ˆå¸Œè¡¨ä¸­çš„ç´¢å¼•ä½ç½®ã€‚hashCode() å®šä¹‰åœ¨JDKçš„Object.javaä¸­ï¼Œè¿™å°±æ„å‘³ç€Javaä¸­çš„ä»»ä½•ç±»éƒ½åŒ…å«æœ‰hashCode() å‡½æ•°ã€‚\næ•£åˆ—è¡¨å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹(key-value)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šèƒ½æ ¹æ®â€œé”®â€å¿«é€Ÿçš„æ£€ç´¢å‡ºå¯¹åº”çš„â€œå€¼â€ã€‚è¿™å…¶ä¸­å°±åˆ©ç”¨åˆ°äº†æ•£åˆ—ç ï¼ï¼ˆå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€è¦çš„å¯¹è±¡ï¼‰\nä¸ºä»€ä¹ˆè¦æœ‰ hashCode æˆ‘ä»¬ä»¥â€œHashSet å¦‚ä½•æ£€æŸ¥é‡å¤â€ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰ hashCodeï¼š\nå½“ä½ æŠŠå¯¹è±¡åŠ å…¥ HashSet æ—¶ï¼ŒHashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸å…¶ä»–å·²ç»åŠ å…¥çš„å¯¹è±¡çš„ hashcode å€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„hashcodeï¼ŒHashSetä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equalsï¼ˆï¼‰æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼ŒHashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚ï¼ˆæ‘˜è‡ªæˆ‘çš„Javaå¯è’™ä¹¦ã€ŠHead fist javaã€‹ç¬¬äºŒç‰ˆï¼‰ã€‚è¿™æ ·æˆ‘ä»¬å°±å¤§å¤§å‡å°‘äº† equals çš„æ¬¡æ•°ï¼Œç›¸åº”å°±å¤§å¤§æé«˜äº†æ‰§è¡Œé€Ÿåº¦ã€‚\nhashCodeï¼ˆï¼‰ä¸equalsï¼ˆï¼‰çš„ç›¸å…³è§„å®š å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œåˆ™hashcodeä¸€å®šä¹Ÿæ˜¯ç›¸åŒçš„ ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰,å¯¹ä¸¤ä¸ªå¯¹è±¡åˆ†åˆ«è°ƒç”¨equalsæ–¹æ³•éƒ½è¿”å›true ä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„hashcodeå€¼ï¼Œå®ƒä»¬ä¹Ÿä¸ä¸€å®šæ˜¯ç›¸ç­‰çš„ å› æ­¤ï¼Œequals æ–¹æ³•è¢«è¦†ç›–è¿‡ï¼Œåˆ™ hashCode æ–¹æ³•ä¹Ÿå¿…é¡»è¢«è¦†ç›– hashCode() çš„é»˜è®¤è¡Œä¸ºæ˜¯å¯¹å †ä¸Šçš„å¯¹è±¡äº§ç”Ÿç‹¬ç‰¹å€¼ã€‚å¦‚æœæ²¡æœ‰é‡å†™ hashCode()ï¼Œåˆ™è¯¥ class çš„ä¸¤ä¸ªå¯¹è±¡æ— è®ºå¦‚ä½•éƒ½ä¸ä¼šç›¸ç­‰ï¼ˆå³ä½¿è¿™ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘ç›¸åŒçš„æ•°æ®ï¼‰ 28. ä¸ºä»€ä¹ˆJavaä¸­åªæœ‰å€¼ä¼ é€’ ä¸ºä»€ä¹ˆJavaä¸­åªæœ‰å€¼ä¼ é€’ï¼Ÿ\n29. ç®€è¿°çº¿ç¨‹ï¼Œç¨‹åºã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€‚ä»¥åŠä»–ä»¬ä¹‹é—´å…³ç³»æ˜¯ä»€ä¹ˆ çº¿ç¨‹ä¸è¿›ç¨‹ç›¸ä¼¼ï¼Œä½†çº¿ç¨‹æ˜¯ä¸€ä¸ªæ¯”è¿›ç¨‹æ›´å°çš„æ‰§è¡Œå•ä½ã€‚ä¸€ä¸ªè¿›ç¨‹åœ¨å…¶æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¯ä»¥äº§ç”Ÿå¤šä¸ªçº¿ç¨‹ã€‚ä¸è¿›ç¨‹ä¸åŒçš„æ˜¯åŒç±»çš„å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€å—å†…å­˜ç©ºé—´å’Œä¸€ç»„ç³»ç»Ÿèµ„æºï¼Œæ‰€ä»¥ç³»ç»Ÿåœ¨äº§ç”Ÿä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ–æ˜¯åœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´ä½œåˆ‡æ¢å·¥ä½œæ—¶ï¼Œè´Ÿæ‹…è¦æ¯”è¿›ç¨‹å°å¾—å¤šï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œçº¿ç¨‹ä¹Ÿè¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ã€‚\nç¨‹åºæ˜¯å«æœ‰æŒ‡ä»¤å’Œæ•°æ®çš„æ–‡ä»¶ï¼Œè¢«å­˜å‚¨åœ¨ç£ç›˜æˆ–å…¶ä»–çš„æ•°æ®å­˜å‚¨è®¾å¤‡ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ç¨‹åºæ˜¯é™æ€çš„ä»£ç ã€‚\nè¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œæ˜¯ç³»ç»Ÿè¿è¡Œç¨‹åºçš„åŸºæœ¬å•ä½ï¼Œå› æ­¤è¿›ç¨‹æ˜¯åŠ¨æ€çš„ã€‚ç³»ç»Ÿè¿è¡Œä¸€ä¸ªç¨‹åºå³æ˜¯ä¸€ä¸ªè¿›ç¨‹ä»åˆ›å»ºï¼Œè¿è¡Œåˆ°æ¶ˆäº¡çš„è¿‡ç¨‹ã€‚ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªè¿›ç¨‹å°±æ˜¯ä¸€ä¸ªæ‰§è¡Œä¸­çš„ç¨‹åºï¼Œå®ƒåœ¨è®¡ç®—æœºä¸­ä¸€ä¸ªæŒ‡ä»¤æ¥ç€ä¸€ä¸ªæŒ‡ä»¤åœ°æ‰§è¡Œç€ï¼ŒåŒæ—¶ï¼Œæ¯ä¸ªè¿›ç¨‹è¿˜å æœ‰æŸäº›ç³»ç»Ÿèµ„æºå¦‚CPUæ—¶é—´ï¼Œå†…å­˜ç©ºé—´ï¼Œæ–‡ä»¶ï¼Œæ–‡ä»¶ï¼Œè¾“å…¥è¾“å‡ºè®¾å¤‡çš„ä½¿ç”¨æƒç­‰ç­‰ã€‚æ¢å¥è¯è¯´ï¼Œå½“ç¨‹åºåœ¨æ‰§è¡Œæ—¶ï¼Œå°†ä¼šè¢«æ“ä½œç³»ç»Ÿè½½å…¥å†…å­˜ä¸­ã€‚ çº¿ç¨‹æ˜¯è¿›ç¨‹åˆ’åˆ†æˆçš„æ›´å°çš„è¿è¡Œå•ä½ã€‚çº¿ç¨‹å’Œè¿›ç¨‹æœ€å¤§çš„ä¸åŒåœ¨äºåŸºæœ¬ä¸Šå„è¿›ç¨‹æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œå„çº¿ç¨‹åˆ™ä¸ä¸€å®šï¼Œå› ä¸ºåŒä¸€è¿›ç¨‹ä¸­çš„çº¿ç¨‹ææœ‰å¯èƒ½ä¼šç›¸äº’å½±å“ã€‚ä»å¦ä¸€è§’åº¦æ¥è¯´ï¼Œè¿›ç¨‹å±äºæ“ä½œç³»ç»Ÿçš„èŒƒç•´ï¼Œä¸»è¦æ˜¯åŒä¸€æ®µæ—¶é—´å†…ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œä¸€ä¸ªä»¥ä¸Šçš„ç¨‹åºï¼Œè€Œçº¿ç¨‹åˆ™æ˜¯åœ¨åŒä¸€ç¨‹åºå†…å‡ ä¹åŒæ—¶æ‰§è¡Œä¸€ä¸ªä»¥ä¸Šçš„ç¨‹åºæ®µã€‚\n30. çº¿ç¨‹æœ‰å“ªäº›åŸºæœ¬çŠ¶æ€ï¼Ÿè¿™äº›çŠ¶æ€æ˜¯å¦‚ä½•å®šä¹‰çš„? æ–°å»º(new)ï¼šæ–°åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚ å¯è¿è¡Œ(runnable)ï¼šçº¿ç¨‹å¯¹è±¡åˆ›å»ºåï¼Œå…¶ä»–çº¿ç¨‹(æ¯”å¦‚mainçº¿ç¨‹ï¼‰è°ƒç”¨äº†è¯¥å¯¹è±¡çš„start()æ–¹æ³•ã€‚è¯¥çŠ¶æ€çš„çº¿ç¨‹ä½äºå¯è¿è¡Œçº¿ç¨‹æ± ä¸­ï¼Œç­‰å¾…è¢«çº¿ç¨‹è°ƒåº¦é€‰ä¸­ï¼Œè· å–cpuçš„ä½¿ç”¨æƒã€‚ è¿è¡Œ(running)ï¼šå¯è¿è¡ŒçŠ¶æ€(runnable)çš„çº¿ç¨‹è·å¾—äº†cpuæ—¶é—´ç‰‡ï¼ˆtimesliceï¼‰ï¼Œæ‰§è¡Œç¨‹åºä»£ç ã€‚ é˜»å¡(block)ï¼šé˜»å¡çŠ¶æ€æ˜¯æŒ‡çº¿ç¨‹å› ä¸ºæŸç§åŸå› æ”¾å¼ƒäº†cpuä½¿ç”¨æƒï¼Œä¹Ÿå³è®©å‡ºäº†cpu timesliceï¼Œæš‚æ—¶åœæ­¢è¿è¡Œã€‚ç›´åˆ°çº¿ç¨‹è¿›å…¥å¯è¿è¡Œ(runnable)çŠ¶æ€ï¼Œæ‰æœ‰ æœºä¼šå†æ¬¡è·å¾—cpu timesliceè½¬åˆ°è¿è¡Œ(running)çŠ¶æ€ã€‚é˜»å¡çš„æƒ…å†µåˆ†ä¸‰ç§ï¼š (ä¸€). ç­‰å¾…é˜»å¡ï¼šè¿è¡Œ(running)çš„çº¿ç¨‹æ‰§è¡Œo.wait()æ–¹æ³•ï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹æ”¾ å…¥ç­‰å¾…é˜Ÿåˆ—(waitting queue)ä¸­ã€‚ (äºŒ). åŒæ­¥é˜»å¡ï¼šè¿è¡Œ(running)çš„çº¿ç¨‹åœ¨è·å–å¯¹è±¡çš„åŒæ­¥é”æ—¶ï¼Œè‹¥è¯¥åŒæ­¥é” è¢«åˆ«çš„çº¿ç¨‹å ç”¨ï¼Œåˆ™JVMä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥é”æ± (lock pool)ä¸­ã€‚ (ä¸‰). å…¶ä»–é˜»å¡: è¿è¡Œ(running)çš„çº¿ç¨‹æ‰§è¡ŒThread.sleep(long ms)æˆ–t.join()æ–¹æ³•ï¼Œæˆ–è€…å‘å‡ºäº†I/Oè¯·æ±‚æ—¶ï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹ç½®ä¸ºé˜»å¡çŠ¶æ€ã€‚å½“sleep()çŠ¶æ€è¶…æ—¶join()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ã€æˆ–è€…I/Oå¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å¯è¿è¡Œ(runnable)çŠ¶æ€ã€‚ æ­»äº¡(dead)ï¼šçº¿ç¨‹run()ã€main()æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œæˆ–è€…å› å¼‚å¸¸é€€å‡ºäº†run()æ–¹æ³•ï¼Œåˆ™è¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚æ­»äº¡çš„çº¿ç¨‹ä¸å¯å†æ¬¡å¤ç”Ÿã€‚ å¤‡æ³¨ï¼š å¯ä»¥ç”¨æ—©èµ·ååœ°é“æ¥æ¯”å–»è¿™ä¸ªè¿‡ç¨‹ï¼š\nè¿˜æ²¡èµ·åºŠï¼šsleeping\nèµ·åºŠæ”¶æ‹¾å¥½äº†ï¼Œéšæ—¶å¯ä»¥ååœ°é“å‡ºå‘ï¼šRunnable\nç­‰åœ°é“æ¥ï¼šWaiting\nåœ°é“æ¥äº†ï¼Œä½†è¦æ’é˜Ÿä¸Šåœ°é“ï¼šI/Oé˜»å¡\nä¸Šäº†åœ°é“ï¼Œå‘ç°æš‚æ—¶æ²¡åº§ä½ï¼šsynchronizedé˜»å¡\nåœ°é“ä¸Šæ‰¾åˆ°åº§ä½ï¼šRunning\nåˆ°è¾¾ç›®çš„åœ°ï¼šDead\n31 å…³äº final å…³é”®å­—çš„ä¸€äº›æ€»ç»“ finalå…³é”®å­—ä¸»è¦ç”¨åœ¨ä¸‰ä¸ªåœ°æ–¹ï¼šå˜é‡ã€æ–¹æ³•ã€ç±»ã€‚\nå¯¹äºä¸€ä¸ªfinalå˜é‡ï¼Œå¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œåˆ™å…¶æ•°å€¼ä¸€æ—¦åœ¨åˆå§‹åŒ–ä¹‹åä¾¿ä¸èƒ½æ›´æ”¹ï¼›å¦‚æœæ˜¯å¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œåˆ™åœ¨å¯¹å…¶åˆå§‹åŒ–ä¹‹åä¾¿ä¸èƒ½å†è®©å…¶æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ã€‚ å½“ç”¨finalä¿®é¥°ä¸€ä¸ªç±»æ—¶ï¼Œè¡¨æ˜è¿™ä¸ªç±»ä¸èƒ½è¢«ç»§æ‰¿ã€‚finalç±»ä¸­çš„æ‰€æœ‰æˆå‘˜æ–¹æ³•éƒ½ä¼šè¢«éšå¼åœ°æŒ‡å®šä¸ºfinalæ–¹æ³•ã€‚ ä½¿ç”¨finalæ–¹æ³•çš„åŸå› æœ‰ä¸¤ä¸ªã€‚ç¬¬ä¸€ä¸ªåŸå› æ˜¯æŠŠæ–¹æ³•é”å®šï¼Œä»¥é˜²ä»»ä½•ç»§æ‰¿ç±»ä¿®æ”¹å®ƒçš„å«ä¹‰ï¼›ç¬¬äºŒä¸ªåŸå› æ˜¯æ•ˆç‡ã€‚åœ¨æ—©æœŸçš„Javaå®ç°ç‰ˆæœ¬ä¸­ï¼Œä¼šå°†finalæ–¹æ³•è½¬ä¸ºå†…åµŒè°ƒç”¨ã€‚ä½†æ˜¯å¦‚æœæ–¹æ³•è¿‡äºåºå¤§ï¼Œå¯èƒ½çœ‹ä¸åˆ°å†…åµŒè°ƒç”¨å¸¦æ¥çš„ä»»ä½•æ€§èƒ½æå‡ï¼ˆç°åœ¨çš„Javaç‰ˆæœ¬å·²ç»ä¸éœ€è¦ä½¿ç”¨finalæ–¹æ³•è¿›è¡Œè¿™äº›ä¼˜åŒ–äº†ï¼‰ã€‚ç±»ä¸­æ‰€æœ‰çš„privateæ–¹æ³•éƒ½éšå¼åœ°æŒ‡å®šä¸ºfinalã€‚ 32 Java ä¸­çš„å¼‚å¸¸å¤„ç† Javaå¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„å›¾ åœ¨ Java ä¸­ï¼Œæ‰€æœ‰çš„å¼‚å¸¸éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„ç¥–å…ˆjava.langåŒ…ä¸­çš„ Throwableç±»ã€‚Throwableï¼š æœ‰ä¸¤ä¸ªé‡è¦çš„å­ç±»ï¼šExceptionï¼ˆå¼‚å¸¸ï¼‰ å’Œ Errorï¼ˆé”™è¯¯ï¼‰ ï¼ŒäºŒè€…éƒ½æ˜¯ Java å¼‚å¸¸å¤„ç†çš„é‡è¦å­ç±»ï¼Œå„è‡ªéƒ½åŒ…å«å¤§é‡å­ç±»ã€‚\nErrorï¼ˆé”™è¯¯ï¼‰:æ˜¯ç¨‹åºæ— æ³•å¤„ç†çš„é”™è¯¯ï¼Œè¡¨ç¤ºè¿è¡Œåº”ç”¨ç¨‹åºä¸­è¾ƒä¸¥é‡é—®é¢˜ã€‚å¤§å¤šæ•°é”™è¯¯ä¸ä»£ç ç¼–å†™è€…æ‰§è¡Œçš„æ“ä½œæ— å…³ï¼Œè€Œè¡¨ç¤ºä»£ç è¿è¡Œæ—¶ JVMï¼ˆJava è™šæ‹Ÿæœºï¼‰å‡ºç°çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒJavaè™šæ‹Ÿæœºè¿è¡Œé”™è¯¯ï¼ˆVirtual MachineErrorï¼‰ï¼Œå½“ JVM ä¸å†æœ‰ç»§ç»­æ‰§è¡Œæ“ä½œæ‰€éœ€çš„å†…å­˜èµ„æºæ—¶ï¼Œå°†å‡ºç° OutOfMemoryErrorã€‚è¿™äº›å¼‚å¸¸å‘ç”Ÿæ—¶ï¼ŒJavaè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸€èˆ¬ä¼šé€‰æ‹©çº¿ç¨‹ç»ˆæ­¢ã€‚\nè¿™äº›é”™è¯¯è¡¨ç¤ºæ•…éšœå‘ç”Ÿäºè™šæ‹Ÿæœºè‡ªèº«ã€æˆ–è€…å‘ç”Ÿåœ¨è™šæ‹Ÿæœºè¯•å›¾æ‰§è¡Œåº”ç”¨æ—¶ï¼Œå¦‚Javaè™šæ‹Ÿæœºè¿è¡Œé”™è¯¯ï¼ˆVirtual MachineErrorï¼‰ã€ç±»å®šä¹‰é”™è¯¯ï¼ˆNoClassDefFoundErrorï¼‰ç­‰ã€‚è¿™äº›é”™è¯¯æ˜¯ä¸å¯æŸ¥çš„ï¼Œå› ä¸ºå®ƒä»¬åœ¨åº”ç”¨ç¨‹åºçš„æ§åˆ¶å’Œå¤„ç†èƒ½åŠ›ä¹‹ å¤–ï¼Œè€Œä¸”ç»å¤§å¤šæ•°æ˜¯ç¨‹åºè¿è¡Œæ—¶ä¸å…è®¸å‡ºç°çš„çŠ¶å†µã€‚å¯¹äºè®¾è®¡åˆç†çš„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œå³ä½¿ç¡®å®å‘ç”Ÿäº†é”™è¯¯ï¼Œæœ¬è´¨ä¸Šä¹Ÿä¸åº”è¯¥è¯•å›¾å»å¤„ç†å®ƒæ‰€å¼•èµ·çš„å¼‚å¸¸çŠ¶å†µã€‚åœ¨ Javaä¸­ï¼Œé”™è¯¯é€šè¿‡Errorçš„å­ç±»æè¿°ã€‚\nExceptionï¼ˆå¼‚å¸¸ï¼‰:æ˜¯ç¨‹åºæœ¬èº«å¯ä»¥å¤„ç†çš„å¼‚å¸¸ã€‚Exception ç±»æœ‰ä¸€ä¸ªé‡è¦çš„å­ç±» RuntimeExceptionã€‚RuntimeException å¼‚å¸¸ç”±Javaè™šæ‹ŸæœºæŠ›å‡ºã€‚NullPointerExceptionï¼ˆè¦è®¿é—®çš„å˜é‡æ²¡æœ‰å¼•ç”¨ä»»ä½•å¯¹è±¡æ—¶ï¼ŒæŠ›å‡ºè¯¥å¼‚å¸¸ï¼‰ã€ArithmeticExceptionï¼ˆç®—æœ¯è¿ç®—å¼‚å¸¸ï¼Œä¸€ä¸ªæ•´æ•°é™¤ä»¥0æ—¶ï¼ŒæŠ›å‡ºè¯¥å¼‚å¸¸ï¼‰å’Œ ArrayIndexOutOfBoundsException ï¼ˆä¸‹æ ‡è¶Šç•Œå¼‚å¸¸ï¼‰ã€‚\næ³¨æ„ï¼šå¼‚å¸¸å’Œé”™è¯¯çš„åŒºåˆ«ï¼šå¼‚å¸¸èƒ½è¢«ç¨‹åºæœ¬èº«å¯ä»¥å¤„ç†ï¼Œé”™è¯¯æ˜¯æ— æ³•å¤„ç†ã€‚\nThrowableç±»å¸¸ç”¨æ–¹æ³• public string getMessage():è¿”å›å¼‚å¸¸å‘ç”Ÿæ—¶çš„è¯¦ç»†ä¿¡æ¯ public string toString():è¿”å›å¼‚å¸¸å‘ç”Ÿæ—¶çš„ç®€è¦æè¿° public string getLocalizedMessage():è¿”å›å¼‚å¸¸å¯¹è±¡çš„æœ¬åœ°åŒ–ä¿¡æ¯ã€‚ä½¿ç”¨Throwableçš„å­ç±»è¦†ç›–è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥å£°ç§°æœ¬åœ°åŒ–ä¿¡æ¯ã€‚å¦‚æœå­ç±»æ²¡æœ‰è¦†ç›–è¯¥æ–¹æ³•ï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›çš„ä¿¡æ¯ä¸getMessageï¼ˆï¼‰è¿”å›çš„ç»“æœç›¸åŒ public void printStackTrace():åœ¨æ§åˆ¶å°ä¸Šæ‰“å°Throwableå¯¹è±¡å°è£…çš„å¼‚å¸¸ä¿¡æ¯ å¼‚å¸¸å¤„ç†æ€»ç»“ try å—ï¼šç”¨äºæ•è·å¼‚å¸¸ã€‚å…¶åå¯æ¥é›¶ä¸ªæˆ–å¤šä¸ªcatchå—ï¼Œå¦‚æœæ²¡æœ‰catchå—ï¼Œåˆ™å¿…é¡»è·Ÿä¸€ä¸ªfinallyå—ã€‚ catch å—ï¼šç”¨äºå¤„ç†tryæ•è·åˆ°çš„å¼‚å¸¸ã€‚ finally å—ï¼šæ— è®ºæ˜¯å¦æ•è·æˆ–å¤„ç†å¼‚å¸¸ï¼Œfinallyå—é‡Œçš„è¯­å¥éƒ½ä¼šè¢«æ‰§è¡Œã€‚å½“åœ¨tryå—æˆ–catchå—ä¸­é‡åˆ°returnè¯­å¥æ—¶ï¼Œfinallyè¯­å¥å—å°†åœ¨æ–¹æ³•è¿”å›ä¹‹å‰è¢«æ‰§è¡Œã€‚ åœ¨ä»¥ä¸‹4ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œfinallyå—ä¸ä¼šè¢«æ‰§è¡Œï¼š\nåœ¨finallyè¯­å¥å—ä¸­å‘ç”Ÿäº†å¼‚å¸¸ã€‚ åœ¨å‰é¢çš„ä»£ç ä¸­ç”¨äº†System.exit()é€€å‡ºç¨‹åºã€‚ ç¨‹åºæ‰€åœ¨çš„çº¿ç¨‹æ­»äº¡ã€‚ å…³é—­CPUã€‚ 33 Javaåºåˆ—è¯ä¸­å¦‚æœæœ‰äº›å­—æ®µä¸æƒ³è¿›è¡Œåºåˆ—åŒ– æ€ä¹ˆåŠ å¯¹äºä¸æƒ³è¿›è¡Œåºåˆ—åŒ–çš„å˜é‡ï¼Œä½¿ç”¨transientå…³é”®å­—ä¿®é¥°ã€‚\ntransientå…³é”®å­—çš„ä½œç”¨æ˜¯ï¼šé˜»æ­¢å®ä¾‹ä¸­é‚£äº›ç”¨æ­¤å…³é”®å­—ä¿®é¥°çš„çš„å˜é‡åºåˆ—åŒ–ï¼›å½“å¯¹è±¡è¢«ååºåˆ—åŒ–æ—¶ï¼Œè¢«transientä¿®é¥°çš„å˜é‡å€¼ä¸ä¼šè¢«æŒä¹…åŒ–å’Œæ¢å¤ã€‚transientåªèƒ½ä¿®é¥°å˜é‡ï¼Œä¸èƒ½ä¿®é¥°ç±»å’Œæ–¹æ³•ã€‚\n34 è·å–ç”¨é”®ç›˜è¾“å…¥å¸¸ç”¨çš„çš„ä¸¤ç§æ–¹æ³• æ–¹æ³•1ï¼šé€šè¿‡ Scanner\nScanner input = new Scanner(System.in); String s = input.nextLine(); input.close(); æ–¹æ³•2ï¼šé€šè¿‡ BufferedReader\nBufferedReader input = new BufferedReader(new InputStreamReader(System.in)); String s = input.readLine(); JavaåŸºç¡€å­¦ä¹ ä¹¦ç±æ¨è ã€ŠHead First Java.ç¬¬äºŒç‰ˆã€‹ï¼š å¯ä»¥è¯´æ˜¯æˆ‘çš„ Java å¯è’™ä¹¦ç±äº†ï¼Œç‰¹åˆ«é€‚åˆæ–°æ‰‹è¯»å½“ç„¶ä¹Ÿé€‚åˆæˆ‘ä»¬ç”¨æ¥æ¸©æ•…JavaçŸ¥è¯†ç‚¹ã€‚\nã€ŠJavaæ ¸å¿ƒæŠ€æœ¯å·1+å·2ã€‹ï¼š å¾ˆæ£’çš„ä¸¤æœ¬ä¹¦ï¼Œå»ºè®®æœ‰ç‚¹ Java åŸºç¡€ä¹‹åå†è¯»ï¼Œä»‹ç»çš„è¿˜æ˜¯æ¯”è¾ƒæ·±å…¥çš„ï¼Œéå¸¸æ¨èã€‚\nã€ŠJavaç¼–ç¨‹æ€æƒ³(ç¬¬4ç‰ˆ)ã€‹ï¼š è¿™æœ¬ä¹¦è¦å¸¸è¯»ï¼Œåˆå­¦è€…å¯ä»¥å¿«é€Ÿæ¦‚è§ˆï¼Œä¸­ç­‰ç¨‹åºå‘˜å¯ä»¥æ·±å…¥çœ‹çœ‹ Javaï¼Œè€é¸Ÿè¿˜å¯ä»¥ç”¨ä¹‹å›é¡¾ Java çš„ä½“ç³»ã€‚è¿™æœ¬ä¹¦ä¹‹æ‰€ä»¥å‰å®³ï¼Œå› ä¸ºå®ƒåœ¨æ— å½¢ä¸­æ•´åˆäº†è®¾è®¡æ¨¡å¼ï¼Œè¿™æœ¬ä¹¦ä¹‹æ‰€ä»¥éš¾è¯»ï¼Œä¹Ÿæ°æ°åœ¨äºä»–å¯¹è®¾è®¡æ¨¡å¼çš„æ•´åˆæ˜¯æ— å½¢çš„ã€‚\n","permalink":"https://zjxjwxk.github.io/posts/java/java%E6%A0%B8%E5%BF%83/","summary":"\u003ch2 id=\"1-é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«\"\u003e1. é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«\u003c/h2\u003e\n\u003ch3 id=\"é¢å‘è¿‡ç¨‹\"\u003eé¢å‘è¿‡ç¨‹\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eä¼˜ç‚¹ï¼š\u003c/strong\u003e æ€§èƒ½æ¯”é¢å‘å¯¹è±¡é«˜ï¼Œå› ä¸ºç±»è°ƒç”¨æ—¶éœ€è¦å®ä¾‹åŒ–ï¼Œå¼€é”€æ¯”è¾ƒå¤§ï¼Œæ¯”è¾ƒæ¶ˆè€—èµ„æº;æ¯”å¦‚å•ç‰‡æœºã€åµŒå…¥å¼å¼€å‘ã€Linux/Unixç­‰ä¸€èˆ¬é‡‡ç”¨é¢å‘è¿‡ç¨‹å¼€å‘ï¼Œæ€§èƒ½æ˜¯æœ€é‡è¦çš„å› ç´ ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eç¼ºç‚¹ï¼š\u003c/strong\u003e æ²¡æœ‰é¢å‘å¯¹è±¡æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•\u003c/p\u003e\n\u003ch3 id=\"é¢å‘å¯¹è±¡\"\u003eé¢å‘å¯¹è±¡\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eä¼˜ç‚¹ï¼š\u003c/strong\u003e æ˜“ç»´æŠ¤ã€æ˜“å¤ç”¨ã€æ˜“æ‰©å±•ï¼Œç”±äºé¢å‘å¯¹è±¡æœ‰å°è£…ã€ç»§æ‰¿ã€å¤šæ€æ€§çš„ç‰¹æ€§ï¼Œå¯ä»¥è®¾è®¡å‡ºä½è€¦åˆçš„ç³»ç»Ÿï¼Œä½¿ç³»ç»Ÿæ›´åŠ çµæ´»ã€æ›´åŠ æ˜“äºç»´æŠ¤\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eç¼ºç‚¹ï¼š\u003c/strong\u003e æ€§èƒ½æ¯”é¢å‘è¿‡ç¨‹ä½\u003c/p\u003e\n\u003ch2 id=\"2-java-è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\"\u003e2. Java è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eç®€å•æ˜“å­¦ï¼›\u003c/li\u003e\n\u003cli\u003eé¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰ï¼›\u003c/li\u003e\n\u003cli\u003eå¹³å°æ— å…³æ€§ï¼ˆ Java è™šæ‹Ÿæœºå®ç°å¹³å°æ— å…³æ€§ï¼‰ï¼›\u003c/li\u003e\n\u003cli\u003eå¯é æ€§ï¼›\u003c/li\u003e\n\u003cli\u003eå®‰å…¨æ€§ï¼›\u003c/li\u003e\n\u003cli\u003eæ”¯æŒå¤šçº¿ç¨‹ï¼ˆ C++ è¯­è¨€æ²¡æœ‰å†…ç½®çš„å¤šçº¿ç¨‹æœºåˆ¶ï¼Œå› æ­¤å¿…é¡»è°ƒç”¨æ“ä½œç³»ç»Ÿçš„å¤šçº¿ç¨‹åŠŸèƒ½æ¥è¿›è¡Œå¤šçº¿ç¨‹ç¨‹åºè®¾è®¡ï¼Œè€Œ Java è¯­è¨€å´æä¾›äº†å¤šçº¿ç¨‹æ”¯æŒï¼‰ï¼›\u003c/li\u003e\n\u003cli\u003eæ”¯æŒç½‘ç»œç¼–ç¨‹å¹¶ä¸”å¾ˆæ–¹ä¾¿ï¼ˆ Java è¯­è¨€è¯ç”Ÿæœ¬èº«å°±æ˜¯ä¸ºç®€åŒ–ç½‘ç»œç¼–ç¨‹è®¾è®¡çš„ï¼Œå› æ­¤ Java è¯­è¨€ä¸ä»…æ”¯æŒç½‘ç»œç¼–ç¨‹è€Œä¸”å¾ˆæ–¹ä¾¿ï¼‰ï¼›\u003c/li\u003e\n\u003cli\u003eç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜ï¼›\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"3-ä»€ä¹ˆæ˜¯-jdk-ä»€ä¹ˆæ˜¯-jre-ä»€ä¹ˆæ˜¯-jvm-ä¸‰è€…ä¹‹é—´çš„è”ç³»ä¸åŒºåˆ«\"\u003e3. ä»€ä¹ˆæ˜¯ JDK ä»€ä¹ˆæ˜¯ JRE ä»€ä¹ˆæ˜¯ JVM ä¸‰è€…ä¹‹é—´çš„è”ç³»ä¸åŒºåˆ«\u003c/h2\u003e\n\u003cp\u003eè¿™å‡ ä¸ªæ˜¯Javaä¸­å¾ˆåŸºæœ¬å¾ˆåŸºæœ¬çš„ä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡ä¸€å®šè¿˜æœ‰å¾ˆå¤šäººæä¸æ¸…æ¥šï¼ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬å¤§å¤šæ•°æ—¶å€™åœ¨ä½¿ç”¨ç°æˆçš„ç¼–è¯‘å·¥å…·ä»¥åŠç¯å¢ƒçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰å»è€ƒè™‘è¿™äº›ä¸œè¥¿ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJDK:\u003c/strong\u003e JDKï¼ˆJava Development Kitï¼‰é¡¾åæ€ä¹‰å®ƒæ˜¯ç»™å¼€å‘è€…æä¾›çš„å¼€å‘å·¥å…·ç®±,æ˜¯ç»™ç¨‹åºå¼€å‘è€…ç”¨çš„ã€‚å®ƒé™¤äº†åŒ…æ‹¬å®Œæ•´çš„JREï¼ˆJava Runtime Environmentï¼‰ï¼ŒJavaè¿è¡Œç¯å¢ƒï¼Œè¿˜åŒ…å«äº†å…¶ä»–ä¾›å¼€å‘è€…ä½¿ç”¨çš„å·¥å…·åŒ…ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJRE:\u003c/strong\u003e æ™®é€šç”¨æˆ·è€Œåªéœ€è¦å®‰è£… JREï¼ˆJava Runtime Environmentï¼‰æ¥è¿è¡Œ Java ç¨‹åºã€‚è€Œç¨‹åºå¼€å‘è€…å¿…é¡»å®‰è£…JDKæ¥ç¼–è¯‘ã€è°ƒè¯•ç¨‹åºã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eJVMï¼š\u003c/strong\u003e å½“æˆ‘ä»¬è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼ŒJVM è´Ÿè´£å°†å­—èŠ‚ç è½¬æ¢ä¸ºç‰¹å®šæœºå™¨ä»£ç ï¼ŒJVM æä¾›äº†å†…å­˜ç®¡ç†/åƒåœ¾å›æ”¶å’Œå®‰å…¨æœºåˆ¶ç­‰ã€‚è¿™ç§ç‹¬ç«‹äºç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿï¼Œæ­£æ˜¯ java ç¨‹åºå¯ä»¥ä¸€æ¬¡ç¼–å†™å¤šå¤„æ‰§è¡Œçš„åŸå› ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eåŒºåˆ«ä¸è”ç³»ï¼š\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eJDK ç”¨äºå¼€å‘ï¼ŒJRE ç”¨äºè¿è¡Œjavaç¨‹åº ï¼›\u003c/li\u003e\n\u003cli\u003eJDK å’Œ JRE ä¸­éƒ½åŒ…å« JVM ï¼›\u003c/li\u003e\n\u003cli\u003eJVM æ˜¯ java ç¼–ç¨‹è¯­è¨€çš„æ ¸å¿ƒå¹¶ä¸”å…·æœ‰å¹³å°ç‹¬ç«‹æ€§ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"4-ä»€ä¹ˆæ˜¯å­—èŠ‚ç -é‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\"\u003e4. ä»€ä¹ˆæ˜¯å­—èŠ‚ç  é‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆ\u003c/h2\u003e\n\u003ch3 id=\"å…ˆçœ‹ä¸‹-java-ä¸­çš„ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨\"\u003eå…ˆçœ‹ä¸‹ java ä¸­çš„ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ï¼š ã€€ã€€\u003c/h3\u003e\n\u003cp\u003eJava ä¸­å¼•å…¥äº†è™šæ‹Ÿæœºçš„æ¦‚å¿µï¼Œå³åœ¨æœºå™¨å’Œç¼–è¯‘ç¨‹åºä¹‹é—´åŠ å…¥äº†ä¸€å±‚æŠ½è±¡çš„è™šæ‹Ÿçš„æœºå™¨ã€‚è¿™å°è™šæ‹Ÿçš„æœºå™¨åœ¨ä»»ä½•å¹³å°ä¸Šéƒ½æä¾›ç»™ç¼–è¯‘ç¨‹åºä¸€ä¸ªçš„å…±åŒçš„æ¥å£ã€‚\u003c/p\u003e","title":"JavaåŸºç¡€çŸ¥è¯†"}]